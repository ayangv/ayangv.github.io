<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>zhishengçš„åšå®¢</title>
  
  <subtitle>å‘è¦ä¸€ä¸ªä¸ªå¡«ï¼Œè·¯è¦ä¸€æ­¥æ­¥èµ°ï¼</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2018-10-01T04:16:46.000Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>zhisheng</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Mac ä¸Šæ­å»º Flink 1.6.0 ç¯å¢ƒå¹¶æ„å»ºè¿è¡Œç®€å•ç¨‹åºå…¥é—¨</title>
    <link href="http://yoursite.com/2018/09/18/flink-install/"/>
    <id>http://yoursite.com/2018/09/18/flink-install/</id>
    <published>2018-09-17T16:00:00.000Z</published>
    <updated>2018-10-01T04:16:46.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://ws2.sinaimg.cn/large/006tNc79ly1fvsli4dkgzj31hc0zfass.jpg" alt="009"></p><a id="more"></a><h3 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h3><p>1ã€å®‰è£…æŸ¥çœ‹ Java çš„ç‰ˆæœ¬å·ï¼Œæ¨èä½¿ç”¨ Java 8ã€‚</p><h3 id="å®‰è£…-Flink"><a href="#å®‰è£…-Flink" class="headerlink" title="å®‰è£… Flink"></a>å®‰è£… Flink</h3><p>2ã€åœ¨ Mac OS X ä¸Šå®‰è£… Flink æ˜¯éå¸¸æ–¹ä¾¿çš„ã€‚æ¨èé€šè¿‡ homebrew æ¥å®‰è£…ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install apache-flink</span><br></pre></td></tr></table></figure><p>3ã€æ£€æŸ¥å®‰è£…ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flink --version</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Version: 1.6.0, Commit ID: ff472b4</span><br></pre></td></tr></table></figure><p>4ã€å¯åŠ¨ flink </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">è¿›å…¥å®‰è£…ç›®å½•ï¼š</span><br><span class="line"></span><br><span class="line">cd /usr/local/Cellar/apache-flink/1.6.0/libexec/bin</span><br><span class="line"></span><br><span class="line">æ‰§è¡Œä¸‹é¢å‘½ä»¤</span><br><span class="line"></span><br><span class="line">./start-cluster.sh</span><br><span class="line"></span><br><span class="line">å¯åŠ¨æ—¥å¿—ï¼š</span><br><span class="line"></span><br><span class="line">Starting cluster.</span><br><span class="line">Starting standalonesession daemon on host zhisheng.</span><br><span class="line">Starting taskexecutor daemon on host zhisheng.</span><br></pre></td></tr></table></figure><p>æ¥ç€å°±å¯ä»¥è¿›å…¥ web é¡µé¢(<a href="http://localhost:8081/" target="_blank" rel="noopener">http://localhost:8081/</a>) æŸ¥çœ‹</p><p><img src="https://ws3.sinaimg.cn/large/006tNbRwgy1fvdtbrqnqcj31ao0iamz8.jpg" alt="1flink-web"></p><h3 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h3><p>1ã€æ–°å»ºä¸€ä¸ª maven é¡¹ç›®</p><p><img src="https://ws2.sinaimg.cn/large/006tNbRwgy1fvdtdwzs0lj30sf0j7ae9.jpg" alt="flink-demo"></p><p>åˆ›å»ºä¸€ä¸ª SocketTextStreamWordCount æ–‡ä»¶ï¼ŒåŠ å…¥ä»¥ä¸‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zhisheng.flink;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.flink.api.common.functions.FlatMapFunction;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.api.java.tuple.Tuple2;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.streaming.api.datastream.DataStreamSource;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.streaming.api.datastream.SingleOutputStreamOperator;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.util.Collector;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by zhisheng_tian on 2018/9/18</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SocketTextStreamWordCount</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//å‚æ•°æ£€æŸ¥</span></span><br><span class="line">        <span class="keyword">if</span> (args.length != <span class="number">2</span>) &#123;</span><br><span class="line">            System.err.println(<span class="string">"USAGE:\nSocketTextStreamWordCount &lt;hostname&gt; &lt;port&gt;"</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        String hostname = args[<span class="number">0</span>];</span><br><span class="line">        Integer port = Integer.parseInt(args[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// set up the streaming execution environment</span></span><br><span class="line">        <span class="keyword">final</span> StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–æ•°æ®</span></span><br><span class="line">        DataStreamSource&lt;String&gt; stream = env.socketTextStream(hostname, port);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è®¡æ•°</span></span><br><span class="line">        SingleOutputStreamOperator&lt;Tuple2&lt;String, Integer&gt;&gt; sum = stream.flatMap(<span class="keyword">new</span> LineSplitter())</span><br><span class="line">                .keyBy(<span class="number">0</span>)</span><br><span class="line">                .sum(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        sum.print();</span><br><span class="line"></span><br><span class="line">        env.execute(<span class="string">"Java WordCount from SocketTextStream Example"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">LineSplitter</span> <span class="keyword">implements</span> <span class="title">FlatMapFunction</span>&lt;<span class="title">String</span>, <span class="title">Tuple2</span>&lt;<span class="title">String</span>, <span class="title">Integer</span>&gt;&gt; </span>&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">flatMap</span><span class="params">(String s, Collector&lt;Tuple2&lt;String, Integer&gt;&gt; collector)</span> </span>&#123;</span><br><span class="line">            String[] tokens = s.toLowerCase().split(<span class="string">"\\W+"</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (String token: tokens) &#123;</span><br><span class="line">                <span class="keyword">if</span> (token.length() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    collector.collect(<span class="keyword">new</span> Tuple2&lt;String, Integer&gt;(token, <span class="number">1</span>));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ç€è¿›å…¥å·¥ç¨‹ç›®å½•ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ‰“åŒ…ã€‚</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn clean package -Dmaven.test.skip=true</span><br></pre></td></tr></table></figure><p><img src="https://ws4.sinaimg.cn/large/006tNbRwgy1fvdth7y4k1j31b40gxwi9.jpg" alt="2build"></p><p>ç„¶åæˆ‘ä»¬å¼€å¯ç›‘å¬ 9000 ç«¯å£: </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -l 9000</span><br></pre></td></tr></table></figure><p><img src="https://ws3.sinaimg.cn/large/006tNbRwgy1fvdtiq9l78j30nd04h3yp.jpg" alt="ç›‘å¬"></p><p>æœ€åè¿›å…¥ flink å®‰è£…ç›®å½• bin ä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è·‘ç¨‹åºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flink run -c com.zhisheng.flink.SocketTextStreamWordCount /Users/zhisheng/IdeaProjects/flink/word-count/target/original-word-count-1.0-SNAPSHOT.jar 127.0.0.1 9000</span><br></pre></td></tr></table></figure><p>æ³¨æ„æ¢æˆä½ è‡ªå·±é¡¹ç›®çš„è·¯å¾„ã€‚</p><p><img src="https://ws3.sinaimg.cn/large/006tNbRwgy1fvdtl0aml1j31kw05hgn9.jpg" alt="4run"></p><p>æ‰§è¡Œå®Œä¸Šè¿°å‘½ä»¤åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ webUI ä¸­çœ‹åˆ°æ­£åœ¨è¿è¡Œçš„ç¨‹åºï¼š</p><p> <img src="https://ws2.sinaimg.cn/large/006tNbRwgy1fvdtmqzvc8j31a10d7q41.jpg" alt="5running-job"></p><p>æˆ‘ä»¬å¯ä»¥åœ¨ nc ç›‘å¬ç«¯å£ä¸­è¾“å…¥ textï¼Œæ¯”å¦‚ï¼š</p><p><img src="https://ws2.sinaimg.cn/large/006tNbRwgy1fvdtrr7bvhj30mn08lt97.jpg" alt="nc"></p><p>ç„¶åæˆ‘ä»¬é€šè¿‡ tail å‘½ä»¤çœ‹ä¸€ä¸‹è¾“å‡ºçš„ log æ–‡ä»¶ï¼Œæ¥è§‚å¯Ÿç»Ÿè®¡ç»“æœã€‚è¿›å…¥ç›®å½• apache-flink/1.6.0/libexec/logï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tail -f flink-zhisheng-taskexecutor-0-zhisheng.out</span><br></pre></td></tr></table></figure><p> æ³¨æ„ï¼šåˆ‡æ¢æˆä½ è‡ªå·±çš„è·¯å¾„å’ŒæŸ¥çœ‹è‡ªå·±çš„ç›®å½•ã€‚</p><p><img src="https://ws3.sinaimg.cn/large/006tNbRwgy1fvdtw41tyoj31kw0bf0vd.jpg" alt="result"></p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æœ¬æ–‡æè¿°äº†å¦‚ä½•åœ¨ Mac ç”µè„‘ä¸Šå®‰è£… Flinkï¼ŒåŠè¿è¡Œå®ƒã€‚æ¥ç€é€šè¿‡ä¸€ä¸ªç®€å•çš„ Flink ç¨‹åºæ¥ä»‹ç»å¦‚ä½•æ„å»ºåŠè¿è¡ŒFlink ç¨‹åºã€‚</p><h3 id="å…³æ³¨æˆ‘"><a href="#å…³æ³¨æˆ‘" class="headerlink" title="å…³æ³¨æˆ‘"></a>å…³æ³¨æˆ‘</h3><p><img src="http://ohfk1r827.bkt.clouddn.com/blog/180103/C6LG3mGa12.jpg" alt="zhisheng"></p><p>è½¬è½½è¯·æ³¨æ˜åœ°å€ï¼š<a href="http://www.54tianzhisheng.cn/2018/09/18/flink-install" target="_blank" rel="noopener">http://www.54tianzhisheng.cn/2018/09/18/flink-install</a> </p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://ws2.sinaimg.cn/large/006tNc79ly1fvsli4dkgzj31hc0zfass.jpg&quot; alt=&quot;009&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="Flink" scheme="http://yoursite.com/tags/Flink/"/>
    
      <category term="å¤§æ•°æ®" scheme="http://yoursite.com/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/"/>
    
  </entry>
  
  <entry>
    <title>Go å¹¶å‘â€”â€”å®ç°åç¨‹åŒæ­¥çš„å‡ ç§æ–¹å¼</title>
    <link href="http://yoursite.com/2018/08/30/go-sync/"/>
    <id>http://yoursite.com/2018/08/30/go-sync/</id>
    <published>2018-08-29T16:00:00.000Z</published>
    <updated>2018-08-30T14:04:03.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://ws4.sinaimg.cn/large/006tNbRwly1fus2khvi22j31hc0zfahk.jpg" alt=""></p><a id="more"></a><h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>Java ä¸­æœ‰ä¸€ç³»åˆ—çš„çº¿ç¨‹åŒæ­¥çš„æ–¹æ³•ï¼Œgo é‡Œé¢æœ‰ goroutineï¼ˆåç¨‹ï¼‰ï¼Œå…ˆçœ‹ä¸‹ä¸‹é¢çš„ä»£ç æ‰§è¡Œçš„ç»“æœæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">"Goroutine 1"</span>)</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">"Goroutine 2"</span>)</span><br><span class="line">    &#125;()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œä»¥ä¸Šä»£ç å¾ˆå¯èƒ½çœ‹ä¸åˆ°è¾“å‡ºã€‚</p><p>å› ä¸ºæœ‰å¯èƒ½è¿™ä¸¤ä¸ªåç¨‹è¿˜æ²¡å¾—åˆ°æ‰§è¡Œï¼Œä¸»åç¨‹å°±å·²ç»ç»“æŸäº†ï¼Œè€Œä¸»åç¨‹ç»“æŸæ—¶ä¼šç»“æŸæ‰€æœ‰å…¶ä»–åç¨‹ï¼Œæ‰€ä»¥å¯¼è‡´ä»£ç è¿è¡Œçš„ç»“æœä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚</p><p>ä¼°è®¡ä¸å°‘æ–°æ¥è§¦ go çš„ç«¥é‹éƒ½ä¼šå¯¹æ­¤éƒé—·ğŸ˜’ï¼Œå¯èƒ½ä¼šé—®é‚£ä¹ˆè¯¥å¦‚ä½•ç­‰å¾…ä¸»åç¨‹ä¸­åˆ›å»ºçš„åç¨‹æ‰§è¡Œå®Œæ¯•ä¹‹åå†ç»“æŸä¸»åç¨‹å‘¢ï¼Ÿ</p><p>ä¸‹é¢è¯´å‡ ç§å¯ä»¥è§£å†³çš„æ–¹æ³•ï¼š</p><h3 id="Sleep-ä¸€æ®µæ—¶é—´"><a href="#Sleep-ä¸€æ®µæ—¶é—´" class="headerlink" title="Sleep ä¸€æ®µæ—¶é—´"></a>Sleep ä¸€æ®µæ—¶é—´</h3><p>åœ¨ main æ–¹æ³•é€€å‡ºä¹‹å‰ sleep ä¸€æ®µæ—¶é—´å°±<strong>å¯èƒ½</strong>ä¼šå‡ºç°ç»“æœäº†ï¼Œå¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">    <span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">"Goroutine 1"</span>)</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">"Goroutine 2"</span>)</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    time.Sleep(time.Second * <span class="number">1</span>) <span class="comment">// ç¡çœ 1ç§’ï¼Œç­‰å¾…ä¸Šé¢ä¸¤ä¸ªåç¨‹ç»“æŸ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸¤ä¸ªç®€å•çš„åç¨‹æ‰§è¡Œæ¶ˆè€—çš„æ—¶é—´å¾ˆçŸ­çš„ï¼Œæ‰€ä»¥ä½ ä¼šå‘ç°ç°åœ¨å°±æœ‰ç»“æœå‡ºç°äº†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Goroutine 1</span><br><span class="line">Goroutine 2</span><br></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆä¸Šé¢æˆ‘è¦è¯´ â€œå¯èƒ½ä¼šå‡ºç°â€ ï¼Ÿ</p><p>å› ä¸º sleep è¿™ä¸ªæ—¶é—´ç›®å‰æ˜¯è®¾ç½®çš„ 1sï¼Œå¦‚æœæˆ‘è¿™ä¸¤ä¸ªåç¨‹é‡Œé¢æ‰§è¡Œäº†å¾ˆå¤æ‚çš„é€»è¾‘æ“ä½œï¼ˆæ—¶é—´å¤§äº 1sï¼‰ï¼Œé‚£ä¹ˆå°±ä¼šå‘ç°ä¾æ—§ä¹Ÿæ˜¯æ— ç»“æœæ‰“å°å‡ºæ¥çš„ã€‚</p><p>é‚£ä¹ˆå°±å¯ä»¥å‘ç°è¿™ç§æ–¹å¼å¾—åˆ°é—®é¢˜æ‰€åœ¨äº†ï¼š<strong>æˆ‘ä»¬æ— æ³•ç¡®å®šéœ€è¦ç¡çœ å¤šä¹…</strong></p><p>ä¸Šé¢é‚£ç§æ–¹å¼æœ‰é—®é¢˜ï¼Œgo é‡Œé¢å…¶å®ä¹Ÿå¯ä»¥ç”¨ç®¡é“æ¥å®ç°åŒæ­¥çš„ã€‚</p><h3 id="ç®¡é“å®ç°åŒæ­¥"><a href="#ç®¡é“å®ç°åŒæ­¥" class="headerlink" title="ç®¡é“å®ç°åŒæ­¥"></a>ç®¡é“å®ç°åŒæ­¥</h3><p>é‚£ä¹ˆç”¨ç®¡é“æ€ä¹ˆå®ç°åŒæ­¥å‘¢ï¼Ÿshow codeï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">struct</span>&#123;&#125;)</span><br><span class="line">    count := <span class="number">2</span> <span class="comment">// count è¡¨ç¤ºæ´»åŠ¨çš„åç¨‹ä¸ªæ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">"Goroutine 1"</span>)</span><br><span class="line">        ch &lt;- <span class="keyword">struct</span>&#123;&#125;&#123;&#125; <span class="comment">// åç¨‹ç»“æŸï¼Œå‘å‡ºä¿¡å·</span></span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">"Goroutine 2"</span>)</span><br><span class="line">        ch &lt;- <span class="keyword">struct</span>&#123;&#125;&#123;&#125; <span class="comment">// åç¨‹ç»“æŸï¼Œå‘å‡ºä¿¡å·</span></span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> <span class="keyword">range</span> ch &#123;</span><br><span class="line">        <span class="comment">// æ¯æ¬¡ä»chä¸­æ¥æ”¶æ•°æ®ï¼Œè¡¨æ˜ä¸€ä¸ªæ´»åŠ¨çš„åç¨‹ç»“æŸ</span></span><br><span class="line">        count--</span><br><span class="line">        <span class="comment">// å½“æ‰€æœ‰æ´»åŠ¨çš„åç¨‹éƒ½ç»“æŸæ—¶ï¼Œå…³é—­ç®¡é“</span></span><br><span class="line">        <span class="keyword">if</span> count == <span class="number">0</span> &#123;</span><br><span class="line">            <span class="built_in">close</span>(ch)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ç§æ–¹å¼æ˜¯ä¸€ç§æ¯”è¾ƒå®Œç¾çš„è§£å†³æ–¹æ¡ˆï¼Œ goroutine / channel å®ƒä»¬ä¹Ÿæ˜¯åœ¨ go é‡Œé¢ç»å¸¸æ­é…åœ¨ä¸€èµ·çš„ä¸€å¯¹ã€‚</p><h3 id="sync-WaitGroup"><a href="#sync-WaitGroup" class="headerlink" title="sync.WaitGroup"></a>sync.WaitGroup</h3><p>å…¶å® go é‡Œé¢ä¹Ÿæä¾›äº†æ›´ç®€å•çš„æ–¹å¼ â€”â€” ä½¿ç”¨ sync.WaitGroupã€‚</p><p>WaitGroup é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯ç”¨æ¥ç­‰å¾…ä¸€ç»„æ“ä½œå®Œæˆçš„ã€‚WaitGroup å†…éƒ¨å®ç°äº†ä¸€ä¸ªè®¡æ•°å™¨ï¼Œç”¨æ¥è®°å½•æœªå®Œæˆçš„æ“ä½œä¸ªæ•°ï¼Œå®ƒæä¾›äº†ä¸‰ä¸ªæ–¹æ³•ï¼š</p><ul><li>Add() ç”¨æ¥æ·»åŠ è®¡æ•°</li><li>Done() ç”¨æ¥åœ¨æ“ä½œç»“æŸæ—¶è°ƒç”¨ï¼Œä½¿è®¡æ•°å‡ä¸€</li><li>Wait() ç”¨æ¥ç­‰å¾…æ‰€æœ‰çš„æ“ä½œç»“æŸï¼Œå³è®¡æ•°å˜ä¸º 0ï¼Œè¯¥å‡½æ•°ä¼šåœ¨è®¡æ•°ä¸ä¸º 0 æ—¶ç­‰å¾…ï¼Œåœ¨è®¡æ•°ä¸º 0 æ—¶ç«‹å³è¿”å›</li></ul><p>ç»§ç»­ show codeï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">    <span class="string">"sync"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> wg sync.WaitGroup</span><br><span class="line"></span><br><span class="line">    wg.Add(<span class="number">2</span>) <span class="comment">// å› ä¸ºæœ‰ä¸¤ä¸ªåŠ¨ä½œï¼Œæ‰€ä»¥å¢åŠ 2ä¸ªè®¡æ•°</span></span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">"Goroutine 1"</span>)</span><br><span class="line">        wg.Done() <span class="comment">// æ“ä½œå®Œæˆï¼Œå‡å°‘ä¸€ä¸ªè®¡æ•°</span></span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">"Goroutine 2"</span>)</span><br><span class="line">        wg.Done() <span class="comment">// æ“ä½œå®Œæˆï¼Œå‡å°‘ä¸€ä¸ªè®¡æ•°</span></span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    wg.Wait() <span class="comment">// ç­‰å¾…ï¼Œç›´åˆ°è®¡æ•°ä¸º0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½ ä¼šå‘ç°ä¹Ÿæ˜¯å¯ä»¥çœ‹åˆ°è¿è¡Œç»“æœçš„ï¼Œæ˜¯ä¸æ˜¯å‘ç°è¿™ç§æ–¹å¼æ˜¯å¾ˆç®€å•çš„ã€‚</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>å¤šçœ‹åˆ«äººå†™çš„ä»£ç ï¼›å¤šæƒ³æƒ³ä¸ºå•¥è¦è¿™æ ·å†™ï¼›å¤šæŸ¥è‡ªå·±ä¸ç†è§£çš„åœ°æ–¹ï¼›å¤šå†™ demo æµ‹è¯•ï¼›å¤šå†™æ–‡ç« æ€»ç»“ã€‚</p><h3 id="å…³æ³¨æˆ‘"><a href="#å…³æ³¨æˆ‘" class="headerlink" title="å…³æ³¨æˆ‘"></a>å…³æ³¨æˆ‘</h3><p><img src="http://ohfk1r827.bkt.clouddn.com/blog/180103/C6LG3mGa12.jpg" alt="zhisheng"></p><p>æœ¬æ–‡åœ°å€ä¸ºï¼š<a href="http://www.54tianzhisheng.cn/2018/08/30/go-sync/" target="_blank" rel="noopener">http://www.54tianzhisheng.cn/2018/08/30/go-sync/</a> ï¼Œè½¬è½½è¯·æ³¨æ˜åŸæ–‡å‡ºå¤„ï¼</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://ws4.sinaimg.cn/large/006tNbRwly1fus2khvi22j31hc0zfahk.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="GO" scheme="http://yoursite.com/tags/GO/"/>
    
  </entry>
  
  <entry>
    <title>æ•™ä½ å¦‚ä½•åœ¨ IDEA è¿œç¨‹ Debug ElasticSearch</title>
    <link href="http://yoursite.com/2018/08/14/idea-remote-debug-elasticsearch/"/>
    <id>http://yoursite.com/2018/08/14/idea-remote-debug-elasticsearch/</id>
    <published>2018-08-13T16:00:00.000Z</published>
    <updated>2018-10-01T04:12:57.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://ws1.sinaimg.cn/large/0069RVTdly1fu9jy37ktlj31hc0zkdnx.jpg" alt="007"></p><a id="more"></a><h3 id="å‰æ"><a href="#å‰æ" class="headerlink" title="å‰æ"></a>å‰æ</h3><p>ä¹‹å‰åœ¨<a href="http://www.54tianzhisheng.cn/2018/08/05/es-code01/" target="_blank" rel="noopener">æºç é˜…è¯»ç¯å¢ƒæ­å»ºæ–‡ç« </a>ä¸­å†™è¿‡æˆ‘é‡åˆ°çš„ä¸€ä¸ªé—®é¢˜è¿Ÿè¿Ÿæ²¡æœ‰è§£å†³ï¼Œä¹Ÿä¸€ç›´å›°æ‰°ç€æˆ‘ã€‚é—®é¢˜å¦‚ä¸‹ï¼Œåœ¨å¯åŠ¨çš„æ—¶å€™è§£å†³æ‰å…¶ä»–å¼‚å¸¸å’ŒæŠ¥é”™åï¼Œæœ€åå‰©ä¸‹è¿™ä¸ªé”™è¯¯ä¸€ç›´è§£å†³ä¸äº†ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">2018</span>-<span class="number">08</span>-<span class="number">01</span>T09:<span class="number">44</span>:<span class="number">27</span>,<span class="number">370</span>][ERROR][o.e.b.ElasticsearchUncaughtExceptionHandler] [] fatal error in thread [main], exiting</span><br><span class="line">java.lang.NoClassDefFoundError: org/elasticsearch/plugins/ExtendedPluginsClassLoader</span><br><span class="line">    at org.elasticsearch.plugins.PluginsService.loadBundle(PluginsService.java:<span class="number">632</span>) ~[main/:?]</span><br><span class="line">    at org.elasticsearch.plugins.PluginsService.loadBundles(PluginsService.java:<span class="number">557</span>) ~[main/:?]</span><br><span class="line">    at org.elasticsearch.plugins.PluginsService.&lt;init&gt;(PluginsService.java:<span class="number">162</span>) ~[main/:?]</span><br><span class="line">    at org.elasticsearch.node.Node.&lt;init&gt;(Node.java:<span class="number">311</span>) ~[main/:?]</span><br><span class="line">    at org.elasticsearch.node.Node.&lt;init&gt;(Node.java:<span class="number">252</span>) ~[main/:?]</span><br><span class="line">    at org.elasticsearch.bootstrap.Bootstrap$<span class="number">5</span>.&lt;init&gt;(Bootstrap.java:<span class="number">213</span>) ~[main/:?]</span><br><span class="line">    at org.elasticsearch.bootstrap.Bootstrap.setup(Bootstrap.java:<span class="number">213</span>) ~[main/:?]</span><br><span class="line">    at org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:<span class="number">326</span>) ~[main/:?]</span><br><span class="line">    at org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:<span class="number">136</span>) ~[main/:?]</span><br><span class="line">    at org.elasticsearch.bootstrap.Elasticsearch.execute(Elasticsearch.java:<span class="number">127</span>) ~[main/:?]</span><br><span class="line">    at org.elasticsearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:<span class="number">86</span>) ~[main/:?]</span><br><span class="line">    at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:<span class="number">124</span>) ~[main/:?]</span><br><span class="line">    at org.elasticsearch.cli.Command.main(Command.java:<span class="number">90</span>) ~[main/:?]</span><br><span class="line">    at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:<span class="number">93</span>) ~[main/:?]</span><br><span class="line">    at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:<span class="number">86</span>) ~[main/:?]</span><br><span class="line">Caused by: java.lang.ClassNotFoundException: org.elasticsearch.plugins.ExtendedPluginsClassLoader</span><br><span class="line">    at jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:<span class="number">582</span>) ~[?:?]</span><br><span class="line">    at jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:<span class="number">190</span>) ~[?:?]</span><br><span class="line">    at java.lang.ClassLoader.loadClass(ClassLoader.java:<span class="number">499</span>) ~[?:?]</span><br><span class="line">    ... <span class="number">15</span> more</span><br></pre></td></tr></table></figure><p>ç½‘ä¸Šçš„è§£å†³åŠæ³•ä¹Ÿè¯•äº†å¾ˆå¤šéï¼ŒåŒ…æ‹¬è‡ªå·±ä¹Ÿåœ¨ <a href="https://github.com/elastic/elasticsearch/issues/30774" target="_blank" rel="noopener">GitHub issue</a> æé—®äº†ï¼Œä¹Ÿæ²¡èƒ½è§£å†³ã€‚ç„¶ååé¢è‡ªå·±åˆ†äº«æ–‡ç« åœ¨æ˜é‡‘ä¹Ÿå‘ç°æœ‰äººå’Œæˆ‘æœ‰åŒæ ·çš„é—®é¢˜ã€‚</p><p>ä¸‹é¢è®²è®²å¦ä¸€ç§å¯ä»¥è®©ä½ ç»§ç»­çœ‹æºç çš„æ–¹æ³•ã€‚</p><h3 id="è¿œç¨‹-Debug"><a href="#è¿œç¨‹-Debug" class="headerlink" title="è¿œç¨‹ Debug"></a>è¿œç¨‹ Debug</h3><p>å‰ææ¡ä»¶æ˜¯ä½ ä¹‹å‰å·²ç»æŠŠé¡¹ç›®å¯¼å…¥è¿› IDEA äº†ï¼Œå¦‚æœä½ è¿˜æ²¡äº†è§£ï¼Œè¯·çœ‹ä¹‹å‰çš„æ–‡ç« ï¼Œè¿™é‡Œä¸é‡å¤äº†ã€‚</p><h4 id="å¯åŠ¨ä¸€ä¸ªå®ä¾‹"><a href="#å¯åŠ¨ä¸€ä¸ªå®ä¾‹" class="headerlink" title="å¯åŠ¨ä¸€ä¸ªå®ä¾‹"></a>å¯åŠ¨ä¸€ä¸ªå®ä¾‹</h4><p>åœ¨ä½  git æ‹‰å–ä¸‹çš„ä»£ç ï¼Œåˆ‡æ¢ä½ è¦é˜…è¯»çš„åˆ†æ”¯ä»£ç åï¼Œæ‰§è¡Œä¸‹é¢è¿™æ¡å‘½ä»¤å¯åŠ¨ä¸€ä¸ª debug çš„å®ä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./gradlew run --debug-jvm</span><br></pre></td></tr></table></figure><p>å¯åŠ¨ç­‰ä¼šåï¼Œå°±å¯ä»¥çœ‹åˆ°å¯åŠ¨å¥½åçš„ç«¯å£å·ä¸º 8000 äº†ã€‚</p><p><img src="https://ws1.sinaimg.cn/large/006tNbRwgy1fu9gcjbddyj31dv0fd7al.jpg" alt="å¯åŠ¨debugå®ä¾‹"></p><h4 id="é…ç½®-IDEA"><a href="#é…ç½®-IDEA" class="headerlink" title="é…ç½® IDEA"></a>é…ç½® IDEA</h4><p>æ–°å»ºä¸€ä¸ªè¿œç¨‹çš„ debugï¼š</p><p><img src="https://ws2.sinaimg.cn/large/006tNbRwgy1fu9gchtqvrj30v10lwgp8.jpg" alt="idea-remote"></p><p>é…ç½®å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://ws4.sinaimg.cn/large/006tNbRwgy1fu9gchfmn9j30v10lwgnz.jpg" alt="remote-settings"></p><p>æ¥ä¸‹æ¥ç‚¹å‡» OK å°±å¥½äº†ã€‚</p><p>ç„¶åç‚¹å‡»ä¸‹é¢çš„ debug å›¾æ ‡ï¼š</p><p><img src="https://ws3.sinaimg.cn/large/006tNbRwgy1fu9gcirlstj30o107o75i.jpg" alt="debug"></p><p>å¯åŠ¨åå¦‚ä¸‹ï¼š</p><p><img src="https://ws1.sinaimg.cn/large/006tNbRwgy1fu9gddmwktj30ou09r74p.jpg" alt="2018-08-14_19-18-11"></p><p>è¿™æ—¶å°±å¯ä»¥å‘ç°æ˜¯å¯ä»¥æŠŠæ•´ä¸ªæµç¨‹å…¨å¯åŠ¨äº†ï¼Œä¹Ÿä¸ä¼šæŠ¥ä»€ä¹ˆé”™è¯¯ï¼</p><p>æµç¨‹å…¨å¯åŠ¨åï¼Œä½ ä¼šå‘ç°ç»ˆç«¯çš„æ—¥å¿—éƒ½æ‰“å°å‡ºæ¥äº†ï¼ˆæ³¨æ„ï¼šè¿™æ—¶ä¸æ˜¯æ‰“å°åœ¨ä½ çš„ IDEA æ§åˆ¶å°ï¼‰</p><p><img src="https://ws2.sinaimg.cn/large/006tNbRwgy1fu9gcgggq1j31kw0uk4qp.jpg" alt="2018-08-14_19-21-48"></p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>é‡åˆ°é—®é¢˜ï¼Œå¤šæ€è€ƒï¼Œå¤šæœç´¢ï¼Œå¤šæƒ³åŠæ³•è§£å†³ï¼è¿™æ ·æ‰èƒ½å¤Ÿä¸æ–­çš„æå‡ä½ è§£å†³é—®é¢˜çš„èƒ½åŠ›ï¼</p><h3 id="å…³æ³¨æˆ‘"><a href="#å…³æ³¨æˆ‘" class="headerlink" title="å…³æ³¨æˆ‘"></a>å…³æ³¨æˆ‘</h3><h3 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h3><p>è½¬è½½è¯·åŠ¡å¿…æ³¨æ˜æ–‡ç« å‡ºå¤„ä¸ºï¼š</p><p><a href="http://www.54tianzhisheng.cn/2018/08/14/idea-remote-debug-elasticsearch/" target="_blank" rel="noopener">http://www.54tianzhisheng.cn/2018/08/14/idea-remote-debug-elasticsearch/</a></p><h3 id="ç›¸å…³æ–‡ç« "><a href="#ç›¸å…³æ–‡ç« " class="headerlink" title="ç›¸å…³æ–‡ç« "></a>ç›¸å…³æ–‡ç« </h3><p>1ã€<a href="http://www.54tianzhisheng.cn/2018/08/04/why-see-es-code/" target="_blank" rel="noopener">æ¸£æ¸£èœé¸¡ä¸ºä»€ä¹ˆè¦çœ‹ ElasticSearch æºç ï¼Ÿ</a></p><p>2ã€<a href="http://www.54tianzhisheng.cn/2018/08/05/es-code01/" target="_blank" rel="noopener">æ¸£æ¸£èœé¸¡çš„ ElasticSearch æºç è§£æ â€”â€” ç¯å¢ƒæ­å»º</a></p><p>3ã€<a href="http://www.54tianzhisheng.cn/2018/08/11/es-code02/" target="_blank" rel="noopener">æ¸£æ¸£èœé¸¡çš„ ElasticSearch æºç è§£æ â€”â€” å¯åŠ¨æµç¨‹(ä¸Š)</a></p><p>4ã€<a href="http://www.54tianzhisheng.cn/2018/08/11/es-code03/" target="_blank" rel="noopener">æ¸£æ¸£èœé¸¡çš„ ElasticSearch æºç è§£æ â€”â€” å¯åŠ¨æµç¨‹(ä¸‹)</a></p><p>5ã€<a href="http://www.54tianzhisheng.cn/2017/09/08/Elasticsearch-analyzers/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆä¸€ï¼‰ï¼šElasticsearch é»˜è®¤åˆ†è¯å™¨å’Œä¸­åˆ†åˆ†è¯å™¨ä¹‹é—´çš„æ¯”è¾ƒåŠä½¿ç”¨æ–¹æ³•</a></p><p>6ã€<a href="http://www.54tianzhisheng.cn/2017/09/09/Elasticsearch-install/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆäºŒï¼‰ï¼šå…¨æ–‡æœç´¢å¼•æ“ Elasticsearch é›†ç¾¤æ­å»ºå…¥é—¨æ•™ç¨‹</a></p><p>7ã€<a href="http://www.54tianzhisheng.cn/2017/10/15/ElasticSearch-cluster-health-metrics/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆä¸‰ï¼‰ï¼šElasticSearch é›†ç¾¤ç›‘æ§</a></p><p>8ã€<a href="http://www.54tianzhisheng.cn/2017/10/18/ElasticSearch-nodes-metrics/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆå››ï¼‰ï¼šElasticSearch å•ä¸ªèŠ‚ç‚¹ç›‘æ§</a></p><p>9ã€<a href="http://www.54tianzhisheng.cn/2017/12/25/ELK/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆäº”ï¼‰ï¼šELK å®æ—¶æ—¥å¿—åˆ†æå¹³å°ç¯å¢ƒæ­å»º</a></p><p>10ã€<a href="http://www.54tianzhisheng.cn/2018/08/14/idea-remote-debug-elasticsearch/" target="_blank" rel="noopener">æ•™ä½ å¦‚ä½•åœ¨ IDEA è¿œç¨‹ Debug ElasticSearch</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://ws1.sinaimg.cn/large/0069RVTdly1fu9jy37ktlj31hc0zkdnx.jpg&quot; alt=&quot;007&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="ElasticSearch" scheme="http://yoursite.com/tags/ElasticSearch/"/>
    
  </entry>
  
  <entry>
    <title>æ¸£æ¸£èœé¸¡çš„ ElasticSearch æºç è§£æ â€”â€” å¯åŠ¨æµç¨‹ï¼ˆä¸‹ï¼‰</title>
    <link href="http://yoursite.com/2018/08/12/es-code03/"/>
    <id>http://yoursite.com/2018/08/12/es-code03/</id>
    <published>2018-08-11T16:00:00.000Z</published>
    <updated>2018-08-14T13:32:55.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://ws1.sinaimg.cn/large/006tNbRwly1fu8gbvoubfj31hc0vlqdt.jpg" alt="006"></p><a id="more"></a><h3 id="å…³æ³¨æˆ‘"><a href="#å…³æ³¨æˆ‘" class="headerlink" title="å…³æ³¨æˆ‘"></a>å…³æ³¨æˆ‘</h3><p><img src="http://ohfk1r827.bkt.clouddn.com/blog/180103/C6LG3mGa12.jpg" alt="zhisheng"></p><p>è½¬è½½è¯·åŠ¡å¿…æ³¨æ˜åŸåˆ›åœ°å€ä¸ºï¼š<a href="http://www.54tianzhisheng.cn/2018/08/12/es-code03/" target="_blank" rel="noopener">http://www.54tianzhisheng.cn/2018/08/12/es-code03/</a></p><h3 id="å‰æ"><a href="#å‰æ" class="headerlink" title="å‰æ"></a>å‰æ</h3><p><a href="http://www.54tianzhisheng.cn/2018/08/11/es-code02/" target="_blank" rel="noopener">ä¸Šç¯‡æ–‡ç« </a>å†™å®Œäº† ES æµç¨‹å¯åŠ¨çš„ä¸€éƒ¨åˆ†ï¼Œmain æ–¹æ³•éƒ½å…¥å£ï¼Œä»¥åŠåˆ›å»º Elasticsearch è¿è¡Œçš„å¿…é¡»ç¯å¢ƒä»¥åŠç›¸å…³é…ç½®ï¼Œæ¥ç€å°±æ˜¯åˆ›å»ºè¯¥ç¯å¢ƒçš„èŠ‚ç‚¹äº†ã€‚</p><h3 id="Node-çš„åˆ›å»º"><a href="#Node-çš„åˆ›å»º" class="headerlink" title="Node çš„åˆ›å»º"></a>Node çš„åˆ›å»º</h3><p>çœ‹ä¸‹æ–°å»ºèŠ‚ç‚¹çš„ä»£ç ï¼š(ä»£ç æ¯”è¾ƒå¤šï¼Œè¿™é‡Œæ˜¯æ¯”è¾ƒå…³é”®çš„åœ°æ–¹ï¼Œæˆ‘å°±æŠŠæ³¨é‡Šç›´æ¥å†™åœ¨ä»£ç ä¸Šé¢äº†ï¼Œå®åœ¨ä¸å¥½æ‹†å¼€è¿™æ®µä»£ç ï¼Œ300 å¤šè¡Œä»£ç )</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">(Environment environment)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>(environment, Collections.emptyList()); <span class="comment">//æ‰§è¡Œä¸‹é¢çš„ä»£ç </span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="title">Node</span><span class="params">(<span class="keyword">final</span> Environment environment, Collection&lt;Class&lt;? extends Plugin&gt;&gt; classpathPlugins)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> List&lt;Closeable&gt; resourcesToClose = <span class="keyword">new</span> ArrayList&lt;&gt;(); <span class="comment">// register everything we need to release in the case of an error</span></span><br><span class="line">    <span class="keyword">boolean</span> success = <span class="keyword">false</span>;</span><br><span class="line">    &#123;</span><br><span class="line"><span class="comment">// use temp logger just to say we are starting. we can't use it later on because the node name might not be set</span></span><br><span class="line">        Logger logger = Loggers.getLogger(Node.class, NODE_NAME_SETTING.get(environment.settings()));</span><br><span class="line">        logger.info(<span class="string">"initializing ..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        originalSettings = environment.settings();</span><br><span class="line">        Settings tmpSettings = Settings.builder().put(environment.settings())</span><br><span class="line">            .put(Client.CLIENT_TYPE_SETTING_S.getKey(), CLIENT_TYPE).build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// create the node environment as soon as possible, to recover the node id and enable logging</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            nodeEnvironment = <span class="keyword">new</span> NodeEnvironment(tmpSettings, environment); <span class="comment">//1ã€åˆ›å»ºèŠ‚ç‚¹ç¯å¢ƒ,æ¯”å¦‚èŠ‚ç‚¹åç§°,èŠ‚ç‚¹ID,åˆ†ç‰‡ä¿¡æ¯,å­˜å‚¨å…ƒ,ä»¥åŠåˆ†é…å†…å­˜å‡†å¤‡ç»™èŠ‚ç‚¹ä½¿ç”¨</span></span><br><span class="line">            resourcesToClose.add(nodeEnvironment);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException ex) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"Failed to create node environment"</span>, ex);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">boolean</span> hadPredefinedNodeName = NODE_NAME_SETTING.exists(tmpSettings);</span><br><span class="line">        <span class="keyword">final</span> String nodeId = nodeEnvironment.nodeId();</span><br><span class="line">        tmpSettings = addNodeNameIfNeeded(tmpSettings, nodeId);</span><br><span class="line">        <span class="keyword">final</span> Logger logger = Loggers.getLogger(Node.class, tmpSettings);</span><br><span class="line"><span class="comment">// this must be captured after the node name is possibly added to the settings</span></span><br><span class="line">        <span class="keyword">final</span> String nodeName = NODE_NAME_SETTING.get(tmpSettings);</span><br><span class="line">        <span class="keyword">if</span> (hadPredefinedNodeName == <span class="keyword">false</span>) &#123;</span><br><span class="line">            logger.info(<span class="string">"node name derived from node ID [&#123;&#125;]; set [&#123;&#125;] to override"</span>, nodeId, NODE_NAME_SETTING.getKey());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            logger.info(<span class="string">"node name [&#123;&#125;], node ID [&#123;&#125;]"</span>, nodeName, nodeId);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2ã€æ‰“å°å‡ºJVMç›¸å…³ä¿¡æ¯</span></span><br><span class="line">        <span class="keyword">final</span> JvmInfo jvmInfo = JvmInfo.jvmInfo();</span><br><span class="line">        logger.info(</span><br><span class="line"><span class="string">"version[&#123;&#125;], pid[&#123;&#125;], build[&#123;&#125;/&#123;&#125;/&#123;&#125;/&#123;&#125;], OS[&#123;&#125;/&#123;&#125;/&#123;&#125;], JVM[&#123;&#125;/&#123;&#125;/&#123;&#125;/&#123;&#125;]"</span>,</span><br><span class="line">            Version.displayVersion(Version.CURRENT, Build.CURRENT.isSnapshot()),</span><br><span class="line">            jvmInfo.pid(), Build.CURRENT.flavor().displayName(),</span><br><span class="line">            Build.CURRENT.type().displayName(), Build.CURRENT.shortHash(),</span><br><span class="line">            Build.CURRENT.date(), Constants.OS_NAME, Constants.OS_VERSION,</span><br><span class="line">            Constants.OS_ARCH,Constants.JVM_VENDOR,Constants.JVM_NAME,</span><br><span class="line">            Constants.JAVA_VERSION,Constants.JVM_VERSION);</span><br><span class="line">        logger.info(<span class="string">"JVM arguments &#123;&#125;"</span>, Arrays.toString(jvmInfo.getInputArguments()));</span><br><span class="line">        <span class="comment">//æ£€æŸ¥å½“å‰ç‰ˆæœ¬æ˜¯ä¸æ˜¯ pre-release ç‰ˆæœ¬ï¼ˆSnapshotï¼‰ï¼Œ</span></span><br><span class="line">        warnIfPreRelease(Version.CURRENT, Build.CURRENT.isSnapshot(), logger);</span><br><span class="line">ã€‚ã€‚ã€‚</span><br><span class="line">        <span class="keyword">this</span>.pluginsService = <span class="keyword">new</span> PluginsService(tmpSettings, environment.configFile(), environment.modulesFile(), environment.pluginsFile(), classpathPlugins);   <span class="comment">//3ã€åˆ©ç”¨PluginsServiceåŠ è½½ç›¸åº”çš„æ¨¡å—å’Œæ’ä»¶</span></span><br><span class="line">        <span class="keyword">this</span>.settings = pluginsService.updatedSettings();</span><br><span class="line">        localNodeFactory = <span class="keyword">new</span> LocalNodeFactory(settings, nodeEnvironment.nodeId());</span><br><span class="line"></span><br><span class="line"><span class="comment">// create the environment based on the finalized (processed) view of the settings</span></span><br><span class="line"><span class="comment">// this is just to makes sure that people get the same settings, no matter where they ask them from</span></span><br><span class="line">        <span class="keyword">this</span>.environment = <span class="keyword">new</span> Environment(<span class="keyword">this</span>.settings, environment.configFile());</span><br><span class="line">        Environment.assertEquivalent(environment, <span class="keyword">this</span>.environment);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> List&lt;ExecutorBuilder&lt;?&gt;&gt; executorBuilders = pluginsService.getExecutorBuilders(settings);        <span class="comment">//çº¿ç¨‹æ± </span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> ThreadPool threadPool = <span class="keyword">new</span> ThreadPool(settings, executorBuilders.toArray(<span class="keyword">new</span> ExecutorBuilder[<span class="number">0</span>]));</span><br><span class="line">        resourcesToClose.add(() -&gt; ThreadPool.terminate(threadPool, <span class="number">10</span>, TimeUnit.SECONDS));</span><br><span class="line">        <span class="comment">// adds the context to the DeprecationLogger so that it does not need to be injected everywhere</span></span><br><span class="line">        DeprecationLogger.setThreadContext(threadPool.getThreadContext());</span><br><span class="line">        resourcesToClose.add(() -&gt; DeprecationLogger.removeThreadContext(threadPool.getThreadContext()));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> List&lt;Setting&lt;?&gt;&gt; additionalSettings = <span class="keyword">new</span> ArrayList&lt;&gt;(pluginsService.getPluginSettings());       <span class="comment">//é¢å¤–é…ç½®</span></span><br><span class="line">        <span class="keyword">final</span> List&lt;String&gt; additionalSettingsFilter = <span class="keyword">new</span> ArrayList&lt;&gt;(pluginsService.getPluginSettingsFilter());</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">final</span> ExecutorBuilder&lt;?&gt; builder : threadPool.builders()) &#123;</span><br><span class="line">            <span class="comment">//4ã€åŠ è½½ä¸€äº›é¢å¤–é…ç½®</span></span><br><span class="line">            additionalSettings.addAll(builder.getRegisteredSettings());</span><br><span class="line">        &#125;</span><br><span class="line">        client = <span class="keyword">new</span> NodeClient(settings, threadPool);<span class="comment">//5ã€åˆ›å»ºä¸€ä¸ªèŠ‚ç‚¹å®¢æˆ·ç«¯                                                                                  </span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//6ã€ç¼“å­˜ä¸€ç³»åˆ—æ¨¡å—,å¦‚NodeModule,ClusterModule,IndicesModule,ActionModule,GatewayModule,SettingsModule,RepositioriesModuleï¼ŒscriptModuleï¼ŒanalysisModule</span></span><br><span class="line">        <span class="keyword">final</span> ResourceWatcherService resourceWatcherService = <span class="keyword">new</span> ResourceWatcherService(settings, threadPool);</span><br><span class="line">        <span class="keyword">final</span> ScriptModule scriptModule = <span class="keyword">new</span> ScriptModule(settings, pluginsService.filterPlugins(ScriptPlugin.class));</span><br><span class="line">        AnalysisModule analysisModule = <span class="keyword">new</span> AnalysisModule(<span class="keyword">this</span>.environment, pluginsService.filterPlugins(AnalysisPlugin.class));</span><br><span class="line">        <span class="comment">// this is as early as we can validate settings at this point. we already pass them to ScriptModule as well as ThreadPool so we might be late here already</span></span><br><span class="line">        <span class="keyword">final</span> SettingsModule settingsModule = <span class="keyword">new</span> SettingsModule(<span class="keyword">this</span>.settings, additionalSettings, additionalSettingsFilter);</span><br><span class="line">scriptModule.registerClusterSettingsListeners(settingsModule.getClusterSettings());</span><br><span class="line">        resourcesToClose.add(resourceWatcherService);</span><br><span class="line">        <span class="keyword">final</span> NetworkService networkService = <span class="keyword">new</span> NetworkService(</span><br><span class="line">  getCustomNameResolvers(pluginsService.filterPlugins(DiscoveryPlugin.class)));</span><br><span class="line">        List&lt;ClusterPlugin&gt; clusterPlugins = pluginsService.filterPlugins(ClusterPlugin.class);</span><br><span class="line">        <span class="keyword">final</span> ClusterService clusterService = <span class="keyword">new</span> ClusterService(settings, settingsModule.getClusterSettings(), threadPool,                                                      ClusterModule.getClusterStateCustomSuppliers(clusterPlugins));</span><br><span class="line">        clusterService.addStateApplier(scriptModule.getScriptService());</span><br><span class="line">        resourcesToClose.add(clusterService);</span><br><span class="line">        <span class="keyword">final</span> IngestService ingestService = <span class="keyword">new</span> IngestService(settings, threadPool, <span class="keyword">this</span>.environment,                                                  scriptModule.getScriptService(), analysisModule.getAnalysisRegistry(), pluginsService.filterPlugins(IngestPlugin.class));</span><br><span class="line">        <span class="keyword">final</span> DiskThresholdMonitor listener = <span class="keyword">new</span> DiskThresholdMonitor(settings, clusterService::state, clusterService.getClusterSettings(), client);</span><br><span class="line">        <span class="keyword">final</span> ClusterInfoService clusterInfoService = newClusterInfoService(settings, clusterService, threadPool, client,</span><br><span class="line">listener::onNewInfo);</span><br><span class="line">        <span class="keyword">final</span> UsageService usageService = <span class="keyword">new</span> UsageService(settings);</span><br><span class="line"></span><br><span class="line">        ModulesBuilder modules = <span class="keyword">new</span> ModulesBuilder();</span><br><span class="line"><span class="comment">// plugin modules must be added here, before others or we can get crazy injection errors...</span></span><br><span class="line">        <span class="keyword">for</span> (Module pluginModule : pluginsService.createGuiceModules()) &#123;</span><br><span class="line">            modules.add(pluginModule);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">final</span> MonitorService monitorService = <span class="keyword">new</span> MonitorService(settings, nodeEnvironment, threadPool, clusterInfoService);</span><br><span class="line">        ClusterModule clusterModule = <span class="keyword">new</span> ClusterModule(settings, clusterService, clusterPlugins, clusterInfoService);</span><br><span class="line">        modules.add(clusterModule);</span><br><span class="line">        IndicesModule indicesModule = <span class="keyword">new</span> IndicesModule(pluginsService.filterPlugins(MapperPlugin.class));</span><br><span class="line">        modules.add(indicesModule);</span><br><span class="line"></span><br><span class="line">        SearchModule searchModule = <span class="keyword">new</span> SearchModule(settings, <span class="keyword">false</span>, pluginsService.filterPlugins(SearchPlugin.class));</span><br><span class="line">        CircuitBreakerService circuitBreakerService = createCircuitBreakerService(settingsModule.getSettings(),</span><br><span class="line">                                                                                  settingsModule.getClusterSettings());</span><br><span class="line">        resourcesToClose.add(circuitBreakerService);</span><br><span class="line">        modules.add(<span class="keyword">new</span> GatewayModule());</span><br><span class="line"></span><br><span class="line">        PageCacheRecycler pageCacheRecycler = createPageCacheRecycler(settings);</span><br><span class="line">        BigArrays bigArrays = createBigArrays(pageCacheRecycler, circuitBreakerService);</span><br><span class="line">        resourcesToClose.add(bigArrays);</span><br><span class="line">        modules.add(settingsModule);</span><br><span class="line">        List&lt;NamedWriteableRegistry.Entry&gt; namedWriteables = Stream.of(</span><br><span class="line">            NetworkModule.getNamedWriteables().stream(),</span><br><span class="line">            indicesModule.getNamedWriteables().stream(),</span><br><span class="line">            searchModule.getNamedWriteables().stream(),</span><br><span class="line">            pluginsService.filterPlugins(Plugin.class).stream()</span><br><span class="line">            .flatMap(p -&gt; p.getNamedWriteables().stream()),</span><br><span class="line">            ClusterModule.getNamedWriteables().stream())</span><br><span class="line">            .flatMap(Function.identity()).collect(Collectors.toList());</span><br><span class="line">        <span class="keyword">final</span> NamedWriteableRegistry namedWriteableRegistry = <span class="keyword">new</span> NamedWriteableRegistry(namedWriteables);</span><br><span class="line">        NamedXContentRegistry xContentRegistry = <span class="keyword">new</span> NamedXContentRegistry(Stream.of(</span><br><span class="line">            NetworkModule.getNamedXContents().stream(),</span><br><span class="line">            searchModule.getNamedXContents().stream(),</span><br><span class="line">            pluginsService.filterPlugins(Plugin.class).stream()</span><br><span class="line">            .flatMap(p -&gt; p.getNamedXContent().stream()),</span><br><span class="line">            ClusterModule.getNamedXWriteables().stream())</span><br><span class="line">.flatMap(Function.identity()).collect(toList()));</span><br><span class="line">        modules.add(<span class="keyword">new</span> RepositoriesModule(<span class="keyword">this</span>.environment, pluginsService.filterPlugins(RepositoryPlugin.class), xContentRegistry));</span><br><span class="line">        <span class="keyword">final</span> MetaStateService metaStateService = <span class="keyword">new</span> MetaStateService(settings, nodeEnvironment, xContentRegistry);</span><br><span class="line">        <span class="keyword">final</span> IndicesService indicesService = <span class="keyword">new</span> IndicesService(settings, pluginsService, nodeEnvironment, xContentRegistry,</span><br><span class="line">analysisModule.getAnalysisRegistry(),                                                                clusterModule.getIndexNameExpressionResolver(), indicesModule.getMapperRegistry(), namedWriteableRegistry,threadPool, settingsModule.getIndexScopedSettings(), circuitBreakerService, bigArrays, scriptModule.getScriptService(),client, metaStateService);</span><br><span class="line"></span><br><span class="line">        Collection&lt;Object&gt; pluginComponents = pluginsService.filterPlugins(Plugin.class).stream()</span><br><span class="line">            .flatMap(p -&gt; p.createComponents(client, clusterService, threadPool, resourceWatcherService,scriptModule.getScriptService(), xContentRegistry, environment, nodeEnvironment,namedWriteableRegistry).stream())</span><br><span class="line">.collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line">        ActionModule actionModule = <span class="keyword">new</span> ActionModule(<span class="keyword">false</span>, settings, clusterModule.getIndexNameExpressionResolver(),</span><br><span class="line">                                                     settingsModule.getIndexScopedSettings(), settingsModule.getClusterSettings(), settingsModule.getSettingsFilter(),threadPool, pluginsService.filterPlugins(ActionPlugin.class), client, circuitBreakerService, usageService);</span><br><span class="line">        modules.add(actionModule);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//7ã€è·å–RestController,ç”¨äºå¤„ç†å„ç§Elasticsearchçš„restå‘½ä»¤,å¦‚_cat,_all,_cat/health,_clustersç­‰restå‘½ä»¤(Elasticsearchç§°ä¹‹ä¸ºaction)</span></span><br><span class="line">        <span class="keyword">final</span> RestController restController = actionModule.getRestController();</span><br><span class="line">        <span class="keyword">final</span> NetworkModule networkModule = <span class="keyword">new</span> NetworkModule(settings, <span class="keyword">false</span>, pluginsService.filterPlugins(NetworkPlugin.class),threadPool, bigArrays, pageCacheRecycler, circuitBreakerService, namedWriteableRegistry, xContentRegistry,networkService, restController);</span><br><span class="line">        Collection&lt;UnaryOperator&lt;Map&lt;String, MetaData.Custom&gt;&gt;&gt; customMetaDataUpgraders =</span><br><span class="line">            pluginsService.filterPlugins(Plugin.class).stream()</span><br><span class="line">            .map(Plugin::getCustomMetaDataUpgrader)</span><br><span class="line">            .collect(Collectors.toList());</span><br><span class="line">        Collection&lt;UnaryOperator&lt;Map&lt;String, IndexTemplateMetaData&gt;&gt;&gt; indexTemplateMetaDataUpgraders =</span><br><span class="line">            pluginsService.filterPlugins(Plugin.class).stream()</span><br><span class="line">            .map(Plugin::getIndexTemplateMetaDataUpgrader)</span><br><span class="line">            .collect(Collectors.toList());</span><br><span class="line">        Collection&lt;UnaryOperator&lt;IndexMetaData&gt;&gt; indexMetaDataUpgraders = pluginsService.filterPlugins(Plugin.class).stream()</span><br><span class="line">            .map(Plugin::getIndexMetaDataUpgrader).collect(Collectors.toList());</span><br><span class="line">        <span class="keyword">final</span> MetaDataUpgrader metaDataUpgrader = <span class="keyword">new</span> MetaDataUpgrader(customMetaDataUpgraders, indexTemplateMetaDataUpgraders);</span><br><span class="line">        <span class="keyword">final</span> MetaDataIndexUpgradeService metaDataIndexUpgradeService = <span class="keyword">new</span> MetaDataIndexUpgradeService(settings, xContentRegistry,                                                                                            indicesModule.getMapperRegistry(), settingsModule.getIndexScopedSettings(), indexMetaDataUpgraders);</span><br><span class="line">        <span class="keyword">final</span> GatewayMetaState gatewayMetaState = <span class="keyword">new</span> GatewayMetaState(settings, nodeEnvironment, metaStateService,                                                      metaDataIndexUpgradeService, metaDataUpgrader);</span><br><span class="line">        <span class="keyword">new</span> TemplateUpgradeService(settings, client, clusterService, threadPool, indexTemplateMetaDataUpgraders);</span><br><span class="line">        <span class="keyword">final</span> Transport transport = networkModule.getTransportSupplier().get();</span><br><span class="line">        Set&lt;String&gt; taskHeaders = Stream.concat(</span><br><span class="line">            pluginsService.filterPlugins(ActionPlugin.class).stream().flatMap(p -&gt; p.getTaskHeaders().stream()),</span><br><span class="line">            Stream.of(<span class="string">"X-Opaque-Id"</span>)</span><br><span class="line">        ).collect(Collectors.toSet());</span><br><span class="line">        <span class="keyword">final</span> TransportService transportService = newTransportService(settings, transport, threadPool,</span><br><span class="line">                                                                      networkModule.getTransportInterceptor(), localNodeFactory, settingsModule.getClusterSettings(), taskHeaders);</span><br><span class="line">        <span class="keyword">final</span> ResponseCollectorService responseCollectorService = <span class="keyword">new</span> ResponseCollectorService(<span class="keyword">this</span>.settings, clusterService);</span><br><span class="line">        <span class="keyword">final</span> SearchTransportService searchTransportService =  <span class="keyword">new</span> SearchTransportService(settings, transportService,</span><br><span class="line">                                                                                          SearchExecutionStatsCollector.makeWrapper(responseCollectorService));</span><br><span class="line">        <span class="keyword">final</span> Consumer&lt;Binder&gt; httpBind;</span><br><span class="line">        <span class="keyword">final</span> HttpServerTransport httpServerTransport;</span><br><span class="line">        <span class="keyword">if</span> (networkModule.isHttpEnabled()) &#123;</span><br><span class="line">            httpServerTransport = networkModule.getHttpServerTransportSupplier().get();</span><br><span class="line">            httpBind = b -&gt; &#123;</span><br><span class="line">b.bind(HttpServerTransport.class).toInstance(httpServerTransport);</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            httpBind = b -&gt; &#123;</span><br><span class="line">                b.bind(HttpServerTransport.class).toProvider(Providers.of(<span class="keyword">null</span>));</span><br><span class="line">            &#125;;</span><br><span class="line">            httpServerTransport = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> DiscoveryModule discoveryModule = <span class="keyword">new</span> DiscoveryModule(<span class="keyword">this</span>.settings, threadPool, transportService, namedWriteableRegistry,networkService, clusterService.getMasterService(), clusterService.getClusterApplierService(),clusterService.getClusterSettings(), pluginsService.filterPlugins(DiscoveryPlugin.class),clusterModule.getAllocationService());</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">this</span>.nodeService = <span class="keyword">new</span> NodeService(settings, threadPool, monitorService, discoveryModule.getDiscovery(),transportService, indicesService, pluginsService, circuitBreakerService, scriptModule.getScriptService(),httpServerTransport, ingestService, clusterService, settingsModule.getSettingsFilter(), responseCollectorService,searchTransportService);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> SearchService searchService = newSearchService(clusterService, indicesService, threadPool, scriptModule.getScriptService(), bigArrays, searchModule.getFetchPhase(),responseCollectorService);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> List&lt;PersistentTasksExecutor&lt;?&gt;&gt; tasksExecutors = pluginsService</span><br><span class="line">            .filterPlugins(PersistentTaskPlugin.class).stream()</span><br><span class="line">     .map(p -&gt; p.getPersistentTasksExecutor(clusterService, threadPool, client))</span><br><span class="line">            .flatMap(List::stream)</span><br><span class="line">            .collect(toList());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> PersistentTasksExecutorRegistry registry = <span class="keyword">new</span> PersistentTasksExecutorRegistry(settings, tasksExecutors);</span><br><span class="line">        <span class="keyword">final</span> PersistentTasksClusterService persistentTasksClusterService =</span><br><span class="line">            <span class="keyword">new</span> PersistentTasksClusterService(settings, registry, clusterService);</span><br><span class="line">        <span class="keyword">final</span> PersistentTasksService persistentTasksService = <span class="keyword">new</span> PersistentTasksService(settings, clusterService, threadPool, client);</span><br><span class="line"></span><br><span class="line"><span class="comment">//8ã€ç»‘å®šå¤„ç†å„ç§æœåŠ¡çš„å®ä¾‹,è¿™é‡Œæ˜¯æœ€æ ¸å¿ƒçš„åœ°æ–¹,ä¹Ÿæ˜¯Elasticsearchèƒ½å¤„ç†å„ç§æœåŠ¡çš„æ ¸å¿ƒ.</span></span><br><span class="line">        modules.add(b -&gt; &#123;</span><br><span class="line">            b.bind(Node.class).toInstance(<span class="keyword">this</span>);</span><br><span class="line">            b.bind(NodeService.class).toInstance(nodeService);</span><br><span class="line">            b.bind(NamedXContentRegistry.class).toInstance(xContentRegistry);</span><br><span class="line">            b.bind(PluginsService.class).toInstance(pluginsService);</span><br><span class="line">            b.bind(Client.class).toInstance(client);</span><br><span class="line">            b.bind(NodeClient.class).toInstance(client);</span><br><span class="line">            b.bind(Environment.class).toInstance(<span class="keyword">this</span>.environment);</span><br><span class="line">            b.bind(ThreadPool.class).toInstance(threadPool);</span><br><span class="line">            b.bind(NodeEnvironment.class).toInstance(nodeEnvironment);</span><br><span class="line"> b.bind(ResourceWatcherService.class).toInstance(resourceWatcherService);</span><br><span class="line">b.bind(CircuitBreakerService.class).toInstance(circuitBreakerService);</span><br><span class="line">            b.bind(BigArrays.class).toInstance(bigArrays);</span><br><span class="line">      b.bind(ScriptService.class).toInstance(scriptModule.getScriptService());</span><br><span class="line"> b.bind(AnalysisRegistry.class).toInstance(analysisModule.getAnalysisRegistry());</span><br><span class="line">            b.bind(IngestService.class).toInstance(ingestService);</span><br><span class="line">            b.bind(UsageService.class).toInstance(usageService);</span><br><span class="line"> b.bind(NamedWriteableRegistry.class).toInstance(namedWriteableRegistry);</span><br><span class="line">            b.bind(MetaDataUpgrader.class).toInstance(metaDataUpgrader);</span><br><span class="line">            b.bind(MetaStateService.class).toInstance(metaStateService);</span><br><span class="line">            b.bind(IndicesService.class).toInstance(indicesService);</span><br><span class="line">            b.bind(SearchService.class).toInstance(searchService);            b.bind(SearchTransportService.class).toInstance(searchTransportService);</span><br><span class="line">b.bind(SearchPhaseController.class).toInstance(<span class="keyword">new</span> SearchPhaseController(settings, searchService::createReduceContext));</span><br><span class="line">            b.bind(Transport.class).toInstance(transport);</span><br><span class="line">            b.bind(TransportService.class).toInstance(transportService);</span><br><span class="line">            b.bind(NetworkService.class).toInstance(networkService);</span><br><span class="line">            b.bind(UpdateHelper.class).toInstance(<span class="keyword">new</span> UpdateHelper(settings, scriptModule.getScriptService()));</span><br><span class="line">b.bind(MetaDataIndexUpgradeService.class).toInstance(metaDataIndexUpgradeService);</span><br><span class="line">            b.bind(ClusterInfoService.class).toInstance(clusterInfoService);</span><br><span class="line">            b.bind(GatewayMetaState.class).toInstance(gatewayMetaState);</span><br><span class="line">            b.bind(Discovery.class).toInstance(discoveryModule.getDiscovery());</span><br><span class="line">            &#123;</span><br><span class="line">                RecoverySettings recoverySettings = <span class="keyword">new</span> RecoverySettings(settings, settingsModule.getClusterSettings());</span><br><span class="line">                processRecoverySettings(settingsModule.getClusterSettings(), recoverySettings);</span><br><span class="line">                b.bind(PeerRecoverySourceService.class).toInstance(<span class="keyword">new</span> PeerRecoverySourceService(settings, transportService,</span><br><span class="line">indicesService, recoverySettings));</span><br><span class="line">                b.bind(PeerRecoveryTargetService.class).toInstance(<span class="keyword">new</span> PeerRecoveryTargetService(settings, threadPool,</span><br><span class="line">transportService, recoverySettings, clusterService));</span><br><span class="line">            &#125;</span><br><span class="line">            httpBind.accept(b);</span><br><span class="line">            pluginComponents.stream().forEach(p -&gt; b.bind((Class) p.getClass()).toInstance(p));</span><br><span class="line">b.bind(PersistentTasksService.class).toInstance(persistentTasksService);       b.bind(PersistentTasksClusterService.class).toInstance(persistentTasksClusterService);</span><br><span class="line">b.bind(PersistentTasksExecutorRegistry.class).toInstance(registry); &#125;);</span><br><span class="line">        injector = modules.createInjector();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// TODO hack around circular dependencies problems in AllocationService</span></span><br><span class="line">clusterModule.getAllocationService().setGatewayAllocator(injector.getInstance(GatewayAllocator.class));</span><br><span class="line"></span><br><span class="line">        List&lt;LifecycleComponent&gt; pluginLifecycleComponents = pluginComponents.stream()</span><br><span class="line">            .filter(p -&gt; p <span class="keyword">instanceof</span> LifecycleComponent)</span><br><span class="line">            .map(p -&gt; (LifecycleComponent) p).collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//9ã€åˆ©ç”¨Guiceå°†å„ç§æ¨¡å—ä»¥åŠæœåŠ¡(xxxService)æ³¨å…¥åˆ°Elasticsearchç¯å¢ƒä¸­</span></span><br><span class="line">pluginLifecycleComponents.addAll(pluginsService.getGuiceServiceClasses().stream()                                     .map(injector::getInstance).collect(Collectors.toList()));</span><br><span class="line">        resourcesToClose.addAll(pluginLifecycleComponents);</span><br><span class="line">        <span class="keyword">this</span>.pluginLifecycleComponents = Collections.unmodifiableList(pluginLifecycleComponents);</span><br><span class="line">        client.initialize(injector.getInstance(<span class="keyword">new</span> Key&lt;Map&lt;GenericAction, TransportAction&gt;&gt;() &#123;&#125;), () -&gt; clusterService.localNode().getId(), transportService.getRemoteClusterService());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (NetworkModule.HTTP_ENABLED.get(settings)) &#123; <span class="comment">//å¦‚æœelasticsearch.ymlæ–‡ä»¶ä¸­é…ç½®äº†http.enabledå‚æ•°(é»˜è®¤ä¸ºtrue),åˆ™ä¼šåˆå§‹åŒ–RestHandlers</span></span><br><span class="line">            logger.debug(<span class="string">"initializing HTTP handlers ..."</span>);</span><br><span class="line">            actionModule.initRestHandlers(() -&gt; clusterService.state().nodes()); <span class="comment">//åˆå§‹åŒ–RestHandlers, è§£æé›†ç¾¤å‘½ä»¤,å¦‚_cat/,_cat/health</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//10ã€åˆå§‹åŒ–å·¥ä½œå®Œæˆ</span></span><br><span class="line">        logger.info(<span class="string">"initialized"</span>);</span><br><span class="line"></span><br><span class="line">        success = <span class="keyword">true</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException ex) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ElasticsearchException(<span class="string">"failed to bind service"</span>, ex);</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!success) &#123;</span><br><span class="line">            IOUtils.closeWhileHandlingException(resourcesToClose);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç çœŸçš„å¾ˆå¤šï¼Œè¿™é‡Œå†è¯´ä¸‹ä¸Šé¢è¿™ä¹ˆå¤šä»£ç ä¸»è¦å¹²äº†ä»€ä¹ˆå§ï¼šï¼ˆå…·ä½“æ˜¯å“ªè¡Œä»£ç æ‰§è¡Œçš„å¦‚ä¸‹æµç¨‹ï¼Œä¸Šé¢ä»£ç ä¸­ä¹Ÿæ ‡è®°äº†ï¼‰</p><p>1ã€åˆ›å»ºèŠ‚ç‚¹ç¯å¢ƒ,æ¯”å¦‚èŠ‚ç‚¹åç§°,èŠ‚ç‚¹ ID,åˆ†ç‰‡ä¿¡æ¯,å­˜å‚¨å…ƒ,ä»¥åŠåˆ†é…å†…å­˜å‡†å¤‡ç»™èŠ‚ç‚¹ä½¿ç”¨</p><p>2ã€æ‰“å°å‡º JVM ç›¸å…³ä¿¡æ¯</p><p>3ã€åˆ©ç”¨ PluginsService åŠ è½½ç›¸åº”çš„æ¨¡å—å’Œæ’ä»¶ï¼Œå…·ä½“å“ªäº›æ¨¡å—å¯ä»¥å» modules ç›®å½•ä¸‹æŸ¥çœ‹</p><p>4ã€åŠ è½½ä¸€äº›é¢å¤–çš„é…ç½®å‚æ•°</p><p>5ã€åˆ›å»ºä¸€ä¸ªèŠ‚ç‚¹å®¢æˆ·ç«¯</p><p>6ã€ç¼“å­˜ä¸€ç³»åˆ—æ¨¡å—,å¦‚NodeModule,ClusterModule,IndicesModule,ActionModule,GatewayModule,SettingsModule,RepositioriesModuleï¼ŒscriptModuleï¼ŒanalysisModule</p><p>7ã€è·å– RestControllerï¼Œç”¨äºå¤„ç†å„ç§ Elasticsearch çš„ rest å‘½ä»¤,å¦‚ _cat, _all, _cat/health, _clusters ç­‰ restå‘½ä»¤</p><p>8ã€ç»‘å®šå¤„ç†å„ç§æœåŠ¡çš„å®ä¾‹</p><p>9ã€åˆ©ç”¨ Guice å°†å„ç§æ¨¡å—ä»¥åŠæœåŠ¡(xxxService)æ³¨å…¥åˆ° Elasticsearch ç¯å¢ƒä¸­</p><p>10ã€åˆå§‹åŒ–å·¥ä½œå®Œæˆï¼ˆæ‰“å°æ—¥å¿—ï¼‰</p><h3 id="JarHell-æŠ¥é”™è§£é‡Š"><a href="#JarHell-æŠ¥é”™è§£é‡Š" class="headerlink" title="JarHell æŠ¥é”™è§£é‡Š"></a>JarHell æŠ¥é”™è§£é‡Š</h3><p>å‰ä¸€ç¯‡é˜…è¯»æºç ç¯å¢ƒæ­å»ºçš„æ–‡ç« å†™è¿‡ç”¨ JDK 1.8 ç¼–è¯‘ ES æºç æ˜¯ä¼šé‡åˆ°å¦‚ä¸‹å¼‚å¸¸ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">org.elasticsearch.bootstrap.StartupException: java.lang.IllegalStateException: jar hell!</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¯´ä¸‹å°±æ˜¯ setup æ–¹æ³•ä¸­çš„å¦‚ä¸‹ä»£ç å¯¼è‡´çš„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// look for jar hell</span></span><br><span class="line">    <span class="keyword">final</span> Logger logger = ESLoggerFactory.getLogger(JarHell.class);</span><br><span class="line">    JarHell.checkJarHell(logger::debug);</span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException | URISyntaxException e) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> BootstrapException(e);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥ä½ å¦‚æœæ˜¯ç”¨ JDK 1.8 ç¼–è¯‘çš„ï¼Œé‚£ä¹ˆå°±éœ€è¦æŠŠæ‰€æœ‰çš„æœ‰è¿™å—çš„ä»£ç ç»™æ³¨é‡Šæ‰å°±å¯ä»¥ç¼–è¯‘æˆåŠŸçš„ã€‚</p><p>æˆ‘è‡ªå·±è¯•è¿‡ç”¨ JDK 10 ç¼–è¯‘æ˜¯æ²¡æœ‰å‡ºç°è¿™é‡ŒæŠ¥é”™çš„ã€‚</p><h3 id="æ­£å¼å¯åŠ¨-ES-èŠ‚ç‚¹"><a href="#æ­£å¼å¯åŠ¨-ES-èŠ‚ç‚¹" class="headerlink" title="æ­£å¼å¯åŠ¨ ES èŠ‚ç‚¹"></a>æ­£å¼å¯åŠ¨ ES èŠ‚ç‚¹</h3><p>å›åˆ°ä¸Šé¢ Bootstrap ä¸­çš„é™æ€ init æ–¹æ³•ä¸­ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ­£å¼å¯åŠ¨ elasticsearch èŠ‚ç‚¹äº†ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">INSTANCE.start();  <span class="comment">//è°ƒç”¨ä¸‹é¢çš„ start æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">()</span> <span class="keyword">throws</span> NodeValidationException </span>&#123;</span><br><span class="line">    node.start();                                       <span class="comment">//æ­£å¼å¯åŠ¨ Elasticsearch èŠ‚ç‚¹</span></span><br><span class="line">    keepAliveThread.start();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥çœ‹çœ‹è¿™ä¸ª start æ–¹æ³•é‡Œé¢çš„ <code>node.start()</code> æ–¹æ³•æºç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Node <span class="title">start</span><span class="params">()</span> <span class="keyword">throws</span> NodeValidationException </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!lifecycle.moveToStarted()) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Logger logger = Loggers.getLogger(Node.class, NODE_NAME_SETTING.get(settings));</span><br><span class="line">    logger.info(<span class="string">"starting ..."</span>);</span><br><span class="line">    pluginLifecycleComponents.forEach(LifecycleComponent::start); </span><br><span class="line">    </span><br><span class="line">    <span class="comment">//1ã€åˆ©ç”¨Guiceè·å–ä¸Šè¿°æ³¨å†Œçš„å„ç§æ¨¡å—ä»¥åŠæœåŠ¡</span></span><br><span class="line">    <span class="comment">//Node çš„å¯åŠ¨å…¶å®å°±æ˜¯ node é‡Œæ¯ä¸ªç»„ä»¶çš„å¯åŠ¨ï¼ŒåŒæ ·çš„ï¼Œåˆ†åˆ«è°ƒç”¨ä¸åŒçš„å®ä¾‹çš„ start æ–¹æ³•æ¥å¯åŠ¨è¿™ä¸ªç»„ä»¶, å¦‚ä¸‹ï¼š</span></span><br><span class="line">    injector.getInstance(MappingUpdatedAction.class).setClient(client);</span><br><span class="line">    injector.getInstance(IndicesService.class).start();</span><br><span class="line">    injector.getInstance(IndicesClusterStateService.class).start();</span><br><span class="line">    injector.getInstance(SnapshotsService.class).start();</span><br><span class="line">    injector.getInstance(SnapshotShardsService.class).start();</span><br><span class="line">    injector.getInstance(RoutingService.class).start();</span><br><span class="line">    injector.getInstance(SearchService.class).start();</span><br><span class="line">    nodeService.getMonitorService().start();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> ClusterService clusterService = injector.getInstance(ClusterService.class);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> NodeConnectionsService nodeConnectionsService = injector.getInstance(NodeConnectionsService.class);</span><br><span class="line">    nodeConnectionsService.start();</span><br><span class="line">    clusterService.setNodeConnectionsService(nodeConnectionsService);</span><br><span class="line"></span><br><span class="line">    injector.getInstance(ResourceWatcherService.class).start();</span><br><span class="line">    injector.getInstance(GatewayService.class).start();</span><br><span class="line">    Discovery discovery = injector.getInstance(Discovery.class);</span><br><span class="line">    clusterService.getMasterService().setClusterStatePublisher(discovery::publish);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Start the transport service now so the publish address will be added to the local disco node in ClusterService</span></span><br><span class="line">    TransportService transportService = injector.getInstance(TransportService.class);</span><br><span class="line">    transportService.getTaskManager().setTaskResultsService(injector.getInstance(TaskResultsService.class));</span><br><span class="line">    transportService.start();</span><br><span class="line">    <span class="keyword">assert</span> localNodeFactory.getNode() != <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">assert</span> transportService.getLocalNode().equals(localNodeFactory.getNode())</span><br><span class="line">        : <span class="string">"transportService has a different local node than the factory provided"</span>;</span><br><span class="line">    <span class="keyword">final</span> MetaData onDiskMetadata;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// we load the global state here (the persistent part of the cluster state stored on disk) to</span></span><br><span class="line">        <span class="comment">// pass it to the bootstrap checks to allow plugins to enforce certain preconditions based on the recovered state.</span></span><br><span class="line">        <span class="keyword">if</span> (DiscoveryNode.isMasterNode(settings) || DiscoveryNode.isDataNode(settings)) &#123;<span class="comment">//æ ¹æ®é…ç½®æ–‡ä»¶çœ‹å½“å‰èŠ‚ç‚¹æ˜¯masterè¿˜æ˜¯dataèŠ‚ç‚¹</span></span><br><span class="line">            onDiskMetadata = injector.getInstance(GatewayMetaState.class).loadMetaState();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            onDiskMetadata = MetaData.EMPTY_META_DATA;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">assert</span> onDiskMetadata != <span class="keyword">null</span> : <span class="string">"metadata is null but shouldn't"</span>; <span class="comment">// this is never null</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UncheckedIOException(e);</span><br><span class="line">    &#125;</span><br><span class="line">    validateNodeBeforeAcceptingRequests(<span class="keyword">new</span> BootstrapContext(settings, onDiskMetadata), transportService.boundAddress(), pluginsService</span><br><span class="line">        .filterPlugins(Plugin</span><br><span class="line">        .class)</span><br><span class="line">        .stream()</span><br><span class="line">        .flatMap(p -&gt; p.getBootstrapChecks().stream()).collect(Collectors.toList()));</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2ã€å°†å½“å‰èŠ‚ç‚¹åŠ å…¥åˆ°ä¸€ä¸ªé›†ç¾¤ç°‡ä¸­å»,å¹¶å¯åŠ¨å½“å‰èŠ‚ç‚¹</span></span><br><span class="line">    clusterService.addStateApplier(transportService.getTaskManager());</span><br><span class="line">    <span class="comment">// start after transport service so the local disco is known</span></span><br><span class="line">    discovery.start(); <span class="comment">// start before cluster service so that it can set initial state on ClusterApplierService</span></span><br><span class="line">    clusterService.start();</span><br><span class="line">    <span class="keyword">assert</span> clusterService.localNode().equals(localNodeFactory.getNode())</span><br><span class="line">        : <span class="string">"clusterService has a different local node than the factory provided"</span>;</span><br><span class="line">    transportService.acceptIncomingRequests();</span><br><span class="line">    discovery.startInitialJoin();</span><br><span class="line">    <span class="comment">// tribe nodes don't have a master so we shouldn't register an observer         s</span></span><br><span class="line">    <span class="keyword">final</span> TimeValue initialStateTimeout = DiscoverySettings.INITIAL_STATE_TIMEOUT_SETTING.get(settings);</span><br><span class="line">    <span class="keyword">if</span> (initialStateTimeout.millis() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">final</span> ThreadPool thread = injector.getInstance(ThreadPool.class);</span><br><span class="line">        ClusterState clusterState = clusterService.state();</span><br><span class="line">        ClusterStateObserver observer = <span class="keyword">new</span> ClusterStateObserver(clusterState, clusterService, <span class="keyword">null</span>, logger, thread.getThreadContext());</span><br><span class="line">        <span class="keyword">if</span> (clusterState.nodes().getMasterNodeId() == <span class="keyword">null</span>) &#123;</span><br><span class="line">            logger.debug(<span class="string">"waiting to join the cluster. timeout [&#123;&#125;]"</span>, initialStateTimeout);</span><br><span class="line">            <span class="keyword">final</span> CountDownLatch latch = <span class="keyword">new</span> CountDownLatch(<span class="number">1</span>);</span><br><span class="line">            observer.waitForNextChange(<span class="keyword">new</span> ClusterStateObserver.Listener() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNewClusterState</span><span class="params">(ClusterState state)</span> </span>&#123; latch.countDown(); &#125;</span><br><span class="line"></span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClusterServiceClose</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                    latch.countDown();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onTimeout</span><span class="params">(TimeValue timeout)</span> </span>&#123;</span><br><span class="line">                    logger.warn(<span class="string">"timed out while waiting for initial discovery state - timeout: &#123;&#125;"</span>,</span><br><span class="line">                        initialStateTimeout);</span><br><span class="line">                    latch.countDown();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, state -&gt; state.nodes().getMasterNodeId() != <span class="keyword">null</span>, initialStateTimeout);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                latch.await();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ElasticsearchTimeoutException(<span class="string">"Interrupted while waiting for initial discovery state"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (NetworkModule.HTTP_ENABLED.get(settings)) &#123;</span><br><span class="line">        injector.getInstance(HttpServerTransport.class).start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (WRITE_PORTS_FILE_SETTING.get(settings)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (NetworkModule.HTTP_ENABLED.get(settings)) &#123;</span><br><span class="line">            HttpServerTransport http = injector.getInstance(HttpServerTransport.class);</span><br><span class="line">            writePortsFile(<span class="string">"http"</span>, http.boundAddress());</span><br><span class="line">        &#125;</span><br><span class="line">        TransportService transport = injector.getInstance(TransportService.class);</span><br><span class="line">        writePortsFile(<span class="string">"transport"</span>, transport.boundAddress());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    logger.info(<span class="string">"started"</span>);</span><br><span class="line"></span><br><span class="line">    pluginsService.filterPlugins(ClusterPlugin.class).forEach(ClusterPlugin::onNodeStarted);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸»è¦æ˜¯ï¼š</p><p>1ã€åˆ©ç”¨ Guice è·å–ä¸Šè¿°æ³¨å†Œçš„å„ç§æ¨¡å—ä»¥åŠæœåŠ¡ï¼Œç„¶åå¯åŠ¨ node é‡Œæ¯ä¸ªç»„ä»¶ï¼ˆåˆ†åˆ«è°ƒç”¨ä¸åŒçš„å®ä¾‹çš„ start æ–¹æ³•æ¥å¯åŠ¨ï¼‰</p><p>2ã€æ‰“å°æ—¥å¿—ï¼ˆå¯åŠ¨èŠ‚ç‚¹å®Œæˆï¼‰</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>è¿™ç¯‡æ–‡ç« ä¸»è¦æŠŠå¤§æ¦‚å¯åŠ¨æµç¨‹ä¸²é€šäº†ï¼Œè®²äº†ä¸‹ node èŠ‚ç‚¹çš„åˆ›å»ºå’Œæ­£å¼å¯åŠ¨ ES èŠ‚ç‚¹äº†ã€‚å› ä¸ºç¯‡å¹…è¾ƒå¤šæ‰€ä»¥æ‹†å¼€æˆä¸¤ç¯‡ï¼Œå…ˆä¸æ‰£ç»†èŠ‚äº†ï¼Œåé¢æµç¨‹å¯åŠ¨æ–‡ç« å†™å®Œåæˆ‘ä»¬å†å•ä¸€çš„æ‰£ç»†èŠ‚ã€‚</p><h3 id="ç›¸å…³æ–‡ç« "><a href="#ç›¸å…³æ–‡ç« " class="headerlink" title="ç›¸å…³æ–‡ç« "></a>ç›¸å…³æ–‡ç« </h3><p>1ã€<a href="http://www.54tianzhisheng.cn/2018/08/04/why-see-es-code/" target="_blank" rel="noopener">æ¸£æ¸£èœé¸¡ä¸ºä»€ä¹ˆè¦çœ‹ ElasticSearch æºç ï¼Ÿ</a></p><p>2ã€<a href="http://www.54tianzhisheng.cn/2018/08/05/es-code01/" target="_blank" rel="noopener">æ¸£æ¸£èœé¸¡çš„ ElasticSearch æºç è§£æ â€”â€” ç¯å¢ƒæ­å»º</a></p><p>3ã€<a href="http://www.54tianzhisheng.cn/2018/08/11/es-code02/" target="_blank" rel="noopener">æ¸£æ¸£èœé¸¡çš„ ElasticSearch æºç è§£æ â€”â€” å¯åŠ¨æµç¨‹(ä¸Š)</a></p><p>4ã€<a href="http://www.54tianzhisheng.cn/2018/08/11/es-code03/" target="_blank" rel="noopener">æ¸£æ¸£èœé¸¡çš„ ElasticSearch æºç è§£æ â€”â€” å¯åŠ¨æµç¨‹(ä¸‹)</a></p><p>5ã€<a href="http://www.54tianzhisheng.cn/2017/09/08/Elasticsearch-analyzers/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆä¸€ï¼‰ï¼šElasticsearch é»˜è®¤åˆ†è¯å™¨å’Œä¸­åˆ†åˆ†è¯å™¨ä¹‹é—´çš„æ¯”è¾ƒåŠä½¿ç”¨æ–¹æ³•</a></p><p>6ã€<a href="http://www.54tianzhisheng.cn/2017/09/09/Elasticsearch-install/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆäºŒï¼‰ï¼šå…¨æ–‡æœç´¢å¼•æ“ Elasticsearch é›†ç¾¤æ­å»ºå…¥é—¨æ•™ç¨‹</a></p><p>7ã€<a href="http://www.54tianzhisheng.cn/2017/10/15/ElasticSearch-cluster-health-metrics/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆä¸‰ï¼‰ï¼šElasticSearch é›†ç¾¤ç›‘æ§</a></p><p>8ã€<a href="http://www.54tianzhisheng.cn/2017/10/18/ElasticSearch-nodes-metrics/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆå››ï¼‰ï¼šElasticSearch å•ä¸ªèŠ‚ç‚¹ç›‘æ§</a></p><p>9ã€<a href="http://www.54tianzhisheng.cn/2017/12/25/ELK/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆäº”ï¼‰ï¼šELK å®æ—¶æ—¥å¿—åˆ†æå¹³å°ç¯å¢ƒæ­å»º</a></p><p>10ã€<a href="http://www.54tianzhisheng.cn/2018/08/14/idea-remote-debug-elasticsearch/" target="_blank" rel="noopener">æ•™ä½ å¦‚ä½•åœ¨ IDEA è¿œç¨‹ Debug ElasticSearch</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://ws1.sinaimg.cn/large/006tNbRwly1fu8gbvoubfj31hc0vlqdt.jpg&quot; alt=&quot;006&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="ElasticSearch" scheme="http://yoursite.com/tags/ElasticSearch/"/>
    
  </entry>
  
  <entry>
    <title>æ¸£æ¸£èœé¸¡çš„ ElasticSearch æºç è§£æ â€”â€” å¯åŠ¨æµç¨‹ï¼ˆä¸Šï¼‰</title>
    <link href="http://yoursite.com/2018/08/11/es-code02/"/>
    <id>http://yoursite.com/2018/08/11/es-code02/</id>
    <published>2018-08-10T16:00:00.000Z</published>
    <updated>2018-08-14T13:33:11.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://ws2.sinaimg.cn/large/006tNbRwly1fu8gag9ycij31hc0w0awj.jpg" alt="005"></p><a id="more"></a><h3 id="å…³æ³¨æˆ‘"><a href="#å…³æ³¨æˆ‘" class="headerlink" title="å…³æ³¨æˆ‘"></a>å…³æ³¨æˆ‘</h3><p><img src="http://ohfk1r827.bkt.clouddn.com/blog/180103/C6LG3mGa12.jpg" alt="zhisheng"></p><p>è½¬è½½è¯·åŠ¡å¿…æ³¨æ˜åŸåˆ›åœ°å€ä¸ºï¼š<a href="http://www.54tianzhisheng.cn/2018/08/11/es-code02/" target="_blank" rel="noopener">http://www.54tianzhisheng.cn/2018/08/11/es-code02/</a></p><h3 id="å‰æ"><a href="#å‰æ" class="headerlink" title="å‰æ"></a>å‰æ</h3><p>ä¸Šç¯‡æ–‡ç« å†™äº† <a href="http://www.54tianzhisheng.cn/2018/08/05/es-code01/" target="_blank" rel="noopener">ElasticSearch æºç è§£æ â€”â€” ç¯å¢ƒæ­å»º</a> ï¼Œå…¶ä¸­é‡Œé¢è¯´äº†å¯åŠ¨ æ‰“å¼€ server æ¨¡å—ä¸‹çš„ Elasticsearch ç±»ï¼šorg.elasticsearch.bootstrap.Elasticsearchï¼Œè¿è¡Œé‡Œé¢çš„ main å‡½æ•°å°±å¯ä»¥å¯åŠ¨ ElasticSearch äº†ï¼Œè¿™ç¯‡æ–‡ç« è®²è®²å¯åŠ¨æµç¨‹ï¼Œå› ä¸ºç¯‡å¹…ä¼šå¾ˆå¤šï¼Œæ‰€ä»¥åˆ†äº†ä¸¤ç¯‡æ¥å†™ã€‚</p><h3 id="å¯åŠ¨æµç¨‹"><a href="#å¯åŠ¨æµç¨‹" class="headerlink" title="å¯åŠ¨æµç¨‹"></a>å¯åŠ¨æµç¨‹</h3><h4 id="main-æ–¹æ³•å…¥å£"><a href="#main-æ–¹æ³•å…¥å£" class="headerlink" title="main æ–¹æ³•å…¥å£"></a>main æ–¹æ³•å…¥å£</h4><p>å¯ä»¥çœ‹åˆ°å…¥å£å…¶å®æ˜¯ä¸€ä¸ª main æ–¹æ³•ï¼Œæ–¹æ³•é‡Œé¢å…ˆæ˜¯æ£€æŸ¥æƒé™ï¼Œç„¶åæ˜¯ä¸€ä¸ªé”™è¯¯æ—¥å¿—ç›‘å¬å™¨ï¼ˆç¡®ä¿åœ¨æ—¥å¿—é…ç½®ä¹‹å‰çŠ¶æ€æ—¥å¿—æ²¡æœ‰å‡ºç° errorï¼‰ï¼Œç„¶åæ˜¯ Elasticsearch å¯¹è±¡çš„åˆ›å»ºï¼Œç„¶åè°ƒç”¨äº†é™æ€æ–¹æ³• main æ–¹æ³•ï¼ˆ18 è¡Œï¼‰ï¼Œå¹¶æŠŠåˆ›å»ºçš„å¯¹è±¡å’Œå‚æ•°ä»¥åŠ Terminal é»˜è®¤å€¼ä¼ è¿›å»ã€‚é™æ€çš„ main æ–¹æ³•é‡Œé¢è°ƒç”¨ elasticsearch.main æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(<span class="keyword">final</span> String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;         <span class="comment">//1ã€å…¥å£</span></span><br><span class="line">    <span class="comment">// we want the JVM to think there is a security manager installed so that if internal policy decisions that would be based on the</span></span><br><span class="line">    <span class="comment">// presence of a security manager or lack thereof act as if there is a security manager present (e.g., DNS cache policy)</span></span><br><span class="line">    System.setSecurityManager(<span class="keyword">new</span> SecurityManager() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">checkPermission</span><span class="params">(Permission perm)</span> </span>&#123;</span><br><span class="line">            <span class="comment">// grant all permissions so that we can later set the security manager to the one that we want</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    LogConfigurator.registerErrorListener();                            <span class="comment">//</span></span><br><span class="line">    <span class="keyword">final</span> Elasticsearch elasticsearch = <span class="keyword">new</span> Elasticsearch();</span><br><span class="line">    <span class="keyword">int</span> status = main(args, elasticsearch, Terminal.DEFAULT); <span class="comment">//2ã€è°ƒç”¨Elasticsearch.mainæ–¹æ³•</span></span><br><span class="line">    <span class="keyword">if</span> (status != ExitCodes.OK) &#123;</span><br><span class="line">        exit(status);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">final</span> String[] args, <span class="keyword">final</span> Elasticsearch elasticsearch, <span class="keyword">final</span> Terminal terminal)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> elasticsearch.main(args, terminal);  <span class="comment">//3ã€command main</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://ws2.sinaimg.cn/large/006tNbRwly1fu77z6ktl2j315i0t2myl.jpg" alt="1es01"></p><p>å› ä¸º Elasticsearch ç±»æ˜¯ç»§æ‰¿äº† EnvironmentAwareCommand  ç±»ï¼ŒEnvironmentAwareCommand  ç±»ç»§æ‰¿äº† Command ç±»ï¼Œä½†æ˜¯ Elasticsearch ç±»å¹¶æ²¡æœ‰é‡å†™ main æ–¹æ³•ï¼Œæ‰€ä»¥ä¸Šé¢è°ƒç”¨çš„ elasticsearch.main å…¶å®æ˜¯è°ƒç”¨äº† Command çš„ main æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** Parses options for this command from args and executes it. */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">main</span><span class="params">(String[] args, Terminal terminal)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (addShutdownHook()) &#123;                                                <span class="comment">//åˆ©ç”¨Runtime.getRuntime().addShutdownHookæ–¹æ³•åŠ å…¥ä¸€ä¸ªHookï¼Œåœ¨ç¨‹åºé€€å‡ºæ—¶è§¦å‘è¯¥Hook</span></span><br><span class="line">        shutdownHookThread = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">this</span>.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (<span class="keyword">final</span> IOException e) &#123;</span><br><span class="line">                <span class="keyword">try</span> (</span><br><span class="line">                    StringWriter sw = <span class="keyword">new</span> StringWriter();</span><br><span class="line">                    PrintWriter pw = <span class="keyword">new</span> PrintWriter(sw)) &#123;</span><br><span class="line">                    e.printStackTrace(pw);</span><br><span class="line">                    terminal.println(sw.toString());</span><br><span class="line">                &#125; <span class="keyword">catch</span> (<span class="keyword">final</span> IOException impossible) &#123;</span><br><span class="line">                    <span class="comment">// StringWriter#close declares a checked IOException from the Closeable interface but the Javadocs for StringWriter</span></span><br><span class="line">                    <span class="comment">// say that an exception here is impossible</span></span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> AssertionError(impossible);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        Runtime.getRuntime().addShutdownHook(shutdownHookThread);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    beforeMain.run();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        mainWithoutErrorHandling(args, terminal);<span class="comment">//4ã€mainWithoutErrorHandling</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (OptionException e) &#123;</span><br><span class="line">        printHelp(terminal);</span><br><span class="line">        terminal.println(Terminal.Verbosity.SILENT, <span class="string">"ERROR: "</span> + e.getMessage());</span><br><span class="line">        <span class="keyword">return</span> ExitCodes.USAGE;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (UserException e) &#123;</span><br><span class="line">        <span class="keyword">if</span> (e.exitCode == ExitCodes.USAGE) &#123;</span><br><span class="line">            printHelp(terminal);</span><br><span class="line">        &#125;</span><br><span class="line">        terminal.println(Terminal.Verbosity.SILENT, <span class="string">"ERROR: "</span> + e.getMessage());</span><br><span class="line">        <span class="keyword">return</span> e.exitCode;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ExitCodes.OK;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸€å¼€å§‹åˆ©ç”¨ä¸€ä¸ªå‹¾å­å‡½æ•°ï¼Œåœ¨ç¨‹åºé€€å‡ºæ—¶è§¦å‘è¯¥ Hookï¼Œè¯¥æ–¹æ³•ä¸»è¦ä»£ç æ˜¯ mainWithoutErrorHandling() æ–¹æ³•ï¼Œç„¶åä¸‹é¢çš„æ˜¯ catch ä½æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸ï¼Œæ–¹æ³•ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*** Executes the command, but all errors are thrown. */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mainWithoutErrorHandling</span><span class="params">(String[] args, Terminal terminal)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> OptionSet options = parser.parse(args);</span><br><span class="line">    <span class="keyword">if</span> (options.has(helpOption)) &#123;</span><br><span class="line">        printHelp(terminal);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (options.has(silentOption)) &#123;</span><br><span class="line">        terminal.setVerbosity(Terminal.Verbosity.SILENT);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (options.has(verboseOption)) &#123;</span><br><span class="line">        terminal.setVerbosity(Terminal.Verbosity.VERBOSE);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        terminal.setVerbosity(Terminal.Verbosity.NORMAL);</span><br><span class="line">    &#125;</span><br><span class="line">    execute(terminal, options);<span class="comment">//5ã€æ‰§è¡Œ EnvironmentAwareCommand ä¸­çš„ execute()ï¼Œï¼ˆé‡å†™äº†commandé‡Œé¢æŠ½è±¡çš„executeæ–¹æ³•ï¼‰</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç ä» 3 ï½ 14 è¡Œæ˜¯è§£æä¼ è¿›æ¥çš„å‚æ•°å¹¶é…ç½® terminalï¼Œé‡è¦çš„ execute() æ–¹æ³•ï¼Œæ‰§è¡Œçš„æ˜¯ EnvironmentAwareCommand ä¸­çš„ execute() ï¼ˆé‡å†™äº† Command ç±»é‡Œé¢çš„æŠ½è±¡ execute æ–¹æ³•ï¼‰ï¼Œä»ä¸Šé¢é‚£ä¸ªç»§æ‰¿å›¾å¯ä»¥çœ‹åˆ° EnvironmentAwareCommand ç»§æ‰¿äº† Commandï¼Œé‡å†™çš„ execute æ–¹æ³•ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(Terminal terminal, OptionSet options)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Map&lt;String, String&gt; settings = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">final</span> KeyValuePair kvp : settingOption.values(options)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (kvp.value.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UserException(ExitCodes.USAGE, <span class="string">"setting ["</span> + kvp.key + <span class="string">"] must not be empty"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (settings.containsKey(kvp.key)) &#123;</span><br><span class="line">            <span class="keyword">final</span> String message = String.format(</span><br><span class="line">                Locale.ROOT, <span class="string">"setting [%s] already set, saw [%s] and [%s]"</span>,</span><br><span class="line">                kvp.key, settings.get(kvp.key), kvp.value);</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UserException(ExitCodes.USAGE, message);</span><br><span class="line">        &#125;</span><br><span class="line">        settings.put(kvp.key, kvp.value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//6ã€æ ¹æ®æˆ‘ä»¬ideé…ç½®çš„ vm options è¿›è¡Œè®¾ç½®path.dataã€path.homeã€path.logs</span></span><br><span class="line">    putSystemPropertyIfSettingIsMissing(settings, <span class="string">"path.data"</span>, <span class="string">"es.path.data"</span>);</span><br><span class="line">    putSystemPropertyIfSettingIsMissing(settings, <span class="string">"path.home"</span>, <span class="string">"es.path.home"</span>);</span><br><span class="line">    putSystemPropertyIfSettingIsMissing(settings, <span class="string">"path.logs"</span>, <span class="string">"es.path.logs"</span>);</span><br><span class="line"></span><br><span class="line">    execute(terminal, options, createEnv(terminal, settings));<span class="comment">//7ã€å…ˆè°ƒç”¨ createEnv åˆ›å»ºç¯å¢ƒ</span></span><br><span class="line">    <span class="comment">//9ã€æ‰§è¡Œelasticsearchçš„executeæ–¹æ³•ï¼Œelasticsearchä¸­é‡å†™äº†EnvironmentAwareCommandä¸­çš„æŠ½è±¡executeæ–¹æ³•</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–¹æ³•å‰é¢æ˜¯æ ¹æ®ä¼ å‚å»åˆ¤æ–­é…ç½®çš„ï¼Œå¦‚æœé…ç½®ä¸ºç©ºï¼Œå°±ä¼šç›´æ¥è·³åˆ°æ‰§è¡Œ putSystemPropertyIfSettingIsMissing æ–¹æ³•ï¼Œè¿™é‡Œä¼šé…ç½®ä¸‰ä¸ªå±æ€§ï¼špath.dataã€path.homeã€path.logs è®¾ç½® es çš„ dataã€homeã€logs ç›®å½•ï¼Œå®ƒè¿™é‡Œæ˜¯æ ¹æ®æˆ‘ä»¬ ide é…ç½®çš„ vm options è¿›è¡Œè®¾ç½®çš„ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬<a href="http://www.54tianzhisheng.cn/2018/08/05/es-code01/#%E7%BC%96%E8%AF%91" target="_blank" rel="noopener">ä¸Šç¯‡æ–‡ç« </a>è¯´çš„é…ç½®ä¿¡æ¯ï¼Œå¦‚æœä¸é…ç½®çš„è¯å°±ä¼šç›´æ¥æŠ¥é”™ã€‚ä¸‹é¢çœ‹çœ‹ putSystemPropertyIfSettingIsMissing æ–¹æ³•ä»£ç é‡Œé¢æ€ä¹ˆåšåˆ°çš„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** Ensure the given setting exists, reading it from system properties if not already set. */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">putSystemPropertyIfSettingIsMissing</span><span class="params">(<span class="keyword">final</span> Map&lt;String, String&gt; settings, <span class="keyword">final</span> String setting, <span class="keyword">final</span> String key)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> String value = System.getProperty(key);<span class="comment">//è·å–keyï¼ˆes.path.dataï¼‰æ‰¾ç³»ç»Ÿè®¾ç½®</span></span><br><span class="line">    <span class="keyword">if</span> (value != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (settings.containsKey(setting)) &#123;</span><br><span class="line">            <span class="keyword">final</span> String message =</span><br><span class="line">                String.format(</span><br><span class="line">                Locale.ROOT,</span><br><span class="line">                <span class="string">"duplicate setting [%s] found via command-line [%s] and system property [%s]"</span>,</span><br><span class="line">                setting, settings.get(setting), value);</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(message);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            settings.put(setting, value);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œè¿™ä¸‰ä¸ªæ–¹æ³•åï¼š</p><p><img src="https://ws2.sinaimg.cn/large/006tNbRwly1fu77z62vazj31kw0rwwty.jpg" alt="2es02"></p><p>è·³å‡ºæ­¤æ–¹æ³•ï¼Œç»§ç»­çœ‹ä¼šå‘ç° execute æ–¹æ³•è°ƒç”¨äº†æ–¹æ³•ï¼Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execute(terminal, options, createEnv(terminal, settings));</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬å…ˆçœ‹çœ‹ <code>createEnv(terminal, settings)</code> æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> Environment <span class="title">createEnv</span><span class="params">(<span class="keyword">final</span> Terminal terminal, <span class="keyword">final</span> Map&lt;String, String&gt; settings)</span> <span class="keyword">throws</span> UserException </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> String esPathConf = System.getProperty(<span class="string">"es.path.conf"</span>);<span class="comment">//8ã€è¯»å–æˆ‘ä»¬ vm options ä¸­é…ç½®çš„ es.path.conf</span></span><br><span class="line">    <span class="keyword">if</span> (esPathConf == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UserException(ExitCodes.CONFIG, <span class="string">"the system property [es.path.conf] must be set"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> InternalSettingsPreparer.prepareEnvironment(Settings.EMPTY, terminal, settings, getConfigPath(esPathConf));  <span class="comment">//8ã€å‡†å¤‡ç¯å¢ƒ prepareEnvironment</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯»å–æˆ‘ä»¬ ide vm options ä¸­é…ç½®çš„ es.path.confï¼ŒåŒä¸Šç¯‡æ–‡ç« ä¹Ÿè®²äº†è¿™ä¸ªä¸€å®šè¦é…ç½®çš„ï¼Œå› ä¸º es å¯åŠ¨çš„æ—¶å€™ä¼šåŠ è½½æˆ‘ä»¬çš„é…ç½®å’Œä¸€äº›æ’ä»¶ã€‚è¿™é‡Œç»§ç»­çœ‹ä¸‹ä¸Šé¢ä»£ç ç¬¬ 6 è¡Œçš„ prepareEnvironment æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Environment <span class="title">prepareEnvironment</span><span class="params">(Settings input, Terminal terminal, Map&lt;String, String&gt; properties, Path configPath)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// just create enough settings to build the environment, to get the config dir</span></span><br><span class="line">    Settings.Builder output = Settings.builder();</span><br><span class="line">    initializeSettings(output, input, properties);</span><br><span class="line">    Environment environment = <span class="keyword">new</span> Environment(output.build(), configPath);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æŸ¥çœ‹ es.path.conf ç›®å½•ä¸‹çš„é…ç½®æ–‡ä»¶æ˜¯ä¸æ˜¯ yml æ ¼å¼çš„ï¼Œå¦‚æœä¸æ˜¯åˆ™æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸</span></span><br><span class="line">    <span class="keyword">if</span> (Files.exists(environment.configFile().resolve(<span class="string">"elasticsearch.yaml"</span>))) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> SettingsException(<span class="string">"elasticsearch.yaml was deprecated in 5.5.0 and must be renamed to elasticsearch.yml"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (Files.exists(environment.configFile().resolve(<span class="string">"elasticsearch.json"</span>))) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> SettingsException(<span class="string">"elasticsearch.json was deprecated in 5.5.0 and must be converted to elasticsearch.yml"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    output = Settings.builder(); <span class="comment">// start with a fresh output</span></span><br><span class="line">    Path path = environment.configFile().resolve(<span class="string">"elasticsearch.yml"</span>);</span><br><span class="line">    <span class="keyword">if</span> (Files.exists(path)) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            output.loadFromPath(path);  <span class="comment">//åŠ è½½æ–‡ä»¶å¹¶è¯»å–é…ç½®æ–‡ä»¶å†…å®¹</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> SettingsException(<span class="string">"Failed to load settings from "</span> + path.toString(), e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// re-initialize settings now that the config file has been loaded</span></span><br><span class="line">    initializeSettings(output, input, properties);          <span class="comment">//å†ä¸€æ¬¡åˆå§‹åŒ–è®¾ç½®</span></span><br><span class="line">    finalizeSettings(output, terminal);</span><br><span class="line"></span><br><span class="line">    environment = <span class="keyword">new</span> Environment(output.build(), configPath);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// we put back the path.logs so we can use it in the logging configuration file</span></span><br><span class="line">    output.put(Environment.PATH_LOGS_SETTING.getKey(), environment.logsFile().toAbsolutePath().normalize().toString());</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Environment(output.build(), configPath);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://ws1.sinaimg.cn/large/006tNbRwly1fu77z80q0rj31kw0zknk0.jpg" alt="3es03"></p><p>å‡†å¤‡çš„ç¯å¢ƒå¦‚ä¸Šå›¾ï¼Œé€šè¿‡æ„å»ºçš„ç¯å¢ƒæŸ¥çœ‹é…ç½®æ–‡ä»¶ elasticsearch.yml æ˜¯ä¸æ˜¯ä»¥ yml ç»“å°¾ï¼Œå¦‚æœæ˜¯ yaml æˆ–è€… json ç»“å°¾çš„åˆ™æŠ›å‡ºå¼‚å¸¸ï¼ˆåœ¨ 5.5.0 ç‰ˆæœ¬å…¶ä»–ä¸¤ç§æ ¼å¼è¿‡æœŸäº†ï¼Œåªèƒ½ä½¿ç”¨ yml æ ¼å¼ï¼‰ï¼Œç„¶ååŠ è½½è¯¥é…ç½®æ–‡ä»¶å¹¶è¯»å–é‡Œé¢çš„å†…å®¹ï¼ˆKVç»“æ„ï¼‰ã€‚</p><p>è·³å‡º createEnv æ–¹æ³•ï¼Œæˆ‘ä»¬ç»§ç»­çœ‹ execute æ–¹æ³•å§ã€‚</p><p>EnvironmentAwareCommand ç±»çš„ execute æ–¹æ³•ä»£ç å¦‚ä¸‹ï¼š</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(Terminal terminal, OptionSet options, Environment env)</span> <span class="keyword">throws</span> Exception</span>;</span><br></pre></td></tr></table></figure><p> è¿™æ˜¯ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒçš„å®ç°æ–¹æ³•åœ¨ Elasticsearch ç±»ä¸­ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(Terminal terminal, OptionSet options, Environment env)</span> <span class="keyword">throws</span> UserException </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (options.nonOptionArguments().isEmpty() == <span class="keyword">false</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UserException(ExitCodes.USAGE, <span class="string">"Positional arguments not allowed, found "</span> + options.nonOptionArguments());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (options.has(versionOption)) &#123;</span><br><span class="line">        <span class="keyword">final</span> String versionOutput = String.format(</span><br><span class="line">            Locale.ROOT,</span><br><span class="line">            <span class="string">"Version: %s, Build: %s/%s/%s/%s, JVM: %s"</span>,</span><br><span class="line">            Version.displayVersion(Version.CURRENT, Build.CURRENT.isSnapshot()),</span><br><span class="line">            Build.CURRENT.flavor().displayName(),</span><br><span class="line">            Build.CURRENT.type().displayName(),</span><br><span class="line">            Build.CURRENT.shortHash(),</span><br><span class="line">            Build.CURRENT.date(),</span><br><span class="line">            JvmInfo.jvmInfo().version());</span><br><span class="line">        terminal.println(versionOutput);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">boolean</span> daemonize = options.has(daemonizeOption);</span><br><span class="line">    <span class="keyword">final</span> Path pidFile = pidfileOption.value(options);</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">boolean</span> quiet = options.has(quietOption);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// a misconfigured java.io.tmpdir can cause hard-to-diagnose problems later, so reject it immediately</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        env.validateTmpFile();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UserException(ExitCodes.CONFIG, e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        init(daemonize, pidFile, quiet, env);    <span class="comment">//10ã€åˆå§‹åŒ–</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (NodeValidationException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UserException(ExitCodes.CONFIG, e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç é‡Œä¸»è¦è¿˜æ˜¯çœ‹çœ‹ <code>init(daemonize, pidFile, quiet, env);</code> åˆå§‹åŒ–æ–¹æ³•å§ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">final</span> <span class="keyword">boolean</span> daemonize, <span class="keyword">final</span> Path pidFile, <span class="keyword">final</span> <span class="keyword">boolean</span> quiet, Environment initialEnv)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> NodeValidationException, UserException </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Bootstrap.init(!daemonize, pidFile, quiet, initialEnv); <span class="comment">//11ã€æ‰§è¡Œ Bootstrap ä¸­çš„ init æ–¹æ³•</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (BootstrapException | RuntimeException e) &#123;</span><br><span class="line">        <span class="comment">// format exceptions to the console in a special way</span></span><br><span class="line">        <span class="comment">// to avoid 2MB stacktraces from guice, etc.</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> StartupException(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="init-æ–¹æ³•"><a href="#init-æ–¹æ³•" class="headerlink" title="init æ–¹æ³•"></a>init æ–¹æ³•</h4><p>Bootstrap ä¸­çš„é™æ€ init æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">final</span> <span class="keyword">boolean</span> foreground,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">final</span> Path pidFile,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">final</span> <span class="keyword">boolean</span> quiet,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">final</span> Environment initialEnv)</span> <span class="keyword">throws</span> BootstrapException, NodeValidationException, UserException </span>&#123;</span><br><span class="line">    <span class="comment">// force the class initializer for BootstrapInfo to run before</span></span><br><span class="line">    <span class="comment">// the security manager is installed</span></span><br><span class="line">    BootstrapInfo.init();</span><br><span class="line"></span><br><span class="line">    INSTANCE = <span class="keyword">new</span> Bootstrap();   <span class="comment">//12ã€åˆ›å»ºä¸€ä¸ª Bootstrap å®ä¾‹</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> SecureSettings keystore = loadSecureSettings(initialEnv);<span class="comment">//å¦‚æœæ³¨å†Œäº†å®‰å…¨æ¨¡å—åˆ™å°†ç›¸å…³é…ç½®åŠ è½½è¿›æ¥</span></span><br><span class="line">    <span class="keyword">final</span> Environment environment = createEnvironment(foreground, pidFile, keystore, initialEnv.settings(), initialEnv.configFile());   <span class="comment">//å¹²ä¹‹å‰å¹²è¿‡çš„äº‹æƒ…</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        LogConfigurator.configure(environment);   <span class="comment">//13ã€log é…ç½®ç¯å¢ƒ</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> BootstrapException(e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (environment.pidFile() != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            PidFile.create(environment.pidFile(), <span class="keyword">true</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> BootstrapException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">boolean</span> closeStandardStreams = (foreground == <span class="keyword">false</span>) || quiet;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (closeStandardStreams) &#123;</span><br><span class="line">            <span class="keyword">final</span> Logger rootLogger = ESLoggerFactory.getRootLogger();</span><br><span class="line">            <span class="keyword">final</span> Appender maybeConsoleAppender = Loggers.findAppender(rootLogger, ConsoleAppender.class);</span><br><span class="line">            <span class="keyword">if</span> (maybeConsoleAppender != <span class="keyword">null</span>) &#123;</span><br><span class="line">                Loggers.removeAppender(rootLogger, maybeConsoleAppender);</span><br><span class="line">            &#125;</span><br><span class="line">            closeSystOut();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// fail if somebody replaced the lucene jars</span></span><br><span class="line">        checkLucene();             <span class="comment">//14ã€æ£€æŸ¥Luceneç‰ˆæœ¬</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// install the default uncaught exception handler; must be done before security is initialized as we do not want to grant the runtime permission setDefaultUncaughtExceptionHandler</span></span><br><span class="line">        Thread.setDefaultUncaughtExceptionHandler(</span><br><span class="line">            <span class="keyword">new</span> ElasticsearchUncaughtExceptionHandler(() -&gt; Node.NODE_NAME_SETTING.get(environment.settings())));</span><br><span class="line"></span><br><span class="line">        INSTANCE.setup(<span class="keyword">true</span>, environment);      <span class="comment">//15ã€è°ƒç”¨ setup æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// any secure settings must be read during node construction</span></span><br><span class="line">            IOUtils.close(keystore);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> BootstrapException(e);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        INSTANCE.start();         <span class="comment">//26ã€è°ƒç”¨ start æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (closeStandardStreams) &#123;</span><br><span class="line">            closeSysError();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (NodeValidationException | RuntimeException e) &#123;</span><br><span class="line">        <span class="comment">// disable console logging, so user does not see the exception twice (jvm will show it already)</span></span><br><span class="line">        <span class="keyword">final</span> Logger rootLogger = ESLoggerFactory.getRootLogger();</span><br><span class="line">        <span class="keyword">final</span> Appender maybeConsoleAppender = Loggers.findAppender(rootLogger, ConsoleAppender.class);</span><br><span class="line">        <span class="keyword">if</span> (foreground &amp;&amp; maybeConsoleAppender != <span class="keyword">null</span>) &#123;</span><br><span class="line">            Loggers.removeAppender(rootLogger, maybeConsoleAppender);</span><br><span class="line">        &#125;</span><br><span class="line">        Logger logger = Loggers.getLogger(Bootstrap.class);</span><br><span class="line">        <span class="keyword">if</span> (INSTANCE.node != <span class="keyword">null</span>) &#123;</span><br><span class="line">            logger = Loggers.getLogger(Bootstrap.class, Node.NODE_NAME_SETTING.get(INSTANCE.node.settings()));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// HACK, it sucks to do this, but we will run users out of disk space otherwise</span></span><br><span class="line">        <span class="keyword">if</span> (e <span class="keyword">instanceof</span> CreationException) &#123;</span><br><span class="line">            <span class="comment">// guice: log the shortened exc to the log file</span></span><br><span class="line">            ByteArrayOutputStream os = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">            PrintStream ps = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                ps = <span class="keyword">new</span> PrintStream(os, <span class="keyword">false</span>, <span class="string">"UTF-8"</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (UnsupportedEncodingException uee) &#123;</span><br><span class="line">                <span class="keyword">assert</span> <span class="keyword">false</span>;</span><br><span class="line">                e.addSuppressed(uee);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">new</span> StartupException(e).printStackTrace(ps);</span><br><span class="line">            ps.flush();</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                logger.error(<span class="string">"Guice Exception: &#123;&#125;"</span>, os.toString(<span class="string">"UTF-8"</span>));</span><br><span class="line">            &#125; <span class="keyword">catch</span> (UnsupportedEncodingException uee) &#123;</span><br><span class="line">                <span class="keyword">assert</span> <span class="keyword">false</span>;</span><br><span class="line">                e.addSuppressed(uee);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (e <span class="keyword">instanceof</span> NodeValidationException) &#123;</span><br><span class="line">            logger.error(<span class="string">"node validation exception\n&#123;&#125;"</span>, e.getMessage());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// full exception</span></span><br><span class="line">            logger.error(<span class="string">"Exception"</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// re-enable it if appropriate, so they can see any logging during the shutdown process</span></span><br><span class="line">        <span class="keyword">if</span> (foreground &amp;&amp; maybeConsoleAppender != <span class="keyword">null</span>) &#123;</span><br><span class="line">            Loggers.addAppender(rootLogger, maybeConsoleAppender);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">throw</span> e;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ³•ä¸»è¦æœ‰ï¼š</p><p>1ã€åˆ›å»º Bootstrap å®ä¾‹</p><p>2ã€å¦‚æœæ³¨å†Œäº†å®‰å…¨æ¨¡å—åˆ™å°†ç›¸å…³é…ç½®åŠ è½½è¿›æ¥</p><p>3ã€åˆ›å»º Elasticsearch è¿è¡Œçš„å¿…é¡»ç¯å¢ƒä»¥åŠç›¸å…³é…ç½®, å¦‚å°† configã€scriptsã€pluginsã€modulesã€logsã€libã€bin ç­‰é…ç½®ç›®å½•åŠ è½½åˆ°è¿è¡Œç¯å¢ƒä¸­</p><p>4ã€log é…ç½®ç¯å¢ƒï¼Œåˆ›å»ºæ—¥å¿—ä¸Šä¸‹æ–‡</p><p>5ã€æ£€æŸ¥æ˜¯å¦å­˜åœ¨ PID æ–‡ä»¶ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ›å»º PID æ–‡ä»¶</p><p>6ã€æ£€æŸ¥ Lucene ç‰ˆæœ¬</p><p>7ã€è°ƒç”¨ setup æ–¹æ³•ï¼ˆç”¨å½“å‰ç¯å¢ƒæ¥åˆ›å»ºä¸€ä¸ªèŠ‚ç‚¹ï¼‰</p><h4 id="setup-æ–¹æ³•"><a href="#setup-æ–¹æ³•" class="headerlink" title="setup æ–¹æ³•"></a>setup æ–¹æ³•</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setup</span><span class="params">(<span class="keyword">boolean</span> addShutdownHook, Environment environment)</span> <span class="keyword">throws</span> BootstrapException </span>&#123;</span><br><span class="line">    Settings settings = environment.settings();<span class="comment">//æ ¹æ®ç¯å¢ƒå¾—åˆ°é…ç½®</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        spawner.spawnNativeControllers(environment);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> BootstrapException(e);</span><br><span class="line">    &#125;</span><br><span class="line">    initializeNatives(</span><br><span class="line">        environment.tmpFile(),</span><br><span class="line">        BootstrapSettings.MEMORY_LOCK_SETTING.get(settings),</span><br><span class="line">        BootstrapSettings.SYSTEM_CALL_FILTER_SETTING.get(settings),</span><br><span class="line">        BootstrapSettings.CTRLHANDLER_SETTING.get(settings));</span><br><span class="line">    <span class="comment">// initialize probes before the security manager is installed</span></span><br><span class="line">    initializeProbes();</span><br><span class="line">    <span class="keyword">if</span> (addShutdownHook) &#123;</span><br><span class="line">        Runtime.getRuntime().addShutdownHook(<span class="keyword">new</span> Thread() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    IOUtils.close(node, spawner);</span><br><span class="line">                    LoggerContext context = (LoggerContext) LogManager.getContext(<span class="keyword">false</span>);</span><br><span class="line">                    Configurator.shutdown(context);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException ex) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> ElasticsearchException(<span class="string">"failed to stop node"</span>, ex);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// look for jar hell</span></span><br><span class="line">        <span class="keyword">final</span> Logger logger = ESLoggerFactory.getLogger(JarHell.class);</span><br><span class="line">        JarHell.checkJarHell(logger::debug);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException | URISyntaxException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> BootstrapException(e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Log ifconfig output before SecurityManager is installed</span></span><br><span class="line">    IfConfig.logIfNecessary();</span><br><span class="line">    <span class="comment">// install SM after natives, shutdown hooks, etc.</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Security.configure(environment, BootstrapSettings.SECURITY_FILTER_BAD_DEFAULTS_SETTING.get(settings));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException | NoSuchAlgorithmException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> BootstrapException(e);</span><br><span class="line">    &#125;</span><br><span class="line">    node = <span class="keyword">new</span> Node(environment) &#123;              <span class="comment">//16ã€æ–°å»ºèŠ‚ç‚¹</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">validateNodeBeforeAcceptingRequests</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">            <span class="keyword">final</span> BootstrapContext context,</span></span></span><br><span class="line"><span class="function"><span class="params">            <span class="keyword">final</span> BoundTransportAddress boundTransportAddress, List&lt;BootstrapCheck&gt; checks)</span> <span class="keyword">throws</span> NodeValidationException </span>&#123;</span><br><span class="line">            BootstrapChecks.check(context, boundTransportAddress, checks);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç æœ€åå°±æ˜¯ Node èŠ‚ç‚¹çš„åˆ›å»ºï¼Œè¿™ç¯‡æ–‡ç« å°±ä¸è®² Node çš„åˆ›å»ºäº†ï¼Œä¸‹ç¯‡æ–‡ç« ä¼šå¥½å¥½è®²ä¸€ä¸‹ Node èŠ‚ç‚¹çš„åˆ›å»ºå’Œæ­£å¼å¯åŠ¨ ES èŠ‚ç‚¹çš„ã€‚</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>è¿™ç¯‡æ–‡ç« ä¸»è¦å…ˆæŠŠå¤§æ¦‚å¯åŠ¨æµç¨‹ä¸²é€šï¼Œå› ä¸ºç¯‡å¹…è¾ƒå¤šæ‰€ä»¥æ‹†å¼€æˆä¸¤ç¯‡ï¼Œå…ˆä¸æ‰£ç»†èŠ‚äº†ï¼Œåé¢æµç¨‹å¯åŠ¨æ–‡ç« å†™å®Œåæˆ‘ä»¬å†å•ä¸€çš„æ‰£ç»†èŠ‚ã€‚</p><h3 id="ç›¸å…³æ–‡ç« "><a href="#ç›¸å…³æ–‡ç« " class="headerlink" title="ç›¸å…³æ–‡ç« "></a>ç›¸å…³æ–‡ç« </h3><p>1ã€<a href="http://www.54tianzhisheng.cn/2018/08/04/why-see-es-code/" target="_blank" rel="noopener">æ¸£æ¸£èœé¸¡ä¸ºä»€ä¹ˆè¦çœ‹ ElasticSearch æºç ï¼Ÿ</a></p><p>2ã€<a href="http://www.54tianzhisheng.cn/2018/08/05/es-code01/" target="_blank" rel="noopener">æ¸£æ¸£èœé¸¡çš„ ElasticSearch æºç è§£æ â€”â€” ç¯å¢ƒæ­å»º</a></p><p>3ã€<a href="http://www.54tianzhisheng.cn/2018/08/11/es-code02/" target="_blank" rel="noopener">æ¸£æ¸£èœé¸¡çš„ ElasticSearch æºç è§£æ â€”â€” å¯åŠ¨æµç¨‹(ä¸Š)</a></p><p>4ã€<a href="http://www.54tianzhisheng.cn/2018/08/11/es-code03/" target="_blank" rel="noopener">æ¸£æ¸£èœé¸¡çš„ ElasticSearch æºç è§£æ â€”â€” å¯åŠ¨æµç¨‹(ä¸‹)</a></p><p>5ã€<a href="http://www.54tianzhisheng.cn/2017/09/08/Elasticsearch-analyzers/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆä¸€ï¼‰ï¼šElasticsearch é»˜è®¤åˆ†è¯å™¨å’Œä¸­åˆ†åˆ†è¯å™¨ä¹‹é—´çš„æ¯”è¾ƒåŠä½¿ç”¨æ–¹æ³•</a></p><p>6ã€<a href="http://www.54tianzhisheng.cn/2017/09/09/Elasticsearch-install/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆäºŒï¼‰ï¼šå…¨æ–‡æœç´¢å¼•æ“ Elasticsearch é›†ç¾¤æ­å»ºå…¥é—¨æ•™ç¨‹</a></p><p>7ã€<a href="http://www.54tianzhisheng.cn/2017/10/15/ElasticSearch-cluster-health-metrics/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆä¸‰ï¼‰ï¼šElasticSearch é›†ç¾¤ç›‘æ§</a></p><p>8ã€<a href="http://www.54tianzhisheng.cn/2017/10/18/ElasticSearch-nodes-metrics/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆå››ï¼‰ï¼šElasticSearch å•ä¸ªèŠ‚ç‚¹ç›‘æ§</a></p><p>9ã€<a href="http://www.54tianzhisheng.cn/2017/12/25/ELK/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆäº”ï¼‰ï¼šELK å®æ—¶æ—¥å¿—åˆ†æå¹³å°ç¯å¢ƒæ­å»º</a></p><p>10ã€<a href="http://www.54tianzhisheng.cn/2018/08/14/idea-remote-debug-elasticsearch/" target="_blank" rel="noopener">æ•™ä½ å¦‚ä½•åœ¨ IDEA è¿œç¨‹ Debug ElasticSearch</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://ws2.sinaimg.cn/large/006tNbRwly1fu8gag9ycij31hc0w0awj.jpg&quot; alt=&quot;005&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="ElasticSearch" scheme="http://yoursite.com/tags/ElasticSearch/"/>
    
  </entry>
  
  <entry>
    <title>æ¸£æ¸£èœé¸¡çš„ ElasticSearch æºç è§£æ â€”â€” ç¯å¢ƒæ­å»º</title>
    <link href="http://yoursite.com/2018/08/05/es-code01/"/>
    <id>http://yoursite.com/2018/08/05/es-code01/</id>
    <published>2018-08-04T16:00:00.000Z</published>
    <updated>2018-08-26T04:10:20.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://ws4.sinaimg.cn/large/006tNc79ly1fty28q9ljkj31hc0zbqf5.jpg" alt="girl-3551832_1920"></p><a id="more"></a><h3 id="å…³æ³¨æˆ‘"><a href="#å…³æ³¨æˆ‘" class="headerlink" title="å…³æ³¨æˆ‘"></a>å…³æ³¨æˆ‘</h3><p><img src="http://ohfk1r827.bkt.clouddn.com/blog/180103/C6LG3mGa12.jpg" alt="zhisheng"></p><p>è½¬è½½è¯·åŠ¡å¿…æ³¨æ˜åŸåˆ›åœ°å€ä¸ºï¼š<a href="http://www.54tianzhisheng.cn/2018/08/05/es-code01/" target="_blank" rel="noopener">http://www.54tianzhisheng.cn/2018/08/05/es-code01/</a></p><h3 id="è½¯ä»¶ç¯å¢ƒ"><a href="#è½¯ä»¶ç¯å¢ƒ" class="headerlink" title="è½¯ä»¶ç¯å¢ƒ"></a>è½¯ä»¶ç¯å¢ƒ</h3><p>1ã€Intellij Idea:2018.2ç‰ˆæœ¬</p><p>2ã€Elasticsearch æºç ç‰ˆæœ¬: 6.3.2</p><p>3ã€JDK:10.0.2</p><p>4ã€Gradle : å»ºè®® 4.5 åŠä»¥ä¸Šç‰ˆæœ¬</p><p>5ã€Macbook Pro 2017 </p><h3 id="å®‰è£…-ElasticSearch"><a href="#å®‰è£…-ElasticSearch" class="headerlink" title="å®‰è£… ElasticSearch"></a>å®‰è£… ElasticSearch</h3><p> å» <a href="https://www.elastic.co/downloads/past-releases" target="_blank" rel="noopener">https://www.elastic.co/downloads/past-releases</a> è¿™é‡Œæ‰¾åˆ° ElasticSearch 6.3.2 ç‰ˆæœ¬ï¼Œä¸‹è½½åç„¶åè§£å‹å°±å¥½äº†ã€‚ï¼ˆæ³¨æ„ï¼šè¿™ä¸ªç‰ˆæœ¬éœ€è¦å’Œä¸‹é¢çš„æºç ç‰ˆæœ¬ä¸€è‡´ï¼‰</p><h3 id="ä¸‹è½½æºç "><a href="#ä¸‹è½½æºç " class="headerlink" title="ä¸‹è½½æºç "></a>ä¸‹è½½æºç </h3><p>ä» <a href="https://github.com/elastic/elasticsearch" target="_blank" rel="noopener">https://github.com/elastic/elasticsearch</a> ä¸Šä¸‹è½½ç›¸åº”ç‰ˆæœ¬çš„æºä»£ç ï¼Œè¿™é‡Œå»ºè®®ç”¨ git clone ï¼Œè¿™æ ·çš„è¯åé¢ä½ å¯ä»¥éšæ„åˆ‡æ¢åˆ° ElasticSearch çš„å…¶ä»–ç‰ˆæœ¬å»ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone git@github.com:elastic/elasticsearch.git</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çœ‹ä¸‹æœ‰å“ªäº›ç‰ˆæœ¬çš„ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git tag</span><br></pre></td></tr></table></figure><p>æ‰¾åˆ°äº†ç›®å‰æºç ç‰ˆæœ¬æœ€æ–°çš„ç‰ˆæœ¬çš„ç¨³å®šç‰ˆä¸ºï¼šv6.3.2</p><p>åˆ‡æ¢åˆ°è¯¥ç‰ˆæœ¬ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout v6.3.2</span><br></pre></td></tr></table></figure><p>äºæ˜¯å°±å¯ä»¥åˆ‡æ¢åˆ°è¯¥ç¨³å®šç‰ˆæœ¬äº†ã€‚æ¥ä¸‹æ¥ä¸è¦ç›´æ¥å¯¼å…¥åˆ° IDEA/Eclipse ä¸­ã€‚</p><h3 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h3><p><a href="https://github.com/elastic/elasticsearch/blob/master/CONTRIBUTING.md#configuring-ides-and-running-tests" target="_blank" rel="noopener">GitHub è¿™é‡Œ</a>å·²ç»æœ‰æè¿°å¦‚ä½•å¯¼å…¥ IDEA/Eclipse ä¸­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">JDK 10 is required to build Elasticsearch. You must have a JDK 10 installation with the environment variable JAVA_HOME referencing the path to Java home for your JDK 10 installation. By default, tests use the same runtime as JAVA_HOME. However, since Elasticsearch, supports JDK 8 the build supports compiling with JDK 10 and testing on a JDK 8 runtime; to do this, set RUNTIME_JAVA_HOME pointing to the Java home of a JDK 8 installation. Note that this mechanism can be used to test against other JDKs as well, this is not only limited to JDK 8.</span><br><span class="line"></span><br><span class="line">Note: It is also required to have JAVA7_HOME, JAVA8_HOME and JAVA10_HOME available so that the tests can pass.</span><br><span class="line"></span><br><span class="line">Warning: do not use sdkman for Java installations which do not have proper jrunscript for jdk distributions.</span><br><span class="line"></span><br><span class="line">Elasticsearch uses the Gradle wrapper for its build. You can execute Gradle using the wrapper via the gradlew script in the root of the repository.</span><br><span class="line"></span><br><span class="line">Configuring IDEs And Running Tests</span><br><span class="line">Eclipse users can automatically configure their IDE: ./gradlew eclipse then File: Import: Existing Projects into Workspace. Select the option Search for nested projects. Additionally you will want to ensure that Eclipse is using 2048m of heap by modifying eclipse.ini accordingly to avoid GC overhead errors.</span><br><span class="line"></span><br><span class="line">IntelliJ users can automatically configure their IDE: ./gradlew idea then File-&gt;New Project From Existing Sources. Point to the root of the source directory, select Import project from external model-&gt;Gradle, enable Use auto-import. In order to run tests directly from IDEA 2017.2 and above, it is required to disable the IDEA run launcher in order to avoid idea_rt.jar causing &quot;jar hell&quot;. This can be achieved by adding the -Didea.no.launcher=true JVM option. Alternatively, idea.no.launcher=true can be set in the idea.properties file which can be accessed under Help &gt; Edit Custom Properties (this will require a restart of IDEA). For IDEA 2017.3 and above, in addition to the JVM option, you will need to go to Run-&gt;Edit Configurations-&gt;...-&gt;Defaults-&gt;JUnit and verify that the Shorten command line setting is set to user-local default: none. You may also need to remove ant-javafx.jar from your classpath if that is reported as a source of jar hell.</span><br><span class="line"></span><br><span class="line">To run an instance of elasticsearch from the source code run ./gradlew run</span><br><span class="line"></span><br><span class="line">The Elasticsearch codebase makes heavy use of Java asserts and the test runner requires that assertions be enabled within the JVM. This can be accomplished by passing the flag -ea to the JVM on startup.</span><br><span class="line"></span><br><span class="line">For IntelliJ, go to Run-&gt;Edit Configurations...-&gt;Defaults-&gt;JUnit-&gt;VM options and input -ea.</span><br><span class="line"></span><br><span class="line">For Eclipse, go to Preferences-&gt;Java-&gt;Installed JREs and add -ea to VM Arguments.</span><br></pre></td></tr></table></figure><p>ä¸Šé¢è¯´äº†ä¸‹å¦‚ä½•ç¼–è¯‘ Elasticsearch å’Œå¦‚ä½•åœ¨ ide ä¸­é…ç½®å¥½ç¯å¢ƒã€‚ä¸‹é¢è¯´ä¸‹æ­¥éª¤å§ï¼šï¼ˆè¿™é‡Œæˆ‘åªæ˜¯æ¼”ç¤ºåœ¨ IDEA ä¸­å¦‚ä½•å¯¼å…¥ï¼‰</p><p>1ã€åœ¨æˆ‘ä»¬ä¸‹è½½çš„ Elasticsearch æ ¹ç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤ï¼š(æ‰§è¡Œå·²ç»å†™å¥½çš„è„šæœ¬ gradlew)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./gradlew idea</span><br></pre></td></tr></table></figure><p>è¯·æ³¨æ„ç‰ˆæœ¬å’Œæˆ‘çš„ä¸€è‡´ï¼Œæ—©çš„ç‰ˆæœ¬å¯èƒ½æ²¡æœ‰è¯¥æ‰§è¡Œè„šæœ¬ï¼Œéœ€è¦æ‰§è¡Œ <code>gradle idea</code> å‘½ä»¤</p><p>æœ€åç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://ws4.sinaimg.cn/large/0069RVTdly1fty1xfk9m9j31kw0ib494.jpg" alt="idea-config"></p><p>2ã€å¯¼å…¥ IDEA </p><p>idea ä¸­ <code>File -&gt; New Project From Existing Sources</code> é€‰æ‹©ä½ ä¸‹è½½çš„ Elasticsearch æ ¹ç›®å½•ï¼Œç„¶åç‚¹ <code>open</code> ï¼Œä¹‹å <code>Import project from external model -&gt; Gradle</code> , é€‰ä¸­ <code>Use auto-import</code>, ç„¶åå°±å¯ä»¥äº†ã€‚</p><p>å¯¼å…¥è¿›å»åï¼Œgradle åˆä¼šç¼–è¯‘ä¸€éï¼Œéœ€è¦ç­‰ä¸€ä¼šï¼Œå¥½äº†ä¹‹åå¦‚ä¸‹ï¼š</p><p><img src="https://ws3.sinaimg.cn/large/0069RVTdly1fty1xisz0kj31kw0w07jn.jpg" alt="ok"></p><h3 id="è¿è¡Œ"><a href="#è¿è¡Œ" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h3><p>æ‰“å¼€ server æ¨¡å—ä¸‹çš„ Elasticsearch ç±»ï¼šorg.elasticsearch.bootstrap.Elasticsearchï¼Œè¿è¡Œé‡Œé¢çš„ main å‡½æ•°ã€‚</p><p>1ã€æŠ¥é”™å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ERROR: the system property [es.path.conf] must be set</span><br></pre></td></tr></table></figure><p><img src="https://ws4.sinaimg.cn/large/0069RVTdly1fty1xdcx6zj30ss0ahjru.jpg" alt="1es-path-conf-must-be-set"></p><p>æˆ‘ä»¬åœ¨è¿è¡Œçš„é…ç½® vm options å¦‚ä¸‹ï¼šï¼ˆåé¢å¯åŠ¨æµç¨‹ä¼šå†™ä¸ºä»€ä¹ˆä¼šæŠ¥è¿™ä¸ªé”™è¯¯ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-Des.path.conf=&quot;/usr/local/elasticsearch-6.3.2/config&quot;</span><br></pre></td></tr></table></figure><p><img src="https://ws3.sinaimg.cn/large/0069RVTdly1fty1xebbgxj30v10l9n0w.jpg" alt="2è®¾ç½®es-path-conf"></p><p>2ã€å†æ¬¡è¿è¡Œï¼ŒæŠ¥é”™å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Exception in thread &quot;main&quot; java.lang.IllegalStateException: path.home is not configured</span><br><span class="line">at org.elasticsearch.env.Environment.&lt;init&gt;(Environment.java:103)</span><br><span class="line">at org.elasticsearch.env.Environment.&lt;init&gt;(Environment.java:94)</span><br><span class="line">at org.elasticsearch.node.InternalSettingsPreparer.prepareEnvironment(InternalSettingsPreparer.java:86)</span><br><span class="line">at org.elasticsearch.cli.EnvironmentAwareCommand.createEnv(EnvironmentAwareCommand.java:95)</span><br><span class="line">at org.elasticsearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:86)</span><br><span class="line">at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:124)</span><br><span class="line">at org.elasticsearch.cli.Command.main(Command.java:90)</span><br><span class="line">at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:93)</span><br><span class="line">at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:86)</span><br></pre></td></tr></table></figure><p><img src="https://ws1.sinaimg.cn/large/0069RVTdly1fty1xh2zblj30tk09s40w.jpg" alt="3path-home-not-config"></p><p>æˆ‘ä»¬åœ¨è¿è¡Œçš„é…ç½® vm options å¦‚ä¸‹ï¼šï¼ˆåé¢å¯åŠ¨æµç¨‹ä¼šå†™ä¸ºä»€ä¹ˆä¼šæŠ¥è¿™ä¸ªé”™è¯¯ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-Des.path.home=&quot;/usr/local/elasticsearch-6.3.2&quot;</span><br></pre></td></tr></table></figure><p><img src="https://ws4.sinaimg.cn/large/0069RVTdly1fty1xg4ktmj30v10l976r.jpg" alt="4é…ç½®es-path-home"></p><p>3ã€å†æ¬¡è¿è¡Œï¼ŒæŠ¥é”™å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">2018-08-01 09:38:03,974 main ERROR Could not register mbeans java.security.AccessControlException: access denied (&quot;javax.management.MBeanTrustPermission&quot; &quot;register&quot;)</span><br><span class="line">at java.base/java.security.AccessControlContext.checkPermission(AccessControlContext.java:472)</span><br><span class="line">at java.base/java.lang.SecurityManager.checkPermission(SecurityManager.java:371)</span><br><span class="line">at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.checkMBeanTrustPermission(DefaultMBeanServerInterceptor.java:1805)</span><br><span class="line">at java.management/com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerMBean(DefaultMBeanServerInterceptor.java:318)</span><br><span class="line">at java.management/com.sun.jmx.mbeanserver.JmxMBeanServer.registerMBean(JmxMBeanServer.java:522)</span><br><span class="line">at org.apache.logging.log4j.core.jmx.Server.register(Server.java:389)</span><br><span class="line">at org.apache.logging.log4j.core.jmx.Server.reregisterMBeansAfterReconfigure(Server.java:167)</span><br><span class="line">at org.apache.logging.log4j.core.jmx.Server.reregisterMBeansAfterReconfigure(Server.java:140)</span><br><span class="line">at org.apache.logging.log4j.core.LoggerContext.setConfiguration(LoggerContext.java:556)</span><br><span class="line">at org.apache.logging.log4j.core.LoggerContext.start(LoggerContext.java:261)</span><br><span class="line">at org.apache.logging.log4j.core.impl.Log4jContextFactory.getContext(Log4jContextFactory.java:206)</span><br><span class="line">at org.apache.logging.log4j.core.config.Configurator.initialize(Configurator.java:220)</span><br><span class="line">at org.apache.logging.log4j.core.config.Configurator.initialize(Configurator.java:197)</span><br><span class="line">at org.elasticsearch.common.logging.LogConfigurator.configureStatusLogger(LogConfigurator.java:171)</span><br><span class="line">at org.elasticsearch.common.logging.LogConfigurator.configure(LogConfigurator.java:140)</span><br><span class="line">at org.elasticsearch.common.logging.LogConfigurator.configure(LogConfigurator.java:119)</span><br><span class="line">at org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:294)</span><br><span class="line">at org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:136)</span><br><span class="line">at org.elasticsearch.bootstrap.Elasticsearch.execute(Elasticsearch.java:127)</span><br><span class="line">at org.elasticsearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:86)</span><br><span class="line">at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:124)</span><br><span class="line">at org.elasticsearch.cli.Command.main(Command.java:90)</span><br><span class="line">at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:93)</span><br><span class="line">at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:86)</span><br></pre></td></tr></table></figure><p><img src="https://ws4.sinaimg.cn/large/0069RVTdly1fty1xcqbf1j316r0tbn87.jpg" alt="5access-denied"></p><p>æˆ‘ä»¬åœ¨è¿è¡Œçš„é…ç½® vm options å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-Dlog4j2.disable.jmx=true</span><br></pre></td></tr></table></figure><p><img src="https://ws2.sinaimg.cn/large/0069RVTdly1fty1xglydpj30v10l9q5h.jpg" alt="6log4j-disable-jmx"></p><p>4ã€å¦‚æœä½ ç”¨çš„æ˜¯ JDK 1.8 ç¼–è¯‘çš„åº”è¯¥è¿˜ä¼šæŠ¥è¿™ä¸ªé”™è¯¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[2018-08-01T11:02:24,663][WARN ][o.e.b.ElasticsearchUncaughtExceptionHandler] [] uncaught exception in thread [main]</span><br><span class="line">org.elasticsearch.bootstrap.StartupException: java.lang.IllegalStateException: jar hell!</span><br><span class="line">class: jdk.packager.services.UserJvmOptionsService</span><br><span class="line">jar1: /Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/lib/ant-javafx.jar</span><br><span class="line">jar2: /Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/lib/packager.jar</span><br><span class="line">at org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:140) ~[main/:?]</span><br><span class="line">at org.elasticsearch.bootstrap.Elasticsearch.execute(Elasticsearch.java:127) ~[main/:?]</span><br><span class="line">at org.elasticsearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:86) ~[main/:?]</span><br><span class="line">at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:124) ~[main/:?]</span><br><span class="line">at org.elasticsearch.cli.Command.main(Command.java:90) ~[main/:?]</span><br><span class="line">at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:93) ~[main/:?]</span><br><span class="line">at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:86) ~[main/:?]</span><br><span class="line">Caused by: java.lang.IllegalStateException: jar hell!</span><br><span class="line">class: jdk.packager.services.UserJvmOptionsService</span><br><span class="line">jar1: /Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/lib/ant-javafx.jar</span><br><span class="line">jar2: /Library/Java/JavaVirtualMachines/jdk1.8.0_152.jdk/Contents/Home/lib/packager.jar</span><br><span class="line">at org.elasticsearch.bootstrap.JarHell.checkClass(JarHell.java:273) ~[main/:?]</span><br><span class="line">at org.elasticsearch.bootstrap.JarHell.checkJarHell(JarHell.java:190) ~[main/:?]</span><br><span class="line">at org.elasticsearch.bootstrap.JarHell.checkJarHell(JarHell.java:86) ~[main/:?]</span><br><span class="line">at org.elasticsearch.bootstrap.Bootstrap.setup(Bootstrap.java:198) ~[main/:?]</span><br><span class="line">at org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:326) ~[main/:?]</span><br><span class="line">at org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:136) ~[main/:?]</span><br><span class="line">... 6 more</span><br><span class="line">2018-08-01 11:02:24,713 Thread-2 ERROR No log4j2 configuration file found. Using default configuration: logging only errors to the console. Set system property &apos;log4j2.debug&apos; to show Log4j2 internal initialization logging.</span><br></pre></td></tr></table></figure><p><img src="https://ws1.sinaimg.cn/large/0069RVTdly1fty1xhjppqj31h40gbted.jpg" alt="8jar-hell"></p><p>æœ‰ä¸¤ä¸ªè§£å†³æ–¹æ³•å°±æ˜¯ï¼Œ</p><p>ï¼ˆ1ï¼‰ã€æŠŠæºç ä¸­æœ‰å…³ä½¿ç”¨äº† <code>JarHell.checkJarHell</code> ä»£ç çš„åœ°æ–¹å…¨éƒ¨æ³¨é‡Šæ‰å°±å¥½äº†</p><p>ï¼ˆ2ï¼‰ã€æ¢æˆ JDK 10 ç¼–è¯‘</p><p>ä¸¤ç§æ–¹æ³•æˆ‘éƒ½è¯•äº†æ˜¯å¯è¡Œçš„ï¼Œå»ºè®®ç›´æ¥æ¢ç¬¬äºŒç§æ–¹æ¡ˆå§ï¼</p><p>5ã€ç„¶åå†å¯åŠ¨çš„è¯ï¼Œåº”è¯¥æ²¡é—®é¢˜äº†,å‡ºç°ä¸‹é¢æ—¥å¿—ï¼šï¼ˆç½‘ä¸Šå¾ˆå¤šäººåœ¨è¿™æ­¥å°±å¥½äº†ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">[elasticsearch] Java HotSpot(TM) 64-Bit Server VM warning: Option UseConcMarkSweepGC was deprecated in version 9.0 and will likely be removed in a future release.</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:26,073][INFO ][o.e.n.Node               ] [node-0] initializing ...</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:26,185][INFO ][o.e.e.NodeEnvironment    ] [node-0] using [1] data paths, mounts [[/ (/dev/disk1s1)]], net usable_space [109.3gb], net total_space [233.4gb], types [apfs]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:26,187][INFO ][o.e.e.NodeEnvironment    ] [node-0] heap size [494.9mb], compressed ordinary object pointers [true]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:26,190][INFO ][o.e.n.Node               ] [node-0] node name [node-0], node ID [o9SuMXP-R7uvJLtE3h37Rw]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:26,191][INFO ][o.e.n.Node               ] [node-0] version[6.3.2-SNAPSHOT], pid[61499], build[default/zip/053779d/2018-08-04T08:39:59.714654Z], OS[Mac OS X/10.13.5/x86_64], JVM[&quot;Oracle Corporation&quot;/Java HotSpot(TM) 64-Bit Server VM/10.0.2/10.0.2+13]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:26,191][INFO ][o.e.n.Node               ] [node-0] JVM arguments [-Xms1g, -Xmx1g, -XX:+UseConcMarkSweepGC, -XX:CMSInitiatingOccupancyFraction=75, -XX:+UseCMSInitiatingOccupancyOnly, -XX:+AlwaysPreTouch, -Xss1m, -Djava.awt.headless=true, -Dfile.encoding=UTF-8, -Djna.nosys=true, -XX:-OmitStackTraceInFastThrow, -Dio.netty.noUnsafe=true, -Dio.netty.noKeySetOptimization=true, -Dio.netty.recycler.maxCapacityPerThread=0, -Dlog4j.shutdownHookEnabled=false, -Dlog4j2.disable.jmx=true, -Djava.io.tmpdir=/var/folders/mb/3vpbvkkx13l2jmpt2kmmt0fr0000gn/T/elasticsearch.URRKTybG, -XX:+HeapDumpOnOutOfMemoryError, -XX:HeapDumpPath=data, -XX:ErrorFile=logs/hs_err_pid%p.log, -Xlog:gc*,gc+age=trace,safepoint:file=logs/gc.log:utctime,pid,tags:filecount=32,filesize=64m, -Djava.locale.providers=COMPAT, -XX:UseAVX=2, -ea, -esa, -Xms512m, -Xmx512m, -Des.path.home=/Users/zhisheng/IdeaProjects/github/elasticsearch/distribution/build/cluster/run node0/elasticsearch-6.3.2-SNAPSHOT, -Des.path.conf=/Users/zhisheng/IdeaProjects/github/elasticsearch/distribution/build/cluster/run node0/elasticsearch-6.3.2-SNAPSHOT/config, -Des.distribution.flavor=default, -Des.distribution.type=zip]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:26,191][WARN ][o.e.n.Node               ] [node-0] version [6.3.2-SNAPSHOT] is a pre-release version of Elasticsearch and is not suitable for production</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:28,808][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [aggs-matrix-stats]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:28,809][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [analysis-common]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:28,809][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [ingest-common]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:28,809][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [lang-expression]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:28,809][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [lang-mustache]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:28,809][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [lang-painless]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:28,809][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [mapper-extras]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:28,809][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [parent-join]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:28,809][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [percolator]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:28,809][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [rank-eval]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:28,809][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [reindex]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:28,810][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [repository-url]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:28,810][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [transport-netty4]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:28,810][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [tribe]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:28,810][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [x-pack-core]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:28,810][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [x-pack-deprecation]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:28,810][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [x-pack-graph]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:28,810][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [x-pack-logstash]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:28,810][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [x-pack-ml]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:28,810][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [x-pack-monitoring]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:28,810][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [x-pack-rollup]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:28,810][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [x-pack-security]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:28,811][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [x-pack-sql]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:28,811][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [x-pack-upgrade]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:28,811][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [x-pack-watcher]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:28,811][INFO ][o.e.p.PluginsService     ] [node-0] no plugins loaded</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:32,722][INFO ][o.e.x.s.a.s.FileRolesStore] [node-0] parsed [0] roles from file [/Users/zhisheng/IdeaProjects/github/elasticsearch/distribution/build/cluster/run node0/elasticsearch-6.3.2-SNAPSHOT/config/roles.yml]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:33,358][INFO ][o.e.x.m.j.p.l.CppLogMessageHandler] [controller/61517] [Main.cc@109] controller (64 bit): Version 6.3.2-SNAPSHOT (Build 903094f295d249) Copyright (c) 2018 Elasticsearch BV</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:33,783][DEBUG][o.e.a.ActionModule       ] Using REST wrapper from plugin org.elasticsearch.xpack.security.Security</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:34,110][INFO ][o.e.d.DiscoveryModule    ] [node-0] using discovery type [zen]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:34,971][INFO ][o.e.n.Node               ] [node-0] initialized</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:34,971][INFO ][o.e.n.Node               ] [node-0] starting ...</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:35,217][INFO ][o.e.t.TransportService   ] [node-0] publish_address &#123;127.0.0.1:9300&#125;, bound_addresses &#123;[::1]:9300&#125;, &#123;127.0.0.1:9300&#125;</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:38,291][INFO ][o.e.c.s.MasterService    ] [node-0] zen-disco-elected-as-master ([0] nodes joined)[, ], reason: new_master &#123;node-0&#125;&#123;o9SuMXP-R7uvJLtE3h37Rw&#125;&#123;xjoT1zvpRsm1ZDGLCab1sA&#125;&#123;127.0.0.1&#125;&#123;127.0.0.1:9300&#125;&#123;ml.machine_memory=17179869184, xpack.installed=true, testattr=test, ml.max_open_jobs=20, ml.enabled=true&#125;</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:38,295][INFO ][o.e.c.s.ClusterApplierService] [node-0] new_master &#123;node-0&#125;&#123;o9SuMXP-R7uvJLtE3h37Rw&#125;&#123;xjoT1zvpRsm1ZDGLCab1sA&#125;&#123;127.0.0.1&#125;&#123;127.0.0.1:9300&#125;&#123;ml.machine_memory=17179869184, xpack.installed=true, testattr=test, ml.max_open_jobs=20, ml.enabled=true&#125;, reason: apply cluster state (from master [master &#123;node-0&#125;&#123;o9SuMXP-R7uvJLtE3h37Rw&#125;&#123;xjoT1zvpRsm1ZDGLCab1sA&#125;&#123;127.0.0.1&#125;&#123;127.0.0.1:9300&#125;&#123;ml.machine_memory=17179869184, xpack.installed=true, testattr=test, ml.max_open_jobs=20, ml.enabled=true&#125; committed version [1] source [zen-disco-elected-as-master ([0] nodes joined)[, ]]])</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:38,317][INFO ][o.e.x.s.t.n.SecurityNetty4HttpServerTransport] [node-0] publish_address &#123;127.0.0.1:9200&#125;, bound_addresses &#123;[::1]:9200&#125;, &#123;127.0.0.1:9200&#125;</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:38,319][INFO ][o.e.n.Node               ] [node-0] started</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:38,358][WARN ][o.e.x.s.a.s.m.NativeRoleMappingStore] [node-0] Failed to clear cache for realms [[]]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:38,413][INFO ][o.e.g.GatewayService     ] [node-0] recovered [0] indices into cluster_state</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:38,597][INFO ][o.e.c.m.MetaDataIndexTemplateService] [node-0] adding template [.watch-history-7] for index patterns [.watcher-history-7*]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:38,660][INFO ][o.e.c.m.MetaDataIndexTemplateService] [node-0] adding template [.watches] for index patterns [.watches*]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:38,707][INFO ][o.e.c.m.MetaDataIndexTemplateService] [node-0] adding template [.triggered_watches] for index patterns [.triggered_watches*]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:38,771][INFO ][o.e.c.m.MetaDataIndexTemplateService] [node-0] adding template [.monitoring-logstash] for index patterns [.monitoring-logstash-6-*]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:38,836][INFO ][o.e.c.m.MetaDataIndexTemplateService] [node-0] adding template [.monitoring-es] for index patterns [.monitoring-es-6-*]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:38,878][INFO ][o.e.c.m.MetaDataIndexTemplateService] [node-0] adding template [.monitoring-alerts] for index patterns [.monitoring-alerts-6]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:38,926][INFO ][o.e.c.m.MetaDataIndexTemplateService] [node-0] adding template [.monitoring-beats] for index patterns [.monitoring-beats-6-*]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:38,970][INFO ][o.e.c.m.MetaDataIndexTemplateService] [node-0] adding template [.monitoring-kibana] for index patterns [.monitoring-kibana-6-*]</span><br><span class="line">[elasticsearch] [2018-08-04T16:42:39,055][INFO ][o.e.l.LicenseService     ] [node-0] license [79704513-d3c4-4535-8276-beeb146765de] mode [basic] - valid</span><br></pre></td></tr></table></figure><p>6ã€ä½†æ˜¯æˆ‘å‡ºç°äº†ä¸‹é¢è¿™ä¸ªé—®é¢˜ï¼Œä¸€ç›´å›°æ‰°ç€æˆ‘å‘¢ï¼Œæˆ‘æ˜¯ç›´æ¥è·³è¿‡å»çš„ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[2018-08-01T09:44:27,370][ERROR][o.e.b.ElasticsearchUncaughtExceptionHandler] [] fatal error in thread [main], exiting</span><br><span class="line">java.lang.NoClassDefFoundError: org/elasticsearch/plugins/ExtendedPluginsClassLoader</span><br><span class="line">at org.elasticsearch.plugins.PluginsService.loadBundle(PluginsService.java:632) ~[main/:?]</span><br><span class="line">at org.elasticsearch.plugins.PluginsService.loadBundles(PluginsService.java:557) ~[main/:?]</span><br><span class="line">at org.elasticsearch.plugins.PluginsService.&lt;init&gt;(PluginsService.java:162) ~[main/:?]</span><br><span class="line">at org.elasticsearch.node.Node.&lt;init&gt;(Node.java:311) ~[main/:?]</span><br><span class="line">at org.elasticsearch.node.Node.&lt;init&gt;(Node.java:252) ~[main/:?]</span><br><span class="line">at org.elasticsearch.bootstrap.Bootstrap$5.&lt;init&gt;(Bootstrap.java:213) ~[main/:?]</span><br><span class="line">at org.elasticsearch.bootstrap.Bootstrap.setup(Bootstrap.java:213) ~[main/:?]</span><br><span class="line">at org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:326) ~[main/:?]</span><br><span class="line">at org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:136) ~[main/:?]</span><br><span class="line">at org.elasticsearch.bootstrap.Elasticsearch.execute(Elasticsearch.java:127) ~[main/:?]</span><br><span class="line">at org.elasticsearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:86) ~[main/:?]</span><br><span class="line">at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:124) ~[main/:?]</span><br><span class="line">at org.elasticsearch.cli.Command.main(Command.java:90) ~[main/:?]</span><br><span class="line">at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:93) ~[main/:?]</span><br><span class="line">at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:86) ~[main/:?]</span><br><span class="line">Caused by: java.lang.ClassNotFoundException: org.elasticsearch.plugins.ExtendedPluginsClassLoader</span><br><span class="line">at jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:582) ~[?:?]</span><br><span class="line">at jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:190) ~[?:?]</span><br><span class="line">at java.lang.ClassLoader.loadClass(ClassLoader.java:499) ~[?:?]</span><br><span class="line">... 15 more</span><br></pre></td></tr></table></figure><p><img src="https://ws2.sinaimg.cn/large/0069RVTdly1fty1xi20xzj310q0ilgsa.jpg" alt="7noclassDefFoundError"></p><p>é‡åˆ°çš„è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘åœ¨ GitHub æ±‚åŠ©ä¿¡æ¯å¦‚ä¸‹ï¼š</p><p><a href="https://github.com/elastic/elasticsearch/issues/30774" target="_blank" rel="noopener">https://github.com/elastic/elasticsearch/issues/30774</a></p><p>ä½†æ˜¯å¹¶æ²¡æœ‰è§£å†³æˆ‘çš„é—®é¢˜ï¼Œè¿™é‡Œæš‚æ—¶å…ˆè®°å½•ä¸‹æ¥ï¼æˆ‘è‡ªå·±ä¹Ÿè·Ÿäº†ä¸‹æºç ï¼Œå®šä½åˆ°é”™è¯¯ä¿¡æ¯æ˜¯æ€ä¹ˆäº§ç”Ÿçš„ï¼Œä½†æ˜¯æ²¡æœ‰è§£å†³æ–¹æ¡ˆï¼</p><p>åé¢å†™äº†ç¯‡æ–‡ç« ï¼š<a href="http://www.54tianzhisheng.cn/2018/08/14/idea-remote-debug-elasticsearch/" target="_blank" rel="noopener">æ•™ä½ å¦‚ä½•åœ¨ IDEA è¿œç¨‹ Debug ElasticSearch</a></p><p>æˆ–è®¸å¯ä»¥å¸®ä½ è§£å†³ä¸Šé¢é—®é¢˜å¸¦ç»™ä½ çš„å›°æ‰°ï¼</p><h3 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h3><p>åé¢æœ‰ä¸€ä¸ªè¯»è€…æé†’äº†æˆ‘ä¸€ä¸‹ï¼Œä»–è‡ªå·±ä¹Ÿé‡åˆ°è¿™ä¸ªé—®é¢˜ï¼Œç„¶åä»–çš„è§£å†³æ–¹æ¡ˆæŒºå¥½çš„ï¼Œå®Œç¾è§£å†³æˆ‘çš„é—®é¢˜ã€‚è¿™é‡Œåšä¸ªè®°å½•ï¼š</p><p><strong>è§£å†³æ–¹æ³•ï¼š</strong> æ‰“å¼€ IDEA <code>Edit Configurations</code> ï¼Œç»™ <code>Include dependencies with Provided scope</code> æ‰“ä¸Šå‹¾å³å¯è§£å†³ï¼Œå¾ˆç®€å•å§ï¼ï¼</p><p><img src="https://ws2.sinaimg.cn/large/006tNbRwgy1fukk7004jvj30v10lwjtu.jpg" alt=""></p><p>ç»§ç»­RUNï¼Œåˆæ¥ä¸€ä¸ª EXceptinï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[2018-08-23T01:13:38,551][WARN ][o.e.b.ElasticsearchUncaughtExceptionHandler] [] uncaught exception in thread [main]</span><br><span class="line">org.elasticsearch.bootstrap.StartupException: java.security.AccessControlException: access denied (&quot;java.lang.RuntimePermission&quot; &quot;createClassLoader&quot;)</span><br><span class="line">    at org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:140) ~[main/:?]</span><br><span class="line">    at org.elasticsearch.bootstrap.Elasticsearch.execute(Elasticsearch.java:127) ~[main/:?]</span><br><span class="line">    at org.elasticsearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:86) ~[main/:?]</span><br><span class="line">    at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:124) ~[main/:?]</span><br><span class="line">    at org.elasticsearch.cli.Command.main(Command.java:90) ~[main/:?]</span><br><span class="line">    at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:93) ~[main/:?]</span><br><span class="line">    at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:86) ~[main/:?]</span><br><span class="line">Caused by: java.security.AccessControlException: access denied (&quot;java.lang.RuntimePermission&quot; &quot;createClassLoader&quot;)</span><br><span class="line">    at java.security.AccessControlContext.checkPermission(AccessControlContext.java:472) ~[?:?]</span><br><span class="line">    at java.security.AccessController.checkPermission(AccessController.java:895) ~[?:?]</span><br><span class="line">    at java.lang.SecurityManager.checkPermission(SecurityManager.java:335) ~[?:?]</span><br><span class="line">    at java.lang.SecurityManager.checkCreateClassLoader(SecurityManager.java:397) ~[?:?]</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">Exception: java.security.AccessControlException thrown from the UncaughtExceptionHandler in thread &quot;Thread-2&quot;</span><br></pre></td></tr></table></figure><p><strong>ç¬¬ä¸€ç§ï¼š</strong> åœ¨ <code>config</code> ç›®å½•ä¸‹æ–°å»º <code>java.policy</code> æ–‡ä»¶ï¼Œå¡«å…¥ä¸‹é¢å†…å®¹:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">grant &#123;</span><br><span class="line">    permission java.lang.RuntimePermission &quot;createClassLoader&quot;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨ <code>VM options</code> åŠ å…¥ <code>java.security.policy</code> çš„è®¾ç½®ï¼ŒæŒ‡å‘è¯¥æ–‡ä»¶å³å¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-Djava.security.policy=/usr/local/elasticsearch-6.3.2/config/java.policy</span><br></pre></td></tr></table></figure><p><strong>ç¬¬äºŒç§ï¼š</strong> å°±æ˜¯åœ¨ <code>%JAVA_HOME%/conf/security</code> ç›®å½•ä¸‹ï¼ˆJDK10æ˜¯è¿™ä¸ªè·¯å¾„ï¼Œä¹‹å‰çš„ç‰ˆæœ¬ä¸ç¡®å®šï¼‰ï¼Œæˆ‘çš„ç›®å½•æ˜¯ <code>/Library/Java/JavaVirtualMachines/jdk-10.0.2.jdk/Contents/Home/conf/security</code>ï¼Œæ‰“å¼€ <code>java.policy</code> æ–‡ä»¶ï¼Œåœ¨ <code>grant</code> ä¸­åŠ å…¥ä¸‹é¢è¿™å¥ï¼Œèµ‹äºˆæƒé™ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//for es 6.3.2</span><br><span class="line">permission java.lang.RuntimePermission &quot;createClassLoader&quot;;</span><br></pre></td></tr></table></figure><p><img src="https://ws1.sinaimg.cn/large/006tNbRwgy1fukkbubwxkj312a0qktdf.jpg" alt=""></p><p>å† RUNï¼Œè¿™æ¬¡å¯ç»ˆäºè¿è¡Œèµ·æ¥äº†ï¼ï¼ï¼</p><p>å†æ¬¡æ„Ÿè°¢ä¸‹è¯»è€…ï¼Œä»–çš„æ–‡ç« åœ°å€æ˜¯ï¼š<a href="">http://laijianfeng.org/2018/08/%E6%95%99%E4%BD%A0%E7%BC%96%E8%AF%91%E8%B0%83%E8%AF%95Elasticsearch-6-3-2%E6%BA%90%E7%A0%81/</a></p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æŠ˜è…¾çš„è·¯ä¸Šå°‘ä¸äº†å„ç§é”™è¯¯çƒ¦æ‰°ä½ ï¼Œå­¦ä¼šè§£å†³é—®é¢˜ï¼</p><h3 id="ç›¸å…³æ–‡ç« "><a href="#ç›¸å…³æ–‡ç« " class="headerlink" title="ç›¸å…³æ–‡ç« "></a>ç›¸å…³æ–‡ç« </h3><p>1ã€<a href="http://www.54tianzhisheng.cn/2018/08/04/why-see-es-code/" target="_blank" rel="noopener">æ¸£æ¸£èœé¸¡ä¸ºä»€ä¹ˆè¦çœ‹ ElasticSearch æºç ï¼Ÿ</a></p><p>2ã€<a href="http://www.54tianzhisheng.cn/2018/08/05/es-code01/" target="_blank" rel="noopener">æ¸£æ¸£èœé¸¡çš„ ElasticSearch æºç è§£æ â€”â€” ç¯å¢ƒæ­å»º</a></p><p>3ã€<a href="http://www.54tianzhisheng.cn/2018/08/11/es-code02/" target="_blank" rel="noopener">æ¸£æ¸£èœé¸¡çš„ ElasticSearch æºç è§£æ â€”â€” å¯åŠ¨æµç¨‹(ä¸Š)</a></p><p>4ã€<a href="http://www.54tianzhisheng.cn/2018/08/11/es-code03/" target="_blank" rel="noopener">æ¸£æ¸£èœé¸¡çš„ ElasticSearch æºç è§£æ â€”â€” å¯åŠ¨æµç¨‹(ä¸‹)</a></p><p>5ã€<a href="http://www.54tianzhisheng.cn/2017/09/08/Elasticsearch-analyzers/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆä¸€ï¼‰ï¼šElasticsearch é»˜è®¤åˆ†è¯å™¨å’Œä¸­åˆ†åˆ†è¯å™¨ä¹‹é—´çš„æ¯”è¾ƒåŠä½¿ç”¨æ–¹æ³•</a></p><p>6ã€<a href="http://www.54tianzhisheng.cn/2017/09/09/Elasticsearch-install/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆäºŒï¼‰ï¼šå…¨æ–‡æœç´¢å¼•æ“ Elasticsearch é›†ç¾¤æ­å»ºå…¥é—¨æ•™ç¨‹</a></p><p>7ã€<a href="http://www.54tianzhisheng.cn/2017/10/15/ElasticSearch-cluster-health-metrics/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆä¸‰ï¼‰ï¼šElasticSearch é›†ç¾¤ç›‘æ§</a></p><p>8ã€<a href="http://www.54tianzhisheng.cn/2017/10/18/ElasticSearch-nodes-metrics/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆå››ï¼‰ï¼šElasticSearch å•ä¸ªèŠ‚ç‚¹ç›‘æ§</a></p><p>9ã€<a href="http://www.54tianzhisheng.cn/2017/12/25/ELK/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆäº”ï¼‰ï¼šELK å®æ—¶æ—¥å¿—åˆ†æå¹³å°ç¯å¢ƒæ­å»º</a></p><p>10ã€<a href="http://www.54tianzhisheng.cn/2018/08/14/idea-remote-debug-elasticsearch/" target="_blank" rel="noopener">æ•™ä½ å¦‚ä½•åœ¨ IDEA è¿œç¨‹ Debug ElasticSearch</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://ws4.sinaimg.cn/large/006tNc79ly1fty28q9ljkj31hc0zbqf5.jpg&quot; alt=&quot;girl-3551832_1920&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="ElasticSearch" scheme="http://yoursite.com/tags/ElasticSearch/"/>
    
  </entry>
  
  <entry>
    <title>æ¸£æ¸£èœé¸¡ä¸ºä»€ä¹ˆè¦çœ‹ ElasticSearch æºç ï¼Ÿ</title>
    <link href="http://yoursite.com/2018/08/04/why-see-es-code/"/>
    <id>http://yoursite.com/2018/08/04/why-see-es-code/</id>
    <published>2018-08-03T16:00:00.000Z</published>
    <updated>2018-08-04T14:35:12.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://ws3.sinaimg.cn/large/006tNc79ly1fty1lwmoa0j31hc0vjjyz.jpg" alt="004"></p><a id="more"></a><h3 id="å‰æ"><a href="#å‰æ" class="headerlink" title="å‰æ"></a>å‰æ</h3><p>äººå·¥æ™ºèƒ½ã€å¤§æ•°æ®å¿«é€Ÿå‘å±•çš„ä»Šå¤©ï¼Œå¯¹äº TB ç”šè‡³ PB çº§å¤§æ•°æ®çš„å¿«é€Ÿæ£€ç´¢å·²ç„¶æˆä¸ºåˆšéœ€ï¼Œå¤§å‹ä¼ä¸šæ—©å·²æ·¹æ²¡åœ¨ç³»ç»Ÿç”Ÿæˆçš„æµ©ç€šæ•°æ®æµå½“ä¸­ã€‚å¤§æ•°æ®æŠ€æœ¯ä¸šå·²é›†ä¸­åœ¨å¦‚ä½•å­˜å‚¨å’Œå¤„ç†è¿™äº›æµ·é‡çš„æ•°æ®ä¸Šã€‚Elasticsearch ä½œä¸ºå¼€æºé¢†åŸŸçš„åèµ·ä¹‹ç§€ï¼Œä»2010å¹´è‡³ä»Šå¾—åˆ°é£è·ƒå¼çš„å‘å±•ã€‚ Elasticsearch ä»¥å…¶å¼€æºã€åˆ†å¸ƒå¼ã€RESTFul API ä¸‰å¤§ä¼˜åŠ¿ï¼Œå·²ç»æˆä¸ºå½“ä¸‹é£å£ä¸­â€œä¼šé£çš„çŒªâ€ã€‚</p><p>åœ¨æˆ‘çš„ç”µè„‘æœ¬åœ°å†™äº†å‡ ç¯‡ ElasticSearch çš„æºç è§£æäº†ï¼Œå›è¿‡å¤´æ¥æƒ³æƒ³åº”è¯¥ä¹Ÿå†™ä¸€ç¯‡ä¸ºä½•æˆ‘ä¼šå»çœ‹å®ƒçš„æºç ï¼Ÿ</p><p>ä¸ºä»€ä¹ˆå‘¢ï¼Ÿä¸‹é¢æˆ‘è®²è®²è‡ªå·±ä»æ¥è§¦æœç´¢åˆ°ç°åœ¨çœ‹æºç çš„è¿‡ç¨‹ï¼</p><h3 id="å…³æ³¨æˆ‘"><a href="#å…³æ³¨æˆ‘" class="headerlink" title="å…³æ³¨æˆ‘"></a>å…³æ³¨æˆ‘</h3><p><img src="http://ohfk1r827.bkt.clouddn.com/blog/180103/C6LG3mGa12.jpg" alt="zhisheng"></p><p>è½¬è½½è¯·åŠ¡å¿…æ³¨æ˜åŸåˆ›åœ°å€ä¸ºï¼š<a href="http://www.54tianzhisheng.cn/2018/08/04/why-see-es-code/" target="_blank" rel="noopener">http://www.54tianzhisheng.cn/2018/08/24/why-see-es-code/</a></p><h3 id="ç¬¬ä¸€æ¬¡æ¥è§¦æœç´¢"><a href="#ç¬¬ä¸€æ¬¡æ¥è§¦æœç´¢" class="headerlink" title="ç¬¬ä¸€æ¬¡æ¥è§¦æœç´¢"></a>ç¬¬ä¸€æ¬¡æ¥è§¦æœç´¢</h3><p>æœç´¢ï¼Œæˆ‘ä»¬é¦–å…ˆæƒ³åˆ°çš„æ˜¯æœç´¢å¼•æ“ï¼šGoogleã€ç™¾åº¦ï¼Œè¿™ä¸ªå°±ç®—æ˜¯æ¥è§¦çš„æœ€æ—©çš„äº†ã€‚</p><p>æˆ‘è‡ªå·±é¡¹ç›®é‡Œé¢æ¥è§¦æœç´¢æ˜¯å¤§äºŒæš‘å‡é‚£æ—¶ç»ƒä¹ çš„ä¸€ä¸ªé¡¹ç›®ï¼Œé‡Œé¢ç”¨äº† Solrï¼Œç„¶åå½“æ—¶è‡ªå·±ä¹Ÿç¨å¾®äº†è§£äº†ä¸‹ï¼Œå¹¶ç”¨åœ¨äº†é¡¹ç›®é‡Œé¢ã€‚</p><h3 id="ç¬¬äºŒæ¬¡æ¥è§¦æœç´¢"><a href="#ç¬¬äºŒæ¬¡æ¥è§¦æœç´¢" class="headerlink" title="ç¬¬äºŒæ¬¡æ¥è§¦æœç´¢"></a>ç¬¬äºŒæ¬¡æ¥è§¦æœç´¢</h3><p>ä»ç¬¬ä¸€æ¬¡é¡¹ç›®é‡Œé¢ç”¨åˆ°äº†æœç´¢ï¼Œåé¢è‡ªå·±å¯¹è¿™æ–¹é¢å°±æ¯”è¾ƒæ„Ÿå…´è¶£ã€‚å†ä¸€æ¬¡æ¥è§¦æœç´¢æ˜¯å®ä¹ çš„æ—¶å€™è¿›å…¬å¸ã€‚ç¬¬ä¸€ä»¶äº‹æƒ…å°±æ˜¯è¢«è€å¤§å«çš„å»å­¦ä¹ æ­å»º Elasticsearch é›†ç¾¤ï¼Œäºæ˜¯ä¹ï¼Œç”µè„‘å°±è£…äº†ä¸‰ä¸ªè™šæ‹Ÿæœºï¼ŒElasticsearch å°±ä¸€ä¸ªä¸ªçš„è£…äº†èµ·æ¥äº†ã€‚ä¹Ÿè®°å½•äº†åšå®¢ä¸‹æ¥ï¼š<a href="http://www.54tianzhisheng.cn/2017/09/09/Elasticsearch-install/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆäºŒï¼‰ï¼šå…¨æ–‡æœç´¢å¼•æ“ Elasticsearch é›†ç¾¤æ­å»ºå…¥é—¨æ•™ç¨‹</a>ï¼Œå½“æ—¶æ­å»ºçš„æ—¶å€™ ES çš„ç‰ˆæœ¬æ‰åˆšä» 2.x å‡çº§åˆ° 5.x å‘¢ï¼Œæˆªæ­¢æœ¬æ–‡æ—¶é—´ 2018.08.04ï¼Œç°åœ¨ ES ç‰ˆæœ¬å·²ç»æ˜¯åˆ° 7.0 äº†ï¼Œè¿™ç‰ˆæœ¬å‡çº§æ˜¯çœŸçš„çš„å¿«ï¼Œè¿™ä¹Ÿè¯´æ˜äº† ES çš„æ´»è·ƒåº¦å¾ˆé«˜ï¼ŒèƒŒåçš„å¼€å‘å·¥ç¨‹å¸ˆç»´æŠ¤ä¹Ÿå¿«ï¼Œä¾§é¢çªå‡ºè¦å»çœ‹å®ƒæºç çš„é‡è¦æ€§ã€‚</p><p>å½“æ—¶è‡ªå·±åœ¨æœ¬åœ°æµ‹è¯•æ­å»ºé›†ç¾¤åï¼Œç»™åˆ†é…äº†å¦å¤–ä¸€ä¸ªä»»åŠ¡å°±æ˜¯å»äº†è§£ ES ä¸­çš„è‡ªå¸¦åˆ†è¯ã€è‹±æ–‡åˆ†è¯ã€ä¸­æ–‡åˆ†è¯çš„ç›¸åŒä¸å·®å¼‚ã€ä»¥åŠè‡ªå·±å»ºç«‹åˆ†è¯éœ€è¦æ³¨æ„çš„ç‚¹ã€‚äºæ˜¯ä¹ï¼šå½“æ—¶åœ¨å…¬å¸ wiki è´¡çŒ®äº†è¿™ç¯‡æ–‡ç« ï¼š<a href="http://www.54tianzhisheng.cn/2017/09/08/Elasticsearch-analyzers/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆä¸€ï¼‰ï¼šElasticsearch é»˜è®¤åˆ†è¯å™¨å’Œä¸­åˆ†åˆ†è¯å™¨ä¹‹é—´çš„æ¯”è¾ƒåŠä½¿ç”¨æ–¹æ³•</a>ã€‚è¿™ç¯‡æ–‡ç« å‡ ä¹å·²ç»æŠŠå¸‚é¢ä¸Šæ‰€æœ‰çš„åˆ†è¯éƒ½å†™è¿›å»äº†ï¼ŒåŒ…æ‹¬ä»–ä»¬çš„ç›¸åŒç‚¹ã€ä¸åŒç‚¹ã€å¦‚ä½•ä½¿ç”¨ã€å¦‚ä½•è‡ªå®šä¹‰åˆ†è¯å™¨ã€‚</p><p>ç„¶åè¿˜æœ‰å°±æ˜¯æˆ‘åŒç»„çš„ä¸€ä¸ªåŒå­¦ï¼Œå¥¹çš„ä»»åŠ¡å°±æ˜¯ 2.x å‡çº§åˆ° 5.x ä¸­ mapping çš„å¤§æ”¹å˜æœ‰å“ªäº›ï¼Ÿåé¢æˆ‘ä¹Ÿçœ‹äº†å¥¹æ€»ç»“çš„æ–‡æ¡£ï¼Œå¾ˆè¯¦ç»†ï¼</p><p>åœ¨è¿™æ¬¡æ¥è§¦äº† ES åï¼Œå› ä¸ºæˆ‘è‡ªå·±æœ¬åœ°å·²ç»æœ‰ç¯å¢ƒäº†ï¼Œæ‰€ä»¥è‡ªå·±æµ‹è¯•äº†ä¸€äº›åŠŸèƒ½ï¼Œç»™ ES å®‰è£…æ’ä»¶ï¼ˆIKã€x-packã€æ”¯æŒ sql çš„ã€ï¼‰ï¼Œåé¢è‡ªå·±ä¹Ÿå»æµ‹è¯• ES çš„ç´¢å¼•ã€æ–‡æ¡£ã€REST APIã€‚</p><h3 id="ç¬¬ä¸‰æ¬¡æ¥è§¦æœç´¢"><a href="#ç¬¬ä¸‰æ¬¡æ¥è§¦æœç´¢" class="headerlink" title="ç¬¬ä¸‰æ¬¡æ¥è§¦æœç´¢"></a>ç¬¬ä¸‰æ¬¡æ¥è§¦æœç´¢</h3><p>ç”±äºæ˜¯è‡ªå·±å¯¹å…¶æ„Ÿå…´è¶£ï¼Œæ‰€ä»¥åé¢å°±å»æ‰¾äº†äº›ç›¸å…³çš„è§†é¢‘ï¼Œæ¯”å¦‚ï¼šä¸­åçŸ³è¡«çš„ã€ŠElasticsearch é¡¶å°–é«˜æ‰‹ç³»åˆ—-é«˜æ‰‹è¿›é˜¶ç¯‡ã€‹å‡ ä¸ªç³»åˆ—è§†é¢‘æ•™ç¨‹ä¸ªäººæ„Ÿè§‰è¿˜æ˜¯ä¸é”™çš„ï¼Œçœ‹å®Œè¿™å‡ ä¸ªç³»åˆ—ä¼°è®¡å…¥é—¨è‚¯å®šæ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚ç‰ˆæƒåŸå› ï¼Œä¸æä¾›ä¸‹è½½é“¾æ¥ã€‚</p><p>å¦å¤–å°±æ˜¯ã€ŠElasticsearch æƒå¨æŒ‡å—ã€‹ç¿»è¯‘çš„ç‰ˆæœ¬ï¼Œç¿»è¯‘è¿˜æ²¡æœ‰å…¨ï¼Œå¯ä»¥å»çœ‹çœ‹ï¼Œè®²å¾—å¾ˆè¯¦ç»†çš„ï¼Œå¸‚é¢ä¸Šåº”è¯¥è¿˜æ²¡æœ‰å“ªæœ¬ä¹¦è®²çš„æœ‰è¿™ä¹ˆæ¸…æ¥šï¼Œå¦‚æœè‹±æ–‡ä¸é”™çš„å¯ä»¥ç›´æ¥å•ƒè‹±æ–‡å§ã€‚</p><p>è¿˜æœ‰å°±æ˜¯å®˜ç½‘çš„æ–‡æ¡£äº†ï¼Œéå¸¸éå¸¸è¯¦ç»†ï¼Œè¿˜æœ‰ demoï¼Œ2.x ç‰ˆæœ¬çš„æ˜¯æœ‰ä¸­æ–‡çš„å®˜æ–¹æ–‡æ¡£ï¼Œå¯ä»¥å‡‘åˆç€çœ‹ã€‚</p><p>å­¦ä¹ æ–°ä¸œè¥¿ï¼Œè¦å­¦ä¼šå…ˆçœ‹å®˜æ–¹æ–‡æ¡£ï¼Œä½•å†µ Elasticsearch çš„å®˜æ–¹æ–‡æ¡£è¿™ä¹ˆè¯¦ç»†å‘¢ï¼</p><h3 id="ç¬¬å››æ¬¡æ¥è§¦æœç´¢"><a href="#ç¬¬å››æ¬¡æ¥è§¦æœç´¢" class="headerlink" title="ç¬¬å››æ¬¡æ¥è§¦æœç´¢"></a>ç¬¬å››æ¬¡æ¥è§¦æœç´¢</h3><p>åé¢å®ä¹ çš„æ—¶å€™ï¼Œåˆåˆ†é…äº†å…¬å¸ä¸­é—´ä»¶ç›‘æ§çš„ä¸¤ä¸ªæ¨¡å—ï¼šElasticsearch å’Œ HBase ç»„ä»¶çš„ç›‘æ§ã€‚äºæ˜¯ä¹ï¼Œå†æ¬¡æœ‰æœºä¼šæ¥è§¦ Elasticsearch äº†ï¼Œè¿™æ¬¡ä¸»è¦è¿˜æ˜¯åˆ©ç”¨ Elasticsearch è‡ªå¸¦çš„ REST API ï¼š<code>_cluster/health</code> ã€<code>_cluster/stats</code>ã€<code>_nodes</code>ã€<code>_nodes/stats</code> å»è·å–åˆ°é›†ç¾¤çš„å¥åº·ä¿¡æ¯ã€èŠ‚ç‚¹ä¿¡æ¯ï¼ˆå†…å­˜ã€CPUã€ç½‘ç»œã€JVMç­‰ä¿¡æ¯ï¼‰ã€‚ä¸ºäº†åšè¿™ä¸ªé¡¹ç›®è‡ªå·±å½“æ—¶ä¹Ÿå»æ‰¾äº†ç½‘ä¸Šå¾ˆå¤šç±»ä¼¼çš„æ–‡ç« å‚è€ƒå¸¸ç”¨çš„ç›‘æ§æŒ‡æ ‡å’Œä»–ä»¬æ˜¯æ€ä¹ˆåšç›‘æ§çš„ã€‚æˆ‘å½“æ—¶çš„ä»»åŠ¡ä¸»è¦è¿˜æ˜¯é‡‡é›†ä¿¡æ¯ï¼Œç„¶åå­˜åˆ°å…¬å¸å¤§é¡¹ç›®çš„ influxdb ä¸­ï¼Œæœ€åç”¨ grafana å±•ç¤ºå‡ºæ¥ï¼Œåé¢æˆ‘ç»„çš„è¿ç»´å¤§ä½¬ç»™æˆ‘çœ‹äº†ç›‘æ§å¤§ç›˜ï¼Œç•Œé¢æŒºé…·ç‚«çš„ï¼Œå“ˆå“ˆå“ˆï¼Œç‰›é€¼ï¼</p><p>å½“æ—¶å†™çš„ä¸¤ç¯‡åšå®¢ï¼š</p><p>1ã€<a href="http://www.54tianzhisheng.cn/2017/10/15/ElasticSearch-cluster-health-metrics/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆä¸‰ï¼‰ï¼šElasticSearch é›†ç¾¤ç›‘æ§</a></p><p>2ã€<a href="http://www.54tianzhisheng.cn/2017/10/18/ElasticSearch-nodes-metrics/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆå››ï¼‰ï¼šElasticSearch å•ä¸ªèŠ‚ç‚¹ç›‘æ§</a></p><p>å–ä¹‹ç½‘ç»œï¼Œè¿˜ä¹‹ç½‘ç»œï¼Œå¸Œæœ›ç»™åé¢åšç±»ä¼¼ä»»åŠ¡çš„å°ä¼™ä¼´ç»™ç‚¹å‚è€ƒæ„è§ï¼</p><p>å†å°±æ˜¯è‡ªå·±æ­å»º ELKï¼ˆElasticSearch, Logstash, Kibanaï¼‰æ—¥å¿—åˆ†æå¹³å°ï¼Œç„¶åç©äº†ä¸‹ï¼</p><p>æ­å»ºç¯å¢ƒåšå®¢ï¼š<a href="http://www.54tianzhisheng.cn/2017/12/25/ELK/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆäº”ï¼‰ï¼šELK å®æ—¶æ—¥å¿—åˆ†æå¹³å°ç¯å¢ƒæ­å»º</a></p><h3 id="ç¬¬äº”æ¬¡æ¥è§¦æœç´¢"><a href="#ç¬¬äº”æ¬¡æ¥è§¦æœç´¢" class="headerlink" title="ç¬¬äº”æ¬¡æ¥è§¦æœç´¢"></a>ç¬¬äº”æ¬¡æ¥è§¦æœç´¢</h3><p>åé¢å°±æ²¡æ€ä¹ˆæ¥è§¦ ElasticSearch äº†ï¼Œä¸€ç›´å¿™ç€å…¶ä»–çš„ä¸œè¥¿ã€‚</p><p>å®ä¹ è¾èŒåï¼Œæ¯•ä¸šå‡ºæ¥æ‰¾å·¥ä½œçš„é‚£æ®µæ—¥å­ï¼Œè‡ªå·±åˆèŠ±äº†ä¸€æ˜ŸæœŸç¨å¾®è¿‡äº†ä¸€é ã€ŠElasticsearch æƒå¨æŒ‡å—ã€‹ è¿™æœ¬ä¹¦ï¼Œè¯è¯´è¿˜å¸®æˆ‘é¢è¯•æŒºè¿‡ä¸å°‘å…³å‘¢ï¼Œå“ˆå“ˆå“ˆï¼å› ä¸ºæˆ‘é¡¹ç›®é‡Œå†™äº† Elasticsearch çš„ç›‘æ§ï¼Œå¦‚æœä½ å¯¹ Elasticsearch å…¶ä»–çš„ä¸ç†Ÿæ‚‰ï¼Œé¢è¯•å®˜ç¨å¾®é—®äº›å…¶ä»–å…³äºè¿™æ–¹é¢çš„ï¼Œé‚£å°±ä¸çŸ¥é“å°±æœ‰ç‚¹å°´å°¬ğŸ˜…äº†ï¼Œæ‰€ä»¥è¿˜æ˜¯å‡†å¤‡äº†ä¸‹ã€‚çœ‹å®Œä¹‹ååº”ä»˜é¢è¯•æ²¡å¤šå¤§çš„é—®é¢˜ã€‚</p><h3 id="ç¬¬å…­æ¬¡æ¥è§¦"><a href="#ç¬¬å…­æ¬¡æ¥è§¦" class="headerlink" title="ç¬¬å…­æ¬¡æ¥è§¦"></a>ç¬¬å…­æ¬¡æ¥è§¦</h3><p>çœ‹èµ·æ¥æˆ‘æ¥è§¦äº† Elasticsearch å¾ˆä¹…äº†ï¼Œå…¶å®çœŸæ­£é¡¹ç›®é‡Œé¢æ˜¯æ²¡æœ‰ç”¨åˆ° Elasticsearch åšè¿‡é¡¹ç›®çš„ï¼Œæ²¡æœ‰ç”¨åˆ° Elasticsearch çš„æœç´¢åšä»€ä¹ˆé¡¹ç›®ï¼Œäºæ˜¯è‡ªå·±å½“æ—¶æ‰¾å·¥ä½œå…¶å®ä¹Ÿæ‰“ç®—æ‰¾åˆ°å·¥ä½œåçœ‹èƒ½ä¸èƒ½è‡ªå·±åšä¸ªé¡¹ç›®æˆ–è€…å…¬å¸é¡¹ç›®é‡Œé¢ç”¨ç”¨ Elasticsearch å‘¢ï¼Ÿ</p><p>ç»“æœåœ¨æ–°å…¬å¸æ–°é¡¹ç›®é‡Œï¼Œå¾ˆå¿«å°±ç”¨åˆ°äº†ã€‚åªä¸è¿‡è¿™æ¬¡ä¸æ˜¯ Java é¡¹ç›®é‡Œé¢ç”¨äº†ï¼Œè€Œæ˜¯å’Œ GoLang æ•´åˆã€‚ä¸è¿‡ API éƒ½å·®ä¸å¤šï¼Œå¤šç†Ÿæ‚‰å‡ æ¬¡å°±å¾ˆå¿«ä¸Šæ‰‹äº†ï¼Œå…³é”®è¿˜æ˜¯è¦æ‡‚ Elasticsearch å¦‚ä½•æ„é€  DSL æŸ¥è¯¢è¯­å¥ï¼Œè¿™æ ·å†è½¬æ¢æˆ GO é‡Œé¢çš„ API å°±å¿«äº†ã€‚</p><p>è¿˜æœ‰å°±æ˜¯å…¬å¸é‡Œåˆšå¥½æœ‰ä¸ªä¸­ç§‘é™¢ç ”ç©¶ç”Ÿå¤§ä½¬ï¼Œä»–å°±å†™è¿‡ Elasticsearch è¿™å—çš„ä¹¦ç±ã€Šä» lucene åˆ° Elasticsearch å…¨æ–‡æ£€ç´¢å®æˆ˜ã€‹ï¼Œå¦å¤–ä»–çš„ CSDN åšå®¢ä¹Ÿå¾ˆç«ï¼Œé˜…è¯»é‡å¾ˆé«˜ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥ä¹°æœ¬ä¹¦æ”¯æŒä¸‹ã€‚</p><p>ä¸­é€”è‡ªå·±é‡åˆ° Elasticsearch å®åœ¨ä¸ä¼šçš„é—®é¢˜ä¹Ÿä¼šä¸»åŠ¨å»æ‰¾å¤§ä½¬å’¨è¯¢ï¼Œç„¶åå¤§ä½¬è€å¿ƒæ•™æ•™æˆ‘è¿™ä¸ªæ¸£æ¸£èœé¸¡ï¼Œåœ¨æ–‡ç« è¿™é‡Œæ„Ÿè°¢ä¸‹å¤§ä½¬è¿™æ®µæ—¶é—´çš„å…³ç…§ã€‚</p><h3 id="èŒç”Ÿé˜…è¯»æºç çš„æƒ³æ³•"><a href="#èŒç”Ÿé˜…è¯»æºç çš„æƒ³æ³•" class="headerlink" title="èŒç”Ÿé˜…è¯»æºç çš„æƒ³æ³•"></a>èŒç”Ÿé˜…è¯»æºç çš„æƒ³æ³•</h3><p>æ—¢ç„¶æ¥è§¦äº†è¿™ä¹ˆä¹…çš„ Elasticsearch ï¼Œé¡¹ç›®é‡Œç”¨è¿‡ï¼Œä¹¦ç±ä¹Ÿçœ‹è¿‡ï¼Œè™½ç„¶è¿˜ä¸æ˜¯å¾ˆç†Ÿï¼Œä½†æ˜¯å¦‚æœçœ‹çœ‹å®ƒçš„æºç æ˜¯ä¸æ˜¯ä¼šè®©æˆ‘å¯¹å®ƒçš„å°è±¡æ›´æ·±å‘¢ï¼Ÿ</p><p>è¯´å¹²å°±å¹²ï¼Œæ™šä¸Šå›å®¶å°±ä» GitHub clone äº†æºç åœ¨æœ¬åœ°ï¼Œé‚£æ—¶åˆšå¥½å›å®¶ï¼Œå°±åœ¨ç«è½¦ä¸Šç›´æ¥ç”¨ VS code çœ‹äº†ä¼šæºç ï¼Œä¹Ÿæ²¡æœ‰åœ¨ ide é‡Œ debug èµ·æ¥ã€‚</p><p>å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™å·²ç»æŠŠ Elasticsearch çš„æ•´ä¸ªå¯åŠ¨æµç¨‹ï¼ˆåŠ è½½è¯»å–é…ç½®ã€åŠ è½½æ’ä»¶ç­‰ï¼‰ã€å¦‚ä½•æ”¯æŒ REST API çœ‹äº†ä¸‹ï¼Œåé¢ä¼šåœ¨ä¸‹ç­åå›å®¶ç»§ç»­é˜…è¯»æºç ï¼Œç»§ç»­åˆ†äº«æˆ‘çš„æºç è§£æçš„ã€‚</p><p>æœ‰æƒ³æ³•å°±å»å¹²ï¼Œä¸å°è¯•ä¸‹ï¼Œæ€ä¹ˆçŸ¥é“é€‚ä¸é€‚åˆä½ ï¼Ÿ</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>å…¶å®é˜…è¯»æºç çš„ä¸»è¦åŸå› è¿˜æ˜¯è‡ªå·±æ„Ÿå…´è¶£ï¼›å¦å¤–å°±æ˜¯è¿™ä¸œè¥¿ç°åœ¨é¡¹ç›®é‡Œç¡®å®ä¹Ÿç”¨åˆ°äº†ï¼Œå¦‚æœæˆ‘å¯¹æºç ç†Ÿæ‚‰çš„è¯å¯èƒ½ä¼šå¯¹æˆ‘çš„ç†è§£ä¼šæ›´åŠ é€å½»ç‚¹ï¼›è¿˜æœ‰å°±æ˜¯ Elasticsearch ç¡®å®ç«ï¼Œå…¬å¸å‡ ä¹éƒ½ç”¨çš„ï¼Œæ‰€ä»¥å­¦ä¹ ä¸‹è¿˜æ˜¯æœ‰å¿…è¦çš„ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://ws3.sinaimg.cn/large/006tNc79ly1fty1lwmoa0j31hc0vjjyz.jpg&quot; alt=&quot;004&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="ElasticSearch" scheme="http://yoursite.com/tags/ElasticSearch/"/>
    
  </entry>
  
  <entry>
    <title>æ¸£æ¸£èœé¸¡çš„èš‚èšé‡‘æœé¢è¯•ç»å†(äºŒ)</title>
    <link href="http://yoursite.com/2018/07/31/alipay02/"/>
    <id>http://yoursite.com/2018/07/31/alipay02/</id>
    <published>2018-07-30T16:00:00.000Z</published>
    <updated>2018-07-31T15:17:07.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://ws2.sinaimg.cn/large/801b780aly1fttgbvge25j21f60vyack.jpg" alt="2018-07-31_23-16-07"></p><a id="more"></a><h2 id="èš‚èšé‡‘æœ"><a href="#èš‚èšé‡‘æœ" class="headerlink" title="èš‚èšé‡‘æœ"></a>èš‚èšé‡‘æœ</h2><h3 id="ç”µè¯äºŒé¢ï¼ˆ85-åˆ†é’Ÿï¼‰"><a href="#ç”µè¯äºŒé¢ï¼ˆ85-åˆ†é’Ÿï¼‰" class="headerlink" title="ç”µè¯äºŒé¢ï¼ˆ85 åˆ†é’Ÿï¼‰"></a>ç”µè¯äºŒé¢ï¼ˆ85 åˆ†é’Ÿï¼‰</h3><p>1ã€è‡ªæˆ‘ä»‹ç»ã€å·¥ä½œç»å†ã€æŠ€æœ¯æ ˆ</p><p>2ã€é¡¹ç›®ä¸­ä½ å­¦åˆ°äº†ä»€ä¹ˆæŠ€æœ¯ï¼Ÿï¼ˆæŠŠä¸‰é¡¹ç›®å…·ä½“æè¿°äº†å¾ˆä¹…ï¼‰</p><p>3ã€å¾®æœåŠ¡åˆ’åˆ†çš„ç²’åº¦</p><p>4ã€å¾®æœåŠ¡çš„é«˜å¯ç”¨æ€ä¹ˆä¿è¯çš„ï¼Ÿ</p><p>5ã€å¸¸ç”¨çš„è´Ÿè½½å‡è¡¡ï¼Œè¯¥æ€ä¹ˆç”¨ï¼Œä½ èƒ½è¯´ä¸‹å—ï¼Ÿ</p><p>6ã€ç½‘å…³èƒ½å¤Ÿä¸ºåç«¯æœåŠ¡å¸¦æ¥å“ªäº›å¥½å¤„ï¼Ÿ</p><p>7ã€Spring Bean çš„ç”Ÿå‘½å‘¨æœŸ</p><p>8ã€xml ä¸­é…ç½®çš„ initã€destroy æ–¹æ³•æ€ä¹ˆå¯ä»¥åšåˆ°è°ƒç”¨å…·ä½“çš„æ–¹æ³•ï¼Ÿ</p><p>9ã€åå°„çš„æœºåˆ¶</p><p>10ã€Object ç±»ä¸­çš„æ–¹æ³•</p><p>11ã€hashcode å’Œ equals æ–¹æ³•å¸¸ç”¨åœ°æ–¹</p><p>12ã€å¯¹è±¡æ¯”è¾ƒæ˜¯å¦ç›¸åŒ</p><p>13ã€hashmap put æ–¹æ³•å­˜æ”¾çš„æ—¶å€™æ€ä¹ˆåˆ¤æ–­æ˜¯å¦æ˜¯é‡å¤çš„</p><p>14ã€Object toString æ–¹æ³•å¸¸ç”¨çš„åœ°æ–¹ï¼Œä¸ºä»€ä¹ˆè¦é‡å†™è¯¥æ–¹æ³•</p><p>15ã€Set å’Œ List åŒºåˆ«ï¼Ÿ</p><p>16ã€ArrayList å’Œ LinkedList åŒºåˆ«</p><p>17ã€å¦‚æœå­˜å–ç›¸åŒçš„æ•°æ®ï¼ŒArrayList å’Œ LinkedList è°å ç”¨ç©ºé—´æ›´å¤§ï¼Ÿ</p><p>18ã€Set å­˜çš„é¡ºåºæ˜¯æœ‰åºçš„å—ï¼Ÿ</p><p>19ã€å¸¸è§ Set çš„å®ç°æœ‰å“ªäº›ï¼Ÿ</p><p>20ã€TreeSet å¯¹å­˜å…¥å¯¹æ•°æ®æœ‰ä»€ä¹ˆè¦æ±‚å‘¢ï¼Ÿ</p><p>21ã€HashSet çš„åº•å±‚å®ç°å‘¢</p><p>22ã€TreeSet åº•å±‚æºç æœ‰çœ‹è¿‡å—ï¼Ÿ</p><p>23ã€HashSet æ˜¯ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿä¸ºä»€ä¹ˆä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ</p><p>24ã€Java ä¸­æœ‰å“ªäº›çº¿ç¨‹å®‰å…¨çš„ Mapï¼Ÿ</p><p>25ã€Concurrenthashmap æ˜¯æ€ä¹ˆåšåˆ°çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ</p><p>26ã€HashTable ä½ äº†è§£è¿‡å—ï¼Ÿ</p><p>27ã€å¦‚ä½•ä¿è¯çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Ÿ</p><p>28ã€synchronizedã€lock</p><p>29ã€volatile çš„åŸå­æ€§é—®é¢˜ï¼Ÿä¸ºä»€ä¹ˆ i++ è¿™ç§ä¸æ”¯æŒåŸå­æ€§ï¼Ÿä»è®¡ç®—æœºåŸç†çš„è®¾è®¡æ¥è®²ä¸‹ä¸èƒ½ä¿è¯åŸå­æ€§çš„åŸå› </p><p>30ã€happens before åŸç†</p><p>31ã€cas æ“ä½œ</p><p>32ã€lock å’Œ synchronized çš„åŒºåˆ«ï¼Ÿ</p><p>33ã€å…¬å¹³é”å’Œéå…¬å¹³é”</p><p>34ã€Java è¯»å†™é”</p><p>35ã€è¯»å†™é”è®¾è®¡ä¸»è¦è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ</p><p>36ã€ä½ é¡¹ç›®é™¤äº†å†™ Java ä»£ç ï¼Œè¿˜æœ‰å‰ç«¯ä»£ç ï¼Œé‚£ä½ çŸ¥é“å‰ç«¯æœ‰å“ªäº›æ¡†æ¶å—ï¼Ÿ</p><p>37ã€MySQL åˆ†é¡µæŸ¥è¯¢è¯­å¥</p><p>38ã€MySQL äº‹åŠ¡ç‰¹æ€§å’Œéš”ç¦»çº§åˆ«</p><p>39ã€ä¸å¯é‡å¤è¯»ä¼šå‡ºç°åœ¨ä»€ä¹ˆåœºæ™¯ï¼Ÿ</p><p>40ã€sql  having çš„ä½¿ç”¨åœºæ™¯</p><p>41ã€å‰ç«¯æµè§ˆå™¨åœ°å€çš„ä¸€ä¸ª http è¯·æ±‚åˆ°åç«¯æ•´ä¸ªæµç¨‹æ˜¯æ€ä¹ˆæ ·ï¼Ÿèƒ½å¤Ÿè¯´ä¸‹å—ï¼Ÿ</p><p>42ã€http é»˜è®¤ç«¯å£ï¼Œhttps é»˜è®¤ç«¯å£</p><p>43ã€DNS ä½ çŸ¥é“æ˜¯å¹²å˜›çš„å—ï¼Ÿ</p><p>44ã€ä½ ä»¬å¼€å‘ç”¨çš„ ide æ˜¯å•¥ï¼Ÿä½ èƒ½è¯´ä¸‹ idea çš„å¸¸ç”¨å‡ ä¸ªå¿«æ·é”®å§ï¼Ÿ</p><p>45ã€ä»£ç ç‰ˆæœ¬ç®¡ç†ä½ ä»¬ç”¨çš„æ˜¯å•¥ï¼Ÿ</p><p>46ã€git rebase å’Œ merge æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><p>47ã€ä½ ä»¬å…¬å¸åŠ ç­å¤šå—ï¼Ÿ</p><p>48ã€åé¢ä¸€èµ·èŠ high äº†ï¼Œä¹‹é—´æ‰¯äº†äº›è›‹ï¼Œå“ˆå“ˆå“ˆ</p><h3 id="ç›¸å…³æ–‡ç« ï¼š"><a href="#ç›¸å…³æ–‡ç« ï¼š" class="headerlink" title="ç›¸å…³æ–‡ç« ï¼š"></a>ç›¸å…³æ–‡ç« ï¼š</h3><p><a href="http://www.54tianzhisheng.cn/2017/08/04/yaxin/" target="_blank" rel="noopener">1ã€ç§‹æ‹›ç¬¬ä¸€ç«™ â€”â€” äºšä¿¡ç§‘æŠ€</a></p><p><a href="http://www.54tianzhisheng.cn/2017/08/04/iqiyi/" target="_blank" rel="noopener">2ã€ç§‹æ‹›ç¬¬äºŒç«™ â€”â€” å†…æ¨çˆ±å¥‡è‰º</a></p><p><a href="http://www.54tianzhisheng.cn/2017/08/04/alibaba/" target="_blank" rel="noopener">3ã€ç§‹æ‹›ç¬¬ä¸‰ç«™ â€”â€” å†…æ¨é˜¿é‡Œï¼ˆä¸€é¢ï¼‰</a></p><p><a href="http://www.54tianzhisheng.cn/2017/08/28/recommend-books/" target="_blank" rel="noopener">4ã€é‚£äº›å¹´æˆ‘çœ‹è¿‡çš„ä¹¦ â€”â€” è‡´æ•¬æˆ‘çš„å¤§å­¦ç”Ÿæ´» â€”â€” Say Good Bye ï¼</a></p><p><a href="http://www.54tianzhisheng.cn/2017/09/17/Interview-summary/" target="_blank" rel="noopener">5ã€é¢è¯•è¿‡é˜¿é‡Œç­‰äº’è”ç½‘å¤§å…¬å¸ï¼Œæˆ‘çŸ¥é“äº†è¿™äº›å¥—è·¯</a></p><p><a href="http://www.54tianzhisheng.cn/2018/07/12/youzan/" target="_blank" rel="noopener">6ã€æ¸£æ¸£èœé¸¡çš„æœ‰èµé¢è¯•ç»å†ï¼ˆä¸€ï¼‰</a></p><p><a href="http://www.54tianzhisheng.cn/2018/07/30/alipay01/" target="_blank" rel="noopener">7ã€æ¸£æ¸£èœé¸¡çš„èš‚èšé‡‘æœé¢è¯•ç»å†ï¼ˆä¸€ï¼‰</a></p><h3 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h3><p>æœ¬åœ°åœ°å€ï¼š<a href="http://www.54tianzhisheng.cn/2018/07/31/alipay02" target="_blank" rel="noopener">http://www.54tianzhisheng.cn/2018/07/31/alipay02</a> ï¼Œè½¬è½½è¯·æˆæƒï¼Œå¦åˆ™ç¦æ­¢è½¬è½½ï¼</p><p><strong>æœ¬æ–‡é¦–å‘åœ¨æˆ‘çš„çŸ¥è¯†æ˜Ÿçƒï¼Œæœ€è¿‘è‡ªå·±ä¸€ç›´åœ¨å†™å‰æ®µæ—¶é—´çš„æ‰€æœ‰é¢è¯•æƒ…å†µï¼Œå·²ç»åˆ†äº«åœ¨æˆ‘çš„çŸ¥è¯†æ˜Ÿçƒï¼Œå¦‚æœæ„Ÿå…´è¶£ï¼Œå¯ä»¥åŠ å…¥æˆ‘çš„çŸ¥è¯†æ˜Ÿçƒï¼</strong></p><p><img src="https://ws1.sinaimg.cn/large/006tNc79ly1fts8b5uin5j30o00didgn.jpg" alt="zhisheng_zsxq"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://ws2.sinaimg.cn/large/801b780aly1fttgbvge25j21f60vyack.jpg&quot; alt=&quot;2018-07-31_23-16-07&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="é¢ç»" scheme="http://yoursite.com/tags/%E9%9D%A2%E7%BB%8F/"/>
    
  </entry>
  
  <entry>
    <title>æ¸£æ¸£èœé¸¡çš„èš‚èšé‡‘æœé¢è¯•ç»å†(ä¸€)</title>
    <link href="http://yoursite.com/2018/07/30/alipay01/"/>
    <id>http://yoursite.com/2018/07/30/alipay01/</id>
    <published>2018-07-29T16:00:00.000Z</published>
    <updated>2018-07-30T13:56:13.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://ws4.sinaimg.cn/large/006tNc79ly1fts8b55rbfj30zk0nj4do.jpg" alt="cafe-3537801_1280"></p><a id="more"></a><h2 id="èš‚èšé‡‘æœ"><a href="#èš‚èšé‡‘æœ" class="headerlink" title="èš‚èšé‡‘æœ"></a>èš‚èšé‡‘æœ</h2><h3 id="ç”µè¯ä¸€é¢"><a href="#ç”µè¯ä¸€é¢" class="headerlink" title="ç”µè¯ä¸€é¢"></a>ç”µè¯ä¸€é¢</h3><p>1ã€è‡ªæˆ‘ä»‹ç»ã€è‡ªå·±åšçš„é¡¹ç›®å’ŒæŠ€æœ¯é¢†åŸŸ</p><p>2ã€é¡¹ç›®ä¸­çš„ç›‘æ§ï¼šé‚£ä¸ªç›‘æ§æŒ‡æ ‡å¸¸è§çš„å“ªäº›ï¼Ÿ</p><p>3ã€å¾®æœåŠ¡æ¶‰åŠåˆ°çš„æŠ€æœ¯ä»¥åŠéœ€è¦æ³¨æ„çš„é—®é¢˜æœ‰å“ªäº›ï¼Ÿ</p><p>4ã€æ³¨å†Œä¸­å¿ƒä½ äº†è§£äº†å“ªäº›ï¼Ÿ</p><p>5ã€consul çš„å¯é æ€§ä½ äº†è§£å—ï¼Ÿ</p><p>6ã€consul çš„æœºåˆ¶ä½ æœ‰æ²¡æœ‰å…·ä½“æ·±å…¥è¿‡ï¼Ÿæœ‰æ²¡æœ‰å’Œå…¶ä»–çš„æ³¨å†Œä¸­å¿ƒå¯¹æ¯”è¿‡ï¼Ÿ</p><p>7ã€é¡¹ç›®ç”¨ Spring æ¯”è¾ƒå¤šï¼Œæœ‰æ²¡æœ‰äº†è§£ Spring çš„åŸç†ï¼ŸAOP å’Œ IOC çš„åŸç†</p><p>8ã€Spring Booté™¤äº†è‡ªåŠ¨é…ç½®ï¼Œç›¸æ¯”ä¼ ç»Ÿçš„ Spring æœ‰ä»€ä¹ˆå…¶ä»–çš„åŒºåˆ«ï¼Ÿ</p><p>9ã€Spring Cloud æœ‰äº†è§£å¤šå°‘ï¼Ÿ</p><p>10ã€Spring Bean çš„ç”Ÿå‘½å‘¨æœŸ</p><p>11ã€HashMap å’Œ hashTable åŒºåˆ«ï¼Ÿ</p><p>12ã€Object çš„ hashcode æ–¹æ³•é‡å†™äº†ï¼Œequals æ–¹æ³•è¦ä¸è¦æ”¹ï¼Ÿ</p><p>13ã€Hashmap çº¿ç¨‹ä¸å®‰å…¨çš„å‡ºç°åœºæ™¯</p><p>14ã€çº¿ä¸ŠæœåŠ¡ CPU å¾ˆé«˜è¯¥æ€ä¹ˆåšï¼Ÿæœ‰å“ªäº›æªæ–½å¯ä»¥æ‰¾åˆ°é—®é¢˜</p><p>15ã€JDK ä¸­æœ‰å“ªå‡ ä¸ªçº¿ç¨‹æ± ï¼Ÿé¡ºå¸¦æŠŠçº¿ç¨‹æ± è®²äº†ä¸ªé</p><p>16ã€SQL ä¼˜åŒ–çš„å¸¸è§æ–¹æ³•æœ‰å“ªäº›</p><p>17ã€SQL ç´¢å¼•çš„é¡ºåºï¼Œå­—æ®µçš„é¡ºåº</p><p>18ã€æŸ¥çœ‹ SQL æ˜¯ä¸æ˜¯ä½¿ç”¨äº†ç´¢å¼•ï¼Ÿï¼ˆæœ‰ä»€ä¹ˆå·¥å…·ï¼‰</p><p>19ã€TCP å’Œ UDP çš„åŒºåˆ«ï¼ŸTCP æ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­æ€ä¹ˆåšåˆ°å¯é çš„ï¼Ÿ</p><p>20ã€è¯´ä¸‹ä½ çŸ¥é“çš„æ’åºç®—æ³•å§</p><p>21ã€æŸ¥æ‰¾ä¸€ä¸ªæ•°ç»„çš„ä¸­ä½æ•°ï¼Ÿ</p><p>22ã€ä½ æœ‰ä»€ä¹ˆé—®é¢˜æƒ³é—®æˆ‘çš„å—ï¼Ÿ</p><h3 id="ç›¸å…³æ–‡ç« ï¼š"><a href="#ç›¸å…³æ–‡ç« ï¼š" class="headerlink" title="ç›¸å…³æ–‡ç« ï¼š"></a>ç›¸å…³æ–‡ç« ï¼š</h3><p><a href="http://www.54tianzhisheng.cn/2017/08/04/yaxin/" target="_blank" rel="noopener">1ã€ç§‹æ‹›ç¬¬ä¸€ç«™ â€”â€” äºšä¿¡ç§‘æŠ€</a></p><p><a href="http://www.54tianzhisheng.cn/2017/08/04/iqiyi/" target="_blank" rel="noopener">2ã€ç§‹æ‹›ç¬¬äºŒç«™ â€”â€” å†…æ¨çˆ±å¥‡è‰º</a></p><p><a href="http://www.54tianzhisheng.cn/2017/08/04/alibaba/" target="_blank" rel="noopener">3ã€ç§‹æ‹›ç¬¬ä¸‰ç«™ â€”â€” å†…æ¨é˜¿é‡Œï¼ˆä¸€é¢ï¼‰</a></p><p><a href="http://www.54tianzhisheng.cn/2017/08/28/recommend-books/" target="_blank" rel="noopener">4ã€é‚£äº›å¹´æˆ‘çœ‹è¿‡çš„ä¹¦ â€”â€” è‡´æ•¬æˆ‘çš„å¤§å­¦ç”Ÿæ´» â€”â€” Say Good Bye ï¼</a></p><p><a href="http://www.54tianzhisheng.cn/2017/09/17/Interview-summary/" target="_blank" rel="noopener">5ã€é¢è¯•è¿‡é˜¿é‡Œç­‰äº’è”ç½‘å¤§å…¬å¸ï¼Œæˆ‘çŸ¥é“äº†è¿™äº›å¥—è·¯</a></p><p><a href="http://www.54tianzhisheng.cn/2018/07/12/youzan/" target="_blank" rel="noopener">6ã€æ¸£æ¸£èœé¸¡çš„æœ‰èµé¢è¯•ç»å†ï¼ˆä¸€ï¼‰</a></p><h3 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h3><p>æœ¬åœ°åœ°å€ï¼š<a href="http://www.54tianzhisheng.cn/2018/07/30/alipay01" target="_blank" rel="noopener">http://www.54tianzhisheng.cn/2018/07/30/alipay01</a> ï¼Œè½¬è½½è¯·æˆæƒï¼Œå¦åˆ™ç¦æ­¢è½¬è½½ï¼</p><p><strong>æœ¬æ–‡é¦–å‘åœ¨æˆ‘çš„çŸ¥è¯†æ˜Ÿçƒï¼Œæœ€è¿‘è‡ªå·±ä¸€ç›´åœ¨å†™å‰æ®µæ—¶é—´çš„æ‰€æœ‰é¢è¯•æƒ…å†µï¼Œå·²ç»åˆ†äº«åœ¨æˆ‘çš„çŸ¥è¯†æ˜Ÿçƒï¼Œå¦‚æœæ„Ÿå…´è¶£ï¼Œå¯ä»¥åŠ å…¥æˆ‘çš„çŸ¥è¯†æ˜Ÿçƒï¼</strong></p><p><img src="https://ws1.sinaimg.cn/large/006tNc79ly1fts8b5uin5j30o00didgn.jpg" alt="zhisheng_zsxq"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://ws4.sinaimg.cn/large/006tNc79ly1fts8b55rbfj30zk0nj4do.jpg&quot; alt=&quot;cafe-3537801_1280&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="é¢ç»" scheme="http://yoursite.com/tags/%E9%9D%A2%E7%BB%8F/"/>
    
  </entry>
  
  <entry>
    <title>æ¸£æ¸£èœé¸¡çš„æœ‰èµé¢è¯•ç»å†ï¼ˆä¸€ï¼‰</title>
    <link href="http://yoursite.com/2018/07/12/youzan/"/>
    <id>http://yoursite.com/2018/07/12/youzan/</id>
    <published>2018-07-11T16:00:00.000Z</published>
    <updated>2018-07-15T01:48:13.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://ws4.sinaimg.cn/large/006tKfTcly1ftaaye0j1aj31hc0zganr.jpg" alt="003"></p><p>å‡ºå»é¢è¯•çš„è¯è¿˜æ˜¯å¾—å¥½å¥½å‡†å¤‡ï¼Œä¸ç„¶ä¼šè¢«è™çš„æœ‰ç‚¹æƒ¨ï¼<br><a id="more"></a></p><h2 id="æœ‰èµï¼ˆæ¡†æ¶ç»„ï¼‰"><a href="#æœ‰èµï¼ˆæ¡†æ¶ç»„ï¼‰" class="headerlink" title="æœ‰èµï¼ˆæ¡†æ¶ç»„ï¼‰"></a>æœ‰èµï¼ˆæ¡†æ¶ç»„ï¼‰</h2><p>å››æœˆä»½é¢è¯•æœ‰èµçš„æ—¶å€™ï¼Œè‡ªå·±è¿˜åœ¨å®ä¹ ï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰å¤ä¹ ï¼Œæ˜¯åœ¨ Boss ç›´è˜ä¸ŠæŠ•çš„ï¼Œå½“æ—¶çœ‹åˆ°äº†æœ‰èµçš„ 2018 å±Šæ˜¥æ‹›ï¼Œå°±æŠ•äº†ä¸‹ï¼Œç„¶åä¸çŸ¥é“æ€ä¹ˆå°±è¢«æ¨åˆ°äº†æ¡†æ¶ç»„ï¼Œç»“æœåé¢å°±æ„Ÿè§‰è‡ªå·±è¢«è™çš„å¯æƒ¨äº†ã€‚</p><h3 id="å…³æ³¨æˆ‘"><a href="#å…³æ³¨æˆ‘" class="headerlink" title="å…³æ³¨æˆ‘"></a>å…³æ³¨æˆ‘</h3><p><img src="http://ohfk1r827.bkt.clouddn.com/blog/180103/C6LG3mGa12.jpg" alt="zhisheng"></p><p>è½¬è½½è¯·åŠ¡å¿…æ³¨æ˜åŸåˆ›åœ°å€ä¸ºï¼š<a href="http://www.54tianzhisheng.cn/2018/07/12/youzan/" target="_blank" rel="noopener">http://www.54tianzhisheng.cn/2018/07/12/youzan/</a></p><h3 id="ç”µè¯ä¸€é¢"><a href="#ç”µè¯ä¸€é¢" class="headerlink" title="ç”µè¯ä¸€é¢"></a>ç”µè¯ä¸€é¢</h3><p>å¥½åƒæ˜¯æ¸…æ˜èŠ‚è¿˜æ˜¯äº”ä¸€åŠ³åŠ¨èŠ‚æ¥ç€ï¼Œæˆ‘è¿˜åœ¨ç¡è§‰ï¼Œå°±æ¥åˆ°ä¸€é¢é¢è¯•å®˜çš„ç”µè¯ï¼Œè¯´ç°åœ¨æœ‰æ—¶é—´å—ï¼Œèƒ½å¤Ÿæ¥å—ä¸‹ç”µè¯é¢è¯•å—ï¼Ÿæˆ‘å‹’ä¸ªå»ï¼Œä»Šå¤©è¿‡èŠ‚ã€æˆ‘è¢«ç”µè¯åµé†’çš„ï¼Œç°åœ¨äººéƒ½æ²¡æ¸…é†’ã€è¿™é¢è¯•é‚£è‚¯å®šå¾—ä¸€é¢å°±æŒ‚äº†ï¼Œæ‰€ä»¥å°±è€å®å¾—è¯´ç°åœ¨è¿˜æ˜¯ä¸æ–¹ä¾¿å‘¢ï¼Œçº¦äº†å‘¨ä¸€ä¸Šåˆ 10 ç‚¹é¢è¯•ã€‚</p><p>å‘¨ä¸€ 10 ç‚¹é¢è¯•å®˜å‡†æ—¶æ‰“ç”µè¯è¿‡æ¥äº†ï¼</p><p>ä»¥ä¸‹æ˜¯é¢è¯•çš„é—®é¢˜ï¼š</p><p>1ã€è‡ªæˆ‘ä»‹ç»</p><p>2ã€Map çš„åº•å±‚ç»“æ„ï¼Ÿï¼ˆHashMapï¼‰</p><p>3ã€çº¿ç¨‹å®‰å…¨çš„ Map ï¼ˆconcurrentHashMapï¼‰ç®€å•çš„è¯´äº†ä¸‹è¿™ä¸¤ 1ã€‚7 å’Œ 1.8 çš„åŒºåˆ«ï¼Œæœ¬æƒ³é—®ä¸‹è¦ä¸è¦æ·±å…¥çš„è®²ä¸‹ï¼ˆæºç çº§åˆ«ï¼‰ï¼Œç»“æœé¢è¯•å®˜è¯´ä¸ç”¨äº†ã€‚</p><p>4ã€é¡¹ç›® MySQL çš„æ•°æ®é‡å’Œå¹¶å‘é‡æœ‰å¤šå¤§ï¼Ÿ</p><p>5ã€ä½ å¯¹æ•°æ®åº“äº†è§£å¤šå°‘ï¼Ÿ</p><p>6ã€ä½ è¯´ä¸‹æ•°æ®åº“çš„ç´¢å¼•å®ç°å’Œéä¸»é”®çš„äºŒçº§ç´¢å¼•</p><p>7ã€é¡¹ç›®ç”¨çš„æ˜¯ SpringBoot ï¼Œä½ èƒ½è¯´ä¸‹ Spring Boot ä¸ Spring çš„åŒºåˆ«å—ï¼Ÿ</p><p>8ã€SpringBoot çš„è‡ªåŠ¨é…ç½®æ˜¯æ€ä¹ˆåšçš„ï¼Ÿ</p><p>9ã€MyBatis å®šä¹‰çš„æ¥å£ï¼Œæ€ä¹ˆæ‰¾åˆ°å®ç°çš„ï¼Ÿ</p><p>10ã€Java å†…å­˜ç»“æ„</p><p>11ã€å¯¹è±¡æ˜¯å¦å¯ GCï¼Ÿ</p><p>12ã€Minor GC å’Œ Full GC</p><p>13ã€åƒåœ¾å›æ”¶ç®—æ³•</p><p>14ã€åƒåœ¾å›æ”¶å™¨ G1</p><p>15ã€é¡¹ç›®é‡Œç”¨è¿‡ ElasticSearch å’Œ Hbaseï¼Œæœ‰æ·±å…¥äº†è§£ä»–ä»¬çš„è°ƒä¼˜æŠ€å·§å—ï¼Ÿ</p><p>16ã€Spring RestTemplate çš„å…·ä½“å®ç°</p><p>17ã€æè¿°ä¸‹ç½‘é¡µä¸€ä¸ª Http è¯·æ±‚ï¼Œåˆ°åç«¯çš„æ•´ä¸ªè¯·æ±‚è¿‡ç¨‹</p><p>18ã€å¤šçº¿ç¨‹çš„å¸¸ç”¨æ–¹æ³•å’Œæ¥å£ç±»åŠçº¿ç¨‹æ± çš„æœºåˆ¶</p><p>19ã€æ€»ç»“æˆ‘çš„ Java åŸºç¡€è¿˜æ˜¯ä¸é”™ï¼Œä½†æ˜¯ä¸€äº›ä¸»æµçš„æ¡†æ¶æºç è¿˜æ˜¯å¤„åœ¨ä½¿ç”¨çš„çŠ¶æ€ï¼Œéœ€è¦ç»§ç»­å»çœ‹æºç </p><p>20ã€æ­»é”</p><p>21ã€è‡ªå·±ç ”ç©¶æ¯”è¾ƒæ–°çš„æŠ€æœ¯ï¼Œè¯´ä¸‹æˆæœï¼</p><p>22ã€ä½ æœ‰ä»€ä¹ˆæƒ³é—®çš„ï¼Ÿæˆ‘å°±é—®äº†ä¸‹å…¬å¸é‚£è¾¹çš„æƒ…å†µï¼Œè¿™ä¸ªè‡ªç”±å‘æŒ¥ï¼</p><p>æœ€åæˆ‘çŸ¥é“æœ‰äºŒé¢çš„é¢è¯•æœºä¼šäº†ã€‚</p><p>10 æ¥åˆ†é’Ÿä¸åˆ°ï¼Œå°±å†æ¬¡æ‰“ç”µè¯è¿‡æ¥çº¦äº†æ˜æ—©ä¸Šåˆ 10 ç‚¹çš„è§†é¢‘é¢è¯•ã€‚</p><h3 id="è§†é¢‘äºŒé¢"><a href="#è§†é¢‘äºŒé¢" class="headerlink" title="è§†é¢‘äºŒé¢"></a>è§†é¢‘äºŒé¢</h3><p>äºŒé¢é¢è¯•å®˜å…ˆæ‰“ç”µè¯è¿‡æ¥ï¼Œç„¶ååŠ äº†ä¸ªå¾®ä¿¡ï¼Œå¼€å§‹å¾®ä¿¡è§†é¢‘é¢è¯•</p><p>è¿™ä¸ªé¢è¯•æˆ‘ä¹Ÿä¸å¤ªè®°å¾—å…·ä½“é¢è¯•é¢˜ç›®äº†ï¼Œä¸‹é¢å†™çš„æ˜¯å¤§æ¦‚æ–¹å‘çš„ï¼š</p><p>1ã€HashMapï¼Œæºç çº§åˆ«çš„é—®äº†ï¼ŒåŒ…æ‹¬ä¸ºä»€ä¹ˆçº¿ç¨‹ä¸å®‰å…¨</p><p>2ã€æ­»é”</p><p>3ã€Synchronized å’Œ ReentrantLock é”æœºåˆ¶ï¼Œæ€ä¹ˆåˆ¤æ–­é‡å…¥é”çš„ï¼Œä¼šä¸ä¼šæ˜¯æ­»é”ï¼Ÿ</p><p>4ã€è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«ï¼Ÿ</p><p>5ã€è¿›ç¨‹ä¹‹é—´å¦‚ä½•ä¿è¯åŒæ­¥ï¼Ÿ</p><p>6ã€åˆ†å¸ƒå¼é”</p><p>7ã€å¯¹è±¡ GC</p><p>8ã€åƒåœ¾å›æ”¶ç®—æ³•</p><p>9ã€JVM å‚æ•°</p><p>10ã€OOM å‡ºç°çš„æœ‰å“ªäº›åœºæ™¯ï¼Ÿä¸ºä»€ä¹ˆä¼šå‘ç”Ÿï¼Ÿ</p><p>11ã€JVM å†…å­˜ç»“æ„è¯´ä¸‹å§</p><p>12ã€å †å’Œæ ˆçš„å…±äº«é—®é¢˜ï¼Ÿ</p><p>13ã€æœ‰æ¯”è¾ƒè¿‡ Http å’Œ RPC å—ï¼Ÿ</p><p>14ã€HttpClient ä½ è¯´è¯´é‡Œé¢çš„å…·ä½“å®ç°å§ï¼Ÿï¼ˆæ¶‰åŠäº†å“ªäº›ä¸œè¥¿ï¼‰</p><p>15ã€é‚£è¦ä½ è®¾è®¡ä¸€ä¸ªé«˜æ€§èƒ½çš„ Http ï¼Œä½ ä¼šæ€ä¹ˆè®¾è®¡ï¼Ÿ</p><p>äºŒé¢å¾®ä¿¡è§†é¢‘é¢è¯•åªè®°å¾—è¿™ä¹ˆå¤šäº†ã€‚</p><hr><p><strong>æœ¬æ–‡é¦–å‘åœ¨æˆ‘çš„çŸ¥è¯†æ˜Ÿçƒï¼Œæœ€è¿‘è‡ªå·±ä¸€ç›´åœ¨å†™å‰æ®µæ—¶é—´çš„æ‰€æœ‰é¢è¯•æƒ…å†µï¼Œåé¢ä¼šä¸€ç¯‡ä¸€ç¯‡åˆ†äº«åœ¨æˆ‘çš„çŸ¥è¯†æ˜Ÿçƒçš„ï¼Œå¦‚æœæ„Ÿå…´è¶£ï¼Œå¯ä»¥åŠ å…¥æˆ‘çš„çŸ¥è¯†æ˜Ÿçƒï¼</strong></p><p><img src="https://ws1.sinaimg.cn/large/006tKfTcly1ftaayfcr1dj30o00didgn.jpg" alt="zhisheng_zsxq"></p><p>çŸ¥è¯†æ˜Ÿçƒæ›´å¤šé¢ç»æ–‡ç« ï¼š</p><p>1ã€<a href="https://t.zsxq.com/EyfYbuv" target="_blank" rel="noopener">èš‚èšé‡‘æœç”µè¯ä¸€é¢</a></p><p>2ã€<a href="https://t.zsxq.com/AurzjA6" target="_blank" rel="noopener">èš‚èšé‡‘æœç”µè¯äºŒé¢â€”â€”åé¢èŠçš„æœ‰ç‚¹high</a></p><p>3ã€<a href="https://t.zsxq.com/66MJauR" target="_blank" rel="noopener">club factory é¢ç»åˆ†äº«</a></p><p>4ã€<a href="https://t.zsxq.com/biybQFa" target="_blank" rel="noopener">ä½œä¸ºé¢è¯•å®˜å¾—åˆ°çš„ç»éªŒ</a></p><p>5ã€<a href="https://t.zsxq.com/FmuvrJI" target="_blank" rel="noopener">å²ä¸Šæœ€å¼ºæœ€å…¨é¢ç»åˆé›†</a></p><p>6ã€<a href="https://t.zsxq.com/BuNVJuJ" target="_blank" rel="noopener">å…¬å¸éœ€è¦ä»€ä¹ˆæ ·çš„äºº</a></p><p>7ã€<a href="https://t.zsxq.com/UN7i6uV" target="_blank" rel="noopener">å¦‚ä½•ä»‹ç»é¡¹ç›®</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://ws4.sinaimg.cn/large/006tKfTcly1ftaaye0j1aj31hc0zganr.jpg&quot; alt=&quot;003&quot;&gt;&lt;/p&gt;
&lt;p&gt;å‡ºå»é¢è¯•çš„è¯è¿˜æ˜¯å¾—å¥½å¥½å‡†å¤‡ï¼Œä¸ç„¶ä¼šè¢«è™çš„æœ‰ç‚¹æƒ¨ï¼&lt;br&gt;
    
    </summary>
    
    
      <category term="é¢ç»" scheme="http://yoursite.com/tags/%E9%9D%A2%E7%BB%8F/"/>
    
  </entry>
  
  <entry>
    <title>20 ä¸ªæ¡ˆä¾‹æ•™ä½ åœ¨ Java 8 ä¸­å¦‚ä½•å¤„ç†æ—¥æœŸå’Œæ—¶é—´?</title>
    <link href="http://yoursite.com/2018/06/20/java-8-date/"/>
    <id>http://yoursite.com/2018/06/20/java-8-date/</id>
    <published>2018-06-19T16:00:00.000Z</published>
    <updated>2018-06-20T15:21:02.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1fsho6kitc6j31hc0zkdr7.jpg" alt="002"><br><a id="more"></a></p><h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>å‰é¢ä¸€ç¯‡æ–‡ç« å†™äº†<a href="http://www.54tianzhisheng.cn/2018/06/19/SimpleDateFormat/" target="_blank" rel="noopener">ã€ŠSimpleDateFormat å¦‚ä½•å®‰å…¨çš„ä½¿ç”¨ï¼Ÿã€‹</a>, é‡Œé¢ä»‹ç»äº† SimpleDateFormat å¦‚ä½•å¤„ç†æ—¥æœŸï¼æ—¶é—´ï¼Œä»¥åŠå¦‚ä½•ä¿è¯çº¿ç¨‹å®‰å…¨ï¼ŒåŠå…¶ä»‹ç»äº†åœ¨ Java 8 ä¸­çš„å¤„ç†æ—¶é—´ï¼æ—¥æœŸé»˜è®¤å°±çº¿ç¨‹å®‰å…¨çš„ DateTimeFormatter ç±»ã€‚é‚£ä¹ˆ Java 8 ä¸­è¯¥æ€ä¹ˆæ ·å¤„ç†ç”Ÿæ´»ä¸­å¸¸è§çš„ä¸€äº›æ—¥æœŸï¼æ—¶é—´å‘¢ï¼Ÿæ¯”å¦‚ï¼šè®¡ç®—ä¸€å‘¨åçš„æ—¥æœŸï¼›è®¡ç®—ä¸€å¹´å‰æˆ–ä¸€å¹´åçš„æ—¥æœŸï¼›æ£€æŸ¥é—°å¹´ç­‰ã€‚</p><p>æ¥ä¸‹æ¥åˆ›å»ºäº† 20 ä¸ªåŸºäºä»»åŠ¡çš„å®ä¾‹æ¥å­¦ä¹  Java 8 çš„æ–°ç‰¹æ€§ã€‚ä»æœ€ç®€å•åˆ›å»ºå½“å¤©çš„æ—¥æœŸå¼€å§‹ï¼Œç„¶ååˆ›å»ºæ—¶é—´åŠæ—¶åŒºï¼Œæ¥ç€æ¨¡æ‹Ÿä¸€ä¸ªæ—¥æœŸæé†’åº”ç”¨ä¸­çš„ä»»åŠ¡â€”â€”è®¡ç®—é‡è¦æ—¥æœŸçš„åˆ°æœŸå¤©æ•°ï¼Œä¾‹å¦‚ç”Ÿæ—¥ã€çºªå¿µæ—¥ã€è´¦å•æ—¥ã€ä¿è´¹åˆ°æœŸæ—¥ã€ä¿¡ç”¨å¡è¿‡æœŸæ—¥ç­‰ã€‚</p><h3 id="å…³æ³¨æˆ‘"><a href="#å…³æ³¨æˆ‘" class="headerlink" title="å…³æ³¨æˆ‘"></a>å…³æ³¨æˆ‘</h3><p><img src="http://ohfk1r827.bkt.clouddn.com/blog/180103/C6LG3mGa12.jpg" alt="zhisheng"></p><p>è½¬è½½è¯·åŠ¡å¿…æ³¨æ˜åŸåˆ›åœ°å€ä¸ºï¼š<a href="http://www.54tianzhisheng.cn/2018/06/20/java-8-date/" target="_blank" rel="noopener">http://www.54tianzhisheng.cn/2018/06/20/java-8-date/</a></p><h3 id="ç¤ºä¾‹-1ã€åœ¨-Java-8-ä¸­è·å–ä»Šå¤©çš„æ—¥æœŸ"><a href="#ç¤ºä¾‹-1ã€åœ¨-Java-8-ä¸­è·å–ä»Šå¤©çš„æ—¥æœŸ" class="headerlink" title="ç¤ºä¾‹ 1ã€åœ¨ Java 8 ä¸­è·å–ä»Šå¤©çš„æ—¥æœŸ"></a>ç¤ºä¾‹ 1ã€åœ¨ Java 8 ä¸­è·å–ä»Šå¤©çš„æ—¥æœŸ</h3><p>Java 8 ä¸­çš„ LocalDate ç”¨äºè¡¨ç¤ºå½“å¤©æ—¥æœŸã€‚å’Œ java.util.Date ä¸åŒï¼Œå®ƒåªæœ‰æ—¥æœŸï¼Œä¸åŒ…å«æ—¶é—´ã€‚å½“ä½ ä»…éœ€è¦è¡¨ç¤ºæ—¥æœŸæ—¶å°±ç”¨è¿™ä¸ªç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LocalDate now = LocalDate.now();</span><br><span class="line">System.out.println(now);</span><br></pre></td></tr></table></figure><p>ç»“æœæ˜¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2018-06-20</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç åˆ›å»ºäº†å½“å¤©çš„æ—¥æœŸï¼Œä¸å«æ—¶é—´ä¿¡æ¯ã€‚æ‰“å°å‡ºçš„æ—¥æœŸæ ¼å¼éå¸¸å‹å¥½ï¼Œä¸åƒè€çš„ Date ç±»æ‰“å°å‡ºä¸€å †æ²¡æœ‰æ ¼å¼åŒ–çš„ä¿¡æ¯ã€‚</p><h3 id="ç¤ºä¾‹-2ã€åœ¨-Java-8-ä¸­è·å–å¹´ã€æœˆã€æ—¥ä¿¡æ¯"><a href="#ç¤ºä¾‹-2ã€åœ¨-Java-8-ä¸­è·å–å¹´ã€æœˆã€æ—¥ä¿¡æ¯" class="headerlink" title="ç¤ºä¾‹ 2ã€åœ¨ Java 8 ä¸­è·å–å¹´ã€æœˆã€æ—¥ä¿¡æ¯"></a>ç¤ºä¾‹ 2ã€åœ¨ Java 8 ä¸­è·å–å¹´ã€æœˆã€æ—¥ä¿¡æ¯</h3><p>LocalDate ç±»æä¾›äº†è·å–å¹´ã€æœˆã€æ—¥çš„å¿«æ·æ–¹æ³•ï¼Œå…¶å®ä¾‹è¿˜åŒ…å«å¾ˆå¤šå…¶å®ƒçš„æ—¥æœŸå±æ€§ã€‚é€šè¿‡è°ƒç”¨è¿™äº›æ–¹æ³•å°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„å¾—åˆ°éœ€è¦çš„æ—¥æœŸä¿¡æ¯ï¼Œä¸ç”¨åƒä»¥å‰ä¸€æ ·éœ€è¦ä¾èµ– java.util.Calendar ç±»äº†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">LocalDate now = LocalDate.now();</span><br><span class="line"><span class="keyword">int</span> year = now.getYear();</span><br><span class="line"><span class="keyword">int</span> monthValue = now.getMonthValue();</span><br><span class="line"><span class="keyword">int</span> dayOfMonth = now.getDayOfMonth();</span><br><span class="line">System.out.printf(<span class="string">"year = %d, month = %d, day = %d"</span>, year, monthValue, dayOfMonth);</span><br></pre></td></tr></table></figure><p>ç»“æœæ˜¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">year = 2018, month = 6, day = 20</span><br></pre></td></tr></table></figure><h3 id="ç¤ºä¾‹-3ã€åœ¨-Java-8-ä¸­å¤„ç†ç‰¹å®šæ—¥æœŸ"><a href="#ç¤ºä¾‹-3ã€åœ¨-Java-8-ä¸­å¤„ç†ç‰¹å®šæ—¥æœŸ" class="headerlink" title="ç¤ºä¾‹ 3ã€åœ¨ Java 8 ä¸­å¤„ç†ç‰¹å®šæ—¥æœŸ"></a>ç¤ºä¾‹ 3ã€åœ¨ Java 8 ä¸­å¤„ç†ç‰¹å®šæ—¥æœŸ</h3><p>åœ¨ç¬¬ä¸€ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬é€šè¿‡é™æ€å·¥å‚æ–¹æ³• now() éå¸¸å®¹æ˜“åœ°åˆ›å»ºäº†å½“å¤©æ—¥æœŸï¼Œä½ è¿˜å¯ä»¥è°ƒç”¨å¦ä¸€ä¸ªæœ‰ç”¨çš„å·¥å‚æ–¹æ³•LocalDate.of() åˆ›å»ºä»»æ„æ—¥æœŸï¼Œ è¯¥æ–¹æ³•éœ€è¦ä¼ å…¥å¹´ã€æœˆã€æ—¥åšå‚æ•°ï¼Œè¿”å›å¯¹åº”çš„ LocalDate å®ä¾‹ã€‚è¿™ä¸ªæ–¹æ³•çš„å¥½å¤„æ˜¯æ²¡å†çŠ¯è€ API çš„è®¾è®¡é”™è¯¯ï¼Œæ¯”å¦‚å¹´åº¦èµ·å§‹äº 1900ï¼Œæœˆä»½æ˜¯ä» 0 å¼€å§‹ç­‰ç­‰ã€‚æ—¥æœŸæ‰€è§å³æ‰€å¾—ï¼Œå°±åƒä¸‹é¢è¿™ä¸ªä¾‹å­è¡¨ç¤ºäº† 6 æœˆ 20 æ—¥ï¼Œæ²¡æœ‰ä»»ä½•éšè—æœºå…³ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LocalDate date = LocalDate.of(<span class="number">2018</span>, <span class="number">06</span>, <span class="number">20</span>);</span><br><span class="line">System.out.println(date);</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°åˆ›å»ºçš„æ—¥æœŸå®Œå…¨ç¬¦åˆé¢„æœŸï¼Œä¸å†™å…¥çš„ 2018 å¹´ 6 æœˆ 20 æ—¥å®Œå…¨ä¸€è‡´ã€‚</p><h3 id="ç¤ºä¾‹-4ã€åœ¨-Java-8-ä¸­åˆ¤æ–­ä¸¤ä¸ªæ—¥æœŸæ˜¯å¦ç›¸ç­‰"><a href="#ç¤ºä¾‹-4ã€åœ¨-Java-8-ä¸­åˆ¤æ–­ä¸¤ä¸ªæ—¥æœŸæ˜¯å¦ç›¸ç­‰" class="headerlink" title="ç¤ºä¾‹ 4ã€åœ¨ Java 8 ä¸­åˆ¤æ–­ä¸¤ä¸ªæ—¥æœŸæ˜¯å¦ç›¸ç­‰"></a>ç¤ºä¾‹ 4ã€åœ¨ Java 8 ä¸­åˆ¤æ–­ä¸¤ä¸ªæ—¥æœŸæ˜¯å¦ç›¸ç­‰</h3><p>ç°å®ç”Ÿæ´»ä¸­æœ‰ä¸€ç±»æ—¶é—´å¤„ç†å°±æ˜¯åˆ¤æ–­ä¸¤ä¸ªæ—¥æœŸæ˜¯å¦ç›¸ç­‰ã€‚ä½ å¸¸å¸¸ä¼šæ£€æŸ¥ä»Šå¤©æ˜¯ä¸æ˜¯ä¸ªç‰¹æ®Šçš„æ—¥å­ï¼Œæ¯”å¦‚ç”Ÿæ—¥ã€çºªå¿µæ—¥æˆ–éäº¤æ˜“æ—¥ã€‚è¿™æ—¶å°±éœ€è¦æŠŠæŒ‡å®šçš„æ—¥æœŸä¸æŸä¸ªç‰¹å®šæ—¥æœŸåšæ¯”è¾ƒï¼Œä¾‹å¦‚åˆ¤æ–­è¿™ä¸€å¤©æ˜¯å¦æ˜¯å‡æœŸã€‚ä¸‹é¢è¿™ä¸ªä¾‹å­ä¼šå¸®åŠ©ä½ ç”¨ Java 8 çš„æ–¹å¼å»è§£å†³ï¼Œä½ è‚¯å®šå·²ç»æƒ³åˆ°äº†ï¼ŒLocalDate é‡è½½äº† equal æ–¹æ³•ï¼Œè¯·çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">LocalDate now = LocalDate.now();</span><br><span class="line">LocalDate date = LocalDate.of(<span class="number">2018</span>, <span class="number">06</span>, <span class="number">20</span>);</span><br><span class="line"><span class="keyword">if</span> (date.equals(now)) &#123;</span><br><span class="line">System.out.println(<span class="string">"åŒä¸€å¤©"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬æ¯”è¾ƒçš„ä¸¤ä¸ªæ—¥æœŸç›¸åŒã€‚æ³¨æ„ï¼Œå¦‚æœæ¯”è¾ƒçš„æ—¥æœŸæ˜¯å­—ç¬¦å‹çš„ï¼Œéœ€è¦å…ˆè§£ææˆæ—¥æœŸå¯¹è±¡å†ä½œåˆ¤æ–­ã€‚</p><h3 id="ç¤ºä¾‹-5ã€åœ¨-Java-8-ä¸­æ£€æŸ¥åƒç”Ÿæ—¥è¿™ç§å‘¨æœŸæ€§äº‹ä»¶"><a href="#ç¤ºä¾‹-5ã€åœ¨-Java-8-ä¸­æ£€æŸ¥åƒç”Ÿæ—¥è¿™ç§å‘¨æœŸæ€§äº‹ä»¶" class="headerlink" title="ç¤ºä¾‹ 5ã€åœ¨ Java 8 ä¸­æ£€æŸ¥åƒç”Ÿæ—¥è¿™ç§å‘¨æœŸæ€§äº‹ä»¶"></a>ç¤ºä¾‹ 5ã€åœ¨ Java 8 ä¸­æ£€æŸ¥åƒç”Ÿæ—¥è¿™ç§å‘¨æœŸæ€§äº‹ä»¶</h3><p>Java ä¸­å¦ä¸€ä¸ªæ—¥æœŸæ—¶é—´çš„å¤„ç†å°±æ˜¯æ£€æŸ¥ç±»ä¼¼æ¯æœˆè´¦å•ã€ç»“å©šçºªå¿µæ—¥ã€EMIæ—¥æˆ–ä¿é™©ç¼´è´¹æ—¥è¿™äº›å‘¨æœŸæ€§äº‹ä»¶ã€‚å¦‚æœä½ åœ¨ç”µå­å•†åŠ¡ç½‘ç«™å·¥ä½œï¼Œé‚£ä¹ˆä¸€å®šä¼šæœ‰ä¸€ä¸ªæ¨¡å—ç”¨æ¥åœ¨åœ£è¯èŠ‚ã€æ„Ÿæ©èŠ‚è¿™ç§èŠ‚æ—¥æ—¶å‘å®¢æˆ·å‘é€é—®å€™é‚®ä»¶ã€‚Java ä¸­å¦‚ä½•æ£€æŸ¥è¿™äº›èŠ‚æ—¥æˆ–å…¶å®ƒå‘¨æœŸæ€§äº‹ä»¶å‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯ MonthDay ç±»ã€‚è¿™ä¸ªç±»ç»„åˆäº†æœˆä»½å’Œæ—¥ï¼Œå»æ‰äº†å¹´ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥ç”¨å®ƒåˆ¤æ–­æ¯å¹´éƒ½ä¼šå‘ç”Ÿäº‹ä»¶ã€‚å’Œè¿™ä¸ªç±»ç›¸ä¼¼çš„è¿˜æœ‰ä¸€ä¸ª YearMonth ç±»ã€‚è¿™äº›ç±»ä¹Ÿéƒ½æ˜¯ä¸å¯å˜å¹¶ä¸”çº¿ç¨‹å®‰å…¨çš„å€¼ç±»å‹ã€‚ä¸‹é¢æˆ‘ä»¬é€šè¿‡ MonthDay æ¥æ£€æŸ¥å‘¨æœŸæ€§äº‹ä»¶ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">LocalDate now = LocalDate.now();</span><br><span class="line">LocalDate dateOfBirth = LocalDate.of(<span class="number">2018</span>, <span class="number">06</span>, <span class="number">20</span>);</span><br><span class="line">MonthDay birthday = MonthDay.of(dateOfBirth.getMonth(), dateOfBirth.getDayOfMonth());</span><br><span class="line">MonthDay currentMonthDay = MonthDay.from(now);</span><br><span class="line"><span class="keyword">if</span> (currentMonthDay.equals(birthday)) &#123;</span><br><span class="line">System.out.println(<span class="string">"Happy Birthday"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">System.out.println(<span class="string">"Sorry, today is not your birthday"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœï¼šï¼ˆæ³¨æ„ï¼šè·å–å½“å‰æ—¶é—´å¯èƒ½ä¸ä½ çœ‹çš„æ—¶å€™ä¸å¯¹ï¼Œæ‰€ä»¥è¿™ä¸ªç»“æœå¯èƒ½å’Œä½ çœ‹çš„æ—¶å€™è¿è¡Œç»“æœä¸ä¸€æ ·ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Happy Birthday</span><br></pre></td></tr></table></figure><p>åªè¦å½“å¤©çš„æ—¥æœŸå’Œç”Ÿæ—¥åŒ¹é…ï¼Œæ— è®ºæ˜¯å“ªä¸€å¹´éƒ½ä¼šæ‰“å°å‡ºç¥è´ºä¿¡æ¯ã€‚ä½ å¯ä»¥æŠŠç¨‹åºæ•´åˆè¿›ç³»ç»Ÿæ—¶é’Ÿï¼Œçœ‹çœ‹ç”Ÿæ—¥æ—¶æ˜¯å¦ä¼šå—åˆ°æé†’ï¼Œæˆ–è€…å†™ä¸€ä¸ªå•å…ƒæµ‹è¯•æ¥æ£€æµ‹ä»£ç æ˜¯å¦è¿è¡Œæ­£ç¡®ã€‚</p><h3 id="ç¤ºä¾‹-6ã€åœ¨-Java-8-ä¸­è·å–å½“å‰æ—¶é—´"><a href="#ç¤ºä¾‹-6ã€åœ¨-Java-8-ä¸­è·å–å½“å‰æ—¶é—´" class="headerlink" title="ç¤ºä¾‹ 6ã€åœ¨ Java 8 ä¸­è·å–å½“å‰æ—¶é—´"></a>ç¤ºä¾‹ 6ã€åœ¨ Java 8 ä¸­è·å–å½“å‰æ—¶é—´</h3><p>ä¸ Java 8 è·å–æ—¥æœŸçš„ä¾‹å­å¾ˆåƒï¼Œè·å–æ—¶é—´ä½¿ç”¨çš„æ˜¯ LocalTime ç±»ï¼Œä¸€ä¸ªåªæœ‰æ—¶é—´æ²¡æœ‰æ—¥æœŸçš„ LocalDate è¿‘äº²ã€‚å¯ä»¥è°ƒç”¨é™æ€å·¥å‚æ–¹æ³• now() æ¥è·å–å½“å‰æ—¶é—´ã€‚é»˜è®¤çš„æ ¼å¼æ˜¯ hh:mm:ss:nnnã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LocalTime localTime = LocalTime.now();</span><br><span class="line">System.out.println(localTime);</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">13:35:56.155</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å½“å‰æ—¶é—´å°±åªåŒ…å«æ—¶é—´ä¿¡æ¯ï¼Œæ²¡æœ‰æ—¥æœŸã€‚</p><h3 id="ç¤ºä¾‹-7ã€å¦‚ä½•åœ¨ç°æœ‰çš„æ—¶é—´ä¸Šå¢åŠ å°æ—¶"><a href="#ç¤ºä¾‹-7ã€å¦‚ä½•åœ¨ç°æœ‰çš„æ—¶é—´ä¸Šå¢åŠ å°æ—¶" class="headerlink" title="ç¤ºä¾‹ 7ã€å¦‚ä½•åœ¨ç°æœ‰çš„æ—¶é—´ä¸Šå¢åŠ å°æ—¶"></a>ç¤ºä¾‹ 7ã€å¦‚ä½•åœ¨ç°æœ‰çš„æ—¶é—´ä¸Šå¢åŠ å°æ—¶</h3><p>é€šè¿‡å¢åŠ å°æ—¶ã€åˆ†ã€ç§’æ¥è®¡ç®—å°†æ¥çš„æ—¶é—´å¾ˆå¸¸è§ã€‚Java 8 é™¤äº†ä¸å˜ç±»å‹å’Œçº¿ç¨‹å®‰å…¨çš„å¥½å¤„ä¹‹å¤–ï¼Œè¿˜æä¾›äº†æ›´å¥½çš„plusHours() æ–¹æ³•æ›¿æ¢ add()ï¼Œå¹¶ä¸”æ˜¯å…¼å®¹çš„ã€‚æ³¨æ„ï¼Œè¿™äº›æ–¹æ³•è¿”å›ä¸€ä¸ªå…¨æ–°çš„ LocalTime å®ä¾‹ï¼Œç”±äºå…¶ä¸å¯å˜æ€§ï¼Œè¿”å›åä¸€å®šè¦ç”¨å˜é‡èµ‹å€¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">LocalTime localTime = LocalTime.now();</span><br><span class="line">System.out.println(localTime);</span><br><span class="line">LocalTime localTime1 = localTime.plusHours(<span class="number">2</span>);<span class="comment">//å¢åŠ 2å°æ—¶</span></span><br><span class="line">System.out.println(localTime1);</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">13:41:20.721</span><br><span class="line">15:41:20.721</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œæ–°çš„æ—¶é—´åœ¨å½“å‰æ—¶é—´ 13:41:20.721 çš„åŸºç¡€ä¸Šå¢åŠ äº† 2 ä¸ªå°æ—¶ã€‚</p><h3 id="ç¤ºä¾‹-8ã€å¦‚ä½•è®¡ç®—ä¸€å‘¨åçš„æ—¥æœŸ"><a href="#ç¤ºä¾‹-8ã€å¦‚ä½•è®¡ç®—ä¸€å‘¨åçš„æ—¥æœŸ" class="headerlink" title="ç¤ºä¾‹ 8ã€å¦‚ä½•è®¡ç®—ä¸€å‘¨åçš„æ—¥æœŸ"></a>ç¤ºä¾‹ 8ã€å¦‚ä½•è®¡ç®—ä¸€å‘¨åçš„æ—¥æœŸ</h3><p>å’Œä¸Šä¸ªä¾‹å­è®¡ç®—ä¸¤å°æ—¶ä»¥åçš„æ—¶é—´ç±»ä¼¼ï¼Œè¿™ä¸ªä¾‹å­ä¼šè®¡ç®—ä¸€å‘¨åçš„æ—¥æœŸã€‚LocalDate æ—¥æœŸä¸åŒ…å«æ—¶é—´ä¿¡æ¯ï¼Œå®ƒçš„ plus()æ–¹æ³•ç”¨æ¥å¢åŠ å¤©ã€å‘¨ã€æœˆï¼ŒChronoUnit ç±»å£°æ˜äº†è¿™äº›æ—¶é—´å•ä½ã€‚ç”±äº LocalDate ä¹Ÿæ˜¯ä¸å˜ç±»å‹ï¼Œè¿”å›åä¸€å®šè¦ç”¨å˜é‡èµ‹å€¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">LocalDate now = LocalDate.now();</span><br><span class="line">LocalDate plusDate = now.plus(<span class="number">1</span>, ChronoUnit.WEEKS);</span><br><span class="line">System.out.println(now);</span><br><span class="line">System.out.println(plusDate);</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2018-06-20</span><br><span class="line">2018-06-27</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æ–°æ—¥æœŸç¦»å½“å¤©æ—¥æœŸæ˜¯ 7 å¤©ï¼Œä¹Ÿå°±æ˜¯ä¸€å‘¨ã€‚ä½ å¯ä»¥ç”¨åŒæ ·çš„æ–¹æ³•å¢åŠ  1 ä¸ªæœˆã€1 å¹´ã€1 å°æ—¶ã€1 åˆ†é’Ÿç”šè‡³ä¸€ä¸ªä¸–çºªï¼Œæ›´å¤šé€‰é¡¹å¯ä»¥æŸ¥çœ‹ Java 8 API ä¸­çš„ ChronoUnit ç±»ã€‚</p><h3 id="ç¤ºä¾‹-9ã€è®¡ç®—ä¸€å¹´å‰æˆ–ä¸€å¹´åçš„æ—¥æœŸ"><a href="#ç¤ºä¾‹-9ã€è®¡ç®—ä¸€å¹´å‰æˆ–ä¸€å¹´åçš„æ—¥æœŸ" class="headerlink" title="ç¤ºä¾‹ 9ã€è®¡ç®—ä¸€å¹´å‰æˆ–ä¸€å¹´åçš„æ—¥æœŸ"></a>ç¤ºä¾‹ 9ã€è®¡ç®—ä¸€å¹´å‰æˆ–ä¸€å¹´åçš„æ—¥æœŸ</h3><p>ç»§ç»­ä¸Šé¢çš„ä¾‹å­ï¼Œä¸Šä¸ªä¾‹å­ä¸­æˆ‘ä»¬é€šè¿‡ LocalDate çš„ plus() æ–¹æ³•å¢åŠ å¤©æ•°ã€å‘¨æ•°æˆ–æœˆæ•°ï¼Œè¿™ä¸ªä¾‹å­æˆ‘ä»¬åˆ©ç”¨ minus() æ–¹æ³•è®¡ç®—ä¸€å¹´å‰çš„æ—¥æœŸã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">LocalDate now = LocalDate.now();</span><br><span class="line">LocalDate minusDate = now.minus(<span class="number">1</span>, ChronoUnit.YEARS);</span><br><span class="line">LocalDate plusDate1 = now.plus(<span class="number">1</span>, ChronoUnit.YEARS);</span><br><span class="line">System.out.println(minusDate);</span><br><span class="line">System.out.println(plusDate1);</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2017-06-20</span><br><span class="line">2019-06-20</span><br></pre></td></tr></table></figure><h3 id="ç¤ºä¾‹-10ã€ä½¿ç”¨-Java-8-çš„-Clock-æ—¶é’Ÿç±»"><a href="#ç¤ºä¾‹-10ã€ä½¿ç”¨-Java-8-çš„-Clock-æ—¶é’Ÿç±»" class="headerlink" title="ç¤ºä¾‹ 10ã€ä½¿ç”¨ Java 8 çš„ Clock æ—¶é’Ÿç±»"></a>ç¤ºä¾‹ 10ã€ä½¿ç”¨ Java 8 çš„ Clock æ—¶é’Ÿç±»</h3><p>Java 8 å¢åŠ äº†ä¸€ä¸ª Clock æ—¶é’Ÿç±»ç”¨äºè·å–å½“æ—¶çš„æ—¶é—´æˆ³ï¼Œæˆ–å½“å‰æ—¶åŒºä¸‹çš„æ—¥æœŸæ—¶é—´ä¿¡æ¯ã€‚ä»¥å‰ç”¨åˆ°System.currentTimeInMillis() å’Œ TimeZone.getDefault() çš„åœ°æ–¹éƒ½å¯ç”¨ Clock æ›¿æ¢ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Clock clock = Clock.systemUTC();</span><br><span class="line">Clock clock1 = Clock.systemDefaultZone();</span><br><span class="line">System.out.println(clock);</span><br><span class="line">System.out.println(clock1);</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SystemClock[Z]</span><br><span class="line">SystemClock[Asia/Shanghai]</span><br></pre></td></tr></table></figure><h3 id="ç¤ºä¾‹-11ã€å¦‚ä½•ç”¨-Java-åˆ¤æ–­æ—¥æœŸæ˜¯æ—©äºè¿˜æ˜¯æ™šäºå¦ä¸€ä¸ªæ—¥æœŸ"><a href="#ç¤ºä¾‹-11ã€å¦‚ä½•ç”¨-Java-åˆ¤æ–­æ—¥æœŸæ˜¯æ—©äºè¿˜æ˜¯æ™šäºå¦ä¸€ä¸ªæ—¥æœŸ" class="headerlink" title="ç¤ºä¾‹ 11ã€å¦‚ä½•ç”¨ Java åˆ¤æ–­æ—¥æœŸæ˜¯æ—©äºè¿˜æ˜¯æ™šäºå¦ä¸€ä¸ªæ—¥æœŸ"></a>ç¤ºä¾‹ 11ã€å¦‚ä½•ç”¨ Java åˆ¤æ–­æ—¥æœŸæ˜¯æ—©äºè¿˜æ˜¯æ™šäºå¦ä¸€ä¸ªæ—¥æœŸ</h3><p>å¦ä¸€ä¸ªå·¥ä½œä¸­å¸¸è§çš„æ“ä½œå°±æ˜¯å¦‚ä½•åˆ¤æ–­ç»™å®šçš„ä¸€ä¸ªæ—¥æœŸæ˜¯å¤§äºæŸå¤©è¿˜æ˜¯å°äºæŸå¤©ï¼Ÿåœ¨ Java 8 ä¸­ï¼ŒLocalDate ç±»æœ‰ä¸¤ç±»æ–¹æ³• isBefore() å’Œ isAfter() ç”¨äºæ¯”è¾ƒæ—¥æœŸã€‚è°ƒç”¨ isBefore() æ–¹æ³•æ—¶ï¼Œå¦‚æœç»™å®šæ—¥æœŸå°äºå½“å‰æ—¥æœŸåˆ™è¿”å› trueã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">LocalDate tomorrow = LocalDate.of(<span class="number">2018</span>,<span class="number">6</span>,<span class="number">20</span>);</span><br><span class="line"><span class="keyword">if</span>(tomorrow.isAfter(now))&#123;</span><br><span class="line">System.out.println(<span class="string">"Tomorrow comes after today"</span>);</span><br><span class="line">&#125;</span><br><span class="line">LocalDate yesterday = now.minus(<span class="number">1</span>, ChronoUnit.DAYS);</span><br><span class="line"><span class="keyword">if</span>(yesterday.isBefore(now))&#123;</span><br><span class="line">System.out.println(<span class="string">"Yesterday is day before today"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ Java 8 ä¸­æ¯”è¾ƒæ—¥æœŸéå¸¸æ–¹ä¾¿ï¼Œä¸éœ€è¦ä½¿ç”¨é¢å¤–çš„ Calendar ç±»æ¥åšè¿™äº›åŸºç¡€å·¥ä½œäº†ã€‚</p><h3 id="ç¤ºä¾‹-12ã€åœ¨-Java-8-ä¸­å¤„ç†æ—¶åŒº"><a href="#ç¤ºä¾‹-12ã€åœ¨-Java-8-ä¸­å¤„ç†æ—¶åŒº" class="headerlink" title="ç¤ºä¾‹ 12ã€åœ¨ Java 8 ä¸­å¤„ç†æ—¶åŒº"></a>ç¤ºä¾‹ 12ã€åœ¨ Java 8 ä¸­å¤„ç†æ—¶åŒº</h3><p>Java 8 ä¸ä»…åˆ†ç¦»äº†æ—¥æœŸå’Œæ—¶é—´ï¼Œä¹ŸæŠŠæ—¶åŒºåˆ†ç¦»å‡ºæ¥äº†ã€‚ç°åœ¨æœ‰ä¸€ç³»åˆ—å•ç‹¬çš„ç±»å¦‚ ZoneId æ¥å¤„ç†ç‰¹å®šæ—¶åŒºï¼ŒZoneDateTime ç±»æ¥è¡¨ç¤ºæŸæ—¶åŒºä¸‹çš„æ—¶é—´ã€‚è¿™åœ¨ Java 8 ä»¥å‰éƒ½æ˜¯ GregorianCalendar ç±»æ¥åšçš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ZoneId america = ZoneId.of(<span class="string">"America/New_York"</span>);</span><br><span class="line">LocalDateTime localtDateAndTime = LocalDateTime.now();</span><br><span class="line">ZonedDateTime dateAndTimeInNewYork  = ZonedDateTime.of(localtDateAndTime, america );</span><br><span class="line">System.out.println(dateAndTimeInNewYork);</span><br></pre></td></tr></table></figure><h3 id="ç¤ºä¾‹-13ã€å¦‚ä½•è¡¨ç¤ºä¿¡ç”¨å¡åˆ°æœŸè¿™ç±»å›ºå®šæ—¥æœŸï¼Œç­”æ¡ˆå°±åœ¨-YearMonth"><a href="#ç¤ºä¾‹-13ã€å¦‚ä½•è¡¨ç¤ºä¿¡ç”¨å¡åˆ°æœŸè¿™ç±»å›ºå®šæ—¥æœŸï¼Œç­”æ¡ˆå°±åœ¨-YearMonth" class="headerlink" title="ç¤ºä¾‹ 13ã€å¦‚ä½•è¡¨ç¤ºä¿¡ç”¨å¡åˆ°æœŸè¿™ç±»å›ºå®šæ—¥æœŸï¼Œç­”æ¡ˆå°±åœ¨ YearMonth"></a>ç¤ºä¾‹ 13ã€å¦‚ä½•è¡¨ç¤ºä¿¡ç”¨å¡åˆ°æœŸè¿™ç±»å›ºå®šæ—¥æœŸï¼Œç­”æ¡ˆå°±åœ¨ YearMonth</h3><p>ä¸ MonthDay æ£€æŸ¥é‡å¤äº‹ä»¶çš„ä¾‹å­ç›¸ä¼¼ï¼ŒYearMonth æ˜¯å¦ä¸€ä¸ªç»„åˆç±»ï¼Œç”¨äºè¡¨ç¤ºä¿¡ç”¨å¡åˆ°æœŸæ—¥ã€FD åˆ°æœŸæ—¥ã€æœŸè´§æœŸæƒåˆ°æœŸæ—¥ç­‰ã€‚è¿˜å¯ä»¥ç”¨è¿™ä¸ªç±»å¾—åˆ° å½“æœˆå…±æœ‰å¤šå°‘å¤©ï¼ŒYearMonth å®ä¾‹çš„ lengthOfMonth() æ–¹æ³•å¯ä»¥è¿”å›å½“æœˆçš„å¤©æ•°ï¼Œåœ¨åˆ¤æ–­ 2 æœˆæœ‰ 28 å¤©è¿˜æ˜¯ 29 å¤©æ—¶éå¸¸æœ‰ç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">YearMonth currentYearMonth = YearMonth.now();</span><br><span class="line">System.out.printf(<span class="string">"Days in month year %s: %d%n"</span>, currentYearMonth, currentYearMonth.lengthOfMonth());</span><br><span class="line">YearMonth creditCardExpiry = YearMonth.of(<span class="number">2018</span>, Month.FEBRUARY);</span><br><span class="line">System.out.printf(<span class="string">"Your credit card expires on %s %n"</span>, creditCardExpiry);</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Days in month year 2018-06: 30</span><br><span class="line">Your credit card expires on 2018-02</span><br></pre></td></tr></table></figure><h3 id="ç¤ºä¾‹-14ã€å¦‚ä½•åœ¨-Java-8-ä¸­æ£€æŸ¥é—°å¹´"><a href="#ç¤ºä¾‹-14ã€å¦‚ä½•åœ¨-Java-8-ä¸­æ£€æŸ¥é—°å¹´" class="headerlink" title="ç¤ºä¾‹ 14ã€å¦‚ä½•åœ¨ Java 8 ä¸­æ£€æŸ¥é—°å¹´"></a>ç¤ºä¾‹ 14ã€å¦‚ä½•åœ¨ Java 8 ä¸­æ£€æŸ¥é—°å¹´</h3><p>LocalDate ç±»æœ‰ä¸€ä¸ªå¾ˆå®ç”¨çš„æ–¹æ³• isLeapYear() åˆ¤æ–­è¯¥å®ä¾‹æ˜¯å¦æ˜¯ä¸€ä¸ªé—°å¹´ã€‚</p><h3 id="ç¤ºä¾‹-15ã€è®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„å¤©æ•°å’Œæœˆæ•°"><a href="#ç¤ºä¾‹-15ã€è®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„å¤©æ•°å’Œæœˆæ•°" class="headerlink" title="ç¤ºä¾‹ 15ã€è®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„å¤©æ•°å’Œæœˆæ•°"></a>ç¤ºä¾‹ 15ã€è®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„å¤©æ•°å’Œæœˆæ•°</h3><p>æœ‰ä¸€ä¸ªå¸¸è§æ—¥æœŸæ“ä½œæ˜¯è®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„å¤©æ•°ã€å‘¨æ•°æˆ–æœˆæ•°ã€‚åœ¨ Java 8 ä¸­å¯ä»¥ç”¨ java.time.Period ç±»æ¥åšè®¡ç®—ã€‚ä¸‹é¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è®¡ç®—äº†å½“å¤©å’Œå°†æ¥æŸä¸€å¤©ä¹‹é—´çš„æœˆæ•°ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">LocalDate date = LocalDate.of(2019, Month.MARCH, 20);</span><br><span class="line">Period period = Period.between(now, date);</span><br><span class="line">System.out.println(&quot;ç¦»ä¸‹ä¸ªæ—¶é—´è¿˜æœ‰&quot; + period.getMonths() + &quot; ä¸ªæœˆ&quot;);</span><br></pre></td></tr></table></figure><h3 id="ç¤ºä¾‹-16ã€åŒ…å«æ—¶å·®ä¿¡æ¯çš„æ—¥æœŸå’Œæ—¶é—´"><a href="#ç¤ºä¾‹-16ã€åŒ…å«æ—¶å·®ä¿¡æ¯çš„æ—¥æœŸå’Œæ—¶é—´" class="headerlink" title="ç¤ºä¾‹ 16ã€åŒ…å«æ—¶å·®ä¿¡æ¯çš„æ—¥æœŸå’Œæ—¶é—´"></a>ç¤ºä¾‹ 16ã€åŒ…å«æ—¶å·®ä¿¡æ¯çš„æ—¥æœŸå’Œæ—¶é—´</h3><p>åœ¨ Java 8 ä¸­ï¼ŒZoneOffset ç±»ç”¨æ¥è¡¨ç¤ºæ—¶åŒºï¼Œä¸¾ä¾‹æ¥è¯´å°åº¦ä¸ GMT æˆ– UTC æ ‡å‡†æ—¶åŒºç›¸å·® +05:30ï¼Œå¯ä»¥é€šè¿‡ZoneOffset.of() é™æ€æ–¹æ³•æ¥è·å–å¯¹åº”çš„æ—¶åŒºã€‚ä¸€æ—¦å¾—åˆ°äº†æ—¶å·®å°±å¯ä»¥é€šè¿‡ä¼ å…¥ LocalDateTime å’Œ ZoneOffset æ¥åˆ›å»ºä¸€ä¸ª OffSetDateTime å¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">LocalDateTime datetime = LocalDateTime.of(<span class="number">2014</span>, Month.JANUARY, <span class="number">14</span>,<span class="number">19</span>,<span class="number">30</span>);</span><br><span class="line">ZoneOffset offset = ZoneOffset.of(<span class="string">"+05:30"</span>);</span><br><span class="line">OffsetDateTime date = OffsetDateTime.of(datetime, offset);  </span><br><span class="line">System.out.println(<span class="string">"Date and Time with timezone offset in Java : "</span> + date);</span><br></pre></td></tr></table></figure><h3 id="ç¤ºä¾‹-17ã€åœ¨-Java-8-ä¸­è·å–å½“å‰çš„æ—¶é—´æˆ³"><a href="#ç¤ºä¾‹-17ã€åœ¨-Java-8-ä¸­è·å–å½“å‰çš„æ—¶é—´æˆ³" class="headerlink" title="ç¤ºä¾‹ 17ã€åœ¨ Java 8 ä¸­è·å–å½“å‰çš„æ—¶é—´æˆ³"></a>ç¤ºä¾‹ 17ã€åœ¨ Java 8 ä¸­è·å–å½“å‰çš„æ—¶é—´æˆ³</h3><p>å¦‚æœä½ è¿˜è®°å¾— Java 8 ä»¥å‰æ˜¯å¦‚ä½•è·å¾—å½“å‰æ—¶é—´æˆ³ï¼Œé‚£ä¹ˆç°åœ¨ä½ ç»ˆäºè§£è„±äº†ã€‚Instant ç±»æœ‰ä¸€ä¸ªé™æ€å·¥å‚æ–¹æ³• now() ä¼šè¿”å›å½“å‰çš„æ—¶é—´æˆ³ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Instant timestamp = Instant.now();</span><br><span class="line">System.out.println(timestamp);</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2018-06-20T06:35:24.881Z</span><br></pre></td></tr></table></figure><p>æ—¶é—´æˆ³ä¿¡æ¯é‡ŒåŒæ—¶åŒ…å«äº†æ—¥æœŸå’Œæ—¶é—´ï¼Œè¿™å’Œ java.util.Date å¾ˆåƒã€‚å®é™…ä¸Š Instant ç±»ç¡®å®ç­‰åŒäº Java 8 ä¹‹å‰çš„ Dateç±»ï¼Œä½ å¯ä»¥ä½¿ç”¨ Date ç±»å’Œ Instant ç±»å„è‡ªçš„è½¬æ¢æ–¹æ³•äº’ç›¸è½¬æ¢ï¼Œä¾‹å¦‚ï¼šDate.from(Instant) å°† Instant è½¬æ¢æˆjava.util.Dateï¼ŒDate.toInstant() åˆ™æ˜¯å°† Date ç±»è½¬æ¢æˆ Instant ç±»ã€‚</p><h3 id="ç¤ºä¾‹-18ã€åœ¨-Java-8-ä¸­å¦‚ä½•ä½¿ç”¨é¢„å®šä¹‰çš„æ ¼å¼åŒ–å·¥å…·å»è§£ææˆ–æ ¼å¼åŒ–æ—¥æœŸ"><a href="#ç¤ºä¾‹-18ã€åœ¨-Java-8-ä¸­å¦‚ä½•ä½¿ç”¨é¢„å®šä¹‰çš„æ ¼å¼åŒ–å·¥å…·å»è§£ææˆ–æ ¼å¼åŒ–æ—¥æœŸ" class="headerlink" title="ç¤ºä¾‹ 18ã€åœ¨ Java 8 ä¸­å¦‚ä½•ä½¿ç”¨é¢„å®šä¹‰çš„æ ¼å¼åŒ–å·¥å…·å»è§£ææˆ–æ ¼å¼åŒ–æ—¥æœŸ"></a>ç¤ºä¾‹ 18ã€åœ¨ Java 8 ä¸­å¦‚ä½•ä½¿ç”¨é¢„å®šä¹‰çš„æ ¼å¼åŒ–å·¥å…·å»è§£ææˆ–æ ¼å¼åŒ–æ—¥æœŸ</h3><p>åœ¨ Java 8 ä»¥å‰çš„ä¸–ç•Œé‡Œï¼Œæ—¥æœŸå’Œæ—¶é—´çš„æ ¼å¼åŒ–éå¸¸è¯¡å¼‚ï¼Œå”¯ä¸€çš„å¸®åŠ©ç±» SimpleDateFormat ä¹Ÿæ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼Œè€Œä¸”ç”¨ä½œå±€éƒ¨å˜é‡è§£æå’Œæ ¼å¼åŒ–æ—¥æœŸæ—¶æ˜¾å¾—å¾ˆç¬¨é‡ã€‚å¹¸å¥½çº¿ç¨‹å±€éƒ¨å˜é‡èƒ½ä½¿å®ƒåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­å˜å¾—å¯ç”¨ï¼Œä¸è¿‡è¿™éƒ½æ˜¯è¿‡å»æ—¶äº†ã€‚Java 8 å¼•å…¥äº†å…¨æ–°çš„æ—¥æœŸæ—¶é—´æ ¼å¼å·¥å…·ï¼Œçº¿ç¨‹å®‰å…¨è€Œä¸”ä½¿ç”¨æ–¹ä¾¿ã€‚å®ƒè‡ªå¸¦äº†ä¸€äº›å¸¸ç”¨çš„å†…ç½®æ ¼å¼åŒ–å·¥å…·ã€‚</p><p>å‚è§æˆ‘ä¸Šä¸€ç¯‡æ–‡ç« ï¼š <a href="http://www.54tianzhisheng.cn/2018/06/19/SimpleDateFormat/" target="_blank" rel="noopener">ã€ŠSimpleDateFormat å¦‚ä½•å®‰å…¨çš„ä½¿ç”¨ï¼Ÿã€‹</a></p><h3 id="ç¤ºä¾‹-19ã€å¦‚ä½•åœ¨-Java-ä¸­ä½¿ç”¨è‡ªå®šä¹‰æ ¼å¼åŒ–å·¥å…·è§£ææ—¥æœŸ"><a href="#ç¤ºä¾‹-19ã€å¦‚ä½•åœ¨-Java-ä¸­ä½¿ç”¨è‡ªå®šä¹‰æ ¼å¼åŒ–å·¥å…·è§£ææ—¥æœŸ" class="headerlink" title="ç¤ºä¾‹ 19ã€å¦‚ä½•åœ¨ Java ä¸­ä½¿ç”¨è‡ªå®šä¹‰æ ¼å¼åŒ–å·¥å…·è§£ææ—¥æœŸ"></a>ç¤ºä¾‹ 19ã€å¦‚ä½•åœ¨ Java ä¸­ä½¿ç”¨è‡ªå®šä¹‰æ ¼å¼åŒ–å·¥å…·è§£ææ—¥æœŸ</h3><p>å°½ç®¡å†…ç½®æ ¼å¼åŒ–å·¥å…·å¾ˆå¥½ç”¨ï¼Œæœ‰æ—¶è¿˜æ˜¯éœ€è¦å®šä¹‰ç‰¹å®šçš„æ—¥æœŸæ ¼å¼ã€‚å¯ä»¥è°ƒç”¨ DateTimeFormatter çš„ ofPattern() é™æ€æ–¹æ³•å¹¶ä¼ å…¥ä»»æ„æ ¼å¼è¿”å›å…¶å®ä¾‹ï¼Œæ ¼å¼ä¸­çš„å­—ç¬¦å’Œä»¥å‰ä»£è¡¨çš„ä¸€æ ·ï¼ŒM ä»£è¡¨æœˆï¼Œm ä»£è¡¨åˆ†ã€‚å¦‚æœæ ¼å¼ä¸è§„èŒƒä¼šæŠ›å‡º DateTimeParseException å¼‚å¸¸ï¼Œä¸è¿‡å¦‚æœåªæ˜¯æŠŠ M å†™æˆ m è¿™ç§é€»è¾‘é”™è¯¯æ˜¯ä¸ä¼šæŠ›å¼‚å¸¸çš„ã€‚</p><p>å‚è§æˆ‘ä¸Šä¸€ç¯‡æ–‡ç« ï¼š <a href="http://www.54tianzhisheng.cn/2018/06/19/SimpleDateFormat/" target="_blank" rel="noopener">ã€ŠSimpleDateFormat å¦‚ä½•å®‰å…¨çš„ä½¿ç”¨ï¼Ÿã€‹</a></p><h3 id="ç¤ºä¾‹-20ã€åœ¨-Java-8-ä¸­å¦‚ä½•æŠŠæ—¥æœŸè½¬æ¢æˆå­—ç¬¦ä¸²"><a href="#ç¤ºä¾‹-20ã€åœ¨-Java-8-ä¸­å¦‚ä½•æŠŠæ—¥æœŸè½¬æ¢æˆå­—ç¬¦ä¸²" class="headerlink" title="ç¤ºä¾‹ 20ã€åœ¨ Java 8 ä¸­å¦‚ä½•æŠŠæ—¥æœŸè½¬æ¢æˆå­—ç¬¦ä¸²"></a>ç¤ºä¾‹ 20ã€åœ¨ Java 8 ä¸­å¦‚ä½•æŠŠæ—¥æœŸè½¬æ¢æˆå­—ç¬¦ä¸²</h3><p>ä¸Šä¸¤ä¸ªä¸»è¦æ˜¯ä»å­—ç¬¦ä¸²è§£ææ—¥æœŸã€‚ç°åœ¨æˆ‘ä»¬åè¿‡æ¥ï¼ŒæŠŠ LocalDateTime æ—¥æœŸå®ä¾‹è½¬æ¢æˆç‰¹å®šæ ¼å¼çš„å­—ç¬¦ä¸²ã€‚è¿™æ˜¯è¿„ä»Šä¸ºæ­¢ Java æ—¥æœŸè½¬å­—ç¬¦ä¸²æœ€ä¸ºç®€å•çš„æ–¹å¼äº†ã€‚ä¸‹é¢çš„ä¾‹å­å°†è¿”å›ä¸€ä¸ªä»£è¡¨æ—¥æœŸçš„æ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚å’Œå‰é¢ç±»ä¼¼ï¼Œè¿˜æ˜¯éœ€è¦åˆ›å»º DateTimeFormatter å®ä¾‹å¹¶ä¼ å…¥æ ¼å¼ï¼Œä½†è¿™å›è°ƒç”¨çš„æ˜¯ format() æ–¹æ³•ï¼Œè€Œé parse() æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•ä¼šæŠŠä¼ å…¥çš„æ—¥æœŸè½¬åŒ–æˆæŒ‡å®šæ ¼å¼çš„å­—ç¬¦ä¸²ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">LocalDateTime arrivalDate  = LocalDateTime.now();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    DateTimeFormatter format = DateTimeFormatter.ofPattern(<span class="string">"MMMdd yyyy  hh:mm a"</span>);</span><br><span class="line">    String landing = arrivalDate.format(format);</span><br><span class="line">    System.out.printf(<span class="string">"Arriving at :  %s %n"</span>, landing);</span><br><span class="line">&#125;<span class="keyword">catch</span> (DateTimeException ex) &#123;</span><br><span class="line">    System.out.printf(<span class="string">"%s can't be formatted!%n"</span>, arrivalDate);</span><br><span class="line">    ex.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Java-8-æ—¥æœŸæ—¶é—´-API-çš„é‡ç‚¹"><a href="#Java-8-æ—¥æœŸæ—¶é—´-API-çš„é‡ç‚¹" class="headerlink" title="Java 8 æ—¥æœŸæ—¶é—´ API çš„é‡ç‚¹"></a>Java 8 æ—¥æœŸæ—¶é—´ API çš„é‡ç‚¹</h3><p>é€šè¿‡è¿™äº›ä¾‹å­ï¼Œä½ è‚¯å®šå·²ç»æŒæ¡äº† Java 8 æ—¥æœŸæ—¶é—´ API çš„æ–°çŸ¥è¯†ç‚¹ã€‚ç°åœ¨æ¥å›é¡¾ä¸€ä¸‹è¿™ä¸ªä¼˜é›… API çš„ä½¿ç”¨è¦ç‚¹ï¼š</p><p>1ï¼‰æä¾›äº† javax.time.ZoneId è·å–æ—¶åŒºã€‚</p><p>2ï¼‰æä¾›äº† LocalDate å’Œ LocalTime ç±»ã€‚</p><p>3ï¼‰Java 8 çš„æ‰€æœ‰æ—¥æœŸå’Œæ—¶é—´ API éƒ½æ˜¯ä¸å¯å˜ç±»å¹¶ä¸”çº¿ç¨‹å®‰å…¨ï¼Œè€Œç°æœ‰çš„ Date å’Œ Calendar API ä¸­çš„ java.util.Date å’ŒSimpleDateFormat æ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚</p><p>4ï¼‰ä¸»åŒ…æ˜¯ java.time, åŒ…å«äº†è¡¨ç¤ºæ—¥æœŸã€æ—¶é—´ã€æ—¶é—´é—´éš”çš„ä¸€äº›ç±»ã€‚é‡Œé¢æœ‰ä¸¤ä¸ªå­åŒ… java.time.format ç”¨äºæ ¼å¼åŒ–ï¼Œ java.time.temporal ç”¨äºæ›´åº•å±‚çš„æ“ä½œã€‚</p><p>5ï¼‰æ—¶åŒºä»£è¡¨äº†åœ°çƒä¸ŠæŸä¸ªåŒºåŸŸå†…æ™®éä½¿ç”¨çš„æ ‡å‡†æ—¶é—´ã€‚æ¯ä¸ªæ—¶åŒºéƒ½æœ‰ä¸€ä¸ªä»£å·ï¼Œæ ¼å¼é€šå¸¸ç”±åŒºåŸŸ/åŸå¸‚æ„æˆï¼ˆAsia/Tokyoï¼‰ï¼Œåœ¨åŠ ä¸Šä¸æ ¼æ—å¨æ²»æˆ– UTC çš„æ—¶å·®ã€‚ä¾‹å¦‚ï¼šä¸œäº¬çš„æ—¶å·®æ˜¯ +09:00ã€‚</p><p>6ï¼‰OffsetDateTime ç±»å®é™…ä¸Šç»„åˆäº† LocalDateTime ç±»å’Œ ZoneOffset ç±»ã€‚ç”¨æ¥è¡¨ç¤ºåŒ…å«å’Œæ ¼æ—å¨æ²»æˆ– UTC æ—¶å·®çš„å®Œæ•´æ—¥æœŸï¼ˆå¹´ã€æœˆã€æ—¥ï¼‰å’Œæ—¶é—´ï¼ˆæ—¶ã€åˆ†ã€ç§’ã€çº³ç§’ï¼‰ä¿¡æ¯ã€‚</p><p>7ï¼‰DateTimeFormatter ç±»ç”¨æ¥æ ¼å¼åŒ–å’Œè§£ææ—¶é—´ã€‚ä¸ SimpleDateFormat ä¸åŒï¼Œè¿™ä¸ªç±»ä¸å¯å˜å¹¶ä¸”çº¿ç¨‹å®‰å…¨ï¼Œéœ€è¦æ—¶å¯ä»¥ç»™é™æ€å¸¸é‡èµ‹å€¼ã€‚ DateTimeFormatter ç±»æä¾›äº†å¤§é‡çš„å†…ç½®æ ¼å¼åŒ–å·¥å…·ï¼ŒåŒæ—¶ä¹Ÿå…è®¸ä½ è‡ªå®šä¹‰ã€‚åœ¨è½¬æ¢æ–¹é¢ä¹Ÿæä¾›äº† parse() å°†å­—ç¬¦ä¸²è§£ææˆæ—¥æœŸï¼Œå¦‚æœè§£æå‡ºé”™ä¼šæŠ›å‡º DateTimeParseExceptionã€‚DateTimeFormatter ç±»åŒæ—¶è¿˜æœ‰format() ç”¨æ¥æ ¼å¼åŒ–æ—¥æœŸï¼Œå¦‚æœå‡ºé”™ä¼šæŠ›å‡º DateTimeExceptionå¼‚å¸¸ã€‚</p><p>8ï¼‰å†è¡¥å……ä¸€ç‚¹ï¼Œæ—¥æœŸæ ¼å¼â€œMMM d yyyyâ€å’Œâ€œMMM dd yyyyâ€æœ‰ä¸€äº›å¾®å¦™çš„ä¸åŒï¼Œç¬¬ä¸€ä¸ªæ ¼å¼å¯ä»¥è§£æâ€œJan 2 2014â€å’Œâ€œJan 14 2014â€ï¼Œè€Œç¬¬äºŒä¸ªåœ¨è§£æâ€œJan 2 2014â€å°±ä¼šæŠ›å¼‚å¸¸ï¼Œå› ä¸ºç¬¬äºŒä¸ªæ ¼å¼é‡Œè¦æ±‚æ—¥å¿…é¡»æ˜¯ä¸¤ä½çš„ã€‚å¦‚æœæƒ³ä¿®æ­£ï¼Œä½ å¿…é¡»åœ¨æ—¥æœŸåªæœ‰ä¸ªä½æ•°æ—¶åœ¨å‰é¢è¡¥é›¶ï¼Œå°±æ˜¯è¯´â€œJan 2 2014â€åº”è¯¥å†™æˆ â€œJan 02 2014â€ã€‚</p><h3 id="ç›¸å…³æ–‡ç« "><a href="#ç›¸å…³æ–‡ç« " class="headerlink" title="ç›¸å…³æ–‡ç« "></a>ç›¸å…³æ–‡ç« </h3><p><a href="http://www.54tianzhisheng.cn/2018/06/19/SimpleDateFormat/" target="_blank" rel="noopener">SimpleDateFormat å¦‚ä½•å®‰å…¨çš„ä½¿ç”¨ï¼Ÿ</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://ws2.sinaimg.cn/large/006tKfTcgy1fsho6kitc6j31hc0zkdr7.jpg&quot; alt=&quot;002&quot;&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="Java" scheme="http://yoursite.com/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>SimpleDateFormat å¦‚ä½•å®‰å…¨çš„ä½¿ç”¨ï¼Ÿ</title>
    <link href="http://yoursite.com/2018/06/19/SimpleDateFormat/"/>
    <id>http://yoursite.com/2018/06/19/SimpleDateFormat/</id>
    <published>2018-06-18T16:00:00.000Z</published>
    <updated>2018-06-20T07:25:33.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1fshewu3v3yj31hc0zkwix.jpg" alt="001"></p><a id="more"></a><h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>ä¸ºä»€ä¹ˆä¼šå†™è¿™ç¯‡æ–‡ç« ï¼Ÿå› ä¸ºè¿™äº›å¤©åœ¨çœ‹ã€Šé˜¿é‡Œå·´å·´å¼€å‘æ‰‹å†Œè¯¦å°½ç‰ˆã€‹ï¼Œæ²¡çœ‹è¿‡çš„å¯ä»¥å…³æ³¨å¾®ä¿¡å…¬ä¼—å·ï¼š<strong>zhisheng</strong>ï¼Œå›å¤å…³é”®å­—ï¼š<strong>é˜¿é‡Œå·´å·´å¼€å‘æ‰‹å†Œè¯¦å°½ç‰ˆ</strong>  å°±å¯ä»¥è·å¾—ã€‚</p><h3 id="å…³æ³¨æˆ‘"><a href="#å…³æ³¨æˆ‘" class="headerlink" title="å…³æ³¨æˆ‘"></a>å…³æ³¨æˆ‘</h3><p><img src="http://ohfk1r827.bkt.clouddn.com/blog/180103/C6LG3mGa12.jpg" alt="mark"></p><p>è½¬è½½è¯·åŠ¡å¿…æ³¨æ˜åŸåˆ›åœ°å€ä¸ºï¼š<a href="http://www.54tianzhisheng.cn/2018/06/19/SimpleDateFormat/" target="_blank" rel="noopener">http://www.54tianzhisheng.cn/2018/06/19/SimpleDateFormat/</a></p><p>åœ¨çœ‹çš„è¿‡ç¨‹ä¸­æœ‰è¿™ä¹ˆä¸€æ¡ï¼š</p><blockquote><p><strong>ã€å¼ºåˆ¶ã€‘SimpleDateFormat æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ç±»ï¼Œä¸€èˆ¬ä¸è¦å®šä¹‰ä¸º static å˜é‡ï¼Œå¦‚æœå®šä¹‰ä¸º staticï¼Œå¿…é¡»åŠ é”ï¼Œæˆ–è€…ä½¿ç”¨ DateUtils å·¥å…·ç±»ã€‚ </strong></p></blockquote><p>çœ‹åˆ°è¿™æ¡æˆ‘ç«‹é©¬å°±æƒ³èµ·äº†æˆ‘å®ä¹ çš„æ—¶å€™æœ‰ä¸ªé¡¹ç›®é‡Œé¢å°±çŠ¯äº†è¿™ä¸ªé”™è¯¯ï¼Œè®°å¾—å½“æ—¶æ˜¯è¿™æ ·å†™çš„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> SimpleDateFormat df = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyyMMddHHmmss"</span>);</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æ‰è®¤çœŸçš„å»ç ”ç©¶ä¸‹è¿™ä¸ª SimpleDateFormatï¼Œæ‰€ä»¥æ‰æœ‰äº†è¿™ç¯‡æ–‡ç« ã€‚</p><h3 id="å®ƒæ˜¯è°ï¼Ÿ"><a href="#å®ƒæ˜¯è°ï¼Ÿ" class="headerlink" title="å®ƒæ˜¯è°ï¼Ÿ"></a>å®ƒæ˜¯è°ï¼Ÿ</h3><p>æƒ³å¿…å¤§å®¶å¯¹ <code>SimpleDateFormat</code> å¹¶ä¸é™Œç”Ÿã€‚<code>SimpleDateFormat</code>  æ˜¯ Java ä¸­ä¸€ä¸ªéå¸¸å¸¸ç”¨çš„ç±»ï¼Œä»–æ˜¯ä»¥åŒºåŸŸæ•æ„Ÿçš„æ–¹å¼æ ¼å¼åŒ–å’Œè§£ææ—¥æœŸçš„å…·ä½“ç±»ã€‚ å®ƒå…è®¸æ ¼å¼åŒ– (date -&gt; text)ã€è¯­æ³•åˆ†æ (text -&gt; date)å’Œæ ‡å‡†åŒ–ã€‚</p><p><code>SimpleDateFormat</code> å…è®¸ä»¥ä»»ä½•ç”¨æˆ·æŒ‡å®šçš„æ—¥æœŸ-æ—¶é—´æ ¼å¼æ–¹å¼å¯åŠ¨ã€‚ ä½†æ˜¯ï¼Œå»ºè®®ä½¿ç”¨ <code>DateFormat</code> ä¸­çš„ <code>getTimeInstance</code>ã€ <code>getDateInstance</code> æˆ– <code>getDateTimeInstance</code> æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªæ—¥æœŸ-æ—¶é—´æ ¼å¼ã€‚ è¿™å‡ ä¸ªæ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªé»˜è®¤çš„æ—¥æœŸï¼æ—¶é—´æ ¼å¼ã€‚ ä½ å¯ä»¥æ ¹æ®éœ€è¦ç”¨ <code>applyPattern</code> æ–¹æ³•ä¿®æ”¹æ ¼å¼æ–¹å¼ã€‚</p><h3 id="æ—¥æœŸæ—¶é—´æ ¼å¼"><a href="#æ—¥æœŸæ—¶é—´æ ¼å¼" class="headerlink" title="æ—¥æœŸæ—¶é—´æ ¼å¼"></a>æ—¥æœŸæ—¶é—´æ ¼å¼</h3><p>æ—¥æœŸå’Œæ—¶é—´æ ¼å¼ç”± <strong>æ—¥æœŸå’Œæ—¶é—´æ¨¡å¼å­—ç¬¦ä¸²</strong> æŒ‡å®šã€‚åœ¨ <strong>æ—¥æœŸå’Œæ—¶é—´æ¨¡å¼å­—ç¬¦ä¸²</strong> ä¸­ï¼ŒæœªåŠ å¼•å·çš„å­—æ¯ â€˜Aâ€™ åˆ° â€˜Zâ€™ å’Œ â€˜aâ€™ åˆ° â€˜zâ€™ è¢«è§£é‡Šä¸ºæ¨¡å¼å­—æ¯ï¼Œç”¨æ¥è¡¨ç¤ºæ—¥æœŸæˆ–æ—¶é—´å­—ç¬¦ä¸²å…ƒç´ ã€‚æ–‡æœ¬å¯ä»¥ä½¿ç”¨å•å¼•å· (â€˜) å¼•èµ·æ¥ï¼Œä»¥å…è¿›è¡Œè§£é‡Šã€‚æ‰€æœ‰å…¶ä»–å­—ç¬¦å‡ä¸è§£é‡Šï¼Œåªæ˜¯åœ¨æ ¼å¼åŒ–æ—¶å°†å®ƒä»¬ç®€å•å¤åˆ¶åˆ°è¾“å‡ºå­—ç¬¦ä¸²ã€‚</p><p>ç®€å•çš„è®²ï¼šè¿™äº› A â€”â€”Zï¼Œa â€”â€” z è¿™äº›å­—æ¯(ä¸è¢«å•å¼•å·åŒ…å›´çš„)ä¼šè¢«ç‰¹æ®Šå¤„ç†æ›¿æ¢ä¸ºå¯¹åº”çš„æ—¥æœŸæ—¶é—´ï¼Œå…¶ä»–çš„å­—ç¬¦ä¸²è¿˜æ˜¯åŸæ ·è¾“å‡ºã€‚</p><p>æ—¥æœŸå’Œæ—¶é—´æ¨¡å¼(<strong>æ³¨æ„å¤§å°å†™ï¼Œä»£è¡¨çš„å«ä¹‰æ˜¯ä¸åŒçš„</strong>)å¦‚ä¸‹ï¼š</p><p><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1fshewuz8vij30vm150tfw.jpg" alt="2018-06-19_11-17-43"></p><h3 id="æ€ä¹ˆä½¿ç”¨ï¼Ÿ"><a href="#æ€ä¹ˆä½¿ç”¨ï¼Ÿ" class="headerlink" title="æ€ä¹ˆä½¿ç”¨ï¼Ÿ"></a>æ€ä¹ˆä½¿ç”¨ï¼Ÿ</h3><p>æ—¥æœŸï¼æ—¶é—´æ ¼å¼æ¨¡ç‰ˆæ ·ä¾‹ï¼šï¼ˆç»™çš„æ—¶é—´æ˜¯ï¼š2001-07-04 12:08:56  U.S. Pacific Time time zoneï¼‰</p><p><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1fshewwuu6pj30x20mqwio.jpg" alt="2018-06-19_11-27-39"></p><p>ä½¿ç”¨æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by zhisheng_tian on 2018/6/19</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FormatDateTime</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SimpleDateFormat myFmt = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyyå¹´MMæœˆddæ—¥ HHæ—¶mmåˆ†ssç§’"</span>);</span><br><span class="line">        SimpleDateFormat myFmt1 = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yy/MM/dd HH:mm"</span>);</span><br><span class="line">        SimpleDateFormat myFmt2 = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);<span class="comment">//ç­‰ä»·äºnow.toLocaleString()</span></span><br><span class="line">        SimpleDateFormat myFmt3 = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyyå¹´MMæœˆddæ—¥ HHæ—¶mmåˆ†ssç§’ E "</span>);</span><br><span class="line">        SimpleDateFormat myFmt4 = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"ä¸€å¹´ä¸­çš„ç¬¬ D å¤© ä¸€å¹´ä¸­ç¬¬wä¸ªæ˜ŸæœŸ ä¸€æœˆä¸­ç¬¬Wä¸ªæ˜ŸæœŸ åœ¨ä¸€å¤©ä¸­kæ—¶ zæ—¶åŒº"</span>);</span><br><span class="line">        Date now = <span class="keyword">new</span> Date();</span><br><span class="line">        System.out.println(myFmt.format(now));</span><br><span class="line">        System.out.println(myFmt1.format(now));</span><br><span class="line">        System.out.println(myFmt2.format(now));</span><br><span class="line">        System.out.println(myFmt3.format(now));</span><br><span class="line">        System.out.println(myFmt4.format(now));</span><br><span class="line">        System.out.println(now.toGMTString());</span><br><span class="line">        System.out.println(now.toLocaleString());</span><br><span class="line">        System.out.println(now.toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœæ˜¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">2018å¹´06æœˆ19æ—¥ 23æ—¶10åˆ†05ç§’</span><br><span class="line">18/06/19 23:10</span><br><span class="line">2018-06-19 23:10:05</span><br><span class="line">2018å¹´06æœˆ19æ—¥ 23æ—¶10åˆ†05ç§’ æ˜ŸæœŸäºŒ</span><br><span class="line">ä¸€å¹´ä¸­çš„ç¬¬ 170 å¤© ä¸€å¹´ä¸­ç¬¬25ä¸ªæ˜ŸæœŸ ä¸€æœˆä¸­ç¬¬4ä¸ªæ˜ŸæœŸ åœ¨ä¸€å¤©ä¸­23æ—¶ CSTæ—¶åŒº</span><br><span class="line">19 Jun 2018 15:10:05 GMT</span><br><span class="line">2018-6-19 23:10:05</span><br><span class="line">Tue Jun 19 23:10:05 CST 2018</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼Œå°±æ˜¯å…ˆè‡ªå·±å®šä¹‰å¥½æ—¶é—´ï¼æ—¥æœŸæ¨¡ç‰ˆï¼Œç„¶åè°ƒç”¨ format æ–¹æ³•ï¼ˆä¼ å…¥ä¸€ä¸ªæ—¶é—´ Date å‚æ•°ï¼‰ã€‚</p><p>ä¸Šé¢çš„æ˜¯æ—¥æœŸè½¬æ¢æˆè‡ªå·±æƒ³è¦çš„å­—ç¬¦ä¸²æ ¼å¼ã€‚ä¸‹é¢åè¿‡æ¥ï¼Œå°†å­—ç¬¦ä¸²ç±»å‹è£…æ¢æˆæ—¥æœŸç±»å‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.text.ParseException;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by zhisheng_tian on 2018/6/19</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StringFormatDate</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String time1 = <span class="string">"2018å¹´06æœˆ19æ—¥ 23æ—¶10åˆ†05ç§’"</span>;</span><br><span class="line">        String time2 = <span class="string">"18/06/19 23:10"</span>;</span><br><span class="line">        String time3 = <span class="string">"2018-06-19 23:10:05"</span>;</span><br><span class="line">        String time4 = <span class="string">"2018å¹´06æœˆ19æ—¥ 23æ—¶10åˆ†05ç§’ æ˜ŸæœŸäºŒ"</span>;</span><br><span class="line"></span><br><span class="line">        SimpleDateFormat myFmt = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyyå¹´MMæœˆddæ—¥ HHæ—¶mmåˆ†ssç§’"</span>);</span><br><span class="line">        SimpleDateFormat myFmt1 = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yy/MM/dd HH:mm"</span>);</span><br><span class="line">        SimpleDateFormat myFmt2 = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);<span class="comment">//ç­‰ä»·äºnow.toLocaleString()</span></span><br><span class="line">        SimpleDateFormat myFmt3 = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyyå¹´MMæœˆddæ—¥ HHæ—¶mmåˆ†ssç§’ E"</span>);</span><br><span class="line"></span><br><span class="line">        Date date1 = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            date1 = myFmt.parse(time1);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ParseException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(date1);</span><br><span class="line"></span><br><span class="line">        Date date2 = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            date2 = myFmt1.parse(time2);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ParseException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(date2);</span><br><span class="line"></span><br><span class="line">        Date date3 = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            date3 = myFmt2.parse(time3);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ParseException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(date3);</span><br><span class="line"></span><br><span class="line">        Date date4 = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            date4 = myFmt3.parse(time4);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ParseException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(date4);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœæ˜¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Tue Jun 19 23:10:05 CST 2018</span><br><span class="line">Tue Jun 19 23:10:00 CST 2018</span><br><span class="line">Tue Jun 19 23:10:05 CST 2018</span><br><span class="line">Tue Jun 19 23:10:05 CST 2018</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªè½¬æ¢æ–¹æ³•ä¹Ÿå¾ˆç®€å•ã€‚ä½†æ˜¯ä¸è¦é«˜å…´çš„å¤ªæ—©ï¼Œä¸»è§’ä¸åœ¨è¿™ã€‚</p><h3 id="çº¿ç¨‹ä¸å®‰å…¨"><a href="#çº¿ç¨‹ä¸å®‰å…¨" class="headerlink" title="çº¿ç¨‹ä¸å®‰å…¨"></a>çº¿ç¨‹ä¸å®‰å…¨</h3><p><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1fsheww10htj31g40wedm3.jpg" alt="2018-06-19_23-56-29"></p><p>åœ¨ SimpleDateFormat ç±»çš„ JavaDoc ä¸­ï¼Œæè¿°äº†è¯¥ç±»ä¸èƒ½å¤Ÿä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œå»ºè®®ä¸ºæ¯ä¸ªçº¿ç¨‹åˆ›å»ºå•ç‹¬çš„æ—¥æœŸï¼æ—¶é—´æ ¼å¼å®ä¾‹ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ä¸€ä¸ªæ—¥æœŸï¼æ—¶é—´æ ¼å¼ï¼Œå®ƒå¿…é¡»åœ¨å¤–éƒ¨è¿›è¡ŒåŒæ­¥ã€‚é‚£ä¹ˆåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹è°ƒç”¨ format() å’Œ parse() æ–¹æ³•åº”è¯¥ä½¿ç”¨åŒæ­¥ä»£ç æ¥é¿å…é—®é¢˜ã€‚ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå…·ä½“çš„åœºæ™¯æ¥ä¸€æ­¥æ­¥çš„æ·±å…¥å­¦ä¹ å’Œç†è§£SimpleDateFormat ç±»ã€‚</p><p>1ã€æ¯ä¸ªçº¿ç¨‹åˆ›å»ºå•ç‹¬çš„æ—¥æœŸï¼æ—¶é—´æ ¼å¼å®ä¾‹</p><blockquote><p> å¤§é‡çš„åˆ›å»º SimpleDateFormat å®ä¾‹å¯¹è±¡ï¼Œç„¶åå†ä¸¢å¼ƒè¿™ä¸ªå¯¹è±¡ï¼Œå ç”¨å¤§é‡çš„å†…å­˜å’Œ JVM ç©ºé—´ã€‚</p></blockquote><p>2ã€åˆ›å»ºä¸€ä¸ªé™æ€çš„ SimpleDateFormat å®ä¾‹ï¼Œåœ¨ä½¿ç”¨æ—¶ç›´æ¥ä½¿ç”¨è¿™ä¸ªå®ä¾‹è¿›è¡Œæ“ä½œï¼ˆæˆ‘å½“æ—¶å°±æ˜¯è¿™ä¹ˆå¹²çš„ğŸ˜„ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> SimpleDateFormat df = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line">Date date = <span class="keyword">new</span> Date();</span><br><span class="line">df.format(date);</span><br></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œè¿™ä¸ªæ–¹æ³•çš„ç¡®å¾ˆä¸é”™ï¼Œåœ¨å¤§éƒ¨åˆ†çš„æ—¶é—´é‡Œé¢éƒ½ä¼šå·¥ä½œå¾—å¾ˆå¥½ï¼Œä½†ä¸€æ—¦åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä¸€å®šè´Ÿè½½æƒ…å†µä¸‹æ—¶ï¼Œè¿™ä¸ªé—®é¢˜å°±å‡ºæ¥äº†ã€‚ä»–ä¼šå‡ºç°å„ç§ä¸åŒçš„æƒ…å†µï¼Œæ¯”å¦‚è½¬åŒ–çš„æ—¶é—´ä¸æ­£ç¡®ï¼Œæ¯”å¦‚æŠ¥é”™ï¼Œæ¯”å¦‚çº¿ç¨‹è¢«æŒ‚æ­»ç­‰ç­‰ã€‚æˆ‘ä»¬çœ‹ä¸‹é¢çš„æµ‹è¯•ç”¨ä¾‹ï¼Œæ‹¿äº‹å®è¯´è¯ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.text.ParseException;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by zhisheng_tian on 2018/6/20</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DateUtils</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">formatDate</span><span class="params">(Date date)</span> <span class="keyword">throws</span> ParseException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sdf.format(date);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">parse</span><span class="params">(String strDate)</span> <span class="keyword">throws</span> ParseException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sdf.parse(strDate);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.text.ParseException;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by zhisheng_tian on 2018/6/20</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DateUtilsTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TestSimpleDateFormatThreadSafe</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">this</span>.join(<span class="number">2000</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e1) &#123;</span><br><span class="line">                    e1.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    System.out.println(<span class="keyword">this</span>.getName() + <span class="string">":"</span> + DateUtils.parse(<span class="string">"2018-06-20 01:18:20"</span>));</span><br><span class="line">                &#125; <span class="keyword">catch</span> (ParseException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">new</span> TestSimpleDateFormatThreadSafe().start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">Exception in thread <span class="string">"Thread-0"</span> Exception in thread <span class="string">"Thread-1"</span> java.lang.NumberFormatException: For input string: <span class="string">""</span></span><br><span class="line">at java.lang.NumberFormatException.forInputString(NumberFormatException.java:<span class="number">65</span>)</span><br><span class="line">at java.lang.Long.parseLong(Long.java:<span class="number">601</span>)</span><br><span class="line">at java.lang.Long.parseLong(Long.java:<span class="number">631</span>)</span><br><span class="line">at java.text.DigitList.getLong(DigitList.java:<span class="number">195</span>)</span><br><span class="line">at java.text.DecimalFormat.parse(DecimalFormat.java:<span class="number">2051</span>)</span><br><span class="line">at java.text.SimpleDateFormat.subParse(SimpleDateFormat.java:<span class="number">1869</span>)</span><br><span class="line">at java.text.SimpleDateFormat.parse(SimpleDateFormat.java:<span class="number">1514</span>)</span><br><span class="line">at java.text.DateFormat.parse(DateFormat.java:<span class="number">364</span>)</span><br><span class="line">at com.zhisheng.demo.date.DateUtils.parse(DateUtils.java:<span class="number">19</span>)</span><br><span class="line">at com.zhisheng.demo.date.DateUtilsTest$TestSimpleDateFormatThreadSafe.run(DateUtilsTest.java:<span class="number">19</span>)</span><br><span class="line">java.lang.NumberFormatException: For input string: <span class="string">".1818"</span></span><br><span class="line">at java.lang.NumberFormatException.forInputString(NumberFormatException.java:<span class="number">65</span>)</span><br><span class="line">at java.lang.Long.parseLong(Long.java:<span class="number">578</span>)</span><br><span class="line">at java.lang.Long.parseLong(Long.java:<span class="number">631</span>)</span><br><span class="line">at java.text.DigitList.getLong(DigitList.java:<span class="number">195</span>)</span><br><span class="line">at java.text.DecimalFormat.parse(DecimalFormat.java:<span class="number">2051</span>)</span><br><span class="line">at java.text.SimpleDateFormat.subParse(SimpleDateFormat.java:<span class="number">2162</span>)</span><br><span class="line">at java.text.SimpleDateFormat.parse(SimpleDateFormat.java:<span class="number">1514</span>)</span><br><span class="line">at java.text.DateFormat.parse(DateFormat.java:<span class="number">364</span>)</span><br><span class="line">at com.zhisheng.demo.date.DateUtils.parse(DateUtils.java:<span class="number">19</span>)</span><br><span class="line">at com.zhisheng.demo.date.DateUtilsTest$TestSimpleDateFormatThreadSafe.run(DateUtilsTest.java:<span class="number">19</span>)</span><br><span class="line">Thread-<span class="number">2</span>:Sat Jun <span class="number">20</span> <span class="number">01</span>:<span class="number">18</span>:<span class="number">20</span> CST <span class="number">2201</span></span><br><span class="line">Thread-<span class="number">2</span>:Wed Jun <span class="number">20</span> <span class="number">01</span>:<span class="number">18</span>:<span class="number">20</span> CST <span class="number">2018</span></span><br><span class="line">Thread-<span class="number">2</span>:Wed Jun <span class="number">20</span> <span class="number">01</span>:<span class="number">18</span>:<span class="number">20</span> CST <span class="number">2018</span></span><br><span class="line">Thread-<span class="number">2</span>:Wed Jun <span class="number">20</span> <span class="number">01</span>:<span class="number">18</span>:<span class="number">20</span> CST <span class="number">2018</span></span><br></pre></td></tr></table></figure><p>è¯´æ˜ï¼šThread-1å’ŒThread-0æŠ¥java.lang.NumberFormatException: multiple pointsé”™è¯¯ï¼Œç›´æ¥æŒ‚æ­»ï¼Œæ²¡èµ·æ¥ï¼›Thread-2 è™½ç„¶æ²¡æœ‰æŒ‚æ­»ï¼Œä½†è¾“å‡ºçš„æ—¶é—´æ˜¯æœ‰é”™è¯¯çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬è¾“å…¥çš„æ—¶é—´æ˜¯ï¼š2018-06-20 01:18:20 ï¼Œå½“ä¼šè¾“å‡ºï¼šSat Jun 20 01:18:20 CST 2201 è¿™æ ·çš„çµå¼‚äº‹ä»¶ã€‚</p><h3 id="Why"><a href="#Why" class="headerlink" title="Why?"></a>Why?</h3><p>ä¸ºä»€ä¹ˆä¼šå‡ºç°çº¿ç¨‹ä¸å®‰å…¨çš„é—®é¢˜å‘¢ï¼Ÿ</p><p>ä¸‹é¢æˆ‘ä»¬é€šè¿‡çœ‹ JDK æºç æ¥çœ‹çœ‹ä¸ºä»€ä¹ˆ SimpleDateFormat å’Œ DateFormat ç±»ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„çœŸæ­£åŸå› ï¼š</p><p>SimpleDateFormat ç»§æ‰¿äº† DateFormatï¼Œåœ¨ DateFormat ä¸­å®šä¹‰äº†ä¸€ä¸ª protected å±æ€§çš„ Calendar ç±»çš„å¯¹è±¡ï¼šcalendarã€‚åªæ˜¯å› ä¸º Calendar ç±»çš„æ¦‚å¿µå¤æ‚ï¼Œç‰µæ‰¯åˆ°æ—¶åŒºä¸æœ¬åœ°åŒ–ç­‰ç­‰ï¼ŒJDK çš„å®ç°ä¸­ä½¿ç”¨äº†æˆå‘˜å˜é‡æ¥ä¼ é€’å‚æ•°ï¼Œè¿™å°±é€ æˆåœ¨å¤šçº¿ç¨‹çš„æ—¶å€™ä¼šå‡ºç°é”™è¯¯ã€‚</p><p>åœ¨ SimpleDateFormat ä¸­çš„ format æ–¹æ³•æºç ä¸­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> StringBuffer <span class="title">format</span><span class="params">(Date date, StringBuffer toAppendTo,FieldPosition pos)</span> </span>&#123;</span><br><span class="line">  pos.beginIndex = pos.endIndex = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> format(date, toAppendTo, pos.getFieldDelegate());</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Called from Format after creating a FieldDelegate</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> StringBuffer <span class="title">format</span><span class="params">(Date date, StringBuffer toAppendTo,FieldDelegate delegate)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// Convert input date to time field list</span></span><br><span class="line">  calendar.setTime(date);</span><br><span class="line">  <span class="keyword">boolean</span> useDateFormatSymbols = useDateFormatSymbols();</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; compiledPattern.length; ) &#123;</span><br><span class="line">    <span class="keyword">int</span> tag = compiledPattern[i] &gt;&gt;&gt; <span class="number">8</span>;</span><br><span class="line">    <span class="keyword">int</span> count = compiledPattern[i++] &amp; <span class="number">0xff</span>;</span><br><span class="line">    <span class="keyword">if</span> (count == <span class="number">255</span>) &#123;</span><br><span class="line">      count = compiledPattern[i++] &lt;&lt; <span class="number">16</span>;</span><br><span class="line">      count |= compiledPattern[i++];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span> (tag) &#123;</span><br><span class="line">      <span class="keyword">case</span> TAG_QUOTE_ASCII_CHAR:</span><br><span class="line">        toAppendTo.append((<span class="keyword">char</span>)count);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> TAG_QUOTE_CHARS:</span><br><span class="line">        toAppendTo.append(compiledPattern, i, count);</span><br><span class="line">        i += count;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        subFormat(tag, count, delegate, toAppendTo, useDateFormatSymbols);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> toAppendTo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>calendar.setTime(date)  è¿™æ¡è¯­å¥æ”¹å˜äº† calendarï¼Œç¨åï¼Œcalendar è¿˜ä¼šç”¨åˆ°ï¼ˆåœ¨ subFormat æ–¹æ³•é‡Œï¼‰ï¼Œè€Œè¿™å°±æ˜¯å¼•å‘é—®é¢˜çš„æ ¹æºã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œåœ¨ä¸€ä¸ªå¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œæœ‰ä¸¤ä¸ªçº¿ç¨‹æŒæœ‰äº†åŒä¸€ä¸ª SimpleDateFormat çš„å®ä¾‹ï¼Œåˆ†åˆ«è°ƒç”¨format æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">çº¿ç¨‹ 1 è°ƒç”¨ format æ–¹æ³•ï¼Œæ”¹å˜äº† calendar è¿™ä¸ªå­—æ®µã€‚</span><br><span class="line">çº¿ç¨‹ 1 ä¸­æ–­äº†ã€‚</span><br><span class="line">çº¿ç¨‹ 2 å¼€å§‹æ‰§è¡Œï¼Œå®ƒä¹Ÿæ”¹å˜äº† calendarã€‚</span><br><span class="line">çº¿ç¨‹ 2 ä¸­æ–­äº†ã€‚</span><br><span class="line">çº¿ç¨‹ 1 å›æ¥äº†</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ï¼Œcalendar å·²ç„¶ä¸æ˜¯å®ƒæ‰€è®¾çš„å€¼ï¼Œè€Œæ˜¯èµ°ä¸Šäº†çº¿ç¨‹ 2 è®¾è®¡çš„é“è·¯ã€‚å¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶äº‰æŠ¢ calendar å¯¹è±¡ï¼Œåˆ™ä¼šå‡ºç°å„ç§é—®é¢˜ï¼Œæ—¶é—´ä¸å¯¹ï¼Œçº¿ç¨‹æŒ‚æ­»ç­‰ç­‰ã€‚</p><p>åˆ†æä¸€ä¸‹ format çš„å®ç°ï¼Œæˆ‘ä»¬ä¸éš¾å‘ç°ï¼Œç”¨åˆ°æˆå‘˜å˜é‡ calendarï¼Œå”¯ä¸€çš„å¥½å¤„ï¼Œå°±æ˜¯åœ¨è°ƒç”¨ subFormat æ—¶ï¼Œå°‘äº†ä¸€ä¸ªå‚æ•°ï¼Œå´å¸¦æ¥äº†è®¸å¤šçš„é—®é¢˜ã€‚å…¶å®ï¼Œåªè¦åœ¨è¿™é‡Œç”¨ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œä¸€è·¯ä¼ é€’ä¸‹å»ï¼Œæ‰€æœ‰é—®é¢˜éƒ½å°†è¿åˆƒè€Œè§£ã€‚</p><p>è¿™ä¸ªé—®é¢˜èƒŒåéšè—ç€ä¸€ä¸ªæ›´ä¸ºé‡è¦çš„é—®é¢˜â€“æ— çŠ¶æ€ï¼šæ— çŠ¶æ€æ–¹æ³•çš„å¥½å¤„ä¹‹ä¸€ï¼Œå°±æ˜¯å®ƒåœ¨å„ç§ç¯å¢ƒä¸‹ï¼Œéƒ½å¯ä»¥å®‰å…¨çš„è°ƒç”¨ã€‚è¡¡é‡ä¸€ä¸ªæ–¹æ³•æ˜¯å¦æ˜¯æœ‰çŠ¶æ€çš„ï¼Œå°±çœ‹å®ƒæ˜¯å¦æ”¹åŠ¨äº†å…¶å®ƒçš„ä¸œè¥¿ï¼Œæ¯”å¦‚å…¨å±€å˜é‡ï¼Œæ¯”å¦‚å®ä¾‹çš„å­—æ®µã€‚format æ–¹æ³•åœ¨è¿è¡Œè¿‡ç¨‹ä¸­æ”¹åŠ¨äº† SimpleDateFormat çš„ calendar å­—æ®µï¼Œæ‰€ä»¥ï¼Œå®ƒæ˜¯æœ‰çŠ¶æ€çš„ã€‚</p><p>è¿™ä¹ŸåŒæ—¶æé†’æˆ‘ä»¬åœ¨å¼€å‘å’Œè®¾è®¡ç³»ç»Ÿçš„æ—¶å€™æ³¨æ„ä¸‹ä¸€ä¸‹ä¸‰ç‚¹:</p><p><strong>1.è‡ªå·±å†™å…¬ç”¨ç±»çš„æ—¶å€™ï¼Œè¦å¯¹å¤šçº¿ç¨‹è°ƒç”¨æƒ…å†µä¸‹çš„åæœåœ¨æ³¨é‡Šé‡Œè¿›è¡Œæ˜ç¡®è¯´æ˜</strong></p><p><strong>2.å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œå¯¹æ¯ä¸€ä¸ªå…±äº«çš„å¯å˜å˜é‡éƒ½è¦æ³¨æ„å…¶çº¿ç¨‹å®‰å…¨æ€§</strong></p><p><strong>3.æˆ‘ä»¬çš„ç±»å’Œæ–¹æ³•åœ¨åšè®¾è®¡çš„æ—¶å€™ï¼Œè¦å°½é‡è®¾è®¡æˆæ— çŠ¶æ€çš„</strong></p><h3 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h3><p>1ã€<strong>éœ€è¦çš„æ—¶å€™åˆ›å»ºæ–°å®ä¾‹</strong></p><p><strong>è¯´æ˜ï¼š</strong>åœ¨éœ€è¦ç”¨åˆ° SimpleDateFormat çš„åœ°æ–¹æ–°å»ºä¸€ä¸ªå®ä¾‹ï¼Œä¸ç®¡ä»€ä¹ˆæ—¶å€™ï¼Œå°†æœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜çš„å¯¹è±¡ç”±å…±äº«å˜ä¸º<strong>å±€éƒ¨ç§æœ‰</strong>éƒ½èƒ½é¿å…å¤šçº¿ç¨‹é—®é¢˜ï¼Œä¸è¿‡ä¹ŸåŠ é‡äº†åˆ›å»ºå¯¹è±¡çš„è´Ÿæ‹…ã€‚åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¿™æ ·å…¶å®å¯¹æ€§èƒ½å½±å“æ¯”ä¸æ˜¯å¾ˆæ˜æ˜¾çš„ã€‚</p><p>2ã€<strong>ä½¿ç”¨åŒæ­¥ï¼šåŒæ­¥ SimpleDateFormat å¯¹è±¡</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.text.ParseException;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DateSyncUtil</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">formatDate</span><span class="params">(Date date)</span> <span class="keyword">throws</span> ParseException </span>&#123;</span><br><span class="line">        <span class="keyword">synchronized</span>(sdf) &#123;</span><br><span class="line">            <span class="keyword">return</span> sdf.format(date);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">parse</span><span class="params">(String strDate)</span> <span class="keyword">throws</span> ParseException </span>&#123;</span><br><span class="line">        <span class="keyword">synchronized</span>(sdf) &#123;</span><br><span class="line">            <span class="keyword">return</span> sdf.parse(strDate);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¯´æ˜ï¼š</strong>å½“çº¿ç¨‹è¾ƒå¤šæ—¶ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨è¯¥æ–¹æ³•æ—¶ï¼Œå…¶ä»–æƒ³è¦è°ƒç”¨æ­¤æ–¹æ³•çš„çº¿ç¨‹å°±è¦ block ç­‰å¾…ï¼Œå¤šçº¿ç¨‹å¹¶å‘é‡å¤§çš„æ—¶å€™ä¼šå¯¹æ€§èƒ½æœ‰ä¸€å®šçš„å½±å“ã€‚</p><p>3ã€<strong>ä½¿ç”¨ ThreadLocal</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import java.text.DateFormat;</span><br><span class="line">import java.text.ParseException;</span><br><span class="line">import java.text.SimpleDateFormat;</span><br><span class="line">import java.util.Date;</span><br><span class="line"></span><br><span class="line">public class ConcurrentDateUtil &#123;</span><br><span class="line"></span><br><span class="line">    private static ThreadLocal&lt;DateFormat&gt; threadLocal = new ThreadLocal&lt;DateFormat&gt;() &#123;</span><br><span class="line">        @Override</span><br><span class="line">        protected DateFormat initialValue() &#123;</span><br><span class="line">            return new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    public static Date parse(String dateStr) throws ParseException &#123;</span><br><span class="line">        return threadLocal.get().parse(dateStr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static String format(Date date) &#123;</span><br><span class="line">        return threadLocal.get().format(date);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¯´æ˜ï¼š</strong>ä½¿ç”¨ ThreadLocal, ä¹Ÿæ˜¯å°†å…±äº«å˜é‡å˜ä¸ºç‹¬äº«ï¼Œçº¿ç¨‹ç‹¬äº«è‚¯å®šèƒ½æ¯”æ–¹æ³•ç‹¬äº«åœ¨å¹¶å‘ç¯å¢ƒä¸­èƒ½å‡å°‘ä¸å°‘åˆ›å»ºå¯¹è±¡çš„å¼€é”€ã€‚å¦‚æœå¯¹æ€§èƒ½è¦æ±‚æ¯”è¾ƒé«˜çš„æƒ…å†µä¸‹ï¼Œä¸€èˆ¬æ¨èä½¿ç”¨è¿™ç§æ–¹æ³•ã€‚</p><h3 id="Java-8-ä¸­çš„è§£å†³åŠæ³•"><a href="#Java-8-ä¸­çš„è§£å†³åŠæ³•" class="headerlink" title="Java 8 ä¸­çš„è§£å†³åŠæ³•"></a>Java 8 ä¸­çš„è§£å†³åŠæ³•</h3><p>Java 8 æä¾›äº†æ–°çš„æ—¥æœŸæ—¶é—´ APIï¼Œå…¶ä¸­åŒ…æ‹¬ç”¨äºæ—¥æœŸæ—¶é—´æ ¼å¼åŒ–çš„ DateTimeFormatterï¼Œå®ƒä¸ SimpleDateFormat æœ€å¤§çš„åŒºåˆ«åœ¨äºï¼šDateTimeFormatter æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè€Œ SimpleDateFormat å¹¶ä¸æ˜¯çº¿ç¨‹å®‰å…¨ã€‚</p><p><strong>DateTimeFormatter å¦‚ä½•ä½¿ç”¨ï¼š</strong></p><p>è§£ææ—¥æœŸ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">String dateStr= <span class="string">"2018å¹´06æœˆ20æ—¥"</span>;</span><br><span class="line">DateTimeFormatter formatter = DateTimeFormatter.ofPattern(<span class="string">"yyyyå¹´MMæœˆddæ—¥"</span>);   </span><br><span class="line">LocalDate date= LocalDate.parse(dateStr, formatter);</span><br></pre></td></tr></table></figure><p>æ—¥æœŸè½¬æ¢ä¸ºå­—ç¬¦ä¸²</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">LocalDateTime now = LocalDateTime.now();  </span><br><span class="line">DateTimeFormatter format = DateTimeFormatter.ofPattern(<span class="string">"yyyyå¹´MMæœˆddæ—¥ hh:mm a"</span>);</span><br><span class="line">String nowStr = now .format(format);</span><br></pre></td></tr></table></figure><p>ç”± DateTimeFormatter çš„é™æ€æ–¹æ³• ofPattern() æ„å»ºæ—¥æœŸæ ¼å¼ï¼ŒLocalDateTime å’Œ LocalDate ç­‰ä¸€äº›è¡¨ç¤ºæ—¥æœŸæˆ–æ—¶é—´çš„ç±»ä½¿ç”¨ parse å’Œ format æ–¹æ³•æŠŠæ—¥æœŸå’Œå­—ç¬¦ä¸²åšè½¬æ¢ã€‚</p><p>ä½¿ç”¨æ–°çš„ APIï¼Œæ•´ä¸ªè½¬æ¢è¿‡ç¨‹éƒ½ä¸éœ€è¦è€ƒè™‘çº¿ç¨‹å®‰å…¨çš„é—®é¢˜ã€‚</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>SimpleDateFormat æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ç±»ï¼Œå¤šçº¿ç¨‹ç¯å¢ƒä¸‹æ³¨æ„çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œå¦‚æœæ˜¯ Java 8 ï¼Œå»ºè®®ä½¿ç”¨ DateTimeFormatter ä»£æ›¿ SimpleDateFormatã€‚</p><h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><p><a href="">http://www.cnblogs.com/peida/archive/2013/05/31/3070790.html</a></p><h3 id="ç›¸å…³æ–‡ç« "><a href="#ç›¸å…³æ–‡ç« " class="headerlink" title="ç›¸å…³æ–‡ç« "></a>ç›¸å…³æ–‡ç« </h3><p><a href="http://www.54tianzhisheng.cn/2018/06/20/java-8-date/" target="_blank" rel="noopener">20 ä¸ªæ¡ˆä¾‹æ•™ä½ åœ¨ Java 8 ä¸­å¦‚ä½•å¤„ç†æ—¥æœŸå’Œæ—¶é—´?</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://ws2.sinaimg.cn/large/006tKfTcgy1fshewu3v3yj31hc0zkwix.jpg&quot; alt=&quot;001&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="Java" scheme="http://yoursite.com/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>è‹¦é€¼çš„æ¯•ä¸šè®ºæ–‡ç»å†</title>
    <link href="http://yoursite.com/2018/05/26/paper/"/>
    <id>http://yoursite.com/2018/05/26/paper/</id>
    <published>2018-05-25T16:00:00.000Z</published>
    <updated>2018-05-26T08:44:28.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1frou078h61j312c0vedse.jpg" alt="2018-05-26_15-01-42"></p><h3 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h3><p>æœ€è¿‘ä¸€ç›´åœ¨å­¦æ ¡å¿™æ¯•ä¸šè®ºæ–‡çš„äº‹ï¼ŒæŠ±æ­‰äº†ï¼Œå¾ˆé•¿ä¸€æ®µæ—¶é—´æ²¡æ›´æ–°æ–‡ç« äº†ï¼Œä»Šå¤©æ˜ŸæœŸå…­ï¼Œæ˜¨å¤©æ˜ŸæœŸäº”ï¼Œå¹¸å¥½æ‰€æœ‰èµ„æ–™éƒ½åœ¨å‘¨æœ«å‰äº¤é½äº†ï¼Œæ˜¨æ™šè¿˜åˆ°å‚åŠ ç­ä¸Šçš„èšä¼šï¼Œä¹Ÿå–äº†ä¸å°‘é…’ï¼Œä½†å¹¸å¥½æ²¡é†‰ï¼Œä¸ç„¶ä»Šå¤©è‚¯å®šä¸ä¼šå†™ä¸‹è¿™ç¯‡æ–‡ç« çš„ã€‚è¿™ç¯‡æ–‡ç« å°±æŠŠä»æ¥è§¦åˆ°æ¯•ä¸šè®ºæ–‡æŒ‡å¯¼è€å¸ˆåˆ°ç°åœ¨çš„è¿™åŠå¹´æ—¶é—´æœ‰å…³æ¯•ä¸šè®ºæ–‡çš„äº‹éƒ½è®²è®²ï¼Œå¸Œæœ›èƒ½å¤Ÿç•™ä¸‹ç‚¹å›å¿†ï¼<br><a id="more"></a><br><img src="https://ws3.sinaimg.cn/large/006tNc79gy1frou087a7wj312q11ktmm.jpg" alt="2018-05-26_15-02-15"></p><h3 id="æ¯•è®¾å°åˆ†é˜Ÿæˆç«‹"><a href="#æ¯•è®¾å°åˆ†é˜Ÿæˆç«‹" class="headerlink" title="æ¯•è®¾å°åˆ†é˜Ÿæˆç«‹"></a>æ¯•è®¾å°åˆ†é˜Ÿæˆç«‹</h3><p>å­¦æ ¡ä¼šç»™æ¯ä¸ªæ¯•ä¸šå¯¼å¸ˆå®‰æ’å¸¦å‡ ä¸ªå­¦ç”Ÿï¼ˆ7ï½8 äººå·¦å³ï¼‰ï¼Œä½†æ˜¯åœ¨å­¦æ ¡å‘å‡ºè¡¨æ ¼ä¹‹å‰ï¼Œè°ä¹Ÿä¸çŸ¥é“è‡ªå·±å°†ä¼šç”±å“ªä¸ªå¯¼å¸ˆå¸¦ï¼Œç”šè‡³ä½ ä¼šå‘ç°å°±ç®—å­¦æ ¡å‘å‡ºè¡¨æ ¼åçœ‹åˆ°è‡ªå·±å¯¼å¸ˆåå­—åï¼Œè‡ªå·±éƒ½ä¸çŸ¥é“è¿™å¯¼å¸ˆæ˜¯è°ï¼Ÿæ˜¯ç”·æ˜¯å¥³ï¼Ÿï¼ˆå½“æŸä¸ªå¯¼å¸ˆçš„åå­—æ¯”è¾ƒä¸­æ€§çš„æ—¶å€™ï¼‰åˆ°åº•å¥½ä¸å¥½ç›¸å¤„ï¼Ÿæ€§æ ¼å’‹æ ·ï¼Ÿä»–çš„è”ç³»æ–¹å¼ï¼ˆæ‰‹æœº æˆ–è€… QQï¼‰ï¼ŒWTFï¼Œä¸€ä¸ªéƒ½ä¸çŸ¥é“ï¼Ÿè‹¦é€¼äº†ï¼Œåé¢ä¹Ÿæ˜¯é€šè¿‡é—®è¾…å¯¼å‘˜æ‰çŸ¥é“è¿™äº›æƒ…å†µã€‚åé¢æˆ‘ä»¬å‡ ä¸ªäººä¸­å°±æœ‰ä¸€ä¸ªå¸¦å¤´å»ºäº†ä¸ª QQ ç¾¤ï¼ˆæ¯•è®¾å°åˆ†é˜Ÿï¼‰ï¼Œå¹¶æŠŠæŒ‡å¯¼è€å¸ˆæ‹‰è¿›ç¾¤äº†ã€‚</p><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1frou05sjbgj30ss0hkjta.jpg" alt="qq"></p><p>å°±è¿™æ ·ï¼Œæˆ‘ä»¬ç»ˆäºå¼€å§‹äº†æ¯•è®¾å°åˆ†é˜Ÿä¹‹æ—…ï¼</p><h3 id="å®ä¹ æ—¶çš„æ¯•è®¾çŠ¶æ€"><a href="#å®ä¹ æ—¶çš„æ¯•è®¾çŠ¶æ€" class="headerlink" title="å®ä¹ æ—¶çš„æ¯•è®¾çŠ¶æ€"></a>å®ä¹ æ—¶çš„æ¯•è®¾çŠ¶æ€</h3><p>2017.12æœˆé‚£æ—¶æ˜¯è¿˜åœ¨å…¬å¸å®ä¹ çš„ï¼Œåˆ°äº†æ¯•ä¸šè®¾è®¡é€‰é¢˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯¼å¸ˆè¿˜å¥½ï¼Œç»™æˆ‘ä»¬æ¯ä¸ªäººå¾ˆè‡ªç”±çš„é€‰æ‹©ï¼Œä½ å¯ä»¥è‡ªæ‹Ÿé¢˜ç›®ï¼Œä¹Ÿå¯ä»¥ä»å¯¼å¸ˆé‚£é‡ŒæŒ‘é€‰é¢˜ç›®ã€‚ä¸è¿‡æˆ‘çœ‹äº†ä¸‹è€å¸ˆç»™çš„é¢˜ç›®ï¼Œå¤§éƒ½æ˜¯æ·±åº¦å­¦ä¹ ã€æœºå™¨å­¦ä¹ åšçš„ç›¸å…³å›¾åƒè¯†åˆ«ã€æ¨èç³»ç»Ÿã€æœç´¢ç³»ç»Ÿã€äººè„¸è¯†åˆ«ã€ç½‘ç»œæµé‡ç›‘æ§ã€æ–‡æœ¬æƒ…æ„Ÿåˆ†æç­‰é«˜å¤§ä¸Šçš„è¯¾é¢˜ã€‚è‡£å¦¾åšä¸åˆ°ï¼Œæ¯•ç«Ÿè¿™éƒ½æ˜¯ç ”ç©¶ç”Ÿæ‰ä¼šç ”ç©¶ç‚¹æ–¹å‘ï¼Œè€å¸ˆä¼šå‘å‡ºæ¥è¿™äº›é¢˜ç›®å¯èƒ½ä¹Ÿæ˜¯å’Œå¥¹è‡ªå·±åœ¨ç ”ç©¶å­¦ä¹ çš„ç›¸å…³çŸ¥è¯†æœ‰å…³ï¼ˆå› ä¸ºæˆ‘åæ¥ç»™å¯¼å¸ˆæ£€æŸ¥æˆ‘çš„ç³»ç»Ÿçš„æ—¶å€™å°±æ˜¯å¯¼å¸ˆå¸¦çš„ä¸€ä¸ªç ”ç©¶ç”Ÿæ£€æŸ¥çš„ï¼ŒæœŸé—´é‚£ä¸ªå­¦é•¿å’Œæˆ‘è¯´ä»–æœ€è¿‘å°±åœ¨åšæ–‡æœ¬æƒ…æ„Ÿåˆ†æç›¸å…³çš„ä¸€ä¸ªé¡¹ç›®ï¼Œå› ä¸ºçœ‹åˆ°æˆ‘é¡¹ç›®ä¸­çš„ä¸­æ–‡åˆ†è¯å™¨ï¼Œæ‰€ä»¥è¿˜å‘æˆ‘è¯·æ•™äº†ä¸‹ï¼Œæˆ‘äºæ˜¯æŠŠæˆ‘åŸæ¥å†™è¿‡çš„ä¸€ç¯‡ä¸­è‹±æ–‡åˆ†è¯å™¨æ‰¾å‡ºæ¥ç»™ä»–ä¸€ä¸ªä¸ªè§£é‡Šï¼‰ï¼Œæ‰€ä»¥å¯¼å¸ˆå¸Œæœ›åœ¨æˆ‘ä»¬è¿™é‡Œä¹Ÿèƒ½å¤Ÿæœ‰äººå»ç ”ç©¶ä¸‹è¿™æ–¹é¢çš„çŸ¥è¯†ï¼Œæ‹“å±•ä¸‹è§†é‡ã€‚ä½†æ˜¯ç”±äºåœ¨å…¬å¸å®ä¹ ï¼Œå·¥ä½œä¹‹å¤–è…¾å‡ºçš„æ—¶é—´ç¡®å®æœ‰é™ï¼Œæ²¡è¿™ä¹ˆå¤šæ—¶é—´å»å­¦ä¹ è¿™äº›ç‰¹åˆ«æ–°çš„ä¸œè¥¿ï¼Œè€Œä¸”è¿˜è¦åšå‡ºä¸€å®šçš„æˆæœå‡ºæ¥ï¼Œè¿™è¿˜æ˜¯æœ‰ç‚¹æŒ‘æˆ˜æ€§çš„ã€‚å¯¼å¸ˆè¯´ä½ å¯ä»¥è‡ªæ‹Ÿé¢˜ç›®ï¼Œæˆ–è€…æŠŠè‡ªå·±åœ¨å…¬å¸åšçš„é¡¹ç›®ä¼˜åŒ–åæ‹¿æ¥åšæ¯•è®¾é¡¹ç›®ã€‚äºæ˜¯ï¼Œæˆ‘é€‰æ‹©çš„æ˜¯æ‹¿è‡ªå·±ä»¥å‰å†™çš„é¡¹ç›®æ¥å½“æ¯•ä¸šè®ºæ–‡é¡¹ç›®äº†ï¼Œå› ä¸ºæ„Ÿè§‰é¡¹ç›®ä¹Ÿè¿˜è¡Œï¼Œæ‹¿æ¥åšæ¯•è®¾å®Œå…¨å¯ä»¥äº†ï¼Œæ‰€ä»¥åé¢è‡ªå·±ä¹Ÿå°±æ¯”è¾ƒè½»æ¾äº†ã€‚</p><h3 id="æ¯•è®¾æµç¨‹"><a href="#æ¯•è®¾æµç¨‹" class="headerlink" title="æ¯•è®¾æµç¨‹"></a>æ¯•è®¾æµç¨‹</h3><p>æŠŠè‡ªå·±çš„æ¯•è®¾é¢˜ç›®æŠ¥ç»™è€å¸ˆåï¼Œè€å¸ˆä¼šæ ¹æ®ä½ çš„é¢˜ç›®å®¡æ ¸æ˜¯å¦å¯ä»¥æ‹¿æ¥å½“æ¯•è®¾ã€‚ç„¶åå†è¦æ±‚ä½ æŠŠæ¯•ä¸šè®¾è®¡çš„å¼€é¢˜æŠ¥å‘Šä¹¦ï¼ˆè®ºæ–‡é¢˜ç›®ã€ç›®çš„ã€æ„ä¹‰ã€æ€ä¹ˆåšã€åšå‡ºä»€ä¹ˆæ•ˆæœã€ç›®æ ‡ä¹‹ç±»çš„ï¼‰å†™è¯¦ç»†ä¸Šäº¤ä¸Šå»ã€‚è¦ç»è¿‡å¯¼å¸ˆå’Œå­¦æ ¡çš„å®¡æ‰¹åæ‰èƒ½å¤Ÿæ­£å¼å¼€é¢˜ã€‚å¼€é¢˜åç¡®å®šåå‡ ä¹å°±å¯ä»¥å¼€å§‹å†™è‡ªå·±çš„é¡¹ç›®äº†ã€‚æœºæ™ºçš„æˆ‘ï¼Œé‚£æ—¶æ¯”è¾ƒè½»æ¾ï¼Œå“ˆå“ˆå“ˆï¼Œå·¥ä½œä¹‹å¤–éƒ½æ’¸ä»£ç å’Œåšå®¢å‘¢ã€‚å·®ä¸å¤šè¿‡äº†ä¸€ä¸ªæœˆåï¼Œå¯¼å¸ˆå°±å¼€å§‹åœ¨ç¾¤é‡Œé—®æˆ‘ä»¬ç³»ç»Ÿå®Œæˆçš„æ€ä¹ˆæ ·äº†ï¼Ÿç„¶åè¦æˆ‘ä»¬ä¸Šäº¤è®ºæ–‡ä»»åŠ¡ä¹¦ï¼Œå­¦æ ¡çš„è¿™ç§ææ–™æœ‰æ—¶å€™è¦çš„å¾ˆæ€¥ï¼Œä¸å¾—ä¸åæ§½ä¸‹ï¼Œå¾ˆå¤´ç–¼ï¼Œè‡ªå·±æœ‰æ—¶å€™éƒ½ä¸€ä¸‹å­äº¤ä¸äº†ã€‚åˆè¿‡äº†ä¸€æ®µæ—¶é—´å°±éœ€è¦æŠŠè®ºæ–‡åˆç¨¿äº¤ä¸Šå»ï¼ŒçœŸæ˜¯è‹¦é€¼ï¼Œé‚£æ—¶è¿˜ä¸çŸ¥é“è®ºæ–‡çš„æ¨¡ç‰ˆåˆ°åº•æ˜¯å’‹æ ·ï¼Ÿè¯¥æ€ä¹ˆå†™æœ¬ç§‘è®ºæ–‡å‘¢ï¼Ÿæå¾—æˆ‘è‡ªå·±é‚£æ®µæ—¶é—´èŠ±äº†å‘¨æœ«ä¸¤å¤©å’Œä¸€å¤©çš„ä¸Šç­çš„æ—¶é—´æ‰å‹‰å¼ºäº¤äº†ä¸ªä¸€èˆ¬çš„åˆç¨¿ï¼Œåˆç¨¿ä¸­çš„å„ç§å›¾ç”»çš„æˆ‘æ˜¯æƒ³å“­ã€‚çœŸå¤šï¼Œè¿˜éº»çƒ¦ã€‚å¹¸å¥½åœ¨é‚£æ®µæ—¶é—´å…¬å¸çš„ä»»åŠ¡è¿˜ä¸å¿™ï¼Œæ‰€ä»¥åœ¨æœ‰æ—¶é—´åœ¨å®ä¹ ä¸Šç­çš„æ—¶å€™ä¹Ÿç¨å¾®å®Œæˆä¸‹è‡ªå·±çš„åˆç¨¿ã€‚</p><p>ä»Šå¹´ 3 ï½ 4 æœˆçš„æ—¶å€™ï¼Œå¯¼å¸ˆä¹Ÿåœ¨ä¸æ–­çš„å«æˆ‘ä»¬æŠŠå­¦æ ¡è¯¥äº¤çš„å®ä¹ æ¯å‘¨æŠ¥å‘Šäº¤ç»™å¥¹ã€‚è¿™ä¸ªå®ä¹ è¿˜æœ‰å®ä¹ ç”³è¯·è¡¨ã€å®ä¹ é‰´å®šè¡¨ææ–™ï¼ˆè¦æ±‚ç›–ç« ï¼‰ï¼Œè¿™ä¸¤ä¸ªèµ„æ–™ä¹Ÿæ˜¯å¾ˆé‡è¦çš„ï¼Œå¦‚æœåé¢æ²¡æœ‰è¿™ä¸ªææ–™éƒ½ä¸èƒ½å‚åŠ ç­”è¾©çš„ã€‚</p><p>åœ¨å¿«äº”æœˆçš„æ—¶å€™ï¼Œå¯¼å¸ˆé‚£æ—¶å°±å¤©å¤©æ™šä¸Šæ·±å¤œåœ¨æ¯•è®¾å°åˆ†é˜Ÿç¾¤é‡Œå‚¬åŒå­¦ä»¬ï¼Œä½ ä»¬çš„è®ºæ–‡å’Œç³»ç»Ÿéƒ½å®Œæˆçš„å’‹æ ·äº†ï¼Ÿç„¶ååˆå‚¬äº†è¦äº¤è®ºæ–‡ä¸­æœŸæŠ¥å‘Šï¼ˆè¿™ä¸ªåº”è¯¥ä¹Ÿè›®é‡è¦çš„ï¼Œæˆ‘ä»¬ç­ä¸¤ä¸ªåŒå­¦å¥½åƒå°±å› ä¸ºè¿™ä¸ªå¯¼è‡´æœ‰ä¸ªè®ºæ–‡ä¸­æœŸæŠ¥å‘Šè­¦å‘Šï¼Œå“å¾—ä»–ä»¬åæ¥ç­”è¾©çš„æ—¶å€™éƒ½æ€•è‡ªå·±æŒ‚äº†ï¼‰ã€‚</p><p>è¿‡å®ŒåŠ³åŠ¨èŠ‚åï¼Œå†è¿‡äº†å‡ å¤©åï¼Œæˆ‘å°±è¾èŒäº†ã€‚è¾èŒååœ¨è‹å·ç©äº†å‡ å¤©ï¼ŒæœŸé—´ä¹Ÿæ˜¯åœ¨ä¸æ–­çš„ä¿®æ”¹è‡ªå·±çš„è®ºæ–‡å’Œä¼˜åŒ–äº›æ ¼å¼é—®é¢˜ã€‚</p><p>åæ¥åˆæµªå›å®¶äº†ï¼Œåœ¨å®¶å‘†äº†å‡ å¤©ï¼Œä¹Ÿæ˜¯æ”¹è®ºæ–‡æ”¹åˆ°æ·±å¤œï¼Œé‚£æ®µæ—¶é—´è‡ªå·±å·²ç»å¼€å§‹åœ¨æŠŠè‡ªå·±çš„è®ºæ–‡åˆç¨¿æ‹¿åˆ°äº›ç¬¬ä¸‰æ–¹å…è´¹çš„æŸ¥é‡å»æŸ¥é‡ç½‘ç«™å»æŸ¥é‡ï¼Œç„¶åæ ¹æ®æŸ¥é‡åçš„ç»“æœï¼Œå°†ä¸€äº›é‡å¤çš„åœ°æ–¹ä¸œæ”¹æ”¹ï¼Œè¥¿å‡‘å‡‘ï¼Œæˆ–è€…ç”¨è‡ªå·±çš„è¯å†™ä¸€éã€‚è¿™æ ·å°±å¯ä»¥å‡å°‘ç‚¹é‡å¤è¯­å¥ã€‚</p><p>å†ç„¶åå°±æ˜¯ 18 å·èµ¶å›æ¥å­¦æ ¡äº†ï¼Œ19ï¼Œ20å·åˆšå¥½å‘¨æœ«ï¼Œåˆæ˜¯ä¸çœ ä¹‹å¤œï¼Œé‚£ä¸¤å¤©ä¸æ–­æŸ¥é‡ï¼Œå‘åˆ«äººè¯·æ•™ï¼Œæ€ä¹ˆåŠ å­—æ•°ï¼Œè‡ªå·±ä¸€å¼€å§‹çš„å­—æ•°å¥½åƒè¿˜æ˜¯ä¸å¤Ÿçš„ï¼Œå­¦æ ¡è¦æ±‚çš„å­—æ•°æœ‰ç‚¹é«˜ï¼Œå…¶ä»–å­¦æ ¡éƒ½æ˜¯ 8000 å­—ï¼Œæˆ‘ä»¬å´è¦æ±‚ 1.5 wï¼ŒçœŸæ˜¯èƒ½æ‰¯å•Šï¼Œæ€ä¹ˆå¯ä»¥æ‰¯å‡ºè¿™ä¹ˆå¤šå­—æ¥ã€‚é€šè¿‡æŸäººçš„ç»éªŒä¹‹è°ˆï¼Œæˆ‘æˆåŠŸçš„æ‰¯äº†ä¸å°‘å­—ï¼Œè¿˜ä¸å¸¦é‡å¤çš„ï¼ŒğŸ˜„ã€‚</p><p>ç„¶å 21 å·å‘¨ä¸€æ‹¿ç»™è€å¸ˆæ£€æŸ¥çš„æ—¶å€™å°±æ˜¯çœ‹äº†ä¸‹æ ¼å¼ï¼ˆè€å¸ˆä¸åœ¨åŠå…¬å®¤ï¼Œå¥¹å¸¦çš„ç ”ç©¶ç”Ÿç»™æ£€æŸ¥çš„ï¼‰ï¼Œè¯´ä½ å…¨æ–‡é¦–è¡Œå’‹éƒ½æ²¡ç¼©è¿›å‘¢ï¼ˆå†™åšå®¢å†™ä¹ æƒ¯äº†ï¼Œè°è¿˜ç¼©è¿›å•Šï¼‰ï¼Œè¡Œé—´è·æ¯”è¾ƒå¤§ï¼Œå›¾çš„æ ‡å·é”™è¯¯ï¼Œä¸»è¦è¿˜æ˜¯æ£€æŸ¥æ ¼å¼ã€‚å½“æ™šï¼Œåˆå¥½å¥½æ”¹äº†ä¸‹ï¼Œå¹¶å’Œæˆ‘åŒå­¦è®¨è®ºäº†ä¸‹ä»–çš„æŒ‡å¯¼å¯¼å¸ˆçš„è¦æ±‚æœ‰å“ªäº›ï¼Œå¹¶ä¹Ÿåšäº†ç›¸åº”çš„ä¿®æ”¹ã€‚ï¼ˆå› ä¸ºæˆ‘çš„ç­”è¾©å¯¼å¸ˆå°±æœ‰æˆ‘é‚£åŒå­¦çš„æŒ‡å¯¼è€å¸ˆï¼‰è®°å¾—å½“æ™šå¥½åƒæ”¹è®ºæ–‡æ”¹åˆ°ä¸‰ç‚¹ï¼Œå¹¸å¥½æœ‰äººé™ªç€æˆ‘ä¸€è¾¹èŠå¤©ä¸€è¾¹æ”¹ï¼Œä¸ç„¶æ—©å›°äº†ï¼Œç¡äº†ã€‚</p><p>22 å·ä¸€æ—©å°±é†’æ¥äº†ï¼Œç„¶åå°±å»æ‰“å°åº—æ‰“å°è®ºæ–‡ã€‚è¿™é‡Œæƒ³ç»™çš„å¤§å®¶ä¸€ä¸ªå»ºè®®å°±æ˜¯ï¼šå¦‚æœä½ ä¹Ÿè¦æ‰“å°è®ºæ–‡ï¼Œæœ€å¥½æ—©ç‚¹å»ï¼Œå› ä¸ºæ¯•ä¸šå­£ï¼Œå­¦æ ¡æ‰“å°åº—å‡ ä¹éƒ½æ˜¯çˆ†æ»¡ï¼Œæ‰“å°è®ºæ–‡çš„éå¸¸å¤šï¼Œè¿˜æœ‰å­¦å¼Ÿå­¦å¦¹æ‰“å°å„ç§è€ƒè¯•å·å­ã€èµ„æ–™å•¥çš„ï¼Œåæ­£äººå¾ˆå¤šï¼Œä¼°è®¡è¦æ’é˜Ÿã€‚æŒ‡å¯¼è€å¸ˆä¹Ÿä¸æ˜¯ä¸€ç›´åœ¨åŠå…¬å®¤çš„ï¼Œä»–ä»¬ä¹Ÿæ˜¯è¦ä¸Šè¯¾çš„ã€‚æ‰€ä»¥æœ€å¥½åœ¨å¯¼å¸ˆåœ¨åŠå…¬å®¤çš„æ—¶å€™èƒ½èµ¶åˆ°ï¼Œè¿™æ ·å°±ä¸ä¼šé”™è¿‡äº†ã€‚è¿™æ¬¡è€å¸ˆæ£€æŸ¥è®ºæ–‡å°±æ¯”è¾ƒä»”ç»†äº†ï¼Œè®ºæ–‡ä¸€è¡Œè¡Œçš„æ‰¾å†…å®¹ï¼Œçœ‹æ˜¯å¦é€šé¡ºï¼Ÿæ˜¯å¦æœ‰ä¸åˆé€‚çš„åœ°æ–¹ï¼Ÿæ ‡ç‚¹ç¬¦å·æ˜¯ä¸æ˜¯å¤šäº†æˆ–è€…å°‘äº†ï¼Ÿæ ¼å¼æ˜¯ä¸æ˜¯è¿˜æœ‰é—®é¢˜ï¼Ÿæ‰€ä»¥å‘¢ï¼Œè¿™æ¬¡åˆå¾ˆæƒ¨ï¼Œè¦æ”¹çš„åœ°æ–¹å¾ˆå¤šï¼Œè¿˜åŒ…æ‹¬æµç¨‹å›¾å’Œ E-R å›¾è¦æ”¹çš„ã€‚è‹¦é€¼äº†ï¼Œä¸‹åˆå›å»ç§Ÿæˆ¿å®¾é¦†çš„æ—¶å€™å°±å¼€å§‹æ‹¼å‘½çš„æ”¹ã€‚æ”¹çš„å·®ä¸å¤šäº†ï¼Œå› ä¸ºç¬¬äºŒå¤©è¦ç­”è¾©äº†ï¼Œæ‰€ä»¥å°±åœ¨çœ‹çœ‹è‡ªå·±çš„ç³»ç»Ÿæ˜¯å¦èƒ½å¤Ÿè·‘èµ·æ¥ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆbugï¼Œç»“æœè¿˜çœŸå‘ç°å‡ ä¸ªå°é”™è¯¯å’Œä¸€ä¸ªå¤§é”™è¯¯ï¼Œå°é”™è¯¯å¾ˆå¿«ä¿®å¤å®Œå–„äº†ï¼Œæœ‰ä¸€ä¸ª Redis å­˜æ•°æ®å†å–å‡ºæ¥çš„æ—¶å€™æ•°æ®å˜åŒ–é—®é¢˜å½“ç„¶debugäº†å¾ˆä¹…æ²¡æ‰¾åˆ°åŸå› ã€‚æ‰¾åˆ°æ·±å¤œä¸€ç‚¹å¤šï¼Œæ²¡è§£å†³ï¼Œæ”¾å¼ƒäº†ï¼Œç¬¬äºŒå¤©ä¸æ¼”ç¤ºè¿™å—ã€‚å½“æ™šæ€•è‡ªå·±æ˜å¤©é¡¹ç›®å¯åŠ¨çš„æ—¶å€™å…¶ä»–ç¯å¢ƒè¦ä¸€ä¸ªä¸ªèµ·ï¼Œéœ€è¦è€—è´¹ä¸å°‘æ—¶é—´ï¼Œäºæ˜¯è‡ªå·±ç®€å•çš„å†™äº†ä¸ªè„šæœ¬ï¼Œä¸€é”®å°†è‡ªå·±é¡¹ç›®çš„ç¯å¢ƒå¯åŠ¨èµ·æ¥ï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥è¿è¡Œé¡¹ç›®å±•ç¤ºç»™ç­”è¾©è€å¸ˆï¼ŒèŠ‚çœæ—¶é—´ï¼Œå°¤å…¶æ˜¯å…³é”®åœºåˆï¼Œæ€•æ‰é“¾å­ã€‚</p><p>23 å·æ—©ä¸Šå¾ˆæ—©å°±å»æŠŠè‡ªå·±çš„å®ä¹ ç”³è¯·è¡¨ã€å®ä¹ é‰´å®šè¡¨ã€å®ä¹  20 å‘¨æ—¥å¿—ã€å®ä¹ ç»ˆç»“ã€è®ºæ–‡åˆç¨¿è¿™äº›èµ„æ–™æ‰“å°ï¼Œç„¶åæ‹¿ç»™å¯¼å¸ˆæŸ¥çœ‹å’Œæ‰“åˆ†ã€‚ï¼ˆåˆæ‰¾å‡ºé—®é¢˜æ¥äº†ï¼Œè‹¦é€¼ï¼Œè®°å¾—é‚£ä¸ªæ—©ä¸Šç°åœºåœ¨å¯¼å¸ˆåŠå…¬å®¤ç”¨ç”µè„‘æ”¹å¥½åï¼Œæ£€æŸ¥å®Œæ‰æ‹¿å»æ‰“å°å†æ‹¿å›æ¥ç»™å¯¼å¸ˆæ£€æŸ¥çš„ï¼Œæ¥å›è·‘æ¥è·‘å»çš„çœŸçš„å¾ˆæ€¥ï¼Œå‡ºäº†ä¸å°‘æ±—ï¼‰æ³¨æ„ï¼šè¶Šæ˜¯å…³é”®æ—¶åˆ»ï¼Œåƒä¸‡è¦é¡ºç€å¯¼å¸ˆæ¥ï¼Œä»–è¯´æ”¹å“ªé‡Œå°±æ”¹å“ªé‡Œï¼Œåƒä¸‡åˆ«åˆšï¼Œæˆ‘ä¸€ä¸ªåŒå­¦çš„è®ºæ–‡æ”¹çš„å¯¼å¸ˆéƒ½å‘ç«äº†ï¼Œå·®ç‚¹æ²¡è®©æˆ‘é‚£åŒå­¦å‚åŠ ç­”è¾©ï¼Œç›´æ¥è¿›å…¥äºŒè¾©çš„ã€‚</p><p>ç­”è¾©çš„æ—¶å€™å…ˆæ¯ä¸ªäººä»‹ç»ä¸‹è‡ªå·±çš„å®ä¹ ç»å†ï¼Œå¬åˆ°ä¸å°‘ç‰›é€¼çš„åŒå­¦ï¼Œè¿›äº†ä¸å°‘å‰å®³çš„å…¬å¸ï¼Œæœ‰çš„åŒå­¦è¿˜å½“ä¸Šäº†å…¬å¸çš„é¡¹ç›®ç»„ç»„é•¿äº†ï¼ŒçœŸå‰å®³ï¼Œä¸€å¹´çš„å®ä¹ æ—¶é—´å°±æ··çš„è¿™ä¹ˆå¥½äº†ã€‚ç¬é—´å‘ç°å·®è·å¾ˆå¤§ã€‚</p><p>ç„¶åå°±æ˜¯æ¯ä¸ªäººçš„ç­”è¾©äº†ï¼Œæˆ‘ç¬¬ä¸‰ä¸ªï¼Œè¿˜å¥½ï¼Œç­”è¾©çš„è¿‡ç¨‹é—®äº†æˆ‘çš„é—®é¢˜å’Œæ¼”ç¤ºç³»ç»Ÿçš„æ—¶å€™éƒ½è¡¨ç°çš„è›®å¥½çš„ã€‚å°±ç°åœºè¿˜é—®äº†æˆ‘æœ‰ä¸ªåŠŸèƒ½çš„ä»£ç æ˜¯å“ªï¼Ÿï¼ˆä¼°è®¡æ˜¯æƒ³çœ‹ä¸‹æ˜¯ä¸æ˜¯è‡ªå·±å†™çš„é¡¹ç›®ï¼‰åé¢ä¹Ÿçœ‹åˆ°æœ‰çš„åŒå­¦é¡¹ç›®ç«Ÿç„¶èµ·ä¸æ¥çš„ï¼Œæˆ–è€…å›ç­”ä¸å‡ºè€å¸ˆçš„é—®é¢˜çš„ã€‚ç­”è¾©è¿‡ç¨‹ä¸­ï¼Œç­”è¾©è€å¸ˆåˆç»™è®ºæ–‡æ‰¾äº†ä¸å°‘é—®é¢˜ï¼Œåˆè¦è‹¦é€¼çš„ä¿®æ”¹äº†ã€‚</p><p>å½“å¤©å°±å‡ºäº†å¾…å®šåå•å’Œè¦äºŒè¾©çš„åå•ï¼Œé€Ÿåº¦è¿˜æ˜¯å¾ˆå¿«ã€‚è¿˜å¥½æˆ‘æ²¡æœ‰ï¼Œå¼€æ£®ã€‚æœ¬ä»¥ä¸ºç­”è¾©å¥½äº†ï¼Œå°±å¯ä»¥æ¾ä¸‹ä¸€å£æ°”äº†ï¼Œåé¢æ”¹å¥½äº†è®ºæ–‡åæ‹¿å»ç»™å¯¼å¸ˆæ£€æŸ¥ï¼Œå¥¹éƒ½è¯´ OK äº†ï¼Œç»“æœæˆ‘å°±å»æŠŠè®ºæ–‡æ‹¿å»èƒ¶è£…äº†ï¼Œæ³¨æ„èƒ¶è£…é¡ºåºåˆ«æé”™äº†ã€‚ç¬¬äºŒå¤©æŠŠèƒ¶è£…å¥½çš„è®ºæ–‡å’Œå„ç§èµ„æ–™ä¸€èµ·äº¤ç»™è€å¸ˆçš„æ—¶å€™ï¼Œç»“æœåˆæŒ‘å‡ºä¸€ä¸ªç›®å½•çš„é—®é¢˜ï¼ŒWTFï¼Œæå¾—æˆ‘åé¢æ”¹å¥½åå»æ‰“å°åº—é‡æ–°èƒ¶è£…äº†éï¼ˆå°çš®ä»åŸæ¥çš„ä¸Šé¢æ‰¯ä¸‹æ¥èƒ¶è£…ï¼‰ã€‚æ˜¨å¤©ç­¾å®Œå­—äº†ï¼ŒæŠŠè®ºæ–‡çš„åˆç¨¿ã€ç»ˆç¨¿ã€ç­”è¾©è®°å½•ã€å®ä¹ ææ–™ç­‰ææ–™ä¸€èµ·è£…è¿›æ¡£æ¡ˆè¢‹äº†ï¼Œè¿™æ‰å®‰å¿ƒäº†ã€‚</p><p>äºæ˜¯å½“æ™šå°±å»å‚åŠ äº†ç­ä¸Šçš„æ¯•ä¸šèšä¼šã€‚</p><p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1frou06i6h3j31kw16oayj.jpg" alt="571527322665_.pic_hd"></p><h3 id="æ„Ÿå—"><a href="#æ„Ÿå—" class="headerlink" title="æ„Ÿå—"></a>æ„Ÿå—</h3><p>è¿™æ®µæ—¶é—´çœŸçš„æ˜¯å¾ˆç´¯ï¼Œæ¯å¤©ç†¬å¤œåˆ°å¾ˆæ™šï¼Œç¬¬äºŒå¤©æ—©ä¸Šå¾ˆæ—©å°±è‡ªç„¶é†’äº†ã€‚ç˜¦äº†ä¸å°‘ï¼Œç‰›ä»”è£¤çš„çš®å¸¦æˆ‘æ„Ÿè§‰éƒ½ç¼©äº†ä¸€åœˆï¼Œå³æ‰‹çš„å‡ ä¸ªæ‰‹æŒ‡å¤©å¤©åœ¨ç”µè„‘çš„è§¦æ‘¸æ¿ä¸Šæ»‘æ¥æ»‘å»çš„ï¼Œéƒ½è„±äº†ä¸€å±‚çš®äº†ï¼Œç°åœ¨æ”¾ä¸Šå»éƒ½æœ‰ç‚¹ç—›ï¼Œæ‰“å°è®ºæ–‡å¥½åƒæ‰“å°äº†7ä»½ï¼Œçƒ§é’±å•Šã€‚å‘ç°æˆ‘çš„è®°å¿†è¿˜æ˜¯å¯ä»¥çš„ï¼Œè¿™ä¹ˆå¤šäº‹ç«Ÿç„¶è¿˜èƒ½è®°å¾—ï¼Œæå¾—æ•´ç¯‡æ–‡ç« æœ‰ç‚¹åƒåœ¨è®°æµæ°´è´¦ï¼Œå“ˆå“ˆå“ˆã€‚åæ­£ä¹Ÿæ˜¯è®°å½•ä¸‹è‡ªå·±çš„è®ºæ–‡ç­”è¾©è¿™æ®µæ—¶é—´çš„ç»å†ã€‚è®ºæ–‡çš„æ ¼å¼å¾ˆé‡è¦ï¼Œä¸å†åƒå†™åšå®¢é‚£æ ·éšæ„ï¼Œè®ºæ–‡æ˜¯éœ€è¦ä»¥ä¸€ç§ä¸¥è°¨çš„æ€åº¦å»å¯¹å¾…çš„ã€‚</p><p>å†™ç€å†™ç€å¿˜äº†è¯´è®ºæ–‡çš„æŸ¥é‡äº†ã€‚ä¸€èˆ¬ä½ ä¸€å¼€å§‹æœ€å¥½å…ˆç”¨ç¬¬ä¸‰æ–¹çš„å…è´¹æŸ¥é‡ä¸‹ï¼Œç„¶åä¿®æ”¹ã€‚</p><p>æˆ‘å½“æ—¶ç”¨çš„æ˜¯ï¼š<a href="http://xueshu.baidu.com/usercenter/papercheck/" target="_blank" rel="noopener">http://xueshu.baidu.com/usercenter/papercheck/</a>   è¿™ä¸ªåœ°æ–¹æœ‰å‡ ä¸ªæ˜¯å¯ä»¥ç¬¬ä¸€æ¬¡å…è´¹æŸ¥é‡çš„ï¼Œå¦‚æœæ¬¡æ•°ç”¨å®Œäº†ï¼Œè®°å¾—æ¢ä¸ªç™¾åº¦è´¦å·å°±åˆæœ‰å¥½äº›æ¬¡æŸ¥é‡çš„æœºä¼šã€‚å¦‚æœä½ å®åœ¨æ˜¯ä¸æ”¾å¿ƒï¼Œå¯ä»¥å»å­¦æ ¡çš„æ‰“å°åº—é—®ä¸‹æ˜¯å¦æœ‰è®ºæ–‡æŸ¥é‡çš„ï¼Œä¹Ÿæ˜¯æŸ¥çš„çŸ¥ç½‘çš„åº“ï¼Œå’Œå­¦æ ¡çŸ¥ç½‘æŸ¥é‡çš„åŒºåˆ«ä¸å¤§ï¼Œæˆ‘æ¯”è¾ƒè‡ªä¿¡ï¼Œæ²¡èŠ±è¿™ä¸ªé’±ï¼Œæ¯•ç«Ÿå¥½è´µï¼ŒğŸ˜¯æˆ‘ç©·ï¼Œå“ˆå“ˆå“ˆã€‚å­¦æ ¡è§„å®šçš„æ˜¯ä¸èƒ½é«˜äº 30% çš„æŸ¥é‡ç‡ï¼Œå»ºè®®è¿˜æ˜¯è‡ªå·±æŠŠæŸ¥é‡é™ä½åˆ° 20% ä»¥ä¸‹ç„¶åå†æäº¤åˆ°å­¦æ ¡çŸ¥ç½‘å»ï¼Œä¸ç„¶è¶…è¿‡çš„è¯æ˜¯éœ€è¦äºŒæ¬¡æŸ¥é‡çš„ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªæ„Ÿå—å°±æ˜¯ï¼šå¤šå’Œä½ çš„å¯¼å¸ˆäº¤æµï¼Œé‡åˆ°ä¸ä¼šæˆ–è€…æ‹¿ä¸å‡†çš„æœ€å¥½åœ¨ç¾¤é‡Œé—®ä»–ï¼Œç„¶åä»–è¯´çš„é”™è¯¯ï¼Œä½ è¦åŠæ—¶æ›´æ”¹å¥½è¿‡æ¥ï¼Œè¯´ä½ é—®é¢˜çš„æ—¶å€™è¦å­¦ä¼šè„¸ä¸ŠæŒ‚ç€ç¬‘å®¹ï¼Œå˜»å˜»å˜»å°±è¿‡å»äº†ï¼Œç„¶åè®°ä½è¯¥é—®é¢˜çš„é”™è¯¯ï¼Œå›å»ç«‹é©¬æ”¹å¥½ï¼ŒåŠæ—¶æ‹¿ææ–™ç»™è€å¸ˆæŸ¥é˜…ä¿®æ”¹å¥½çš„è®ºæ–‡ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://ws1.sinaimg.cn/large/006tNc79gy1frou078h61j312c0vedse.jpg&quot; alt=&quot;2018-05-26_15-01-42&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h3&gt;&lt;p&gt;æœ€è¿‘ä¸€ç›´åœ¨å­¦æ ¡å¿™æ¯•ä¸šè®ºæ–‡çš„äº‹ï¼ŒæŠ±æ­‰äº†ï¼Œå¾ˆé•¿ä¸€æ®µæ—¶é—´æ²¡æ›´æ–°æ–‡ç« äº†ï¼Œä»Šå¤©æ˜ŸæœŸå…­ï¼Œæ˜¨å¤©æ˜ŸæœŸäº”ï¼Œå¹¸å¥½æ‰€æœ‰èµ„æ–™éƒ½åœ¨å‘¨æœ«å‰äº¤é½äº†ï¼Œæ˜¨æ™šè¿˜åˆ°å‚åŠ ç­ä¸Šçš„èšä¼šï¼Œä¹Ÿå–äº†ä¸å°‘é…’ï¼Œä½†å¹¸å¥½æ²¡é†‰ï¼Œä¸ç„¶ä»Šå¤©è‚¯å®šä¸ä¼šå†™ä¸‹è¿™ç¯‡æ–‡ç« çš„ã€‚è¿™ç¯‡æ–‡ç« å°±æŠŠä»æ¥è§¦åˆ°æ¯•ä¸šè®ºæ–‡æŒ‡å¯¼è€å¸ˆåˆ°ç°åœ¨çš„è¿™åŠå¹´æ—¶é—´æœ‰å…³æ¯•ä¸šè®ºæ–‡çš„äº‹éƒ½è®²è®²ï¼Œå¸Œæœ›èƒ½å¤Ÿç•™ä¸‹ç‚¹å›å¿†ï¼&lt;br&gt;
    
    </summary>
    
    
      <category term="éšç¬”" scheme="http://yoursite.com/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>Spring Boot 2.0ç³»åˆ—æ–‡ç« (ä¸ƒ)ï¼šSpringApplication æ·±å…¥æ¢ç´¢</title>
    <link href="http://yoursite.com/2018/04/30/springboot_SpringApplication/"/>
    <id>http://yoursite.com/2018/04/30/springboot_SpringApplication/</id>
    <published>2018-04-29T16:00:00.000Z</published>
    <updated>2018-05-09T04:35:51.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1fqxbkmfds2j31hc0oegze.jpg" alt="sunset-3325080_1920"></p><a id="more"></a><h3 id="å…³æ³¨æˆ‘"><a href="#å…³æ³¨æˆ‘" class="headerlink" title="å…³æ³¨æˆ‘"></a>å…³æ³¨æˆ‘</h3><p><img src="http://ohfk1r827.bkt.clouddn.com/blog/180103/C6LG3mGa12.jpg" alt="mark"></p><p>è½¬è½½è¯·åŠ¡å¿…æ³¨æ˜åŸåˆ›åœ°å€ä¸ºï¼š<a href="http://www.54tianzhisheng.cn/2018/04/30/springboot_SpringApplication/" target="_blank" rel="noopener">http://www.54tianzhisheng.cn/2018/04/30/springboot_SpringApplication/</a></p><h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>åœ¨ Spring Boot é¡¹ç›®çš„å¯åŠ¨ç±»ä¸­å¸¸è§ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringbotApplication</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">SpringApplication.run(SpringbotApplication.class, args);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ä¹Ÿå°±ä¸¤ä¸ªæ¯”è¾ƒå¼•äººæ³¨æ„çš„åœ°æ–¹ï¼š</p><ul><li><code>@SpringBootApplication</code></li><li><code>SpringApplication.run()</code></li></ul><p>å¯¹äºç¬¬ä¸€ä¸ªæ³¨è§£ <code>@SpringBootApplication</code>ï¼Œæˆ‘å·²ç»åœ¨åšå®¢ <a href="http://www.54tianzhisheng.cn/2018/04/19/SpringBootApplication-annotation/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (å…­)ï¼šSpring Boot 2.0ä¸­SpringBootApplicationæ³¨è§£è¯¦è§£</a> ä¸­è¯¦ç»†çš„è®²è§£äº†ã€‚æ¥ä¸‹æ¥å°±æ˜¯æ·±å…¥æ¢ç©¶ç¬¬äºŒä¸ªäº† <code>SpringApplication.run()</code> ã€‚</p><h3 id="æ¢ä¸ªå§¿åŠ¿"><a href="#æ¢ä¸ªå§¿åŠ¿" class="headerlink" title="æ¢ä¸ªå§¿åŠ¿"></a>æ¢ä¸ªå§¿åŠ¿</h3><p>ä¸Šé¢çš„å§¿åŠ¿å¤ªç®€å•äº†ï¼Œåªä¸€è¡Œä»£ç å°±å®Œäº‹äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SpringApplication.run(SpringbotApplication.class, args);</span><br></pre></td></tr></table></figure><p>å…¶å®æ˜¯æ”¯æŒåšä¸€äº›ä¸ªæ€§åŒ–çš„è®¾ç½®ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¢ä¸ªå§¿åŠ¿ç§ç§ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringbotApplication</span> </span>&#123;  </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">SpringApplication app = <span class="keyword">new</span> SpringApplication(SpringbotApplication.class);</span><br><span class="line"> <span class="comment">// è‡ªå®šä¹‰åº”ç”¨ç¨‹åºçš„é…ç½®</span></span><br><span class="line"> <span class="comment">//app.setXxx()</span></span><br><span class="line"> app.run(args)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ²¡é”™ï¼Œå°±æ˜¯é€šè¿‡ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œç„¶åè®¾ç½®ç›¸å…³çš„å±æ€§ï¼Œä»è€Œè¾¾åˆ°å®šåˆ¶åŒ–æœåŠ¡ã€‚æœ‰å“ªäº›å±æ€§å‘¢ï¼Ÿ</p><p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fqx6tttpf2j312618mn4w.jpg" alt="SpringApplicationFileds"></p><p>å±æ€§å¯¹åº”çš„ getï¼set æ–¹æ³•</p><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fqx6tz1wmyj31kw1f3qeo.jpg" alt="springapplication_getset"></p><p>çœ‹åˆ°æ²¡ï¼Œè¿˜å¾ˆå¤šå‘¢ï¼</p><p>ä¸¾ä¸ªä¾‹å­ï¼šä½ æƒ³æŠŠ Spring Boot é¡¹ç›®çš„é»˜è®¤ Banner æ¢æˆä½ è‡ªå·±çš„ï¼Œå°±éœ€è¦åœ¨è¿™é‡Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"><span class="comment">//SpringApplication.run(Springboot2Application.class, args);</span></span><br><span class="line">  SpringApplication application = <span class="keyword">new</span> SpringApplication(Springboot2Application.class);</span><br><span class="line">  application.setBanner((environment, sourceClass, out) -&gt; &#123;</span><br><span class="line">    <span class="comment">//è¿™é‡Œæ‰“å°ä¸€ä¸ªlogo</span></span><br><span class="line">    System.out.println(<span class="string">"      _      _       _\n"</span> +</span><br><span class="line">                       <span class="string">"     | |    (_)     | |\n"</span> +</span><br><span class="line">                       <span class="string">" ____| |__   _  ___ | |__    ___  _ __    __ _\n"</span> +</span><br><span class="line">                       <span class="string">"|_  /| '_ \\ | |/ __|| '_ \\  / _ \\| '_ \\  / _` |\n"</span> +</span><br><span class="line">                       <span class="string">" / / | | | || |\\__ \\| | | ||  __/| | | || (_| |\n"</span> +</span><br><span class="line">                       <span class="string">"/___||_| |_||_||___/|_| |_| \\___||_| |_| \\__, |\n"</span> +</span><br><span class="line">                       <span class="string">"                                          __/ |\n"</span> +</span><br><span class="line">                       <span class="string">"                                         |___/\n"</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  application.setBannerMode(Banner.Mode.CONSOLE);</span><br><span class="line">  <span class="comment">//ä½ è¿˜å¯ä»¥å¹²å…¶ä»–çš„å®šåˆ¶åŒ–åˆå§‹è®¾ç½®</span></span><br><span class="line">  application.run(args);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç°åœ¨é‡å¯é¡¹ç›®ï¼Œä½ å°±ä¼šå‘ç°ï¼Œæ§åˆ¶å°çš„ logo å·²ç»æ¢æˆä½ è‡ªå·±çš„äº†ã€‚</p><p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fqx6tuvk6lj31kw1a6qio.jpg" alt="banner"></p><p>å½“ç„¶äº†ï¼Œä½ å¯èƒ½ä¼šè§‰å¾—è¿™æ ·å†™æœ‰ç‚¹å¤æ‚ï¼Œå—¯å—¯ï¼Œç¡®å®ï¼Œè¿™æ ·ç¡¬ç¼–ç åœ¨ä»£ç é‡Œç¡®å®ä¸å¤ªå‹å¥½ã€‚ä½ è¿˜å¯ä»¥åœ¨<code>src/main/resources</code>è·¯å¾„ä¸‹æ–°å»ºä¸€ä¸ª<code>banner.txt</code>æ–‡ä»¶ï¼Œ<code>banner.txt</code>ä¸­å¡«å†™å¥½éœ€è¦æ‰“å°çš„å­—ç¬¦ä¸²å†…å®¹å³å¯ã€‚</p><p>ä»è¯¥ç±»ä¸­å¯ä»¥çœ‹åˆ°åœ¨ Spring Boot 2 ä¸­å¼•å…¥äº†ä¸ªæ–°çš„ WebApplicationType å’Œ WebEnvironmentã€‚</p><p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fqx6tvo4l3j31ke1fads1.jpg" alt="springapplication-002"></p><p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fqx6tyfizgj31be13ujws.jpg" alt="webapplicationtype"></p><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fqx6tmcuslj31im0yigtw.jpg" alt="springapplication-003"></p><p>ç¡®å®ï¼Œè¿™ä¹Ÿæ˜¯ Spring Boot 2 ä¸­æ¯”è¾ƒå¤§çš„ç‰¹æ€§ï¼Œå®ƒæ˜¯æ”¯æŒå“åº”å¼ç¼–ç¨‹çš„ã€‚æˆ‘ä¹‹å‰åœ¨æ–‡ç«  <a href="http://www.54tianzhisheng.cn/2018/03/06/SpringBoot2-new-features/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (äºŒ)ï¼šSpring Boot 2.0 æ–°ç‰¹æ€§è¯¦è§£</a> ä¸­ä¹Ÿä»‹ç»è¿‡ï¼Œä»¥åæœ‰æœºä¼šä¼šä»‹ç»å®ƒçš„ï¼Œè¿™é‡Œæˆ‘å…ˆå–ä¸ªå…³å­ã€‚</p><h3 id="SpringApplication-åˆå§‹åŒ–"><a href="#SpringApplication-åˆå§‹åŒ–" class="headerlink" title="SpringApplication åˆå§‹åŒ–"></a>SpringApplication åˆå§‹åŒ–</h3><p><code>SpringApplication.run()</code>  çš„å®ç°æ‰æ˜¯æˆ‘ä»¬è¦æ·±å…¥æ¢ç©¶çš„ä¸»è§’ï¼Œè¯¥æ–¹æ³•ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//é™æ€æ–¹æ³•ï¼Œå¯ç”¨äºä½¿ç”¨é»˜è®¤é…ç½®è¿è¡Œ SpringApplication</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ConfigurableApplicationContext <span class="title">run</span><span class="params">(Class&lt;?&gt; primarySource,</span></span></span><br><span class="line"><span class="function"><span class="params">      String... args)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> run(<span class="keyword">new</span> Class&lt;?&gt;[] &#123; primarySource &#125;, args);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ConfigurableApplicationContext <span class="title">run</span><span class="params">(Class&lt;?&gt;[] primarySources,</span></span></span><br><span class="line"><span class="function"><span class="params">String[] args)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> SpringApplication(primarySources).run(args);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªé™æ€æ–¹æ³•ä¸­ï¼Œåˆ›å»º SpringApplication å¯¹è±¡ï¼Œå¹¶è°ƒç”¨è¯¥å¯¹è±¡çš„ run æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">SpringApplication</span><span class="params">(Class&lt;?&gt;... primarySources)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>(<span class="keyword">null</span>, primarySources);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åˆ›å»ºä¸€ä¸ª SpringApplication å®ä¾‹ï¼Œåº”ç”¨ä¸Šä¸‹æ–‡ä¼šæ ¹æ®æŒ‡å®šçš„ä¸»è¦èµ„æºåŠ è½½ beans ï¼Œå®ä¾‹åœ¨è°ƒç”¨ run æ–¹æ³•ä¹‹å‰å¯ä»¥å®šåˆ¶åŒ–</span></span><br><span class="line"><span class="meta">@SuppressWarnings</span>(&#123; <span class="string">"unchecked"</span>, <span class="string">"rawtypes"</span> &#125;)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">SpringApplication</span><span class="params">(ResourceLoader resourceLoader, Class&lt;?&gt;... primarySources)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.resourceLoader = resourceLoader;</span><br><span class="line">  Assert.notNull(primarySources, <span class="string">"PrimarySources must not be null"</span>);</span><br><span class="line">  <span class="keyword">this</span>.primarySources = <span class="keyword">new</span> LinkedHashSet&lt;&gt;(Arrays.asList(primarySources));</span><br><span class="line">  <span class="keyword">this</span>.webApplicationType = deduceWebApplicationType();</span><br><span class="line">  setInitializers((Collection) getSpringFactoriesInstances(</span><br><span class="line">    ApplicationContextInitializer.class));</span><br><span class="line">  setListeners((Collection) getSpringFactoriesInstances(ApplicationListener.class));</span><br><span class="line">  <span class="keyword">this</span>.mainApplicationClass = deduceMainApplicationClass();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆæ˜¯è¿›å…¥å•ä¸ªå‚æ•°çš„æ„é€ æ–¹æ³•ï¼Œç„¶åè¿›å…¥ä¸¤å‚æ•°çš„æ„é€ æ–¹æ³•ï¼ˆResourceLoader ä¸º nullï¼‰ï¼Œç„¶åè¿›è¡Œåˆå§‹åŒ–ã€‚</p><p><strong>1ã€deduceWebApplicationType()</strong> : æ¨æ–­åº”ç”¨çš„ç±»å‹ ï¼Œåˆ›å»ºçš„æ˜¯ä¸€ä¸ª SERVLET åº”ç”¨è¿˜æ˜¯ REACTIVEåº”ç”¨æˆ–è€…æ˜¯ NONE</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String REACTIVE_WEB_ENVIRONMENT_CLASS = <span class="string">"org.springframework.web.reactive.DispatcherHandler"</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String MVC_WEB_ENVIRONMENT_CLASS = <span class="string">"org.springframework.web.servlet.DispatcherServlet"</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String[] WEB_ENVIRONMENT_CLASSES = &#123; <span class="string">"javax.servlet.Servlet"</span>,</span><br><span class="line"><span class="string">"org.springframework.web.context.ConfigurableWebApplicationContext"</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> WebApplicationType <span class="title">deduceWebApplicationType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (ClassUtils.isPresent(REACTIVE_WEB_ENVIRONMENT_CLASS, <span class="keyword">null</span>)</span><br><span class="line">      &amp;&amp; !ClassUtils.isPresent(MVC_WEB_ENVIRONMENT_CLASS, <span class="keyword">null</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> WebApplicationType.REACTIVE;<span class="comment">//è¯¥ç¨‹åºæ˜¯ REACTIVE ç¨‹åº</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (String className : WEB_ENVIRONMENT_CLASSES) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!ClassUtils.isPresent(className, <span class="keyword">null</span>)) &#123;</span><br><span class="line">      <span class="keyword">return</span> WebApplicationType.NONE;<span class="comment">//è¯¥ç¨‹åºä¸º NONE</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> WebApplicationType.SERVLET;<span class="comment">//é»˜è®¤è¿”å›æ˜¯ SERVLET ç¨‹åº</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>2ã€setInitializers((Collection) getSpringFactoriesInstances(ApplicationContextInitializer.class))</strong>ï¼šåˆå§‹åŒ– classpath ä¸‹çš„æ‰€æœ‰çš„å¯ç”¨çš„ ApplicationContextInitializerã€‚</p><p>1ï¼‰ã€getSpringFactoriesInstances()</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> &lt;T&gt; <span class="function">Collection&lt;T&gt; <span class="title">getSpringFactoriesInstances</span><span class="params">(Class&lt;T&gt; type)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> getSpringFactoriesInstances(type, <span class="keyword">new</span> Class&lt;?&gt;[] &#123;&#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è·å–æ‰€æœ‰çš„ Spring å·¥å‚å®ä¾‹</span></span><br><span class="line"><span class="keyword">private</span> &lt;T&gt; <span class="function">Collection&lt;T&gt; <span class="title">getSpringFactoriesInstances</span><span class="params">(Class&lt;T&gt; type,</span></span></span><br><span class="line"><span class="function"><span class="params">Class&lt;?&gt;[] parameterTypes, Object... args)</span> </span>&#123;</span><br><span class="line">  ClassLoader classLoader = Thread.currentThread().getContextClassLoader();</span><br><span class="line">  <span class="comment">// Use names and ensure unique to protect against duplicates</span></span><br><span class="line">  Set&lt;String&gt; names = <span class="keyword">new</span> LinkedHashSet&lt;&gt;(SpringFactoriesLoader.loadFactoryNames(type, classLoader)); <span class="comment">//è·å–æ‰€æœ‰ Spring Factories çš„åå­—</span></span><br><span class="line">  List&lt;T&gt; instances = createSpringFactoriesInstances(type, parameterTypes,</span><br><span class="line">                                                     classLoader, args, names);</span><br><span class="line">  AnnotationAwareOrderComparator.sort(instances); <span class="comment">//Spring å·¥å‚å®ä¾‹æ’åº</span></span><br><span class="line">  <span class="keyword">return</span> instances;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ ¹æ®è¯»å–åˆ°çš„åå­—åˆ›å»ºå¯¹è±¡ï¼ˆSpring å·¥å‚å®ä¾‹ï¼‰</span></span><br><span class="line"><span class="keyword">private</span> &lt;T&gt; <span class="function">List&lt;T&gt; <span class="title">createSpringFactoriesInstances</span><span class="params">(Class&lt;T&gt; type,</span></span></span><br><span class="line"><span class="function"><span class="params"> Class&lt;?&gt;[] parameterTypes, ClassLoader classLoader, Object[] args, Set&lt;String&gt; names)</span> </span>&#123;</span><br><span class="line">  List&lt;T&gt; instances = <span class="keyword">new</span> ArrayList&lt;&gt;(names.size());</span><br><span class="line">  <span class="keyword">for</span> (String name : names) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      Class&lt;?&gt; instanceClass = ClassUtils.forName(name, classLoader);</span><br><span class="line">      Assert.isAssignable(type, instanceClass);</span><br><span class="line">      Constructor&lt;?&gt; constructor = instanceClass.getDeclaredConstructor(parameterTypes);</span><br><span class="line">      T instance = (T) BeanUtils.instantiateClass(constructor, args);</span><br><span class="line">      instances.add(instance);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Throwable ex) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(</span><br><span class="line">        <span class="string">"Cannot instantiate "</span> + type + <span class="string">" : "</span> + name, ex);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> instances;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ SpringFactoriesLoader.loadFactoryNames() ï¼Œæ˜¯ä»  META-INF/spring.factories çš„èµ„æºæ–‡ä»¶ä¸­ï¼Œè¯»å– key ä¸ºorg.springframework.context.ApplicationContextInitializer çš„ valueã€‚</p><p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fqx6xo1yhjj31kw1cinbe.jpg" alt="springfactoriesloader"></p><p>è€Œ spring.factories çš„éƒ¨åˆ†å†…å®¹å¦‚ä¸‹ï¼š</p><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fqx6tt63ojj31kw0kotk4.jpg" alt="2018-05-01_22-21-20"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œæœ€è¿‘çš„å¾—åˆ°çš„ï¼Œæ˜¯ ConfigurationWarningsApplicationContextInitializerï¼ŒContextIdApplicationContextInitializerï¼ŒDelegatingApplicationContextInitializerï¼ŒServerPortInfoApplicationContextInitializer è¿™å››ä¸ªç±»çš„åå­—ã€‚</p><p>2ï¼‰ã€setInitializers()ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setInitializers</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">Collection&lt;? extends ApplicationContextInitializer&lt;?&gt;&gt; initializers)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.initializers = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">  <span class="keyword">this</span>.initializers.addAll(initializers);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥ï¼Œè¿™é‡Œ setInitializers() æ‰€å¾—åˆ°çš„æˆå‘˜å˜é‡ initializers å°±è¢«åˆå§‹åŒ–ä¸ºConfigurationWarningsApplicationContextInitializerï¼ŒContextIdApplicationContextInitializerï¼ŒDelegatingApplicationContextInitializerï¼ŒServerPortInfoApplicationContextInitializer è¿™å››ä¸ªç±»çš„å¯¹è±¡ç»„æˆçš„ listã€‚</p><p><strong>3ã€setListeners((Collection) getSpringFactoriesInstances(ApplicationListener.class))</strong>ï¼šåˆå§‹åŒ– classpath ä¸‹çš„æ‰€æœ‰çš„å¯ç”¨çš„ ApplicationListenerã€‚</p><p>1ï¼‰ã€getSpringFactoriesInstances() å’Œä¸Šé¢çš„ç±»ä¼¼ï¼Œä½†æ˜¯å®ƒæ˜¯ä»  META-INF/spring.factories çš„èµ„æºæ–‡ä»¶ä¸­ï¼Œè·å–åˆ° key ä¸º org.springframework.context.ApplicationListener çš„ valueã€‚</p><p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fqx6ty24gvj31kw0l3n7h.jpg" alt="2018-05-01_22-33-56"></p><p>2ï¼‰ã€setListeners()ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setListeners</span><span class="params">(Collection&lt;? extends ApplicationListener&lt;?&gt;&gt; listeners)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.listeners = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">  <span class="keyword">this</span>.listeners.addAll(listeners);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥ï¼Œè¿™é‡Œ setListeners() æ‰€å¾—åˆ°çš„æˆå‘˜å˜é‡ listeners å°±è¢«åˆå§‹åŒ–ä¸º ClearCachesApplicationListenerï¼ŒParentContextCloserApplicationListenerï¼ŒFileEncodingApplicationListenerï¼ŒAnsiOutputApplicationListener ï¼ŒConfigFileApplicationListenerï¼ŒDelegatingApplicationListenerï¼ŒClasspathLoggingApplicationListenerï¼ŒLoggingApplicationListenerï¼ŒLiquibaseServiceLocatorApplicationListener  è¿™ä¹ä¸ªç±»çš„å¯¹è±¡ç»„æˆçš„ listã€‚</p><p><strong>4ã€deduceMainApplicationClass()</strong> ï¼šæ ¹æ®è°ƒç”¨æ ˆï¼Œæ¨æ–­å‡º main æ–¹æ³•çš„ç±»å</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Class&lt;?&gt; deduceMainApplicationClass() &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    StackTraceElement[] stackTrace = <span class="keyword">new</span> RuntimeException().getStackTrace();</span><br><span class="line">    <span class="keyword">for</span> (StackTraceElement stackTraceElement : stackTrace) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="string">"main"</span>.equals(stackTraceElement.getMethodName())) &#123;</span><br><span class="line">        <span class="keyword">return</span> Class.forName(stackTraceElement.getClassName());</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">catch</span> (ClassNotFoundException ex) &#123;</span><br><span class="line">    <span class="comment">// Swallow and continue</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="run-æ–¹æ³•èƒŒåçš„ç§˜å¯†"><a href="#run-æ–¹æ³•èƒŒåçš„ç§˜å¯†" class="headerlink" title="run æ–¹æ³•èƒŒåçš„ç§˜å¯†"></a>run æ–¹æ³•èƒŒåçš„ç§˜å¯†</h3><p>ä¸Šé¢çœ‹å®Œäº†æ„é€ æ–¹æ³•åï¼Œå·²ç»åˆå§‹åŒ–äº†ä¸€ä¸ª SpringApplication å¯¹è±¡ï¼Œæ¥ä¸‹æ¥è°ƒç”¨å…¶ run æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¿è¡Œ Spring åº”ç”¨ç¨‹åºï¼Œåˆ›å»ºå¹¶åˆ·æ–°ä¸€ä¸ªæ–°çš„ ApplicationContext</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ConfigurableApplicationContext <span class="title">run</span><span class="params">(String... args)</span> </span>&#123;</span><br><span class="line">StopWatch stopWatch = <span class="keyword">new</span> StopWatch();</span><br><span class="line">stopWatch.start();</span><br><span class="line">ConfigurableApplicationContext context = <span class="keyword">null</span>;</span><br><span class="line">Collection&lt;SpringBootExceptionReporter&gt; exceptionReporters = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">configureHeadlessProperty();</span><br><span class="line">SpringApplicationRunListeners listeners = getRunListeners(args);</span><br><span class="line">listeners.starting();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">ApplicationArguments applicationArguments = <span class="keyword">new</span> DefaultApplicationArguments(</span><br><span class="line">args);</span><br><span class="line">ConfigurableEnvironment environment = prepareEnvironment(listeners,</span><br><span class="line">applicationArguments);</span><br><span class="line">configureIgnoreBeanInfo(environment);</span><br><span class="line">Banner printedBanner = printBanner(environment);</span><br><span class="line">context = createApplicationContext();</span><br><span class="line">exceptionReporters = getSpringFactoriesInstances(</span><br><span class="line">SpringBootExceptionReporter.class,</span><br><span class="line"><span class="keyword">new</span> Class[] &#123; ConfigurableApplicationContext.class &#125;, context);</span><br><span class="line">prepareContext(context, environment, listeners, applicationArguments,</span><br><span class="line">printedBanner);</span><br><span class="line">refreshContext(context);</span><br><span class="line">afterRefresh(context, applicationArguments);</span><br><span class="line">stopWatch.stop();</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>.logStartupInfo) &#123;</span><br><span class="line"><span class="keyword">new</span> StartupInfoLogger(<span class="keyword">this</span>.mainApplicationClass)</span><br><span class="line">.logStarted(getApplicationLog(), stopWatch);</span><br><span class="line">&#125;</span><br><span class="line">listeners.started(context);</span><br><span class="line">callRunners(context, applicationArguments);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (Throwable ex) &#123;</span><br><span class="line">handleRunFailure(context, ex, exceptionReporters, listeners);</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(ex);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">listeners.running(context);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (Throwable ex) &#123;</span><br><span class="line">handleRunFailure(context, ex, exceptionReporters, <span class="keyword">null</span>);</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(ex);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> context;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯å˜ä¸ªæ•°å‚æ•° args å³æ˜¯æˆ‘ä»¬æ•´ä¸ªåº”ç”¨ç¨‹åºçš„å…¥å£ main æ–¹æ³•çš„å‚æ•°ã€‚StopWatch æ˜¯æ¥è‡ª org.springframework.util çš„å·¥å…·ç±»ï¼Œå¯ä»¥ç”¨æ¥æ–¹ä¾¿çš„è®°å½•ç¨‹åºçš„è¿è¡Œæ—¶é—´ã€‚</p><p>å†æ¥çœ‹çœ‹ 1.5.12 ä¸ 2.0.1 ç‰ˆæœ¬çš„ run æ–¹æ³• æœ‰ä»€ä¹ˆä¸ä¸€æ ·çš„åœ°æ–¹ï¼Ÿ</p><p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fqx6u0khy1j31kw0wuhar.jpg" alt="difference-1.5-2.0"></p><p>æ¥ä¸‹æ¥å¥½å¥½åˆ†æä¸Šé¢æ–°ç‰ˆæœ¬ï¼ˆ2.0.1ï¼‰çš„ run æ–¹æ³•çš„ä»£ç å¹¶é…åˆæ¯”è¾ƒæ—§ç‰ˆæœ¬ï¼ˆ1.5.12ï¼‰ã€‚</p><p><strong>1ã€configureHeadlessProperty()</strong>ï¼šè®¾ç½® headless æ¨¡å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String SYSTEM_PROPERTY_JAVA_AWT_HEADLESS = <span class="string">"java.awt.headless"</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">boolean</span> headless = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">configureHeadlessProperty</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  System.setProperty(SYSTEM_PROPERTY_JAVA_AWT_HEADLESS, System.getProperty(</span><br><span class="line">    SYSTEM_PROPERTY_JAVA_AWT_HEADLESS, Boolean.toString(<span class="keyword">this</span>.headless)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®é™…ä¸Šæ˜¯å°±æ˜¯è®¾ç½®ç³»ç»Ÿå±æ€§ java.awt.headlessï¼Œè¯¥å±æ€§ä¼šè¢«è®¾ç½®ä¸º trueã€‚</p><p><strong>2ã€getRunListeners()</strong>ï¼šåŠ è½½ SpringApplicationRunListener å¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//<span class="doctag">TODO:</span>  xxx</span></span><br><span class="line">SpringApplicationRunListeners listeners = getRunListeners(args);<span class="comment">//åˆå§‹åŒ–ç›‘å¬å™¨</span></span><br><span class="line">listeners.starting();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  prepareContext(context, environment, listeners, applicationArguments, printedBanner);</span><br><span class="line">  refreshContext(context);</span><br><span class="line">  afterRefresh(context, applicationArguments);</span><br><span class="line">  listeners.started(context);</span><br><span class="line">  callRunners(context, applicationArguments);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  listeners.running(context);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> SpringApplicationRunListeners <span class="title">getRunListeners</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">  Class&lt;?&gt;[] types = <span class="keyword">new</span> Class&lt;?&gt;[] &#123; SpringApplication.class, String[].class &#125;;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> SpringApplicationRunListeners(logger, getSpringFactoriesInstances(</span><br><span class="line">    SpringApplicationRunListener.class, types, <span class="keyword">this</span>, args));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ getRunListeners() ä¸­ä¹Ÿåˆ©ç”¨ SpringFactoriesLoader åŠ è½½ META-INF/spring.factories ä¸­ key ä¸º SpringApplicationRunListener çš„å€¼ï¼Œç„¶åå†å°†è·å–åˆ°çš„å€¼ä½œä¸ºå‚æ•°ä¼ é€’åˆ° SpringApplicationRunListeners çš„æ„é€ æ–¹æ³•ä¸­å»åˆ›å»ºå¯¹è±¡ã€‚</p><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fqxei8t4u6j31do0ow0z9.jpg" alt="2018-05-02_23-11-01"></p><p><strong>3ã€new DefaultApplicationArguments(args)</strong> ï¼šè·å–å¯åŠ¨æ—¶ä¼ å…¥å‚æ•° argsï¼ˆmain æ–¹æ³•ä¼ è¿›æ¥çš„å‚æ•°ï¼‰ å¹¶åˆå§‹åŒ–ä¸º ApplicationArguments å¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">DefaultApplicationArguments</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">  Assert.notNull(args, <span class="string">"Args must not be null"</span>);</span><br><span class="line">  <span class="keyword">this</span>.source = <span class="keyword">new</span> Source(args);</span><br><span class="line">  <span class="keyword">this</span>.args = args;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>4ã€prepareEnvironment(listeners, applicationArguments)</strong>ï¼šæ ¹æ® listeners å’Œ applicationArguments é…ç½®SpringBoot åº”ç”¨çš„ç¯å¢ƒã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> ConfigurableEnvironment <span class="title">prepareEnvironment</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  SpringApplicationRunListeners listeners, ApplicationArguments applicationArguments)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// Create and configure the environment</span></span><br><span class="line">  ConfigurableEnvironment environment = getOrCreateEnvironment();</span><br><span class="line">  configureEnvironment(environment, applicationArguments.getSourceArgs());</span><br><span class="line">  listeners.environmentPrepared(environment);</span><br><span class="line">  bindToSpringApplication(environment);</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.webApplicationType == WebApplicationType.NONE) &#123;</span><br><span class="line">    environment = <span class="keyword">new</span> EnvironmentConverter(getClassLoader())</span><br><span class="line">      .convertToStandardEnvironmentIfNecessary(environment);</span><br><span class="line">  &#125;</span><br><span class="line">  ConfigurationPropertySources.attach(environment);</span><br><span class="line">  <span class="keyword">return</span> environment;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å¦‚æœ environment ä¸ä¸ºç©ºï¼Œç›´æ¥ get åˆ°ï¼Œå¦åˆ™åˆ›å»º</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> ConfigurableEnvironment <span class="title">getOrCreateEnvironment</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.environment != <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.environment;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.webApplicationType == WebApplicationType.SERVLET) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> StandardServletEnvironment();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> StandardEnvironment();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//é…ç½®ç¯å¢ƒ</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">configureEnvironment</span><span class="params">(ConfigurableEnvironment environment,String[] args)</span> </span>&#123;</span><br><span class="line">  configurePropertySources(environment, args);<span class="comment">//é…ç½®è¦ä½¿ç”¨çš„PropertySources</span></span><br><span class="line">  configureProfiles(environment, args);<span class="comment">//é…ç½®è¦ä½¿ç”¨çš„Profiles</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å°†ç¯å¢ƒç»‘å®šåˆ° SpringApplication</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">bindToSpringApplication</span><span class="params">(ConfigurableEnvironment environment)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    Binder.get(environment).bind(<span class="string">"spring.main"</span>, Bindable.ofInstance(<span class="keyword">this</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"Cannot bind to SpringApplication"</span>, ex);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>5ã€configureIgnoreBeanInfo(environment)</strong>ï¼šæ ¹æ®ç¯å¢ƒä¿¡æ¯é…ç½®è¦å¿½ç•¥çš„ bean ä¿¡æ¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String IGNORE_BEANINFO_PROPERTY_NAME = <span class="string">"spring.beaninfo.ignore"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">configureIgnoreBeanInfo</span><span class="params">(ConfigurableEnvironment environment)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (System.getProperty(</span><br><span class="line">    CachedIntrospectionResults.IGNORE_BEANINFO_PROPERTY_NAME) == <span class="keyword">null</span>) &#123;</span><br><span class="line">    Boolean ignore = environment.getProperty(<span class="string">"spring.beaninfo.ignore"</span>,</span><br><span class="line">                                             Boolean.class, Boolean.TRUE);</span><br><span class="line">    System.setProperty(CachedIntrospectionResults.IGNORE_BEANINFO_PROPERTY_NAME,</span><br><span class="line">                       ignore.toString());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>6ã€printBanner(environment)</strong>ï¼šæ‰“å°æ ‡å¿—ï¼Œä¸Šé¢æˆ‘å·²ç»è¯´è¿‡äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> Banner <span class="title">printBanner</span><span class="params">(ConfigurableEnvironment environment)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.bannerMode == Banner.Mode.OFF) &#123;<span class="comment">//å¦‚æœè®¾ç½®ä¸º offï¼Œä¸æ‰“å° Banner</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  ResourceLoader resourceLoader = <span class="keyword">this</span>.resourceLoader != <span class="keyword">null</span> ? <span class="keyword">this</span>.resourceLoader</span><br><span class="line">    : <span class="keyword">new</span> DefaultResourceLoader(getClassLoader());</span><br><span class="line">  SpringApplicationBannerPrinter bannerPrinter = <span class="keyword">new</span> SpringApplicationBannerPrinter(</span><br><span class="line">    resourceLoader, <span class="keyword">this</span>.banner);</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.bannerMode == Mode.LOG) &#123;</span><br><span class="line">    <span class="keyword">return</span> bannerPrinter.print(environment, <span class="keyword">this</span>.mainApplicationClass, logger);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> bannerPrinter.print(environment, <span class="keyword">this</span>.mainApplicationClass, System.out);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>7ã€createApplicationContext()</strong>ï¼šæ ¹æ®åº”ç”¨ç±»å‹æ¥ç¡®å®šè¯¥ Spring Boot é¡¹ç›®åº”è¯¥åˆ›å»ºä»€ä¹ˆç±»å‹çš„ ApplicationContext ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœæ²¡æœ‰æ˜ç¡®è®¾ç½®çš„åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡æˆ–åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ç±»ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨è¿”å›åˆé€‚çš„é»˜è®¤å€¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_WEB_CONTEXT_CLASS = <span class="string">"org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext"</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_REACTIVE_WEB_CONTEXT_CLASS = <span class="string">"org.springframework.boot.web.reactive.context.AnnotationConfigReactiveWebServerApplicationContext"</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_CONTEXT_CLASS = <span class="string">"org.springframework.context.annotation.AnnotationConfigApplicationContext"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> ConfigurableApplicationContext <span class="title">createApplicationContext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Class&lt;?&gt; contextClass = <span class="keyword">this</span>.applicationContextClass;</span><br><span class="line">  <span class="keyword">if</span> (contextClass == <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">switch</span> (<span class="keyword">this</span>.webApplicationType) &#123;<span class="comment">//æ ¹æ®åº”ç”¨ç¨‹åºçš„ç±»å‹æ¥åˆå§‹åŒ–å®¹å™¨</span></span><br><span class="line">        <span class="keyword">case</span> SERVLET:<span class="comment">//servlet åº”ç”¨ç¨‹åº</span></span><br><span class="line">          contextClass = Class.forName(DEFAULT_WEB_CONTEXT_CLASS);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> REACTIVE:<span class="comment">//reactive åº”ç”¨ç¨‹åº</span></span><br><span class="line">          contextClass = Class.forName(DEFAULT_REACTIVE_WEB_CONTEXT_CLASS);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:<span class="comment">//é»˜è®¤</span></span><br><span class="line">          contextClass = Class.forName(DEFAULT_CONTEXT_CLASS);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ClassNotFoundException ex) &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(</span><br><span class="line">    <span class="string">"Unable create a default ApplicationContext,please specify an     ApplicationContextClass"</span>,ex);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//æœ€åé€šè¿‡Springçš„å·¥å…·ç±» BeanUtils åˆå§‹åŒ–å®¹å™¨ç±» bean</span></span><br><span class="line">  <span class="keyword">return</span> (ConfigurableApplicationContext) BeanUtils.instantiateClass(contextClass);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥çœ‹çœ‹åœ¨ 1.5.12 ä¸­æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ</p><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fqx6tx7lchj31kw0nw4gr.jpg" alt="createApplicationContext"></p><p><strong>8ã€exceptionReporters = getSpringFactoriesInstances(      SpringBootExceptionReporter.class,      new Class[] { ConfigurableApplicationContext.class }, context)</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> &lt;T&gt; <span class="function">Collection&lt;T&gt; <span class="title">getSpringFactoriesInstances</span><span class="params">(Class&lt;T&gt; type,</span></span></span><br><span class="line"><span class="function"><span class="params">            Class&lt;?&gt;[] parameterTypes, Object... args)</span> </span>&#123;</span><br><span class="line">  ClassLoader classLoader = Thread.currentThread().getContextClassLoader();</span><br><span class="line">  <span class="comment">// Use names and ensure unique to protect against duplicates</span></span><br><span class="line">  Set&lt;String&gt; names = <span class="keyword">new</span> LinkedHashSet&lt;&gt;(</span><br><span class="line">    SpringFactoriesLoader.loadFactoryNames(type, classLoader));</span><br><span class="line">  List&lt;T&gt; instances = createSpringFactoriesInstances(type, parameterTypes,</span><br><span class="line">       classLoader, args, names);<span class="comment">//æ ¹æ®ç±»å‹ key ä¸º SpringBootExceptionReporter å»åŠ è½½</span></span><br><span class="line">  AnnotationAwareOrderComparator.sort(instances);<span class="comment">//å¯¹å®ä¾‹æ’åº</span></span><br><span class="line">  <span class="keyword">return</span> instances;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä¹Ÿæ˜¯é€šè¿‡ SpringFactoriesLoader åŠ è½½ META-INF/spring.factories ä¸­ key ä¸º SpringBootExceptionReporter çš„å…¨ç±»åçš„ value å€¼ã€‚</p><p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fqx6tp9y81j31kw0tfdqv.jpg" alt="springbootexception"></p><p><strong>9ã€prepareContext(context, environment, listeners, applicationArguments, printedBanner)</strong>ï¼šå®Œæˆæ•´ä¸ªå®¹å™¨çš„åˆ›å»ºä¸å¯åŠ¨ä»¥åŠ bean çš„æ³¨å…¥åŠŸèƒ½ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è£…é… Context</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">prepareContext</span><span class="params">(ConfigurableApplicationContext context,</span></span></span><br><span class="line"><span class="function"><span class="params">   ConfigurableEnvironment environment, SpringApplicationRunListeners listeners,</span></span></span><br><span class="line"><span class="function"><span class="params">   ApplicationArguments applicationArguments, Banner printedBanner)</span> </span>&#123;</span><br><span class="line">  <span class="comment">//å°†ä¹‹å‰å‡†å¤‡å¥½çš„ environment è®¾ç½®ç»™åˆ›å»ºå¥½çš„ ApplicationContext ä½¿ç”¨</span></span><br><span class="line">  context.setEnvironment(environment);</span><br><span class="line">  <span class="comment">//1ã€</span></span><br><span class="line">  postProcessApplicationContext(context);</span><br><span class="line">  <span class="comment">//2ã€</span></span><br><span class="line">  applyInitializers(context);</span><br><span class="line">  listeners.contextPrepared(context);</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.logStartupInfo) &#123;<span class="comment">//å¯åŠ¨æ—¥å¿—</span></span><br><span class="line">    logStartupInfo(context.getParent() == <span class="keyword">null</span>);</span><br><span class="line">    logStartupProfileInfo(context);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// Add boot specific singleton beans</span></span><br><span class="line">  context.getBeanFactory().registerSingleton(<span class="string">"springApplicationArguments"</span>,</span><br><span class="line">                                             applicationArguments);</span><br><span class="line">  <span class="keyword">if</span> (printedBanner != <span class="keyword">null</span>) &#123;</span><br><span class="line">    context.getBeanFactory().registerSingleton(<span class="string">"springBootBanner"</span>, printedBanner);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// Load the sources</span></span><br><span class="line">  Set&lt;Object&gt; sources = getAllSources();</span><br><span class="line">  Assert.notEmpty(sources, <span class="string">"Sources must not be empty"</span>);</span><br><span class="line">  <span class="comment">//3ã€</span></span><br><span class="line">  load(context, sources.toArray(<span class="keyword">new</span> Object[<span class="number">0</span>]));</span><br><span class="line">  listeners.contextLoaded(context);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>1ï¼‰ã€postProcessApplicationContext(context)</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String CONFIGURATION_BEAN_NAME_GENERATOR = <span class="string">"org.springframework.context.annotation.internalConfigurationBeanNameGenerator"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">postProcessApplicationContext</span><span class="params">(ConfigurableApplicationContext context)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.beanNameGenerator != <span class="keyword">null</span>) &#123;</span><br><span class="line">    context.getBeanFactory().registerSingleton(</span><br><span class="line">      AnnotationConfigUtils.CONFIGURATION_BEAN_NAME_GENERATOR,</span><br><span class="line">      <span class="keyword">this</span>.beanNameGenerator);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.resourceLoader != <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (context <span class="keyword">instanceof</span> GenericApplicationContext) &#123;</span><br><span class="line">      ((GenericApplicationContext) context)</span><br><span class="line">      .setResourceLoader(<span class="keyword">this</span>.resourceLoader);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (context <span class="keyword">instanceof</span> DefaultResourceLoader) &#123;</span><br><span class="line">      ((DefaultResourceLoader) context)</span><br><span class="line">      .setClassLoader(<span class="keyword">this</span>.resourceLoader.getClassLoader());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ³•å¯¹ context è¿›è¡Œäº†é¢„è®¾ç½®ï¼Œè®¾ç½®äº† ResourceLoader å’Œ ClassLoaderï¼Œå¹¶å‘ bean å·¥å‚ä¸­æ·»åŠ äº†ä¸€ä¸ªbeanNameGenerator ã€‚</p><p><strong>2ï¼‰ã€applyInitializers(context)</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">applyInitializers</span><span class="params">(ConfigurableApplicationContext context)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (ApplicationContextInitializer initializer : getInitializers()) &#123;</span><br><span class="line">    Class&lt;?&gt; requiredType = GenericTypeResolver.resolveTypeArgument(</span><br><span class="line">      initializer.getClass(), ApplicationContextInitializer.class);</span><br><span class="line">    Assert.isInstanceOf(requiredType, context, <span class="string">"Unable to call initializer."</span>);</span><br><span class="line">    initializer.initialize(context);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨åˆ·æ–°ä¹‹å‰å°†ä»»ä½• ApplicationContextInitializer åº”ç”¨äºä¸Šä¸‹æ–‡</p><p><strong>3)ã€load(context, sources.toArray(new Object[0]))</strong></p><p>ä¸»è¦æ˜¯åŠ è½½å„ç§ beans åˆ° ApplicationContext å¯¹è±¡ä¸­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">load</span><span class="params">(ApplicationContext context, Object[] sources)</span> </span>&#123;</span><br><span class="line">  BeanDefinitionLoader loader = createBeanDefinitionLoader( <span class="comment">//2</span></span><br><span class="line">    getBeanDefinitionRegistry(context), sources);<span class="comment">// 1</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.beanNameGenerator != <span class="keyword">null</span>) &#123;</span><br><span class="line">    loader.setBeanNameGenerator(<span class="keyword">this</span>.beanNameGenerator);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.resourceLoader != <span class="keyword">null</span>) &#123;</span><br><span class="line">    loader.setResourceLoader(<span class="keyword">this</span>.resourceLoader);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.environment != <span class="keyword">null</span>) &#123;</span><br><span class="line">    loader.setEnvironment(<span class="keyword">this</span>.environment);</span><br><span class="line">  &#125;</span><br><span class="line">  loader.load();<span class="comment">//3</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>(1)ã€getBeanDefinitionRegistry(context)</strong></p><p>è·å– bean å®šä¹‰æ³¨å†Œè¡¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> BeanDefinitionRegistry <span class="title">getBeanDefinitionRegistry</span><span class="params">(ApplicationContext context)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (context <span class="keyword">instanceof</span> BeanDefinitionRegistry) &#123;</span><br><span class="line">    <span class="keyword">return</span> (BeanDefinitionRegistry) context;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (context <span class="keyword">instanceof</span> AbstractApplicationContext) &#123;</span><br><span class="line">    <span class="keyword">return</span> (BeanDefinitionRegistry) ((AbstractApplicationContext) context)</span><br><span class="line">      .getBeanFactory();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"Could not locate BeanDefinitionRegistry"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>(2)ã€createBeanDefinitionLoader()</strong></p><p>é€šè¿‡ BeanDefinitionLoader çš„æ„é€ æ–¹æ³•æŠŠå‚æ•°ï¼ˆæ³¨å†Œè¡¨ã€èµ„æºï¼‰ä¼ è¿›å»ï¼Œç„¶ååˆ›å»º BeanDefinitionLoaderã€‚</p><p><strong>(3)ã€load()</strong></p><p>æŠŠèµ„æºå…¨éƒ¨åŠ è½½ã€‚</p><p><strong>10ã€refreshContext(context)</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">refreshContext</span><span class="params">(ConfigurableApplicationContext context)</span> </span>&#123;</span><br><span class="line">  refresh(context);<span class="comment">//1</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.registerShutdownHook) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      context.registerShutdownHook();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (AccessControlException ex) &#123;</span><br><span class="line">      <span class="comment">// Not allowed in some environments.</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åˆ·æ–°åº•å±‚çš„ ApplicationContext</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">refresh</span><span class="params">(ApplicationContext applicationContext)</span> </span>&#123;</span><br><span class="line">  Assert.isInstanceOf(AbstractApplicationContext.class, applicationContext);</span><br><span class="line">  ((AbstractApplicationContext) applicationContext).refresh();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>refreshContext(context) æ–¹æ³•åˆè°ƒç”¨äº† refresh(context)ã€‚åœ¨è°ƒç”¨äº† refresh(context) æ–¹æ³•ä¹‹åï¼Œè°ƒç”¨äº† registerShutdownHook æ–¹æ³•ã€‚ç»§ç»­çœ‹å®ƒçš„ refresh æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">refresh</span><span class="params">()</span> <span class="keyword">throws</span> BeansException, IllegalStateException </span>&#123;</span><br><span class="line">  <span class="keyword">synchronized</span> (<span class="keyword">this</span>.startupShutdownMonitor) &#123;</span><br><span class="line">    <span class="comment">// Prepare this context for refreshing.</span></span><br><span class="line">    prepareRefresh();</span><br><span class="line">    <span class="comment">// Tell the subclass to refresh the internal bean factory.</span></span><br><span class="line">    ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory();</span><br><span class="line">    <span class="comment">// Prepare the bean factory for use in this context.</span></span><br><span class="line">    prepareBeanFactory(beanFactory);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// Allows post-processing of the bean factory in context subclasses.</span></span><br><span class="line">      postProcessBeanFactory(beanFactory);</span><br><span class="line">      <span class="comment">// Invoke factory processors registered as beans in the context.</span></span><br><span class="line">      invokeBeanFactoryPostProcessors(beanFactory);</span><br><span class="line">      <span class="comment">// Register bean processors that intercept bean creation.</span></span><br><span class="line">      registerBeanPostProcessors(beanFactory);</span><br><span class="line">      <span class="comment">// Initialize message source for this context.</span></span><br><span class="line">      initMessageSource();</span><br><span class="line">      <span class="comment">// Initialize event multicaster for this context.</span></span><br><span class="line">      initApplicationEventMulticaster();</span><br><span class="line">      <span class="comment">// Initialize other special beans in specific context subclasses.</span></span><br><span class="line">      onRefresh();</span><br><span class="line">      <span class="comment">// Check for listener beans and register them.</span></span><br><span class="line">      registerListeners();</span><br><span class="line">      <span class="comment">// Instantiate all remaining (non-lazy-init) singletons.</span></span><br><span class="line">      finishBeanFactoryInitialization(beanFactory); <span class="comment">//1</span></span><br><span class="line">      <span class="comment">// Last step: publish corresponding event.</span></span><br><span class="line">      finishRefresh();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (BeansException ex) &#123;</span><br><span class="line">      ã€‚ã€‚ã€‚</span><br><span class="line">        <span class="comment">// Destroy already created singletons to avoid dangling resources.</span></span><br><span class="line">        destroyBeans();</span><br><span class="line">      <span class="comment">// Reset 'active' flag.</span></span><br><span class="line">      cancelRefresh(ex);</span><br><span class="line">      <span class="comment">// Propagate exception to caller.</span></span><br><span class="line">      <span class="keyword">throw</span> ex;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      <span class="comment">// Reset common introspection caches in Spring's core, since we</span></span><br><span class="line">      <span class="comment">// might not ever need metadata for singleton beans anymore...</span></span><br><span class="line">      resetCommonCaches();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±çœ‹è§é‡ç‚¹äº†ï¼Œä»”ç»†çœ‹ä¸Šçš„æ³¨é‡Šï¼Œæ­£åœ¨åšå„ç§åˆå§‹åŒ–å·¥ä½œï¼Œè€Œä»Šå¤©æˆ‘ä»¬å…³æ³¨çš„é‡ç‚¹å°±æ˜¯æ–¹æ³• finishBeanFactoryInitialization(beanFactory)ã€‚è¯¥æ–¹æ³•è¿›è¡Œäº†éæ‡’åŠ è½½ beans çš„åˆå§‹åŒ–å·¥ä½œã€‚ç°åœ¨æˆ‘ä»¬è¿›å…¥è¯¥æ–¹æ³•å†…éƒ¨ï¼Œä¸€æ¢ç©¶ç«Ÿã€‚</p><p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fqx6tli7pjj31kw1757h0.jpg" alt="finishbeanFactoryini"></p><p>çœ‹ä¸Šå›¾æ–¹æ³•ä¸­çš„æœ€åä¸€æ­¥ï¼Œè°ƒç”¨äº† beanFactory çš„ preInstantiateSingletons() æ–¹æ³•ã€‚æ­¤å¤„çš„ beanFactory æ˜¯å“ªä¸ªç±»çš„å®ä¾‹å¯¹è±¡å‘¢ï¼Ÿ</p><p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fqx6xir0iaj31kw0urjuy.jpg" alt="2018-05-02_16-17-50"></p><p>å¯ä»¥çœ‹åˆ° ConfigurableListableBeanFactory æ¥å£çš„å®ç°ç±»åªæœ‰ DefaultListableBeanFactoryï¼Œæˆ‘ä»¬çœ‹ä¸‹å®ç°ç±»ä¸­çš„ preInstantiateSingletons æ–¹æ³•æ˜¯æ€ä¹ˆåšçš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">preInstantiateSingletons</span><span class="params">()</span> <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">  <span class="comment">// Iterate over a copy to allow for init methods which in turn register new bean definitions.</span></span><br><span class="line">  <span class="comment">// While this may not be part of the regular factory bootstrap, it does otherwise work fine.</span></span><br><span class="line">  List&lt;String&gt; beanNames = <span class="keyword">new</span> ArrayList&lt;&gt;(<span class="keyword">this</span>.beanDefinitionNames);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Trigger initialization of all non-lazy singleton beans...</span></span><br><span class="line">  <span class="keyword">for</span> (String beanName : beanNames) &#123;</span><br><span class="line">    RootBeanDefinition bd = getMergedLocalBeanDefinition(beanName);</span><br><span class="line">    <span class="keyword">if</span> (!bd.isAbstract() &amp;&amp; bd.isSingleton() &amp;&amp; !bd.isLazyInit()) &#123;</span><br><span class="line">      <span class="keyword">if</span> (isFactoryBean(beanName)) &#123;</span><br><span class="line">        Object bean = getBean(FACTORY_BEAN_PREFIX + beanName);</span><br><span class="line">        <span class="keyword">if</span> (bean <span class="keyword">instanceof</span> FactoryBean) &#123;</span><br><span class="line">          <span class="keyword">final</span> FactoryBean&lt;?&gt; factory = (FactoryBean&lt;?&gt;) bean;</span><br><span class="line">          <span class="keyword">boolean</span> isEagerInit;</span><br><span class="line">         <span class="keyword">if</span> (System.getSecurityManager() != <span class="keyword">null</span> &amp;&amp; factory <span class="keyword">instanceof</span> SmartFactoryBean)&#123;</span><br><span class="line">            isEagerInit = AccessController.doPrivileged((PrivilegedAction&lt;Boolean&gt;)</span><br><span class="line">             ((SmartFactoryBean&lt;?&gt;) factory)::isEagerInit, getAccessControlContext());</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            isEagerInit = (factory <span class="keyword">instanceof</span> SmartFactoryBean &amp;&amp;</span><br><span class="line">                           ((SmartFactoryBean&lt;?&gt;) factory).isEagerInit());</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> (isEagerInit) &#123;</span><br><span class="line">            getBean(beanName);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        getBean(beanName);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Trigger post-initialization callback for all applicable beans...</span></span><br><span class="line">  <span class="keyword">for</span> (String beanName : beanNames) &#123;</span><br><span class="line">    Object singletonInstance = getSingleton(beanName);</span><br><span class="line">    <span class="keyword">if</span> (singletonInstance <span class="keyword">instanceof</span> SmartInitializingSingleton) &#123;</span><br><span class="line">      <span class="keyword">final</span> SmartInitializingSingleton smartSingleton = (SmartInitializingSingleton) singletonInstance;</span><br><span class="line">      <span class="keyword">if</span> (System.getSecurityManager() != <span class="keyword">null</span>) &#123;</span><br><span class="line">        AccessController.doPrivileged((PrivilegedAction&lt;Object&gt;) () -&gt; &#123;</span><br><span class="line">          smartSingleton.afterSingletonsInstantiated();</span><br><span class="line">          <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;, getAccessControlContext());</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        smartSingleton.afterSingletonsInstantiated();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢çš„ä»£ç ä¸­å¯ä»¥çœ‹åˆ°å¾ˆå¤šè°ƒç”¨äº† getBean(beanName) æ–¹æ³•ï¼Œè·Ÿè¸ªæ­¤æ–¹æ³•è¿›å»åï¼Œæœ€ç»ˆå‘ç° getBean è°ƒç”¨äº†AbstractBeanFactory ç±»çš„ doGetBean(xxx) æ–¹æ³•ï¼ŒdoGetBean(xxx) æ–¹æ³•ä¸­æœ‰è¿™ä¹ˆä¸€æ®µä»£ç ï¼š</p><p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fqx6tr2ukqj31je1fegwm.jpg" alt="2018-05-02_17-17-39"></p><p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fqx6xjtn0hj31ja17g15o.jpg" alt="2018-05-02_17-19-31"></p><p>ä½†æ˜¯ createBean() æ–¹æ³•å¹¶æ²¡æœ‰å¾—åˆ°å®ç°ï¼Œå®ç°ç±»åœ¨ AbstractAutowireCapableBeanFactory ä¸­ã€‚è¿™æ‰æ˜¯åˆ›å»º bean çš„æ ¸å¿ƒæ–¹æ³•ã€‚</p><p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fqx6toc4dxj31kw1bana4.jpg" alt="createBean"></p><p>ä¸çŸ¥ä¸è§‰ï¼Œä»£ç çœ‹çš„è¶Šæ¥è¶Šæ·±ï¼Œæ„Ÿè§‰æ€ç»´éƒ½å·®ç‚¹å›ä¸å» run æ–¹æ³•äº†ï¼Œåˆ‡å›å¤§è„‘çš„ä¸Šä¸‹æ–‡çº¿ç¨‹åˆ° run æ–¹æ³•å»ã€‚</p><p><strong>11ã€afterRefresh(context, applicationArguments)</strong>ï¼šåœ¨ä¸Šä¸‹æ–‡åˆ·æ–°åè°ƒç”¨è¯¥æ–¹æ³•ï¼Œå…¶å†…éƒ¨æ²¡æœ‰åšä»»ä½•æ“ä½œã€‚</p><p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fqx6tnnz8vj31bs0pkgrg.jpg" alt="2018-05-02_17-43-23"></p><p>å‘ç°æ²¡åšä»»ä½•æ“ä½œäº†ä¹‹åï¼Œå°±è§‰å¾—æœ‰ç‚¹å¥‡æ€ªï¼Œæ‰€ä»¥æŠŠå½“å‰ç‰ˆæœ¬å’Œ 1.5.12  å¯¹æ¯”äº†ä¸‹ï¼Œå‘ç°ï¼š</p><p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fqx6ts33l2j31kw0witww.jpg" alt="afterRefresh"></p><p>åœ¨ 1.5.12 ä¸­çš„ afterRefresh() æ–¹æ³•ä¸­è°ƒç”¨äº† callRunners() æ–¹æ³•ï¼Œä½†æ˜¯åœ¨ 2.0.1 ç‰ˆæœ¬ä¸­çš„ run æ–¹æ³•ä¸­è°ƒç”¨äº† callRunners () æ–¹æ³•:</p><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fqx6xmgbpvj31kw0x8hc4.jpg" alt="2018-05-02_17-57-52"></p><p>è¿™é‡Œä¸å¾—ä¸è¯´ SpringApplicationRunListeners åœ¨ 2.0.1 ä¸­çš„æ”¹å˜ï¼š</p><p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fqx6tq6fzhj31kw0y5azk.jpg" alt="2018-05-02_18-28-17"></p><p>å¯ä»¥å‘ç°åœ¨ run æ–¹æ³•ä¸­ï¼ŒSpringApplicationRunListeners ç›‘å¬å™¨çš„çŠ¶æ€èŠ±ç”Ÿäº†å˜åŒ–ï¼Œè¿™ä¹Ÿæ˜¯é€šè¿‡å¯¹æ¯”ä¸åŒç‰ˆæœ¬çš„ä»£ç æ‰çŸ¥é“çš„åŒºåˆ«ï¼Œæ‰€ä»¥è¯´æˆ‘ä»¬çœ‹æºç éœ€è¦å¤šå¯¹æ¯”ç€çœ‹ã€‚</p><p>soï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹è¿™ä¸ª SpringApplicationRunListener è¿™ä¸ªæ¥å£ï¼š</p><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fqx6xla7afj31kw0unx1j.jpg" alt="2018-05-02_18-33-20"></p><p>started çŠ¶æ€ï¼šThe context has been refreshed and the application has started but CommandLineRunner and ApplicationRunner have not been called</p><p>running çŠ¶æ€ï¼šCalled immediately before the run method finishes, when the application context has been refreshed and all CommandLineRunner and ApplicationRunners have been called.</p><h3 id="ç›¸å…³æ–‡ç« "><a href="#ç›¸å…³æ–‡ç« " class="headerlink" title="ç›¸å…³æ–‡ç« "></a>ç›¸å…³æ–‡ç« </h3><p>1ã€<a href="http://www.54tianzhisheng.cn/2018/03/06/SpringBoot2-Migration-Guide/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (ä¸€)ï¼šSpring Boot 2.0 è¿ç§»æŒ‡å—</a></p><p>2ã€<a href="http://www.54tianzhisheng.cn/2018/03/06/SpringBoot2-new-features/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (äºŒ)ï¼šSpring Boot 2.0 æ–°ç‰¹æ€§è¯¦è§£</a></p><p>3ã€<a href="http://www.54tianzhisheng.cn/2018/04/13/Spring_Boot_2.0_Configuration_Changelog/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (ä¸‰)ï¼šSpring Boot 2.0 é…ç½®æ”¹å˜</a></p><p>4ã€<a href="http://www.54tianzhisheng.cn/2018/04/15/springboot2_code/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (å››)ï¼šSpring Boot 2.0 æºç é˜…è¯»ç¯å¢ƒæ­å»º</a></p><p>5ã€<a href="http://www.54tianzhisheng.cn/2018/04/18/spring_boot2_project/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (äº”)ï¼šSpring Boot 2.0 é¡¹ç›®æºç ç»“æ„é¢„è§ˆ</a></p><p>6ã€<a href="http://www.54tianzhisheng.cn/2018/04/19/SpringBootApplication-annotation/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (å…­)ï¼šSpring boot 2.0 ä¸­ SpringBootApplication æ³¨è§£è¯¦è§£</a></p><p>7ã€<a href="http://www.54tianzhisheng.cn/2018/04/30/springboot_SpringApplication/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (ä¸ƒ)ï¼šSpringApplication æ·±å…¥æ¢ç´¢</a></p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æœ¬æ–‡ä»æºç çº§åˆ«åˆ†æäº† Spring Boot åº”ç”¨ç¨‹åºçš„å¯åŠ¨è¿‡ç¨‹ï¼Œç€é‡çœ‹äº† SpringApplication ç±»ä¸­çš„æ„é€ å‡½æ•°çš„åˆå§‹åŒ–å’Œå…¶ run æ–¹æ³•å†…éƒ¨å®ç°ï¼Œå¹¶æŠŠæ¶‰åŠåˆ°çš„æµç¨‹ä»£ç éƒ½è¿‡äº†ä¸€éã€‚</p><p>æ„Ÿæ‚Ÿï¼šæœ‰æ—¶å€™è·Ÿä»£ç è·Ÿç€è·Ÿç€ï¼Œå‘ç°è¶Šé™·è¶Šæ·±ï¼Œå¥½éš¾è·³å‡ºæ¥ï¼åé¢è¿˜éœ€å¤šå‘åˆ«äººè¯·æ•™é˜…è¯»æºç çš„æŠ€å·§ï¼</p><h3 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h3><p>è™½ç„¶æºç å¾ˆéš¾ï¼Œä½†éšç€ä¸æ–­çš„æ¢ç´¢ï¼Œæºç åœ¨ä½ é¢å‰å°†ä¼šä¸€è§ˆæ— é—ï¼Œäº«å—è¿™ç§æ¢ç´¢åçš„æˆå°±æ„Ÿï¼åŠ æ²¹ï¼éªšå¹´ï¼</p><p>è‡ªå·±æœ¬äººèƒ½åŠ›æœ‰é™ï¼Œæºç çœ‹çš„ä¸å¤šï¼Œä¸Šé¢å¦‚æœ‰ä¸å¯¹çš„è¿˜è¯·ç•™è¨€äº¤æµã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://ws3.sinaimg.cn/large/006tKfTcgy1fqxbkmfds2j31hc0oegze.jpg&quot; alt=&quot;sunset-3325080_1920&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="Java" scheme="http://yoursite.com/tags/Java/"/>
    
      <category term="SpringBoot" scheme="http://yoursite.com/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>åˆ†å¸ƒå¼é”çœ‹è¿™ç¯‡å°±å¤Ÿäº†</title>
    <link href="http://yoursite.com/2018/04/24/Distributed_lock/"/>
    <id>http://yoursite.com/2018/04/24/Distributed_lock/</id>
    <published>2018-04-23T16:00:00.000Z</published>
    <updated>2018-05-02T13:21:14.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1fqp2lqscrwj31hc0zk46a.jpg" alt="meadow-811339_1920"></p><a id="more"></a><h3 id="å…³æ³¨æˆ‘"><a href="#å…³æ³¨æˆ‘" class="headerlink" title="å…³æ³¨æˆ‘"></a>å…³æ³¨æˆ‘</h3><p><img src="http://ohfk1r827.bkt.clouddn.com/blog/180103/C6LG3mGa12.jpg" alt="mark"></p><p>è½¬è½½è¯·åŠ¡å¿…æ³¨æ˜åŸåˆ›åœ°å€ä¸ºï¼š<a href="http://www.54tianzhisheng.cn/2018/04/24/Distributed_lock/" target="_blank" rel="noopener">http://www.54tianzhisheng.cn/2018/04/24/Distributed_lock/</a></p><h3 id="ä»€ä¹ˆæ˜¯é”ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯é”ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯é”ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯é”ï¼Ÿ</h3><ul><li>åœ¨å•è¿›ç¨‹çš„ç³»ç»Ÿä¸­ï¼Œå½“å­˜åœ¨å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶æ”¹å˜æŸä¸ªå˜é‡ï¼ˆå¯å˜å…±äº«å˜é‡ï¼‰æ—¶ï¼Œå°±éœ€è¦å¯¹å˜é‡æˆ–ä»£ç å—åšåŒæ­¥ï¼Œä½¿å…¶åœ¨ä¿®æ”¹è¿™ç§å˜é‡æ—¶èƒ½å¤Ÿçº¿æ€§æ‰§è¡Œæ¶ˆé™¤å¹¶å‘ä¿®æ”¹å˜é‡ã€‚</li><li>è€ŒåŒæ­¥çš„æœ¬è´¨æ˜¯é€šè¿‡é”æ¥å®ç°çš„ã€‚ä¸ºäº†å®ç°å¤šä¸ªçº¿ç¨‹åœ¨ä¸€ä¸ªæ—¶åˆ»åŒä¸€ä¸ªä»£ç å—åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹å¯æ‰§è¡Œï¼Œé‚£ä¹ˆéœ€è¦åœ¨æŸä¸ªåœ°æ–¹åšä¸ªæ ‡è®°ï¼Œè¿™ä¸ªæ ‡è®°å¿…é¡»æ¯ä¸ªçº¿ç¨‹éƒ½èƒ½çœ‹åˆ°ï¼Œå½“æ ‡è®°ä¸å­˜åœ¨æ—¶å¯ä»¥è®¾ç½®è¯¥æ ‡è®°ï¼Œå…¶ä½™åç»­çº¿ç¨‹å‘ç°å·²ç»æœ‰æ ‡è®°äº†åˆ™ç­‰å¾…æ‹¥æœ‰æ ‡è®°çš„çº¿ç¨‹ç»“æŸåŒæ­¥ä»£ç å—å–æ¶ˆæ ‡è®°åå†å»å°è¯•è®¾ç½®æ ‡è®°ã€‚è¿™ä¸ªæ ‡è®°å¯ä»¥ç†è§£ä¸ºé”ã€‚</li><li>ä¸åŒåœ°æ–¹å®ç°é”çš„æ–¹å¼ä¹Ÿä¸ä¸€æ ·ï¼Œåªè¦èƒ½æ»¡è¶³æ‰€æœ‰çº¿ç¨‹éƒ½èƒ½çœ‹å¾—åˆ°æ ‡è®°å³å¯ã€‚å¦‚ Java ä¸­ synchronize æ˜¯åœ¨å¯¹è±¡å¤´è®¾ç½®æ ‡è®°ï¼ŒLock æ¥å£çš„å®ç°ç±»åŸºæœ¬ä¸Šéƒ½åªæ˜¯æŸä¸€ä¸ª volitile ä¿®é¥°çš„ int å‹å˜é‡å…¶ä¿è¯æ¯ä¸ªçº¿ç¨‹éƒ½èƒ½æ‹¥æœ‰å¯¹è¯¥ int çš„å¯è§æ€§å’ŒåŸå­ä¿®æ”¹ï¼Œlinux å†…æ ¸ä¸­ä¹Ÿæ˜¯åˆ©ç”¨äº’æ–¥é‡æˆ–ä¿¡å·é‡ç­‰å†…å­˜æ•°æ®åšæ ‡è®°ã€‚</li><li>é™¤äº†åˆ©ç”¨å†…å­˜æ•°æ®åšé”å…¶å®ä»»ä½•äº’æ–¥çš„éƒ½èƒ½åšé”ï¼ˆåªè€ƒè™‘äº’æ–¥æƒ…å†µï¼‰ï¼Œå¦‚æµæ°´è¡¨ä¸­æµæ°´å·ä¸æ—¶é—´ç»“åˆåšå¹‚ç­‰æ ¡éªŒå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªä¸ä¼šé‡Šæ”¾çš„é”ï¼Œæˆ–è€…ä½¿ç”¨æŸä¸ªæ–‡ä»¶æ˜¯å¦å­˜åœ¨ä½œä¸ºé”ç­‰ã€‚åªéœ€è¦æ»¡è¶³åœ¨å¯¹æ ‡è®°è¿›è¡Œä¿®æ”¹èƒ½ä¿è¯åŸå­æ€§å’Œå†…å­˜å¯è§æ€§å³å¯ã€‚</li></ul><h3 id="ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼ï¼Ÿ</h3><p>åˆ†å¸ƒå¼çš„ CAP ç†è®ºå‘Šè¯‰æˆ‘ä»¬:</p><blockquote><p>ä»»ä½•ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿéƒ½æ— æ³•åŒæ—¶æ»¡è¶³ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ã€å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰å’Œåˆ†åŒºå®¹é”™æ€§ï¼ˆPartition toleranceï¼‰ï¼Œæœ€å¤šåªèƒ½åŒæ—¶æ»¡è¶³ä¸¤é¡¹ã€‚</p></blockquote><p>ç›®å‰å¾ˆå¤šå¤§å‹ç½‘ç«™åŠåº”ç”¨éƒ½æ˜¯åˆ†å¸ƒå¼éƒ¨ç½²çš„ï¼Œåˆ†å¸ƒå¼åœºæ™¯ä¸­çš„æ•°æ®ä¸€è‡´æ€§é—®é¢˜ä¸€ç›´æ˜¯ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„è¯é¢˜ã€‚åŸºäº CAPç†è®ºï¼Œå¾ˆå¤šç³»ç»Ÿåœ¨è®¾è®¡ä¹‹åˆå°±è¦å¯¹è¿™ä¸‰è€…åšå‡ºå–èˆã€‚åœ¨äº’è”ç½‘é¢†åŸŸçš„ç»å¤§å¤šæ•°çš„åœºæ™¯ä¸­ï¼Œéƒ½éœ€è¦ç‰ºç‰²å¼ºä¸€è‡´æ€§æ¥æ¢å–ç³»ç»Ÿçš„é«˜å¯ç”¨æ€§ï¼Œç³»ç»Ÿå¾€å¾€åªéœ€è¦ä¿è¯æœ€ç»ˆä¸€è‡´æ€§ã€‚</p><h4 id="åˆ†å¸ƒå¼åœºæ™¯"><a href="#åˆ†å¸ƒå¼åœºæ™¯" class="headerlink" title="åˆ†å¸ƒå¼åœºæ™¯"></a>åˆ†å¸ƒå¼åœºæ™¯</h4><blockquote><p>æ­¤å¤„ä¸»è¦æŒ‡é›†ç¾¤æ¨¡å¼ä¸‹ï¼Œå¤šä¸ªç›¸åŒæœåŠ¡åŒæ—¶å¼€å¯.</p></blockquote><p>åœ¨è®¸å¤šçš„åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬ä¸ºäº†ä¿è¯æ•°æ®çš„æœ€ç»ˆä¸€è‡´æ€§ï¼Œéœ€è¦å¾ˆå¤šçš„æŠ€æœ¯æ–¹æ¡ˆæ¥æ”¯æŒï¼Œæ¯”å¦‚<strong>åˆ†å¸ƒå¼äº‹åŠ¡</strong>ã€<strong>åˆ†å¸ƒå¼é”</strong>ç­‰ã€‚å¾ˆå¤šæ—¶å€™æˆ‘ä»¬éœ€è¦ä¿è¯ä¸€ä¸ªæ–¹æ³•åœ¨åŒä¸€æ—¶é—´å†…åªèƒ½è¢«åŒä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œã€‚åœ¨å•æœºç¯å¢ƒä¸­ï¼Œé€šè¿‡ Java æä¾›çš„å¹¶å‘ API æˆ‘ä»¬å¯ä»¥è§£å†³ï¼Œä½†æ˜¯åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ï¼Œå°±æ²¡æœ‰é‚£ä¹ˆç®€å•å•¦ã€‚</p><ul><li>åˆ†å¸ƒå¼ä¸å•æœºæƒ…å†µä¸‹æœ€å¤§çš„ä¸åŒåœ¨äºå…¶ä¸æ˜¯å¤šçº¿ç¨‹è€Œæ˜¯<strong>å¤šè¿›ç¨‹</strong>ã€‚</li><li>å¤šçº¿ç¨‹ç”±äºå¯ä»¥å…±äº«å †å†…å­˜ï¼Œå› æ­¤å¯ä»¥ç®€å•çš„é‡‡å–å†…å­˜ä½œä¸ºæ ‡è®°å­˜å‚¨ä½ç½®ã€‚è€Œè¿›ç¨‹ä¹‹é—´ç”šè‡³å¯èƒ½éƒ½ä¸åœ¨åŒä¸€å°ç‰©ç†æœºä¸Šï¼Œå› æ­¤éœ€è¦å°†æ ‡è®°å­˜å‚¨åœ¨ä¸€ä¸ªæ‰€æœ‰è¿›ç¨‹éƒ½èƒ½çœ‹åˆ°çš„åœ°æ–¹ã€‚</li></ul><h4 id="ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼é”ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼é”ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼é”ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼é”ï¼Ÿ</h4><ul><li>å½“åœ¨åˆ†å¸ƒå¼æ¨¡å‹ä¸‹ï¼Œæ•°æ®åªæœ‰ä¸€ä»½ï¼ˆæˆ–æœ‰é™åˆ¶ï¼‰ï¼Œæ­¤æ—¶éœ€è¦åˆ©ç”¨é”çš„æŠ€æœ¯æ§åˆ¶æŸä¸€æ—¶åˆ»ä¿®æ”¹æ•°æ®çš„è¿›ç¨‹æ•°ã€‚</li><li>ä¸å•æœºæ¨¡å¼ä¸‹çš„é”ä¸ä»…éœ€è¦ä¿è¯è¿›ç¨‹å¯è§ï¼Œè¿˜éœ€è¦è€ƒè™‘è¿›ç¨‹ä¸é”ä¹‹é—´çš„ç½‘ç»œé—®é¢˜ã€‚ï¼ˆæˆ‘è§‰å¾—åˆ†å¸ƒå¼æƒ…å†µä¸‹ä¹‹æ‰€ä»¥é—®é¢˜å˜å¾—å¤æ‚ï¼Œä¸»è¦å°±æ˜¯éœ€è¦è€ƒè™‘åˆ°<strong>ç½‘ç»œçš„å»¶æ—¶å’Œä¸å¯é </strong>ã€‚ã€‚ã€‚ä¸€ä¸ªå¤§å‘ï¼‰</li><li>åˆ†å¸ƒå¼é”è¿˜æ˜¯å¯ä»¥å°†æ ‡è®°å­˜åœ¨å†…å­˜ï¼Œåªæ˜¯è¯¥å†…å­˜ä¸æ˜¯æŸä¸ªè¿›ç¨‹åˆ†é…çš„å†…å­˜è€Œæ˜¯å…¬å…±å†…å­˜å¦‚ Redisã€Memcacheã€‚è‡³äºåˆ©ç”¨æ•°æ®åº“ã€æ–‡ä»¶ç­‰åšé”ä¸å•æœºçš„å®ç°æ˜¯ä¸€æ ·çš„ï¼Œåªè¦ä¿è¯æ ‡è®°èƒ½äº’æ–¥å°±è¡Œã€‚</li></ul><h3 id="æˆ‘ä»¬éœ€è¦æ€æ ·çš„åˆ†å¸ƒå¼é”ï¼Ÿ"><a href="#æˆ‘ä»¬éœ€è¦æ€æ ·çš„åˆ†å¸ƒå¼é”ï¼Ÿ" class="headerlink" title="æˆ‘ä»¬éœ€è¦æ€æ ·çš„åˆ†å¸ƒå¼é”ï¼Ÿ"></a>æˆ‘ä»¬éœ€è¦æ€æ ·çš„åˆ†å¸ƒå¼é”ï¼Ÿ</h3><ul><li>å¯ä»¥ä¿è¯åœ¨åˆ†å¸ƒå¼éƒ¨ç½²çš„åº”ç”¨é›†ç¾¤ä¸­ï¼ŒåŒä¸€ä¸ªæ–¹æ³•åœ¨åŒä¸€æ—¶é—´åªèƒ½è¢«ä¸€å°æœºå™¨ä¸Šçš„ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œã€‚</li><li>è¿™æŠŠé”è¦æ˜¯ä¸€æŠŠå¯é‡å…¥é”ï¼ˆé¿å…æ­»é”ï¼‰</li><li>è¿™æŠŠé”æœ€å¥½æ˜¯ä¸€æŠŠé˜»å¡é”ï¼ˆæ ¹æ®ä¸šåŠ¡éœ€æ±‚è€ƒè™‘è¦ä¸è¦è¿™æ¡ï¼‰</li><li>è¿™æŠŠé”æœ€å¥½æ˜¯ä¸€æŠŠå…¬å¹³é”ï¼ˆæ ¹æ®ä¸šåŠ¡éœ€æ±‚è€ƒè™‘è¦ä¸è¦è¿™æ¡ï¼‰</li><li>æœ‰é«˜å¯ç”¨çš„è·å–é”å’Œé‡Šæ”¾é”åŠŸèƒ½</li><li>è·å–é”å’Œé‡Šæ”¾é”çš„æ€§èƒ½è¦å¥½</li></ul><h3 id="åŸºäºæ•°æ®åº“åšåˆ†å¸ƒå¼é”"><a href="#åŸºäºæ•°æ®åº“åšåˆ†å¸ƒå¼é”" class="headerlink" title="åŸºäºæ•°æ®åº“åšåˆ†å¸ƒå¼é”"></a>åŸºäºæ•°æ®åº“åšåˆ†å¸ƒå¼é”</h3><blockquote><p>åŸºäºä¹è§‚é”</p></blockquote><h4 id="åŸºäºè¡¨ä¸»é”®å”¯ä¸€åšåˆ†å¸ƒå¼é”"><a href="#åŸºäºè¡¨ä¸»é”®å”¯ä¸€åšåˆ†å¸ƒå¼é”" class="headerlink" title="åŸºäºè¡¨ä¸»é”®å”¯ä¸€åšåˆ†å¸ƒå¼é”"></a>åŸºäºè¡¨ä¸»é”®å”¯ä¸€åšåˆ†å¸ƒå¼é”</h4><p>åˆ©ç”¨ä¸»é”®å”¯ä¸€çš„ç‰¹æ€§ï¼Œå¦‚æœæœ‰å¤šä¸ªè¯·æ±‚åŒæ—¶æäº¤åˆ°æ•°æ®åº“çš„è¯ï¼Œæ•°æ®åº“ä¼šä¿è¯åªæœ‰ä¸€ä¸ªæ“ä½œå¯ä»¥æˆåŠŸï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è®¤ä¸ºæ“ä½œæˆåŠŸçš„é‚£ä¸ªçº¿ç¨‹è·å¾—äº†è¯¥æ–¹æ³•çš„é”ï¼Œå½“æ–¹æ³•æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œæƒ³è¦é‡Šæ”¾é”çš„è¯ï¼Œåˆ é™¤è¿™æ¡æ•°æ®åº“è®°å½•å³å¯ã€‚</p><p>ä¸Šé¢è¿™ç§ç®€å•çš„å®ç°æœ‰ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š</p><ul><li>è¿™æŠŠé”å¼ºä¾èµ–æ•°æ®åº“çš„å¯ç”¨æ€§ï¼Œæ•°æ®åº“æ˜¯ä¸€ä¸ªå•ç‚¹ï¼Œä¸€æ—¦æ•°æ®åº“æŒ‚æ‰ï¼Œä¼šå¯¼è‡´ä¸šåŠ¡ç³»ç»Ÿä¸å¯ç”¨ã€‚</li><li>è¿™æŠŠé”æ²¡æœ‰å¤±æ•ˆæ—¶é—´ï¼Œä¸€æ—¦è§£é”æ“ä½œå¤±è´¥ï¼Œå°±ä¼šå¯¼è‡´é”è®°å½•ä¸€ç›´åœ¨æ•°æ®åº“ä¸­ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•å†è·å¾—åˆ°é”ã€‚</li><li>è¿™æŠŠé”åªèƒ½æ˜¯éé˜»å¡çš„ï¼Œå› ä¸ºæ•°æ®çš„ insert æ“ä½œï¼Œä¸€æ—¦æ’å…¥å¤±è´¥å°±ä¼šç›´æ¥æŠ¥é”™ã€‚æ²¡æœ‰è·å¾—é”çš„çº¿ç¨‹å¹¶ä¸ä¼šè¿›å…¥æ’é˜Ÿé˜Ÿåˆ—ï¼Œè¦æƒ³å†æ¬¡è·å¾—é”å°±è¦å†æ¬¡è§¦å‘è·å¾—é”æ“ä½œã€‚</li><li>è¿™æŠŠé”æ˜¯éé‡å…¥çš„ï¼ŒåŒä¸€ä¸ªçº¿ç¨‹åœ¨æ²¡æœ‰é‡Šæ”¾é”ä¹‹å‰æ— æ³•å†æ¬¡è·å¾—è¯¥é”ã€‚å› ä¸ºæ•°æ®ä¸­æ•°æ®å·²ç»å­˜åœ¨äº†ã€‚</li><li>è¿™æŠŠé”æ˜¯éå…¬å¹³é”ï¼Œæ‰€æœ‰ç­‰å¾…é”çš„çº¿ç¨‹å‡­è¿æ°”å»äº‰å¤ºé”ã€‚</li><li>åœ¨ MySQL æ•°æ®åº“ä¸­é‡‡ç”¨ä¸»é”®å†²çªé˜²é‡ï¼Œåœ¨å¤§å¹¶å‘æƒ…å†µä¸‹æœ‰å¯èƒ½ä¼šé€ æˆé”è¡¨ç°è±¡ã€‚</li></ul><p>å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æœ‰å…¶ä»–æ–¹å¼è§£å†³ä¸Šé¢çš„é—®é¢˜ã€‚</p><ul><li>æ•°æ®åº“æ˜¯å•ç‚¹ï¼Ÿæä¸¤ä¸ªæ•°æ®åº“ï¼Œæ•°æ®ä¹‹å‰åŒå‘åŒæ­¥ï¼Œä¸€æ—¦æŒ‚æ‰å¿«é€Ÿåˆ‡æ¢åˆ°å¤‡åº“ä¸Šã€‚</li><li>æ²¡æœ‰å¤±æ•ˆæ—¶é—´ï¼Ÿåªè¦åšä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œæ¯éš”ä¸€å®šæ—¶é—´æŠŠæ•°æ®åº“ä¸­çš„è¶…æ—¶æ•°æ®æ¸…ç†ä¸€éã€‚</li><li>éé˜»å¡çš„ï¼Ÿæä¸€ä¸ª while å¾ªç¯ï¼Œç›´åˆ° insert æˆåŠŸå†è¿”å›æˆåŠŸã€‚</li><li>éé‡å…¥çš„ï¼Ÿåœ¨æ•°æ®åº“è¡¨ä¸­åŠ ä¸ªå­—æ®µï¼Œè®°å½•å½“å‰è·å¾—é”çš„æœºå™¨çš„ä¸»æœºä¿¡æ¯å’Œçº¿ç¨‹ä¿¡æ¯ï¼Œé‚£ä¹ˆä¸‹æ¬¡å†è·å–é”çš„æ—¶å€™å…ˆæŸ¥è¯¢æ•°æ®åº“ï¼Œå¦‚æœå½“å‰æœºå™¨çš„ä¸»æœºä¿¡æ¯å’Œçº¿ç¨‹ä¿¡æ¯åœ¨æ•°æ®åº“å¯ä»¥æŸ¥åˆ°çš„è¯ï¼Œç›´æ¥æŠŠé”åˆ†é…ç»™ä»–å°±å¯ä»¥äº†ã€‚</li><li>éå…¬å¹³çš„ï¼Ÿå†å»ºä¸€å¼ ä¸­é—´è¡¨ï¼Œå°†ç­‰å¾…é”çš„çº¿ç¨‹å…¨è®°å½•ä¸‹æ¥ï¼Œå¹¶æ ¹æ®åˆ›å»ºæ—¶é—´æ’åºï¼Œåªæœ‰æœ€å…ˆåˆ›å»ºçš„å…è®¸è·å–é”ã€‚</li><li>æ¯”è¾ƒå¥½çš„åŠæ³•æ˜¯åœ¨ç¨‹åºä¸­ç”Ÿäº§ä¸»é”®è¿›è¡Œé˜²é‡ã€‚</li></ul><h4 id="åŸºäºè¡¨å­—æ®µç‰ˆæœ¬å·åšåˆ†å¸ƒå¼é”"><a href="#åŸºäºè¡¨å­—æ®µç‰ˆæœ¬å·åšåˆ†å¸ƒå¼é”" class="headerlink" title="åŸºäºè¡¨å­—æ®µç‰ˆæœ¬å·åšåˆ†å¸ƒå¼é”"></a>åŸºäºè¡¨å­—æ®µç‰ˆæœ¬å·åšåˆ†å¸ƒå¼é”</h4><p>è¿™ä¸ªç­–ç•¥æºäº mysql çš„ mvcc æœºåˆ¶ï¼Œä½¿ç”¨è¿™ä¸ªç­–ç•¥å…¶å®æœ¬èº«æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œå”¯ä¸€çš„é—®é¢˜å°±æ˜¯å¯¹æ•°æ®è¡¨ä¾µå…¥è¾ƒå¤§ï¼Œæˆ‘ä»¬è¦ä¸ºæ¯ä¸ªè¡¨è®¾è®¡ä¸€ä¸ªç‰ˆæœ¬å·å­—æ®µï¼Œç„¶åå†™ä¸€æ¡åˆ¤æ–­ sql æ¯æ¬¡è¿›è¡Œåˆ¤æ–­ï¼Œå¢åŠ äº†æ•°æ®åº“æ“ä½œçš„æ¬¡æ•°ï¼Œåœ¨é«˜å¹¶å‘çš„è¦æ±‚ä¸‹ï¼Œå¯¹æ•°æ®åº“è¿æ¥çš„å¼€é”€ä¹Ÿæ˜¯æ— æ³•å¿å—çš„ã€‚</p><blockquote><p>åŸºäºæ‚²è§‚é”</p></blockquote><h4 id="åŸºäºæ•°æ®åº“æ’ä»–é”åšåˆ†å¸ƒå¼é”"><a href="#åŸºäºæ•°æ®åº“æ’ä»–é”åšåˆ†å¸ƒå¼é”" class="headerlink" title="åŸºäºæ•°æ®åº“æ’ä»–é”åšåˆ†å¸ƒå¼é”"></a>åŸºäºæ•°æ®åº“æ’ä»–é”åšåˆ†å¸ƒå¼é”</h4><p>åœ¨æŸ¥è¯¢è¯­å¥åé¢å¢åŠ <code>for update</code>ï¼Œæ•°æ®åº“ä¼šåœ¨æŸ¥è¯¢è¿‡ç¨‹ä¸­ç»™æ•°æ®åº“è¡¨å¢åŠ æ’ä»–é” (æ³¨æ„ï¼š InnoDB å¼•æ“åœ¨åŠ é”çš„æ—¶å€™ï¼Œåªæœ‰é€šè¿‡ç´¢å¼•è¿›è¡Œæ£€ç´¢çš„æ—¶å€™æ‰ä¼šä½¿ç”¨è¡Œçº§é”ï¼Œå¦åˆ™ä¼šä½¿ç”¨è¡¨çº§é”ã€‚è¿™é‡Œæˆ‘ä»¬å¸Œæœ›ä½¿ç”¨è¡Œçº§é”ï¼Œå°±è¦ç»™è¦æ‰§è¡Œçš„æ–¹æ³•å­—æ®µåæ·»åŠ ç´¢å¼•ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªç´¢å¼•ä¸€å®šè¦åˆ›å»ºæˆå”¯ä¸€ç´¢å¼•ï¼Œå¦åˆ™ä¼šå‡ºç°å¤šä¸ªé‡è½½æ–¹æ³•ä¹‹é—´æ— æ³•åŒæ—¶è¢«è®¿é—®çš„é—®é¢˜ã€‚é‡è½½æ–¹æ³•çš„è¯å»ºè®®æŠŠå‚æ•°ç±»å‹ä¹ŸåŠ ä¸Šã€‚)ã€‚å½“æŸæ¡è®°å½•è¢«åŠ ä¸Šæ’ä»–é”ä¹‹åï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•å†åœ¨è¯¥è¡Œè®°å½•ä¸Šå¢åŠ æ’ä»–é”ã€‚</p><p>æˆ‘ä»¬å¯ä»¥è®¤ä¸ºè·å¾—æ’ä»–é”çš„çº¿ç¨‹å³å¯è·å¾—åˆ†å¸ƒå¼é”ï¼Œå½“è·å–åˆ°é”ä¹‹åï¼Œå¯ä»¥æ‰§è¡Œæ–¹æ³•çš„ä¸šåŠ¡é€»è¾‘ï¼Œæ‰§è¡Œå®Œæ–¹æ³•ä¹‹åï¼Œé€šè¿‡<code>connection.commit()</code>æ“ä½œæ¥é‡Šæ”¾é”ã€‚</p><p>è¿™ç§æ–¹æ³•å¯ä»¥æœ‰æ•ˆçš„è§£å†³ä¸Šé¢æåˆ°çš„æ— æ³•é‡Šæ”¾é”å’Œé˜»å¡é”çš„é—®é¢˜ã€‚</p><ul><li>é˜»å¡é”ï¼Ÿ <code>for update</code>è¯­å¥ä¼šåœ¨æ‰§è¡ŒæˆåŠŸåç«‹å³è¿”å›ï¼Œåœ¨æ‰§è¡Œå¤±è´¥æ—¶ä¸€ç›´å¤„äºé˜»å¡çŠ¶æ€ï¼Œç›´åˆ°æˆåŠŸã€‚</li><li>é”å®šä¹‹åæœåŠ¡å®•æœºï¼Œæ— æ³•é‡Šæ”¾ï¼Ÿä½¿ç”¨è¿™ç§æ–¹å¼ï¼ŒæœåŠ¡å®•æœºä¹‹åæ•°æ®åº“ä¼šè‡ªå·±æŠŠé”é‡Šæ”¾æ‰ã€‚</li></ul><p>ä½†æ˜¯è¿˜æ˜¯æ— æ³•ç›´æ¥è§£å†³æ•°æ®åº“å•ç‚¹å’Œå¯é‡å…¥é—®é¢˜ã€‚</p><p>è¿™é‡Œè¿˜å¯èƒ½å­˜åœ¨å¦å¤–ä¸€ä¸ªé—®é¢˜ï¼Œè™½ç„¶æˆ‘ä»¬å¯¹æ–¹æ³•å­—æ®µåä½¿ç”¨äº†å”¯ä¸€ç´¢å¼•ï¼Œå¹¶ä¸”æ˜¾ç¤ºä½¿ç”¨ for update æ¥ä½¿ç”¨è¡Œçº§é”ã€‚ä½†æ˜¯ï¼ŒMySQL ä¼šå¯¹æŸ¥è¯¢è¿›è¡Œä¼˜åŒ–ï¼Œå³ä¾¿åœ¨æ¡ä»¶ä¸­ä½¿ç”¨äº†ç´¢å¼•å­—æ®µï¼Œä½†æ˜¯å¦ä½¿ç”¨ç´¢å¼•æ¥æ£€ç´¢æ•°æ®æ˜¯ç”± MySQL é€šè¿‡åˆ¤æ–­ä¸åŒæ‰§è¡Œè®¡åˆ’çš„ä»£ä»·æ¥å†³å®šçš„ï¼Œå¦‚æœ MySQL è®¤ä¸ºå…¨è¡¨æ‰«æ•ˆç‡æ›´é«˜ï¼Œæ¯”å¦‚å¯¹ä¸€äº›å¾ˆå°çš„è¡¨ï¼Œå®ƒå°±ä¸ä¼šä½¿ç”¨ç´¢å¼•ï¼Œè¿™ç§æƒ…å†µä¸‹ InnoDB å°†ä½¿ç”¨è¡¨é”ï¼Œè€Œä¸æ˜¯è¡Œé”ã€‚å¦‚æœå‘ç”Ÿè¿™ç§æƒ…å†µå°±æ‚²å‰§äº†ã€‚ã€‚ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æˆ‘ä»¬è¦ä½¿ç”¨æ’ä»–é”æ¥è¿›è¡Œåˆ†å¸ƒå¼é”çš„ lockï¼Œé‚£ä¹ˆä¸€ä¸ªæ’ä»–é”é•¿æ—¶é—´ä¸æäº¤ï¼Œå°±ä¼šå ç”¨æ•°æ®åº“è¿æ¥ã€‚ä¸€æ—¦ç±»ä¼¼çš„è¿æ¥å˜å¾—å¤šäº†ï¼Œå°±å¯èƒ½æŠŠæ•°æ®åº“è¿æ¥æ± æ’‘çˆ†ã€‚</p><h4 id="ä¼˜ç¼ºç‚¹"><a href="#ä¼˜ç¼ºç‚¹" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h4><p><strong>ä¼˜ç‚¹</strong>ï¼šç®€å•ï¼Œæ˜“äºç†è§£</p><p><strong>ç¼ºç‚¹</strong>ï¼šä¼šæœ‰å„ç§å„æ ·çš„é—®é¢˜ï¼ˆæ“ä½œæ•°æ®åº“éœ€è¦ä¸€å®šçš„å¼€é”€ï¼Œä½¿ç”¨æ•°æ®åº“çš„è¡Œçº§é”å¹¶ä¸ä¸€å®šé è°±ï¼Œæ€§èƒ½ä¸é è°±ï¼‰</p><h3 id="åŸºäº-Redis-åšåˆ†å¸ƒå¼é”"><a href="#åŸºäº-Redis-åšåˆ†å¸ƒå¼é”" class="headerlink" title="åŸºäº Redis åšåˆ†å¸ƒå¼é”"></a>åŸºäº Redis åšåˆ†å¸ƒå¼é”</h3><h4 id="åŸºäº-redis-çš„-setnx-ã€expire-æ–¹æ³•åšåˆ†å¸ƒå¼é”"><a href="#åŸºäº-redis-çš„-setnx-ã€expire-æ–¹æ³•åšåˆ†å¸ƒå¼é”" class="headerlink" title="åŸºäº redis çš„ setnx()ã€expire() æ–¹æ³•åšåˆ†å¸ƒå¼é”"></a>åŸºäº redis çš„ setnx()ã€expire() æ–¹æ³•åšåˆ†å¸ƒå¼é”</h4><h5 id="setnx"><a href="#setnx" class="headerlink" title="setnx()"></a>setnx()</h5><p>setnx çš„å«ä¹‰å°±æ˜¯ SET if Not Existsï¼Œå…¶ä¸»è¦æœ‰ä¸¤ä¸ªå‚æ•° setnx(key, value)ã€‚è¯¥æ–¹æ³•æ˜¯åŸå­çš„ï¼Œå¦‚æœ key ä¸å­˜åœ¨ï¼Œåˆ™è®¾ç½®å½“å‰ key æˆåŠŸï¼Œè¿”å› 1ï¼›å¦‚æœå½“å‰ key å·²ç»å­˜åœ¨ï¼Œåˆ™è®¾ç½®å½“å‰ key å¤±è´¥ï¼Œè¿”å› 0ã€‚</p><h5 id="expire"><a href="#expire" class="headerlink" title="expire()"></a>expire()</h5><p>expire è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œè¦æ³¨æ„çš„æ˜¯ setnx å‘½ä»¤ä¸èƒ½è®¾ç½® key çš„è¶…æ—¶æ—¶é—´ï¼Œåªèƒ½é€šè¿‡ expire() æ¥å¯¹ key è®¾ç½®ã€‚</p><h5 id="ä½¿ç”¨æ­¥éª¤"><a href="#ä½¿ç”¨æ­¥éª¤" class="headerlink" title="ä½¿ç”¨æ­¥éª¤"></a>ä½¿ç”¨æ­¥éª¤</h5><p>1ã€setnx(lockkey, 1)  å¦‚æœè¿”å› 0ï¼Œåˆ™è¯´æ˜å ä½å¤±è´¥ï¼›å¦‚æœè¿”å› 1ï¼Œåˆ™è¯´æ˜å ä½æˆåŠŸ</p><p>2ã€expire() å‘½ä»¤å¯¹ lockkey è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œä¸ºçš„æ˜¯é¿å…æ­»é”é—®é¢˜ã€‚</p><p>3ã€æ‰§è¡Œå®Œä¸šåŠ¡ä»£ç åï¼Œå¯ä»¥é€šè¿‡ delete å‘½ä»¤åˆ é™¤ keyã€‚</p><p>è¿™ä¸ªæ–¹æ¡ˆå…¶å®æ˜¯å¯ä»¥è§£å†³æ—¥å¸¸å·¥ä½œä¸­çš„éœ€æ±‚çš„ï¼Œä½†ä»æŠ€æœ¯æ–¹æ¡ˆçš„æ¢è®¨ä¸Šæ¥è¯´ï¼Œå¯èƒ½è¿˜æœ‰ä¸€äº›å¯ä»¥å®Œå–„çš„åœ°æ–¹ã€‚<strong>æ¯”å¦‚ï¼Œå¦‚æœåœ¨ç¬¬ä¸€æ­¥ setnx æ‰§è¡ŒæˆåŠŸåï¼Œåœ¨ expire() å‘½ä»¤æ‰§è¡ŒæˆåŠŸå‰ï¼Œå‘ç”Ÿäº†å®•æœºçš„ç°è±¡ï¼Œé‚£ä¹ˆå°±ä¾ç„¶ä¼šå‡ºç°æ­»é”çš„é—®é¢˜ï¼Œæ‰€ä»¥å¦‚æœè¦å¯¹å…¶è¿›è¡Œå®Œå–„çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ redis çš„ setnx()ã€get() å’Œ getset() æ–¹æ³•æ¥å®ç°åˆ†å¸ƒå¼é”ã€‚</strong></p><h4 id="åŸºäº-redis-çš„-setnx-ã€get-ã€getset-æ–¹æ³•åšåˆ†å¸ƒå¼é”"><a href="#åŸºäº-redis-çš„-setnx-ã€get-ã€getset-æ–¹æ³•åšåˆ†å¸ƒå¼é”" class="headerlink" title="åŸºäº redis çš„ setnx()ã€get()ã€getset()æ–¹æ³•åšåˆ†å¸ƒå¼é”"></a>åŸºäº redis çš„ setnx()ã€get()ã€getset()æ–¹æ³•åšåˆ†å¸ƒå¼é”</h4><p>è¿™ä¸ªæ–¹æ¡ˆçš„èƒŒæ™¯ä¸»è¦æ˜¯åœ¨ setnx() å’Œ expire() çš„æ–¹æ¡ˆä¸Šé’ˆå¯¹å¯èƒ½å­˜åœ¨çš„æ­»é”é—®é¢˜ï¼Œåšäº†ä¸€äº›ä¼˜åŒ–ã€‚</p><h5 id="getset"><a href="#getset" class="headerlink" title="getset()"></a>getset()</h5><p>è¿™ä¸ªå‘½ä»¤ä¸»è¦æœ‰ä¸¤ä¸ªå‚æ•° getset(keyï¼ŒnewValue)ã€‚è¯¥æ–¹æ³•æ˜¯åŸå­çš„ï¼Œå¯¹ key è®¾ç½® newValue è¿™ä¸ªå€¼ï¼Œå¹¶ä¸”è¿”å› key åŸæ¥çš„æ—§å€¼ã€‚å‡è®¾ key åŸæ¥æ˜¯ä¸å­˜åœ¨çš„ï¼Œé‚£ä¹ˆå¤šæ¬¡æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ï¼Œä¼šå‡ºç°ä¸‹è¾¹çš„æ•ˆæœï¼š</p><ol><li>getset(key, â€œvalue1â€)  è¿”å› null   æ­¤æ—¶ key çš„å€¼ä¼šè¢«è®¾ç½®ä¸º value1</li><li>getset(key, â€œvalue2â€)  è¿”å› value1   æ­¤æ—¶ key çš„å€¼ä¼šè¢«è®¾ç½®ä¸º value2</li><li>ä¾æ¬¡ç±»æ¨ï¼</li></ol><h5 id="ä½¿ç”¨æ­¥éª¤-1"><a href="#ä½¿ç”¨æ­¥éª¤-1" class="headerlink" title="ä½¿ç”¨æ­¥éª¤"></a>ä½¿ç”¨æ­¥éª¤</h5><ol><li>setnx(lockkey, å½“å‰æ—¶é—´+è¿‡æœŸè¶…æ—¶æ—¶é—´)ï¼Œå¦‚æœè¿”å› 1ï¼Œåˆ™è·å–é”æˆåŠŸï¼›å¦‚æœè¿”å› 0 åˆ™æ²¡æœ‰è·å–åˆ°é”ï¼Œè½¬å‘ 2ã€‚</li><li>get(lockkey) è·å–å€¼ oldExpireTime ï¼Œå¹¶å°†è¿™ä¸ª value å€¼ä¸å½“å‰çš„ç³»ç»Ÿæ—¶é—´è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœå°äºå½“å‰ç³»ç»Ÿæ—¶é—´ï¼Œåˆ™è®¤ä¸ºè¿™ä¸ªé”å·²ç»è¶…æ—¶ï¼Œå¯ä»¥å…è®¸åˆ«çš„è¯·æ±‚é‡æ–°è·å–ï¼Œè½¬å‘ 3ã€‚</li><li>è®¡ç®— newExpireTime = å½“å‰æ—¶é—´+è¿‡æœŸè¶…æ—¶æ—¶é—´ï¼Œç„¶å getset(lockkey, newExpireTime) ä¼šè¿”å›å½“å‰ lockkey çš„å€¼currentExpireTimeã€‚</li><li>åˆ¤æ–­ currentExpireTime ä¸ oldExpireTime æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœç›¸ç­‰ï¼Œè¯´æ˜å½“å‰ getset è®¾ç½®æˆåŠŸï¼Œè·å–åˆ°äº†é”ã€‚å¦‚æœä¸ç›¸ç­‰ï¼Œè¯´æ˜è¿™ä¸ªé”åˆè¢«åˆ«çš„è¯·æ±‚è·å–èµ°äº†ï¼Œé‚£ä¹ˆå½“å‰è¯·æ±‚å¯ä»¥ç›´æ¥è¿”å›å¤±è´¥ï¼Œæˆ–è€…ç»§ç»­é‡è¯•ã€‚</li><li>åœ¨è·å–åˆ°é”ä¹‹åï¼Œå½“å‰çº¿ç¨‹å¯ä»¥å¼€å§‹è‡ªå·±çš„ä¸šåŠ¡å¤„ç†ï¼Œå½“å¤„ç†å®Œæ¯•åï¼Œæ¯”è¾ƒè‡ªå·±çš„å¤„ç†æ—¶é—´å’Œå¯¹äºé”è®¾ç½®çš„è¶…æ—¶æ—¶é—´ï¼Œå¦‚æœå°äºé”è®¾ç½®çš„è¶…æ—¶æ—¶é—´ï¼Œåˆ™ç›´æ¥æ‰§è¡Œ delete é‡Šæ”¾é”ï¼›å¦‚æœå¤§äºé”è®¾ç½®çš„è¶…æ—¶æ—¶é—´ï¼Œåˆ™ä¸éœ€è¦å†é”è¿›è¡Œå¤„ç†ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cn.com.tpig.cache.redis.RedisService;</span><br><span class="line"><span class="keyword">import</span> cn.com.tpig.utils.SpringUtils;</span><br><span class="line"></span><br><span class="line"><span class="comment">//redisåˆ†å¸ƒå¼é”</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisLockUtil</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> defaultExpire = <span class="number">60</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">RedisLockUtil</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠ é”</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key redis key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> expire è¿‡æœŸæ—¶é—´ï¼Œå•ä½ç§’</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true:åŠ é”æˆåŠŸï¼Œfalseï¼ŒåŠ é”å¤±è´¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">lock</span><span class="params">(String key, <span class="keyword">int</span> expire)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        RedisService redisService = SpringUtils.getBean(RedisService.class);</span><br><span class="line">        <span class="keyword">long</span> status = redisService.setnx(key, <span class="string">"1"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(status == <span class="number">1</span>) &#123;</span><br><span class="line">            redisService.expire(key, expire);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">lock</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> lock2(key, defaultExpire);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠ é”</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key redis key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> expire è¿‡æœŸæ—¶é—´ï¼Œå•ä½ç§’</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true:åŠ é”æˆåŠŸï¼Œfalseï¼ŒåŠ é”å¤±è´¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">lock2</span><span class="params">(String key, <span class="keyword">int</span> expire)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        RedisService redisService = SpringUtils.getBean(RedisService.class);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">long</span> value = System.currentTimeMillis() + expire;</span><br><span class="line">        <span class="keyword">long</span> status = redisService.setnx(key, String.valueOf(value));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(status == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">long</span> oldExpireTime = Long.parseLong(redisService.get(key, <span class="string">"0"</span>));</span><br><span class="line">        <span class="keyword">if</span>(oldExpireTime &lt; System.currentTimeMillis()) &#123;</span><br><span class="line">            <span class="comment">//è¶…æ—¶</span></span><br><span class="line">            <span class="keyword">long</span> newExpireTime = System.currentTimeMillis() + expire;</span><br><span class="line">            <span class="keyword">long</span> currentExpireTime = Long.parseLong(redisService.getSet(key, String.valueOf(newExpireTime)));</span><br><span class="line">            <span class="keyword">if</span>(currentExpireTime == oldExpireTime) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">unLock1</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">        RedisService redisService = SpringUtils.getBean(RedisService.class);</span><br><span class="line">        redisService.del(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">unLock2</span><span class="params">(String key)</span> </span>&#123;    </span><br><span class="line">        RedisService redisService = SpringUtils.getBean(RedisService.class);    </span><br><span class="line">        <span class="keyword">long</span> oldExpireTime = Long.parseLong(redisService.get(key, <span class="string">"0"</span>));   </span><br><span class="line">        <span class="keyword">if</span>(oldExpireTime &gt; System.currentTimeMillis()) &#123;        </span><br><span class="line">            redisService.del(key);    </span><br><span class="line">        &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawRedPacket</span><span class="params">(<span class="keyword">long</span> userId)</span> </span>&#123;</span><br><span class="line">    String key = <span class="string">"draw.redpacket.userid:"</span> + userId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">boolean</span> lock = RedisLockUtil.lock2(key, <span class="number">60</span>);</span><br><span class="line">    <span class="keyword">if</span>(lock) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//é¢†å–æ“ä½œ</span></span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">//é‡Šæ”¾é”</span></span><br><span class="line">            RedisLockUtil.unLock(key);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> RuntimeException(<span class="string">"é‡å¤é¢†å–å¥–åŠ±"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åŸºäº-Redlock-åšåˆ†å¸ƒå¼é”"><a href="#åŸºäº-Redlock-åšåˆ†å¸ƒå¼é”" class="headerlink" title="åŸºäº Redlock åšåˆ†å¸ƒå¼é”"></a>åŸºäº Redlock åšåˆ†å¸ƒå¼é”</h4><p>Redlock æ˜¯ Redis çš„ä½œè€… antirez ç»™å‡ºçš„é›†ç¾¤æ¨¡å¼çš„ Redis åˆ†å¸ƒå¼é”ï¼Œå®ƒåŸºäº N ä¸ªå®Œå…¨ç‹¬ç«‹çš„ Redis èŠ‚ç‚¹ï¼ˆé€šå¸¸æƒ…å†µä¸‹ N å¯ä»¥è®¾ç½®æˆ 5ï¼‰ã€‚</p><p>ç®—æ³•çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p><ul><li>1ã€å®¢æˆ·ç«¯è·å–å½“å‰æ—¶é—´ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ã€‚</li><li>2ã€å®¢æˆ·ç«¯å°è¯•è·å– N ä¸ªèŠ‚ç‚¹çš„é”ï¼Œï¼ˆæ¯ä¸ªèŠ‚ç‚¹è·å–é”çš„æ–¹å¼å’Œå‰é¢è¯´çš„ç¼“å­˜é”ä¸€æ ·ï¼‰ï¼ŒN ä¸ªèŠ‚ç‚¹ä»¥ç›¸åŒçš„ key å’Œ value è·å–é”ã€‚å®¢æˆ·ç«¯éœ€è¦è®¾ç½®æ¥å£è®¿é—®è¶…æ—¶ï¼Œæ¥å£è¶…æ—¶æ—¶é—´éœ€è¦è¿œè¿œå°äºé”è¶…æ—¶æ—¶é—´ï¼Œæ¯”å¦‚é”è‡ªåŠ¨é‡Šæ”¾çš„æ—¶é—´æ˜¯ 10sï¼Œé‚£ä¹ˆæ¥å£è¶…æ—¶å¤§æ¦‚è®¾ç½® 5-50msã€‚è¿™æ ·å¯ä»¥åœ¨æœ‰ redis èŠ‚ç‚¹å®•æœºåï¼Œè®¿é—®è¯¥èŠ‚ç‚¹æ—¶èƒ½å°½å¿«è¶…æ—¶ï¼Œè€Œå‡å°é”çš„æ­£å¸¸ä½¿ç”¨ã€‚</li><li>3ã€å®¢æˆ·ç«¯è®¡ç®—åœ¨è·å¾—é”çš„æ—¶å€™èŠ±è´¹äº†å¤šå°‘æ—¶é—´ï¼Œæ–¹æ³•æ˜¯ç”¨å½“å‰æ—¶é—´å‡å»åœ¨æ­¥éª¤ä¸€è·å–çš„æ—¶é—´ï¼Œåªæœ‰å®¢æˆ·ç«¯è·å¾—äº†è¶…è¿‡ 3 ä¸ªèŠ‚ç‚¹çš„é”ï¼Œè€Œä¸”è·å–é”çš„æ—¶é—´å°äºé”çš„è¶…æ—¶æ—¶é—´ï¼Œå®¢æˆ·ç«¯æ‰è·å¾—äº†åˆ†å¸ƒå¼é”ã€‚</li><li>4ã€å®¢æˆ·ç«¯è·å–çš„é”çš„æ—¶é—´ä¸ºè®¾ç½®çš„é”è¶…æ—¶æ—¶é—´å‡å»æ­¥éª¤ä¸‰è®¡ç®—å‡ºçš„è·å–é”èŠ±è´¹æ—¶é—´ã€‚</li><li>5ã€å¦‚æœå®¢æˆ·ç«¯è·å–é”å¤±è´¥äº†ï¼Œå®¢æˆ·ç«¯ä¼šä¾æ¬¡åˆ é™¤æ‰€æœ‰çš„é”ã€‚<br>ä½¿ç”¨ Redlock ç®—æ³•ï¼Œå¯ä»¥ä¿è¯åœ¨æŒ‚æ‰æœ€å¤š 2 ä¸ªèŠ‚ç‚¹çš„æ—¶å€™ï¼Œåˆ†å¸ƒå¼é”æœåŠ¡ä»ç„¶èƒ½å·¥ä½œï¼Œè¿™ç›¸æ¯”ä¹‹å‰çš„æ•°æ®åº“é”å’Œç¼“å­˜é”å¤§å¤§æé«˜äº†å¯ç”¨æ€§ï¼Œç”±äº redis çš„é«˜æ•ˆæ€§èƒ½ï¼Œåˆ†å¸ƒå¼ç¼“å­˜é”æ€§èƒ½å¹¶ä¸æ¯”æ•°æ®åº“é”å·®ã€‚</li></ul><p>ä½†æ˜¯ï¼Œæœ‰ä¸€ä½åˆ†å¸ƒå¼çš„ä¸“å®¶å†™äº†ä¸€ç¯‡æ–‡ç« ã€ŠHow to do distributed lockingã€‹ï¼Œè´¨ç–‘ Redlock çš„æ­£ç¡®æ€§ã€‚</p><p><a href="">https://mp.weixin.qq.com/s/1bPLk_VZhZ0QYNZS8LkviA</a></p><p><a href="">https://blog.csdn.net/jek123456/article/details/72954106</a></p><h4 id="ä¼˜ç¼ºç‚¹-1"><a href="#ä¼˜ç¼ºç‚¹-1" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h4><p><strong>ä¼˜ç‚¹ï¼š</strong></p><p>æ€§èƒ½é«˜</p><p><strong>ç¼ºç‚¹ï¼š</strong></p><p>å¤±æ•ˆæ—¶é—´è®¾ç½®å¤šé•¿æ—¶é—´ä¸ºå¥½ï¼Ÿå¦‚ä½•è®¾ç½®çš„å¤±æ•ˆæ—¶é—´å¤ªçŸ­ï¼Œæ–¹æ³•æ²¡ç­‰æ‰§è¡Œå®Œï¼Œé”å°±è‡ªåŠ¨é‡Šæ”¾äº†ï¼Œé‚£ä¹ˆå°±ä¼šäº§ç”Ÿå¹¶å‘é—®é¢˜ã€‚å¦‚æœè®¾ç½®çš„æ—¶é—´å¤ªé•¿ï¼Œå…¶ä»–è·å–é”çš„çº¿ç¨‹å°±å¯èƒ½è¦å¹³ç™½çš„å¤šç­‰ä¸€æ®µæ—¶é—´ã€‚</p><h4 id="åŸºäº-redisson-åšåˆ†å¸ƒå¼é”"><a href="#åŸºäº-redisson-åšåˆ†å¸ƒå¼é”" class="headerlink" title="åŸºäº redisson åšåˆ†å¸ƒå¼é”"></a>åŸºäº redisson åšåˆ†å¸ƒå¼é”</h4><p>redisson æ˜¯ redis å®˜æ–¹çš„åˆ†å¸ƒå¼é”ç»„ä»¶ã€‚GitHub åœ°å€ï¼š<a href="">https://github.com/redisson/redisson</a></p><p>ä¸Šé¢çš„è¿™ä¸ªé—®é¢˜ â€”â€”&gt; å¤±æ•ˆæ—¶é—´è®¾ç½®å¤šé•¿æ—¶é—´ä¸ºå¥½ï¼Ÿè¿™ä¸ªé—®é¢˜åœ¨ redisson çš„åšæ³•æ˜¯ï¼šæ¯è·å¾—ä¸€ä¸ªé”æ—¶ï¼Œåªè®¾ç½®ä¸€ä¸ªå¾ˆçŸ­çš„è¶…æ—¶æ—¶é—´ï¼ŒåŒæ—¶èµ·ä¸€ä¸ªçº¿ç¨‹åœ¨æ¯æ¬¡å¿«è¦åˆ°è¶…æ—¶æ—¶é—´æ—¶å»åˆ·æ–°é”çš„è¶…æ—¶æ—¶é—´ã€‚åœ¨é‡Šæ”¾é”çš„åŒæ—¶ç»“æŸè¿™ä¸ªçº¿ç¨‹ã€‚</p><h3 id="åŸºäº-ZooKeeper-åšåˆ†å¸ƒå¼é”"><a href="#åŸºäº-ZooKeeper-åšåˆ†å¸ƒå¼é”" class="headerlink" title="åŸºäº ZooKeeper åšåˆ†å¸ƒå¼é”"></a>åŸºäº ZooKeeper åšåˆ†å¸ƒå¼é”</h3><h4 id="zookeeper-é”ç›¸å…³åŸºç¡€çŸ¥è¯†"><a href="#zookeeper-é”ç›¸å…³åŸºç¡€çŸ¥è¯†" class="headerlink" title="zookeeper é”ç›¸å…³åŸºç¡€çŸ¥è¯†"></a>zookeeper é”ç›¸å…³åŸºç¡€çŸ¥è¯†</h4><ul><li>zk ä¸€èˆ¬ç”±å¤šä¸ªèŠ‚ç‚¹æ„æˆï¼ˆå•æ•°ï¼‰ï¼Œé‡‡ç”¨ zab ä¸€è‡´æ€§åè®®ã€‚å› æ­¤å¯ä»¥å°† zk çœ‹æˆä¸€ä¸ªå•ç‚¹ç»“æ„ï¼Œå¯¹å…¶ä¿®æ”¹æ•°æ®å…¶å†…éƒ¨è‡ªåŠ¨å°†æ‰€æœ‰èŠ‚ç‚¹æ•°æ®è¿›è¡Œä¿®æ”¹è€Œåæ‰æä¾›æŸ¥è¯¢æœåŠ¡ã€‚</li><li>zk çš„æ•°æ®ä»¥ç›®å½•æ ‘çš„å½¢å¼ï¼Œæ¯ä¸ªç›®å½•ç§°ä¸º  znodeï¼Œ znode ä¸­å¯å­˜å‚¨æ•°æ®ï¼ˆä¸€èˆ¬ä¸è¶…è¿‡ 1Mï¼‰ï¼Œè¿˜å¯ä»¥åœ¨å…¶ä¸­å¢åŠ å­èŠ‚ç‚¹ã€‚</li><li>å­èŠ‚ç‚¹æœ‰ä¸‰ç§ç±»å‹ã€‚åºåˆ—åŒ–èŠ‚ç‚¹ï¼Œæ¯åœ¨è¯¥èŠ‚ç‚¹ä¸‹å¢åŠ ä¸€ä¸ªèŠ‚ç‚¹è‡ªåŠ¨ç»™è¯¥èŠ‚ç‚¹çš„åç§°ä¸Šè‡ªå¢ã€‚ä¸´æ—¶èŠ‚ç‚¹ï¼Œä¸€æ—¦åˆ›å»ºè¿™ä¸ª znode çš„å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨å¤±å»è”ç³»ï¼Œè¿™ä¸ª znode ä¹Ÿå°†è‡ªåŠ¨åˆ é™¤ã€‚æœ€åå°±æ˜¯æ™®é€šèŠ‚ç‚¹ã€‚</li><li>Watch æœºåˆ¶ï¼Œclient å¯ä»¥ç›‘æ§æ¯ä¸ªèŠ‚ç‚¹çš„å˜åŒ–ï¼Œå½“äº§ç”Ÿå˜åŒ–ä¼šç»™ client äº§ç”Ÿä¸€ä¸ªäº‹ä»¶ã€‚</li></ul><h4 id="zk-åŸºæœ¬é”"><a href="#zk-åŸºæœ¬é”" class="headerlink" title="zk åŸºæœ¬é”"></a>zk åŸºæœ¬é”</h4><ul><li>åŸç†ï¼šåˆ©ç”¨ä¸´æ—¶èŠ‚ç‚¹ä¸ watch æœºåˆ¶ã€‚æ¯ä¸ªé”å ç”¨ä¸€ä¸ªæ™®é€šèŠ‚ç‚¹ /lockï¼Œå½“éœ€è¦è·å–é”æ—¶åœ¨ /lock ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªä¸´æ—¶èŠ‚ç‚¹ï¼Œåˆ›å»ºæˆåŠŸåˆ™è¡¨ç¤ºè·å–é”æˆåŠŸï¼Œå¤±è´¥åˆ™ watch/lock èŠ‚ç‚¹ï¼Œæœ‰åˆ é™¤æ“ä½œåå†å»äº‰é”ã€‚ä¸´æ—¶èŠ‚ç‚¹å¥½å¤„åœ¨äºå½“è¿›ç¨‹æŒ‚æ‰åèƒ½è‡ªåŠ¨ä¸Šé”çš„èŠ‚ç‚¹è‡ªåŠ¨åˆ é™¤å³å–æ¶ˆé”ã€‚</li><li>ç¼ºç‚¹ï¼šæ‰€æœ‰å–é”å¤±è´¥çš„è¿›ç¨‹éƒ½ç›‘å¬çˆ¶èŠ‚ç‚¹ï¼Œå¾ˆå®¹æ˜“å‘ç”Ÿç¾Šç¾¤æ•ˆåº”ï¼Œå³å½“é‡Šæ”¾é”åæ‰€æœ‰ç­‰å¾…è¿›ç¨‹ä¸€èµ·æ¥åˆ›å»ºèŠ‚ç‚¹ï¼Œå¹¶å‘é‡å¾ˆå¤§ã€‚</li></ul><h4 id="zk-é”ä¼˜åŒ–"><a href="#zk-é”ä¼˜åŒ–" class="headerlink" title="zk é”ä¼˜åŒ–"></a>zk é”ä¼˜åŒ–</h4><ul><li>åŸç†ï¼šä¸Šé”æ”¹ä¸ºåˆ›å»ºä¸´æ—¶æœ‰åºèŠ‚ç‚¹ï¼Œæ¯ä¸ªä¸Šé”çš„èŠ‚ç‚¹å‡èƒ½åˆ›å»ºèŠ‚ç‚¹æˆåŠŸï¼Œåªæ˜¯å…¶åºå·ä¸åŒã€‚åªæœ‰åºå·æœ€å°çš„å¯ä»¥æ‹¥æœ‰é”ï¼Œå¦‚æœè¿™ä¸ªèŠ‚ç‚¹åºå·ä¸æ˜¯æœ€å°çš„åˆ™ watch åºå·æ¯”æœ¬èº«å°çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ (å…¬å¹³é”)ã€‚</li><li>æ­¥éª¤ï¼š</li></ul><ol><li>åœ¨ /lock èŠ‚ç‚¹ä¸‹åˆ›å»ºä¸€ä¸ªæœ‰åºä¸´æ—¶èŠ‚ç‚¹ (EPHEMERAL_SEQUENTIAL)ã€‚</li><li>åˆ¤æ–­åˆ›å»ºçš„èŠ‚ç‚¹åºå·æ˜¯å¦æœ€å°ï¼Œå¦‚æœæ˜¯æœ€å°åˆ™è·å–é”æˆåŠŸã€‚ä¸æ˜¯åˆ™å–é”å¤±è´¥ï¼Œç„¶å watch åºå·æ¯”æœ¬èº«å°çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ã€‚</li><li>å½“å–é”å¤±è´¥ï¼Œè®¾ç½® watch ååˆ™ç­‰å¾… watch äº‹ä»¶åˆ°æ¥åï¼Œå†æ¬¡åˆ¤æ–­æ˜¯å¦åºå·æœ€å°ã€‚</li><li>å–é”æˆåŠŸåˆ™æ‰§è¡Œä»£ç ï¼Œæœ€åé‡Šæ”¾é”ï¼ˆåˆ é™¤è¯¥èŠ‚ç‚¹ï¼‰ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Collections;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.CountDownLatch;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.Condition;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.Lock;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.zookeeper.CreateMode;</span><br><span class="line"><span class="keyword">import</span> org.apache.zookeeper.KeeperException;</span><br><span class="line"><span class="keyword">import</span> org.apache.zookeeper.WatchedEvent;</span><br><span class="line"><span class="keyword">import</span> org.apache.zookeeper.Watcher;</span><br><span class="line"><span class="keyword">import</span> org.apache.zookeeper.ZooDefs;</span><br><span class="line"><span class="keyword">import</span> org.apache.zookeeper.ZooKeeper;</span><br><span class="line"><span class="keyword">import</span> org.apache.zookeeper.data.Stat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DistributedLock</span> <span class="keyword">implements</span> <span class="title">Lock</span>, <span class="title">Watcher</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ZooKeeper zk;</span><br><span class="line">    <span class="keyword">private</span> String root = <span class="string">"/locks"</span>;<span class="comment">//æ ¹</span></span><br><span class="line">    <span class="keyword">private</span> String lockName;<span class="comment">//ç«äº‰èµ„æºçš„æ ‡å¿—</span></span><br><span class="line">    <span class="keyword">private</span> String waitNode;<span class="comment">//ç­‰å¾…å‰ä¸€ä¸ªé”</span></span><br><span class="line">    <span class="keyword">private</span> String myZnode;<span class="comment">//å½“å‰é”</span></span><br><span class="line">    <span class="keyword">private</span> CountDownLatch latch;<span class="comment">//è®¡æ•°å™¨</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> sessionTimeout = <span class="number">30000</span>;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Exception&gt; exception = <span class="keyword">new</span> ArrayList&lt;Exception&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºåˆ†å¸ƒå¼é”,ä½¿ç”¨å‰è¯·ç¡®è®¤configé…ç½®çš„zookeeperæœåŠ¡å¯ç”¨</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> config 127.0.0.1:2181</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> lockName ç«äº‰èµ„æºæ ‡å¿—,lockNameä¸­ä¸èƒ½åŒ…å«å•è¯lock</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DistributedLock</span><span class="params">(String config, String lockName)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.lockName = lockName;</span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ªä¸æœåŠ¡å™¨çš„è¿æ¥</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            zk = <span class="keyword">new</span> ZooKeeper(config, sessionTimeout, <span class="keyword">this</span>);</span><br><span class="line">            Stat stat = zk.exists(root, <span class="keyword">false</span>);</span><br><span class="line">            <span class="keyword">if</span>(stat == <span class="keyword">null</span>)&#123;</span><br><span class="line">                <span class="comment">// åˆ›å»ºæ ¹èŠ‚ç‚¹</span></span><br><span class="line">                zk.create(root, <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">0</span>], ZooDefs.Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            exception.add(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (KeeperException e) &#123;</span><br><span class="line">            exception.add(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            exception.add(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * zookeeperèŠ‚ç‚¹çš„ç›‘è§†å™¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">process</span><span class="params">(WatchedEvent event)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.latch != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">this</span>.latch.countDown();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">lock</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(exception.size() &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> LockException(exception.get(<span class="number">0</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">this</span>.tryLock())&#123;</span><br><span class="line">                System.out.println(<span class="string">"Thread "</span> + Thread.currentThread().getId() + <span class="string">" "</span> +myZnode + <span class="string">" get lock true"</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                waitForLock(waitNode, sessionTimeout);<span class="comment">//ç­‰å¾…é”</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (KeeperException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> LockException(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> LockException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">tryLock</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String splitStr = <span class="string">"_lock_"</span>;</span><br><span class="line">            <span class="keyword">if</span>(lockName.contains(splitStr))</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> LockException(<span class="string">"lockName can not contains \\u000B"</span>);</span><br><span class="line">            <span class="comment">//åˆ›å»ºä¸´æ—¶å­èŠ‚ç‚¹</span></span><br><span class="line">            myZnode = zk.create(root + <span class="string">"/"</span> + lockName + splitStr, <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">0</span>], ZooDefs.Ids.OPEN_ACL_UNSAFE,CreateMode.EPHEMERAL_SEQUENTIAL);</span><br><span class="line">            System.out.println(myZnode + <span class="string">" is created "</span>);</span><br><span class="line">            <span class="comment">//å–å‡ºæ‰€æœ‰å­èŠ‚ç‚¹</span></span><br><span class="line">            List&lt;String&gt; subNodes = zk.getChildren(root, <span class="keyword">false</span>);</span><br><span class="line">            <span class="comment">//å–å‡ºæ‰€æœ‰lockNameçš„é”</span></span><br><span class="line">            List&lt;String&gt; lockObjNodes = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">            <span class="keyword">for</span> (String node : subNodes) &#123;</span><br><span class="line">                String _node = node.split(splitStr)[<span class="number">0</span>];</span><br><span class="line">                <span class="keyword">if</span>(_node.equals(lockName))&#123;</span><br><span class="line">                    lockObjNodes.add(node);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            Collections.sort(lockObjNodes);</span><br><span class="line">            System.out.println(myZnode + <span class="string">"=="</span> + lockObjNodes.get(<span class="number">0</span>));</span><br><span class="line">            <span class="keyword">if</span>(myZnode.equals(root+<span class="string">"/"</span>+lockObjNodes.get(<span class="number">0</span>)))&#123;</span><br><span class="line">                <span class="comment">//å¦‚æœæ˜¯æœ€å°çš„èŠ‚ç‚¹,åˆ™è¡¨ç¤ºå–å¾—é”</span></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//å¦‚æœä¸æ˜¯æœ€å°çš„èŠ‚ç‚¹ï¼Œæ‰¾åˆ°æ¯”è‡ªå·±å°1çš„èŠ‚ç‚¹</span></span><br><span class="line">            String subMyZnode = myZnode.substring(myZnode.lastIndexOf(<span class="string">"/"</span>) + <span class="number">1</span>);</span><br><span class="line">            waitNode = lockObjNodes.get(Collections.binarySearch(lockObjNodes, subMyZnode) - <span class="number">1</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (KeeperException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> LockException(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> LockException(e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">tryLock</span><span class="params">(<span class="keyword">long</span> time, TimeUnit unit)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">this</span>.tryLock())&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> waitForLock(waitNode,time);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">waitForLock</span><span class="params">(String lower, <span class="keyword">long</span> waitTime)</span> <span class="keyword">throws</span> InterruptedException, KeeperException </span>&#123;</span><br><span class="line">        Stat stat = zk.exists(root + <span class="string">"/"</span> + lower,<span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">//åˆ¤æ–­æ¯”è‡ªå·±å°ä¸€ä¸ªæ•°çš„èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨,å¦‚æœä¸å­˜åœ¨åˆ™æ— éœ€ç­‰å¾…é”,åŒæ—¶æ³¨å†Œç›‘å¬</span></span><br><span class="line">        <span class="keyword">if</span>(stat != <span class="keyword">null</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">"Thread "</span> + Thread.currentThread().getId() + <span class="string">" waiting for "</span> + root + <span class="string">"/"</span> + lower);</span><br><span class="line">            <span class="keyword">this</span>.latch = <span class="keyword">new</span> CountDownLatch(<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">this</span>.latch.await(waitTime, TimeUnit.MILLISECONDS);</span><br><span class="line">            <span class="keyword">this</span>.latch = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">unlock</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">"unlock "</span> + myZnode);</span><br><span class="line">            zk.delete(myZnode,-<span class="number">1</span>);</span><br><span class="line">            myZnode = <span class="keyword">null</span>;</span><br><span class="line">            zk.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (KeeperException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">lockInterruptibly</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.lock();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Condition <span class="title">newCondition</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LockException</span> <span class="keyword">extends</span> <span class="title">RuntimeException</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">LockException</span><span class="params">(String e)</span></span>&#123;</span><br><span class="line">            <span class="keyword">super</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">LockException</span><span class="params">(Exception e)</span></span>&#123;</span><br><span class="line">            <span class="keyword">super</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ä¼˜ç¼ºç‚¹-2"><a href="#ä¼˜ç¼ºç‚¹-2" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h4><p><strong>ä¼˜ç‚¹ï¼š</strong></p><p>æœ‰æ•ˆçš„è§£å†³å•ç‚¹é—®é¢˜ï¼Œä¸å¯é‡å…¥é—®é¢˜ï¼Œéé˜»å¡é—®é¢˜ä»¥åŠé”æ— æ³•é‡Šæ”¾çš„é—®é¢˜ã€‚å®ç°èµ·æ¥è¾ƒä¸ºç®€å•ã€‚</p><p><strong>ç¼ºç‚¹ï¼š</strong></p><p>æ€§èƒ½ä¸Šå¯èƒ½å¹¶æ²¡æœ‰ç¼“å­˜æœåŠ¡é‚£ä¹ˆé«˜ï¼Œå› ä¸ºæ¯æ¬¡åœ¨åˆ›å»ºé”å’Œé‡Šæ”¾é”çš„è¿‡ç¨‹ä¸­ï¼Œéƒ½è¦åŠ¨æ€åˆ›å»ºã€é”€æ¯ä¸´æ—¶èŠ‚ç‚¹æ¥å®ç°é”åŠŸèƒ½ã€‚ZK ä¸­åˆ›å»ºå’Œåˆ é™¤èŠ‚ç‚¹åªèƒ½é€šè¿‡ Leader æœåŠ¡å™¨æ¥æ‰§è¡Œï¼Œç„¶åå°†æ•°æ®åŒæ­¥åˆ°æ‰€æœ‰çš„ Follower æœºå™¨ä¸Šã€‚è¿˜éœ€è¦å¯¹ ZKçš„åŸç†æœ‰æ‰€äº†è§£ã€‚</p><h3 id="åŸºäº-Consul-åšåˆ†å¸ƒå¼é”"><a href="#åŸºäº-Consul-åšåˆ†å¸ƒå¼é”" class="headerlink" title="åŸºäº Consul åšåˆ†å¸ƒå¼é”"></a>åŸºäº Consul åšåˆ†å¸ƒå¼é”</h3><p>DD å†™è¿‡ç±»ä¼¼æ–‡ç« ï¼Œå…¶å®ä¸»è¦åˆ©ç”¨ Consul çš„ Key / Value å­˜å‚¨ API ä¸­çš„ acquire å’Œ release æ“ä½œæ¥å®ç°ã€‚</p><p>æ–‡ç« åœ°å€ï¼š<a href="">http://blog.didispace.com/spring-cloud-consul-lock-and-semphore/</a></p><h3 id="ä½¿ç”¨åˆ†å¸ƒå¼é”çš„æ³¨æ„äº‹é¡¹"><a href="#ä½¿ç”¨åˆ†å¸ƒå¼é”çš„æ³¨æ„äº‹é¡¹" class="headerlink" title="ä½¿ç”¨åˆ†å¸ƒå¼é”çš„æ³¨æ„äº‹é¡¹"></a>ä½¿ç”¨åˆ†å¸ƒå¼é”çš„æ³¨æ„äº‹é¡¹</h3><p>1ã€æ³¨æ„åˆ†å¸ƒå¼é”çš„å¼€é”€</p><p>2ã€æ³¨æ„åŠ é”çš„ç²’åº¦</p><p>3ã€åŠ é”çš„æ–¹å¼</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æ— è®ºä½ èº«å¤„ä¸€ä¸ªä»€ä¹ˆæ ·çš„å…¬å¸ï¼Œæœ€å¼€å§‹çš„å·¥ä½œå¯èƒ½éƒ½éœ€è¦ä»æœ€ç®€å•çš„åšèµ·ã€‚ä¸è¦æé˜¿é‡Œå’Œè…¾è®¯çš„ä¸šåŠ¡åœºæ™¯ qps å¦‚ä½•å¤§ï¼Œå› ä¸ºåœ¨è¿™æ ·çš„å¤§åœºæ™¯ä¸­ä½ æœªå¿…èƒ½äº²è‡ªå‚ä¸é¡¹ç›®ï¼Œäº²è‡ªå‚ä¸é¡¹ç›®æœªå¿…èƒ½æ˜¯æ ¸å¿ƒçš„è®¾è®¡è€…ï¼Œæ˜¯æ ¸å¿ƒçš„è®¾è®¡è€…æœªå¿…èƒ½ç‹¬è‡ªè®¾è®¡ã€‚å¸Œæœ›å¤§å®¶èƒ½æ ¹æ®è‡ªå·±å…¬å¸ä¸šåŠ¡åœºæ™¯ï¼Œé€‰æ‹©é€‚åˆè‡ªå·±é¡¹ç›®çš„æ–¹æ¡ˆã€‚</p><h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><p><a href="">http://www.hollischuang.com/archives/1716</a></p><p><a href="">http://www.spring4all.com/question/158</a></p><p><a href="">https://www.cnblogs.com/PurpleDream/p/5559352.html</a></p><p><a href="">http://www.cnblogs.com/PurpleDream/p/5573040.html</a></p><p><a href="">https://www.cnblogs.com/suolu/p/6588902.html</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://ws3.sinaimg.cn/large/006tKfTcgy1fqp2lqscrwj31hc0zk46a.jpg&quot; alt=&quot;meadow-811339_1920&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="æ•°æ®åº“" scheme="http://yoursite.com/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="åˆ†å¸ƒå¼é”" scheme="http://yoursite.com/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/"/>
    
      <category term="Redis" scheme="http://yoursite.com/tags/Redis/"/>
    
      <category term="Zookeeper" scheme="http://yoursite.com/tags/Zookeeper/"/>
    
  </entry>
  
  <entry>
    <title>Spring Boot 2.0ç³»åˆ—æ–‡ç« (å…­)ï¼šSpring Boot 2.0ä¸­SpringBootApplicationæ³¨è§£è¯¦è§£</title>
    <link href="http://yoursite.com/2018/04/19/SpringBootApplication-annotation/"/>
    <id>http://yoursite.com/2018/04/19/SpringBootApplication-annotation/</id>
    <published>2018-04-18T16:00:00.000Z</published>
    <updated>2018-05-02T13:27:38.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1fqifa86vplj31hc0p0n7e.jpg" alt="nature-3201015_1920"></p><a id="more"></a><h3 id="å…³æ³¨æˆ‘"><a href="#å…³æ³¨æˆ‘" class="headerlink" title="å…³æ³¨æˆ‘"></a>å…³æ³¨æˆ‘</h3><p><img src="http://ohfk1r827.bkt.clouddn.com/blog/180103/C6LG3mGa12.jpg" alt="mark"></p><p>è½¬è½½è¯·åŠ¡å¿…æ³¨æ˜åŸåˆ›åœ°å€ä¸ºï¼š<a href="http://www.54tianzhisheng.cn/2018/04/19/SpringBootApplication-annotation/" target="_blank" rel="noopener">http://www.54tianzhisheng.cn/2018/04/19/SpringBootApplication-annotation/</a></p><h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>è®¸å¤š Spring Boot å¼€å‘è€…å–œæ¬¢ä»–ä»¬çš„åº”ç”¨ç¨‹åºä½¿ç”¨è‡ªåŠ¨é…ç½®ã€ç»„ä»¶æ‰«æã€å¹¶èƒ½å¤Ÿåœ¨ä»–ä»¬çš„ â€œApplicationâ€ ç±»ä¸Šå®šä¹‰é¢å¤–çš„é…ç½®ã€‚ å¯ä»¥ä½¿ç”¨ä¸€ä¸ª <code>@SpringBootApplication</code> æ³¨è§£æ¥å¯ç”¨è¿™äº›åŠŸèƒ½ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">SpringApplication.run(Application.class, args);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="SpringBootApplication"><a href="#SpringBootApplication" class="headerlink" title="@SpringBootApplication"></a>@SpringBootApplication</h3><p>è·Ÿè¿›å» <code>@SpringBootApplication</code>  æ³¨è§£å¯ä»¥å‘ç°ä¸‹å›¾ï¼š</p><p><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1fqifa18tt5j31kw17uap2.jpg" alt="springbootapplication"></p><p>å…¶ä¸­æ ‡æ³¨çš„ä¸‰ä¸ªæ³¨è§£æ­£èƒ½è§£å†³æˆ‘ä»¬ä¸Šé¢æ‰€è¯´çš„ä¸‰ç§åŠŸèƒ½ï¼Œå®ƒä»¬æ˜¯ï¼š</p><ul><li><code>@SpringBootConfiguration</code></li><li><code>@EnableAutoConfiguration</code></li><li><code>@ComponentScan</code></li></ul><p>è¯¥æ¥å£é™¤äº†ä¸Šé¢ä¸‰ä¸ªæ³¨è§£å¤–ï¼Œè¿˜æœ‰å››ä¸ªæ–¹æ³•å¦‚ä¸‹ï¼š</p><p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1fqifa27hu2j31kw1aqgy0.jpg" alt="springbootapplication"></p><ul><li>Class&lt;?&gt;[] exclude() default {}:<br>æ ¹æ® class æ¥æ’é™¤ï¼Œæ’é™¤ç‰¹å®šçš„ç±»åŠ å…¥ spring å®¹å™¨ï¼Œä¼ å…¥å‚æ•° value ç±»å‹æ˜¯ class ç±»å‹ã€‚</li><li>String[] excludeName() default {}:<br>æ ¹æ® class name æ¥æ’é™¤ï¼Œæ’é™¤ç‰¹å®šçš„ç±»åŠ å…¥ spring å®¹å™¨ï¼Œä¼ å…¥å‚æ•° value ç±»å‹æ˜¯ class çš„å…¨ç±»åå­—ç¬¦ä¸²æ•°ç»„ã€‚</li><li>String[] scanBasePackages() default {}:<br>æŒ‡å®šæ‰«æåŒ…ï¼Œå‚æ•°æ˜¯åŒ…åçš„å­—ç¬¦ä¸²æ•°ç»„ã€‚</li><li>Class&lt;?&gt;[] scanBasePackageClasses() default {}:<br>æ‰«æç‰¹å®šçš„åŒ…ï¼Œå‚æ•°ç±»ä¼¼æ˜¯ Class ç±»å‹æ•°ç»„ã€‚</li></ul><p>å°±æ‹¿ scanBasePackages æ¥ä¸¾ä¸ªä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span>(scanBasePackages = &#123;<span class="string">"com.zhisheng.controller"</span>,<span class="string">"com.zhisheng.model"</span>&#125;)</span><br></pre></td></tr></table></figure><p>å°†ä¸éœ€è¦çš„ bean æ’é™¤åœ¨ spring å®¹å™¨ä¸­ï¼Œå¦‚ä½•æ“ä½œï¼Ÿçœ‹çœ‹å®˜æ–¹çš„ä»£ç æ€ä¹ˆç”¨çš„ï¼š</p><p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1fqifa5xheaj31kw12rwsj.jpg" alt="sb-enableautoconfig-exclude"></p><h3 id="SpringBootConfiguration"><a href="#SpringBootConfiguration" class="headerlink" title="@SpringBootConfiguration"></a>@SpringBootConfiguration</h3><p><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1fqifab18l3j31kw0w4jyu.jpg" alt="springbootconfiguration"></p><p><code>@SpringBootConfiguration</code>ç»§æ‰¿è‡ª<code>@Configuration</code>ï¼ŒäºŒè€…åŠŸèƒ½ä¹Ÿä¸€è‡´ï¼Œæ ‡æ³¨å½“å‰ç±»æ˜¯é…ç½®ç±»ï¼Œå¹¶ä¼šå°†å½“å‰ç±»å†…å£°æ˜çš„ä¸€ä¸ªæˆ–å¤šä¸ªä»¥<code>@Bean</code>æ³¨è§£æ ‡è®°çš„æ–¹æ³•çš„å®ä¾‹çº³å…¥åˆ°<code>srping</code>å®¹å™¨ä¸­ï¼Œå¹¶ä¸”å®ä¾‹åå°±æ˜¯æ–¹æ³•åã€‚</p><p><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1fqifa4wulcj31h80qgjy9.jpg" alt="configuration"></p><p>è™½è¯´ç°åœ¨å·²ç»æ¨èä½¿ç”¨ Spring Boot é‡Œé¢çš„ <code>@SpringBootConfiguration</code> æ³¨è§£ï¼Œä¸ºäº†æ¢ä¸ªç©¶ç«Ÿï¼Œæˆ‘ä»¬è¿˜æ˜¯ç»§ç»­ç ”ç©¶ä¸‹ <code>@Configuration</code> æ³¨è§£ã€‚</p><h4 id="Configuration"><a href="#Configuration" class="headerlink" title="@Configuration"></a>@Configuration</h4><p>@Configuration æ ‡æ³¨åœ¨ç±»ä¸Šï¼Œç›¸å½“äºæŠŠè¯¥ç±»ä½œä¸º spring çš„ xml é…ç½®æ–‡ä»¶ä¸­çš„ <code>&lt;beans&gt;</code>ï¼Œä½œç”¨ä¸ºï¼šé…ç½® spring å®¹å™¨(åº”ç”¨ä¸Šä¸‹æ–‡)</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="Bean"><a href="#Bean" class="headerlink" title="@Bean"></a>@Bean</h4><p>@Bean æ ‡æ³¨åœ¨æ–¹æ³•ä¸Š(è¿”å›æŸä¸ªå®ä¾‹çš„æ–¹æ³•)ï¼Œç­‰ä»·äº spring çš„ xml é…ç½®æ–‡ä»¶ä¸­çš„<code>&lt;bean&gt;</code>ï¼Œä½œç”¨ä¸ºï¼šæ³¨å†Œ bean å¯¹è±¡</p><p>å¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç« ï¼š<a href="">https://www.ibm.com/developerworks/cn/webservices/ws-springjava/index.html</a></p><h3 id="ComponentScan"><a href="#ComponentScan" class="headerlink" title="@ComponentScan"></a>@ComponentScan</h3><p>å¯ä»¥é€šè¿‡è¯¥æ³¨è§£æŒ‡å®šæ‰«ææŸäº›åŒ…ä¸‹åŒ…å«å¦‚ä¸‹æ³¨è§£çš„å‡è‡ªåŠ¨æ³¨å†Œä¸º spring beansï¼š</p><p>@Componentã€@Serviceã€ @Repositoryã€ @Controllerã€@Entity ç­‰ç­‰</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ComponentScan</span>(basePackages = &#123;<span class="string">"com.zhisheng.controller"</span>,<span class="string">"com.zhisheng.model"</span>&#125;)</span><br></pre></td></tr></table></figure><p>ä»¥å‰æ˜¯åœ¨ xml é…ç½®æ–‡ä»¶ä¸­è®¾ç½®å¦‚ä¸‹æ ‡ç­¾ï¼š<code>&lt;context:component-scan&gt;</code>ï¼ˆç”¨æ¥æ‰«æåŒ…é…ç½®ï¼‰</p><p>é™¤äº†å¯ä»¥ä½¿ç”¨ <code>@ComponentScan</code>  æ³¨è§£æ¥åŠ è½½æˆ‘ä»¬çš„ beanï¼Œè¿˜å¯ä»¥åœ¨ Application ç±»ä¸­ä½¿ç”¨ <code>@Import</code> æŒ‡å®šè¯¥ç±»ã€‚</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Import</span>(&#123;ConsulConfig.class, Log4jEndPointConfiguration.class&#125;)<span class="comment">//ç›´æ¥ imoport è¦å¼•å…¥çš„ç±»</span></span><br></pre></td></tr></table></figure><h3 id="EnableAutoConfiguration"><a href="#EnableAutoConfiguration" class="headerlink" title="@EnableAutoConfiguration"></a>@EnableAutoConfiguration</h3><p><code>@EnableAutoConfiguration</code>çš„ä½œç”¨å¯åŠ¨è‡ªåŠ¨çš„é…ç½®ï¼Œ<code>@EnableAutoConfiguration</code>æ³¨è§£çš„æ„æ€å°±æ˜¯<code>Springboot</code>æ ¹æ®ä½ æ·»åŠ çš„ jar åŒ…æ¥é…ç½®ä½ é¡¹ç›®çš„é»˜è®¤é…ç½®ï¼Œæ¯”å¦‚æ ¹æ®<code>spring-boot-starter-web</code> ï¼Œæ¥åˆ¤æ–­ä½ çš„é¡¹ç›®æ˜¯å¦éœ€è¦æ·»åŠ äº†<code>webmvc</code>å’Œ<code>tomcat</code>ï¼Œå°±ä¼šè‡ªåŠ¨çš„å¸®ä½ é…ç½® web é¡¹ç›®ä¸­æ‰€éœ€è¦çš„é»˜è®¤é…ç½®ã€‚ç®€å•ç‚¹è¯´å°±æ˜¯å®ƒä¼šæ ¹æ®å®šä¹‰åœ¨ classpath ä¸‹çš„ç±»ï¼Œè‡ªåŠ¨çš„ç»™ä½ ç”Ÿæˆä¸€äº› Beanï¼Œå¹¶åŠ è½½åˆ° Spring çš„ Context ä¸­ã€‚</p><p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1fqifa6z9noj31kw1c8k9o.jpg" alt="enable-autoconfiguration"></p><p><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1fqifaa174hj317i0tun1o.jpg" alt="2018-04-19_18-44-22"></p><p>å¯ä»¥çœ‹åˆ° import  å¼•å…¥äº† AutoConfigurationImportSelector ç±»ã€‚è¯¥ç±»ä½¿ç”¨äº† Spring Core åŒ…çš„ SpringFactoriesLoader ç±»çš„ loadFactoryNamesof() æ–¹æ³•ã€‚</p><p>AutoConfigurationImportSelector ç±»å®ç°äº† DeferredImportSelector æ¥å£ï¼Œå¹¶å®ç°äº† <strong>selectImports</strong> æ–¹æ³•ï¼Œç”¨æ¥å¯¼å‡º<em>Configuration</em> ç±»ã€‚</p><p><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1fqifad0xvxj31kw0xw1eq.jpg" alt="getconfigurations"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; configurations = getCandidateConfigurations(annotationMetadata, attributes);</span><br></pre></td></tr></table></figure><p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1fqifabw5ksj31bk0mwdlf.jpg" alt="getconfigurations01"></p><p>å¯¼å‡ºçš„ç±»æ˜¯é€šè¿‡ <em>SpringFactoriesLoader.loadFactoryNames()</em> è¯»å–äº† <em>ClassPath</em> ä¸‹é¢çš„ <em>META-INF/spring.factories</em> æ–‡ä»¶ã€‚</p><p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1fqifa972ujj31kw0wj4d6.jpg" alt="loadfactoryname"></p><p>è¿™ä¸ªæ–‡ä»¶å†…å®¹å¤§è‡´å¦‚ä¸‹ã€‚</p><p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1fqifa3k9x8j31k41f2h3x.jpg" alt="springfactories"></p><p>åé¢ç»§ç»­ä¼šå†™è‡ªåŠ¨é…ç½®æ–¹é¢çš„åšå®¢ï¼Œè¯·ç»§ç»­å…³æ³¨ï¼</p><p>å¦‚æœä½ å‘ç°è‡ªåŠ¨è£…é…çš„ Bean ä¸æ˜¯ä½ æƒ³è¦çš„ï¼Œä½ ä¹Ÿå¯ä»¥ disable å®ƒã€‚æ¯”å¦‚è¯´ï¼Œæˆ‘ä¸æƒ³è¦è‡ªåŠ¨è£…é… Database çš„é‚£äº›Beanï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableAutoConfiguration</span>(exclude = &#123;DataSourceAutoConfiguration.class&#125;)</span><br></pre></td></tr></table></figure><h3 id="ç›¸å…³æ–‡ç« "><a href="#ç›¸å…³æ–‡ç« " class="headerlink" title="ç›¸å…³æ–‡ç« "></a>ç›¸å…³æ–‡ç« </h3><p>1ã€<a href="http://www.54tianzhisheng.cn/2018/03/06/SpringBoot2-Migration-Guide/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (ä¸€)ï¼šSpring Boot 2.0 è¿ç§»æŒ‡å—</a></p><p>2ã€<a href="http://www.54tianzhisheng.cn/2018/03/06/SpringBoot2-new-features/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (äºŒ)ï¼šSpring Boot 2.0 æ–°ç‰¹æ€§è¯¦è§£</a></p><p>3ã€<a href="http://www.54tianzhisheng.cn/2018/04/13/Spring_Boot_2.0_Configuration_Changelog/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (ä¸‰)ï¼šSpring Boot 2.0 é…ç½®æ”¹å˜</a></p><p>4ã€<a href="http://www.54tianzhisheng.cn/2018/04/15/springboot2_code/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (å››)ï¼šSpring Boot 2.0 æºç é˜…è¯»ç¯å¢ƒæ­å»º</a></p><p>5ã€<a href="http://www.54tianzhisheng.cn/2018/04/18/spring_boot2_project/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (äº”)ï¼šSpring Boot 2.0 é¡¹ç›®æºç ç»“æ„é¢„è§ˆ</a></p><p>6ã€<a href="http://www.54tianzhisheng.cn/2018/04/19/SpringBootApplication-annotation/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (å…­)ï¼šSpring boot 2.0 ä¸­ SpringBootApplication æ³¨è§£è¯¦è§£</a></p><p>7ã€<a href="http://www.54tianzhisheng.cn/2018/04/30/springboot_SpringApplication/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (ä¸ƒ)ï¼šSpringApplication æ·±å…¥æ¢ç´¢</a></p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æœ¬æ–‡ä¸»è¦è®²äº† SpringBootApplication æ³¨è§£ï¼Œç„¶åå±•å¼€å†™äº†å…¶åŒ…å«çš„ä¸‰ä¸ªæ³¨è§£ SpringBootConfigurationã€ComponentScanã€EnableAutoConfiguration</p><h3 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h3><p>è™½ç„¶æºç å¾ˆéš¾ï¼Œä½†éšç€ä¸æ–­çš„æ¢ç´¢ï¼Œæºç åœ¨ä½ é¢å‰å°†ä¼šä¸€è§ˆæ— é—ï¼Œäº«å—è¿™ç§æ¢ç´¢åçš„æˆå°±æ„Ÿï¼åŠ æ²¹ï¼éªšå¹´ï¼</p><p>è‡ªå·±æœ¬äººèƒ½åŠ›æœ‰é™ï¼Œæºç çœ‹çš„ä¸å¤šï¼Œä¸Šé¢å¦‚æœ‰ä¸å¯¹çš„è¿˜è¯·ç•™è¨€äº¤æµã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://ws4.sinaimg.cn/large/006tKfTcgy1fqifa86vplj31hc0p0n7e.jpg&quot; alt=&quot;nature-3201015_1920&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="Java" scheme="http://yoursite.com/tags/Java/"/>
    
      <category term="SpringBoot" scheme="http://yoursite.com/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>Spring Boot 2.0ç³»åˆ—æ–‡ç« (äº”)ï¼šSpring Boot 2.0 é¡¹ç›®æºç ç»“æ„é¢„è§ˆ</title>
    <link href="http://yoursite.com/2018/04/18/spring_boot2_project/"/>
    <id>http://yoursite.com/2018/04/18/spring_boot2_project/</id>
    <published>2018-04-17T16:00:00.000Z</published>
    <updated>2018-05-02T13:27:46.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1fqhraflay7j31hc0zk0z1.jpg" alt="fireworks-2585843_1920"></p><a id="more"></a><h3 id="å…³æ³¨æˆ‘"><a href="#å…³æ³¨æˆ‘" class="headerlink" title="å…³æ³¨æˆ‘"></a>å…³æ³¨æˆ‘</h3><p><img src="http://ohfk1r827.bkt.clouddn.com/blog/180103/C6LG3mGa12.jpg" alt="mark"></p><p>è½¬è½½è¯·åŠ¡å¿…æ³¨æ˜åŸåˆ›åœ°å€ä¸ºï¼š<a href="http://www.54tianzhisheng.cn/2018/04/18/spring_boot2_project/" target="_blank" rel="noopener">http://www.54tianzhisheng.cn/2018/04/15/springboot2_code/</a></p><h3 id="é¡¹ç›®ç»“æ„"><a href="#é¡¹ç›®ç»“æ„" class="headerlink" title="é¡¹ç›®ç»“æ„"></a>é¡¹ç›®ç»“æ„</h3><p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1fqhsa07r59j30ps104gpd.jpg" alt="springboot2001"></p><p>ç»“æ„åˆ†æï¼š</p><ul><li>Spring-boot-project   æ ¸å¿ƒä»£ç ï¼Œä»£ç é‡å¾ˆå¤šï¼ˆ197508 è¡Œï¼‰</li><li>Spring-boot-samples  ä¸€äº›æ ·ä¾‹ demoï¼Œä»£ç é‡ä¸å¤šï¼ˆ9685 è¡Œï¼‰ï¼Œè›®æœ‰ç”¨çš„</li><li>Spring-boot-samples-invoker  é‡Œé¢æ— ä»£ç </li><li>Spring-boot-tests   æµ‹è¯•ä»£ç ï¼ˆ1640 è¡Œï¼‰</li></ul><h3 id="spring-boot-project"><a href="#spring-boot-project" class="headerlink" title="spring-boot-project"></a>spring-boot-project</h3><p>Spring-boot-project ä¸‹é¢æœ‰å¾ˆå¤šæ¨¡å—ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1fqhs874239j30p00n2dip.jpg" alt="springboot2002"></p><h4 id="Spirng-boot"><a href="#Spirng-boot" class="headerlink" title="Spirng-boot"></a>Spirng-boot</h4><p><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1fqhs885a4zj30xk1ea78a.jpg" alt="springboot"></p><p>è¯¥æ¨¡å— 47760 è¡Œä»£ç ï¼ˆå«æµ‹è¯•ä»£ç ï¼‰ï¼ŒSpring boot ä¸»è¦çš„åº“ï¼Œæä¾›äº†æ”¯æŒ Spring Boot å…¶ä»–éƒ¨åˆ†çš„åŠŸèƒ½ï¼Œå…¶ä¸­åŒ…æ‹¬äº†ï¼š</p><ul><li>åœ¨<code>SpringApplication</code>ç±»ï¼Œæä¾›é™æ€ä¾¿æ·æ–¹æ³•ï¼Œå¯ä»¥å¾ˆå®¹æ˜“å†™ä¸€ä¸ªç‹¬ç«‹çš„ Spring åº”ç”¨ç¨‹åºã€‚å®ƒå”¯ä¸€çš„å·¥ä½œå°±æ˜¯åˆ›é€ å¹¶æ›´æ–°ä¸€ä¸ªåˆé€‚çš„ Spring<code>ApplicationContext</code></li><li>å¸¦æœ‰å¯é€‰å®¹å™¨çš„åµŒå…¥å¼ Web åº”ç”¨ç¨‹åºï¼ˆTomcatï¼ŒJetty æˆ– Undertowï¼‰</li><li>ä¸€æµçš„å¤–éƒ¨é…ç½®æ”¯æŒ</li><li>ä¾¿æ·<code>ApplicationContext</code>åˆå§‹åŒ–ç¨‹åºï¼ŒåŒ…æ‹¬å¯¹æ•æ„Ÿæ—¥å¿—è®°å½•é»˜è®¤å€¼çš„æ”¯æŒ</li></ul><h4 id="spring-boot-actuator"><a href="#spring-boot-actuator" class="headerlink" title="spring-boot-actuator"></a>spring-boot-actuator</h4><p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1fqhs8ibzjzj30xk15mjv8.jpg" alt="springboot-actuator"></p><p>è¯¥æ¨¡å— 18398 è¡Œä»£ç ï¼ˆå«æµ‹è¯•ä»£ç ï¼‰ï¼Œspring-boot-actuator æ¨¡å—å®ƒå®Œå…¨æ˜¯ä¸€ä¸ªç”¨äºæš´éœ²è‡ªèº«ä¿¡æ¯çš„æ¨¡å—ï¼Œæä¾›äº†ä¸€ä¸ªç›‘æ§å’Œç®¡ç†ç”Ÿäº§ç¯å¢ƒçš„æ¨¡å—ï¼Œå¯ä»¥ä½¿ç”¨ httpã€jmxã€sshã€telnet ç­‰ç®¡ç†å’Œç›‘æ§åº”ç”¨ã€‚å®¡è®¡ï¼ˆAuditingï¼‰ã€ å¥åº·ï¼ˆhealthï¼‰ã€æ•°æ®é‡‡é›†ï¼ˆmetrics gatheringï¼‰ä¼šè‡ªåŠ¨åŠ å…¥åˆ°åº”ç”¨é‡Œé¢ã€‚</p><h4 id="spring-boot-actuator-autoconfigure"><a href="#spring-boot-actuator-autoconfigure" class="headerlink" title="spring-boot-actuator-autoconfigure"></a>spring-boot-actuator-autoconfigure</h4><p><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1fqhs8hfazpj30wi1dy0xb.jpg" alt="springboot-actoator-autoconfig"></p><p>è¯¥æ¨¡å— 16721 è¡Œä»£ç ï¼ˆå«æµ‹è¯•ä»£ç ï¼‰ï¼ŒSpring Boot Actuator æä¾›äº†é¢å¤–çš„è‡ªåŠ¨é…ç½®åŠŸèƒ½ï¼Œå¯ä»¥åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å®ç°å¯å³æ—¶éƒ¨ç½²å’Œæ”¯æŒçš„åŠŸèƒ½ï¼Œä»è€Œè£…é¥°ä½ çš„åº”ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æ­£åœ¨ç¼–å†™ JSON Web æœåŠ¡ï¼Œé‚£ä¹ˆå®ƒå°†æä¾›æœåŠ¡å™¨ï¼Œå®‰å…¨æ€§ï¼Œæ—¥å¿—è®°å½•ï¼Œå¤–éƒ¨é…ç½®ï¼Œç®¡ç†ç«¯ç‚¹ï¼Œå®¡è®¡æŠ½è±¡ç­‰ç­‰åŠŸèƒ½ã€‚å¦‚æœæ‚¨æƒ³å…³é—­å†…ç½®åŠŸèƒ½ï¼Œæˆ–è€…æ‰©å±•æˆ–æ›¿æ¢å®ƒä»¬ï¼Œå®ƒä¹Ÿä¼šå˜å¾—éå¸¸ç®€å•ã€‚</p><h4 id="spring-boot-autoconfigure"><a href="#spring-boot-autoconfigure" class="headerlink" title="spring-boot-autoconfigure"></a>spring-boot-autoconfigure</h4><p><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1fqhs89img2j30xs0og0uz.jpg" alt="springboot-autoconfig"></p><p>è¯¥æ¨¡å— 51100 è¡Œä»£ç ï¼ˆå«æµ‹è¯•ä»£ç ï¼‰ï¼Œ Spring Boot å¯ä»¥æ ¹æ®ç±»è·¯å¾„çš„å†…å®¹é…ç½®å¤§éƒ¨åˆ†å¸¸ç”¨åº”ç”¨ç¨‹åºã€‚å•ä¸ª<code>@EnableAutoConfiguration</code>æ³¨é‡Šä¼šè§¦å‘ Springä¸Šä¸‹æ–‡çš„è‡ªåŠ¨é…ç½®ã€‚</p><p>è‡ªåŠ¨é…ç½®å°è¯•æ¨æ–­ç”¨æˆ·å¯èƒ½éœ€è¦å“ªäº› beanã€‚ä¾‹å¦‚ï¼Œå¦‚æœ <code>HSQLDB</code>åœ¨ç±»è·¯å¾„ä¸­ï¼Œå¹¶ä¸”ç”¨æˆ·å°šæœªé…ç½®ä»»ä½•æ•°æ®åº“è¿æ¥ï¼Œåˆ™ä»–ä»¬å¯èƒ½éœ€è¦å®šä¹‰å†…å­˜æ•°æ®åº“ã€‚å½“ç”¨æˆ·å¼€å§‹å®šä¹‰ä»–ä»¬è‡ªå·±çš„ bean æ—¶ï¼Œè‡ªåŠ¨é…ç½®å°†æ°¸è¿œè¿œç¦»ã€‚</p><h4 id="spring-boot-cli"><a href="#spring-boot-cli" class="headerlink" title="spring-boot-cli"></a>spring-boot-cli</h4><p><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1fqhsa2hmasj30x21aqq6j.jpg" alt="springboot-cli"></p><p>è¯¥æ¨¡å— 9346 è¡Œä»£ç ï¼ˆå«æµ‹è¯•ä»£ç ï¼‰ï¼ŒSpring å‘½ä»¤è¡Œåº”ç”¨ç¨‹åºç¼–è¯‘å¹¶è¿è¡Œ Groovy æºä»£ç ï¼Œä½¿å¾—å¯ä»¥ç¼–å†™å°‘é‡ä»£ç å°±èƒ½è¿è¡Œåº”ç”¨ç¨‹åºã€‚Spring CLI ä¹Ÿå¯ä»¥ç›‘è§†æ–‡ä»¶ï¼Œå½“å®ƒä»¬æ”¹å˜æ—¶è‡ªåŠ¨é‡æ–°ç¼–è¯‘å¹¶é‡æ–°å¯åŠ¨ã€‚</p><h4 id="spring-boot-dependencies"><a href="#spring-boot-dependencies" class="headerlink" title="spring-boot-dependencies"></a>spring-boot-dependencies</h4><p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1fqhs9xrj6qj31kw16be31.jpg" alt="springboot-dependencies"></p><p>è¯¥æ¨¡å—é‡Œé¢æ²¡æœ‰æºç ï¼Œåªæœ‰æ‰€æœ‰ä¾èµ–å’Œæ’ä»¶çš„ç‰ˆæœ¬å·ä¿¡æ¯ã€‚</p><h4 id="spring-boot-devtools"><a href="#spring-boot-devtools" class="headerlink" title="spring-boot-devtools"></a>spring-boot-devtools</h4><p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1fqhs9z88hrj30v41bw785.jpg" alt="springboot-devtools"></p><p>è¯¥æ¨¡å— 9418 è¡Œä»£ç ï¼ˆå«æµ‹è¯•ä»£ç ï¼‰ï¼Œspring-boot-devtools æ¨¡å—æ¥ä½¿ Spring Boot åº”ç”¨æ”¯æŒçƒ­éƒ¨ç½²ï¼Œæé«˜å¼€å‘è€…çš„å¼€å‘æ•ˆç‡ï¼Œæ— éœ€æ‰‹åŠ¨é‡å¯ Spring Boot åº”ç”¨ã€‚</p><h4 id="spring-boot-docs"><a href="#spring-boot-docs" class="headerlink" title="spring-boot-docs"></a>spring-boot-docs</h4><p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1fqhs8affekj30xo1ecdkr.jpg" alt="springboot-docs"></p><p>è¯¥æ¨¡å— 671 è¡Œä»£ç ï¼Œspringboot å‚è€ƒæ–‡ä»¶ã€‚</p><h4 id="spring-boot-parent"><a href="#spring-boot-parent" class="headerlink" title="spring-boot-parent"></a>spring-boot-parent</h4><p><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1fqhs8dxfnij31kw0zrqkw.jpg" alt="springboot-parent"></p><p>è¯¥æ¨¡å—æ˜¯å…¶ä»–é¡¹ç›®çš„ parentï¼Œè¯¥æ¨¡å—çš„çˆ¶æ¨¡å—æ˜¯ spring-boot-dependenciesã€‚</p><h4 id="spring-boot-properties-migrator"><a href="#spring-boot-properties-migrator" class="headerlink" title="spring-boot-properties-migrator"></a>spring-boot-properties-migrator</h4><p><img src="https://ws3.sinaimg.cn/large/006tKfTcgy1fqhs9wkyvsj30um18678o.jpg" alt="springboot-properties-migrator"></p><p>è¯¥æ¨¡å—æœ‰ 495 è¡Œä»£ç ï¼Œåœ¨ Spring Boot 2.0 ä¸­ï¼Œè®¸å¤šé…ç½®å±æ€§è¢«é‡æ–°å‘½å/åˆ é™¤ï¼Œå¼€å‘äººå‘˜éœ€è¦æ›´æ–°<code>application.properties</code>/ <code>application.yml</code>ç›¸åº”çš„é…ç½®ã€‚ä¸ºäº†å¸®åŠ©ä½ è§£å†³è¿™ä¸€é—®é¢˜ï¼ŒSpring Boot å‘å¸ƒäº†ä¸€ä¸ªæ–°<code>spring-boot-properties-migrator</code>æ¨¡å—ã€‚ä¸€æ—¦ä½œä¸ºè¯¥æ¨¡å—ä½œä¸ºä¾èµ–è¢«æ·»åŠ åˆ°ä½ çš„é¡¹ç›®ä¸­ï¼Œå®ƒä¸ä»…ä¼šåˆ†æåº”ç”¨ç¨‹åºçš„ç¯å¢ƒï¼Œè€Œä¸”è¿˜ä¼šåœ¨å¯åŠ¨æ—¶æ‰“å°è¯Šæ–­ä¿¡æ¯ï¼Œè€Œä¸”è¿˜ä¼šåœ¨è¿è¡Œæ—¶ä¸ºæ‚¨æš‚æ—¶è¿ç§»å±æ€§ã€‚åœ¨æ‚¨çš„åº”ç”¨ç¨‹åºè¿ç§»æœŸé—´ï¼Œè¿™ä¸ªæ¨¡å—æ˜¯å¿…å¤‡çš„ï¼Œå®Œæˆè¿ç§»åï¼Œè¯·ç¡®ä¿ä»é¡¹ç›®çš„ä¾èµ–å…³ç³»ä¸­åˆ é™¤æ­¤æ¨¡å—ã€‚</p><h4 id="spring-boot-starters"><a href="#spring-boot-starters" class="headerlink" title="spring-boot-starters"></a>spring-boot-starters</h4><p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1fqhs8foqadj31he1hwh5l.jpg" alt="springboot-starter"></p><p>Starter POMs æ˜¯ç”±å¾ˆå¤šæ–¹ä¾¿çš„ä¾èµ–é›†åˆç»„æˆï¼Œå¦‚æœä½ éœ€è¦ä½¿ç”¨æŸç§æŠ€æœ¯ï¼Œé€šè¿‡æ·»åŠ å°‘é‡çš„jarå°±å¯ä»¥æŠŠç›¸å…³çš„ä¾èµ–åŠ å…¥åˆ°é¡¹ç›®ä¸­å»ã€‚</p><p>è™½ç„¶ä½ çœ‹å¾—åˆ°æœ‰è¿™ä¹ˆå¤š starterï¼Œä½†æ˜¯å´æ²¡æœ‰ä¸€è¡Œ Java ä»£ç ï¼Œæ„ä¸æ„å¤–ï¼Ÿ</p><p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1fqhs84zby0j31kw0xdkb0.jpg" alt="springboot-starter-activemq"></p><p>è¿™ç¡®å®æ˜¯ Spring Boot è‡ªåŠ¨é…ç½®çš„å…³é”®ä¹‹å¤„ï¼Œåé¢æˆ‘å¯ä»¥è®²è®²ã€‚</p><h4 id="spring-boot-test"><a href="#spring-boot-test" class="headerlink" title="spring-boot-test"></a>spring-boot-test</h4><p>æµ‹è¯•ä»£ç ï¼æœ‰ 10980 è¡Œä»£ç ã€‚</p><h4 id="spring-boot-test-autoconfigure"><a href="#spring-boot-test-autoconfigure" class="headerlink" title="spring-boot-test-autoconfigure"></a>spring-boot-test-autoconfigure</h4><p>è‡ªåŠ¨é…ç½®çš„æµ‹è¯•ä»£ç ï¼Œæœ‰ 6063 è¡Œä»£ç ã€‚</p><h4 id="spring-boot-tools"><a href="#spring-boot-tools" class="headerlink" title="spring-boot-tools"></a>spring-boot-tools</h4><p><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1fqhs8kcu5ej30ri0lqwh5.jpg" alt="springboot-tools"></p><ul><li><p>spring-boot-antlib</p><p>Spring Boot AntLib æ¨¡å—ä¸º Apache Ant æä¾›äº†åŸºæœ¬çš„ Spring Boot æ”¯æŒã€‚ æ‚¨å¯ä»¥ä½¿ç”¨è¯¥æ¨¡å—åˆ›å»ºå¯æ‰§è¡Œæ–‡ä»¶å¤¹ã€‚ è¦ä½¿ç”¨è¯¥æ¨¡å—ï¼Œæ‚¨éœ€è¦åœ¨ build.xml ä¸­å£°æ˜ä¸€ä¸ªé¢å¤–çš„ spring-boot å‘½åç©ºé—´ï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤ºï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns:ivy</span>=<span class="string">"antlib:org.apache.ivy.ant"</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:spring-boot</span>=<span class="string">"antlib:org.springframework.boot.ant"</span></span></span><br><span class="line"><span class="tag"><span class="attr">name</span>=<span class="string">"myapp"</span> <span class="attr">default</span>=<span class="string">"build"</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ‚¨éœ€è¦è®°ä½ä½¿ç”¨ -lib é€‰é¡¹å¯åŠ¨ Antï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ant -lib &lt;folder containing spring-boot-antlib-2.1.0.BUILD-SNAPSHOT.jar&gt;</span><br></pre></td></tr></table></figure></li><li><p>Spring-boot-autoconfigure-processor</p><p>spring boot è‡ªåŠ¨é…ç½®çš„æ ¸å¿ƒç±»</p></li><li><p>Spring-boot-configuration-metadata</p><p>Spring boot é…ç½®å…ƒæ•°æ®</p></li><li><p>Spring-boot-configuration-processor</p><p>spring boot é…ç½®çš„æ ¸å¿ƒ</p></li><li><p>Spring-boot-gradle-plugin</p><p>Spring Boot Gradle æ’ä»¶åœ¨ Gradle ä¸­æä¾›äº† Spring Boot æ”¯æŒï¼Œå¯ä»¥æ‰“åŒ…æˆå¯æ‰§è¡Œ jar æˆ– war ï¼Œè¿è¡Œ Spring Boot åº”ç”¨ç¨‹åºï¼Œå¹¶ä½¿ç”¨ spring-boot-dependencies æä¾›çš„ä¾èµ–å…³ç³»ç®¡ç†ã€‚ å®ƒéœ€è¦ Gradle 4.0 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚</p></li><li><p>Spring-boot-maven-plugin</p><p>Spring Boot Maven Plugin åœ¨ Maven ä¸­æä¾›äº† Spring Boot æ”¯æŒï¼Œè®©æ‚¨å¯ä»¥æ‰“åŒ…æˆå¯æ‰§è¡Œ jar æˆ– war åº”ç”¨ï¼Œå¹¶â€œå°±åœ°â€è¿è¡Œåº”ç”¨ç¨‹åºã€‚ è¦ä½¿ç”¨å®ƒï¼Œä½ å¿…é¡»ä½¿ç”¨ Maven 3.2ï¼ˆæˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ã€‚</p></li><li><p>Spring-boot-loader</p><p>spring-boot-load æ¨¡å—é€šè¿‡è‡ªå®šä¹‰ jar åŒ…ç»“æ„ï¼Œè‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼Œä¼˜é›…çš„å®ç°äº†åµŒå¥— jar èµ„æºçš„åŠ è½½ï¼Œé€šè¿‡æ‰“åŒ…æ—¶å€™é‡æ–°è®¾ç½®å¯åŠ¨ç±»å’Œç»„ç»‡ jar ç»“æ„ï¼Œé€šè¿‡è¿è¡Œæ—¶è®¾ç½®è‡ªå®šä¹‰åŠ è½½å™¨æ¥å®ç°åµŒå¥— jar èµ„æºåŠ è½½ã€‚</p></li><li><p>Spring-boot-loader-tools</p><p>spring-boot-load æ¨¡å—çš„å·¥å…·æ¨¡å—</p></li><li><p>Spring-boot-test-support</p><p>æµ‹è¯•</p></li></ul><h3 id="spring-boot-samples"><a href="#spring-boot-samples" class="headerlink" title="spring-boot-samples"></a>spring-boot-samples</h3><p><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1fqhsa4qklcj31kw11y7ud.jpg" alt="springboot-samples"></p><p>æ ·ä¾‹ demo æ¯”è¾ƒå¤šï¼Œå¤§å®¶çœ‹æºç çš„æ—¶å€™å¯ä»¥æ‹¿è¿™äº›ç°æˆ demo æµ‹è¯•ã€‚</p><h3 id="spring-boot-tests"><a href="#spring-boot-tests" class="headerlink" title="spring-boot-tests"></a>spring-boot-tests</h3><p><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1fqhs8cezdbj30ui1dqagt.jpg" alt="springboot-tests"></p><h3 id="ç›¸å…³æ–‡ç« "><a href="#ç›¸å…³æ–‡ç« " class="headerlink" title="ç›¸å…³æ–‡ç« "></a>ç›¸å…³æ–‡ç« </h3><p>1ã€<a href="http://www.54tianzhisheng.cn/2018/03/06/SpringBoot2-Migration-Guide/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (ä¸€)ï¼šSpring Boot 2.0 è¿ç§»æŒ‡å—</a></p><p>2ã€<a href="http://www.54tianzhisheng.cn/2018/03/06/SpringBoot2-new-features/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (äºŒ)ï¼šSpring Boot 2.0 æ–°ç‰¹æ€§è¯¦è§£</a></p><p>3ã€<a href="http://www.54tianzhisheng.cn/2018/04/13/Spring_Boot_2.0_Configuration_Changelog/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (ä¸‰)ï¼šSpring Boot 2.0 é…ç½®æ”¹å˜</a></p><p>4ã€<a href="http://www.54tianzhisheng.cn/2018/04/15/springboot2_code/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (å››)ï¼šSpring Boot 2.0 æºç é˜…è¯»ç¯å¢ƒæ­å»º</a></p><p>5ã€<a href="http://www.54tianzhisheng.cn/2018/04/18/spring_boot2_project/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (äº”)ï¼šSpring Boot 2.0 é¡¹ç›®æºç ç»“æ„é¢„è§ˆ</a></p><p>6ã€<a href="http://www.54tianzhisheng.cn/2018/04/19/SpringBootApplication-annotation/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (å…­)ï¼šSpring boot 2.0 ä¸­ SpringBootApplication æ³¨è§£è¯¦è§£</a></p><p>7ã€<a href="http://www.54tianzhisheng.cn/2018/04/30/springboot_SpringApplication/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (ä¸ƒ)ï¼šSpringApplication æ·±å…¥æ¢ç´¢</a></p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æœ¬æ–‡ä¸»è¦åˆ†æäº†ä¸‹ Spring boot é¡¹ç›®æºç ç»“æ„ã€‚åŒ…å« Spring boot æ ¸å¿ƒæºç ã€æ ·ä¾‹ demoã€æµ‹è¯•ã€‚åˆ†æäº†é¡¹ç›®çš„æ•´ä½“ç»“æ„åï¼Œåé¢æ‰èƒ½å¤Ÿæœ‰çš„æ”¾çŸ¢çš„å»è¯»æºç ã€‚</p><h3 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h3><p>è™½ç„¶æºç å¾ˆéš¾ï¼Œä½†éšç€ä¸æ–­çš„æ¢ç´¢ï¼Œæºç åœ¨ä½ é¢å‰å°†ä¼šä¸€è§ˆæ— é—ï¼Œäº«å—è¿™ç§æ¢ç´¢åçš„æˆå°±æ„Ÿï¼åŠ æ²¹ï¼éªšå¹´ï¼</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://ws1.sinaimg.cn/large/006tKfTcgy1fqhraflay7j31hc0zk0z1.jpg&quot; alt=&quot;fireworks-2585843_1920&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="Java" scheme="http://yoursite.com/tags/Java/"/>
    
      <category term="SpringBoot" scheme="http://yoursite.com/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>Spring Boot 2.0ç³»åˆ—æ–‡ç« (å››)ï¼šSpring Boot 2.0 æºç é˜…è¯»ç¯å¢ƒæ­å»º</title>
    <link href="http://yoursite.com/2018/04/15/springboot2_code/"/>
    <id>http://yoursite.com/2018/04/15/springboot2_code/</id>
    <published>2018-04-14T16:00:00.000Z</published>
    <updated>2018-05-02T13:28:00.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fqdma0kpk1j31hc0zkqox.jpg" alt="night-photograph-2183637_1920"></p><a id="more"></a><h3 id="å‰æ"><a href="#å‰æ" class="headerlink" title="å‰æ"></a>å‰æ</h3><p>å‰å‡ å¤©é¢è¯•çš„æ—¶å€™ï¼Œè¢«é—®è¿‡ Spring Boot çš„è‡ªåŠ¨é…ç½®æºç æ€ä¹ˆå®ç°çš„ï¼Œæ²¡çœ‹è¿‡æºç çš„æˆ‘åªèƒ½æŠ•é™ğŸ‘¦äº†ã€‚</p><p>è¿™ä¸ï¼Œèµ¶ç´§æ¥è¡¥è¡¥äº†ï¼Œæ‰€ä»¥æ‰æœ‰äº†è¿™ç¯‡æ–‡ç« çš„å‡ºç°ï¼ŒSpring Boot 2. 0 æºç é˜…è¯»ç¯å¢ƒçš„æ­å»ºä¸­è¿˜é‡åˆ°ç‚¹é—®é¢˜ï¼Œè¢«å‘æ­»äº†ï¼Œè¿˜å¥½è§£å†³äº†ï¼Œæ„Ÿè°¢ç¾¤é‡Œçš„å°ä¼™ä¼´ï¼</p><h3 id="å…³æ³¨æˆ‘"><a href="#å…³æ³¨æˆ‘" class="headerlink" title="å…³æ³¨æˆ‘"></a>å…³æ³¨æˆ‘</h3><p><img src="http://ohfk1r827.bkt.clouddn.com/blog/180103/C6LG3mGa12.jpg" alt="mark"></p><p>è½¬è½½è¯·åŠ¡å¿…æ³¨æ˜åŸåˆ›åœ°å€ä¸ºï¼š<a href="http://www.54tianzhisheng.cn/2018/04/15/springboot2_code/" target="_blank" rel="noopener">http://www.54tianzhisheng.cn/2018/04/15/springboot2_code/</a></p><h3 id="é¡¹ç›®ä¸‹è½½"><a href="#é¡¹ç›®ä¸‹è½½" class="headerlink" title="é¡¹ç›®ä¸‹è½½"></a>é¡¹ç›®ä¸‹è½½</h3><p>ä» <a href="https://github.com/spring-projects/spring-boot/releases" target="_blank" rel="noopener">https://github.com/spring-projects/spring-boot/releases</a> å¯ä»¥çœ‹åˆ°æ‰€æœ‰ç‰ˆæœ¬çš„ä¸‹è½½åœ°å€ï¼Œæˆ‘è¿™é‡Œé€‰æ‹©çš„æ˜¯ Spring Boot 2 ä¸­æœ€æ–°çš„  <a href="https://github.com/spring-projects/spring-boot/releases/tag/v2.0.1.RELEASE" target="_blank" rel="noopener">v2.0.1.RELEASE </a> ç‰ˆæœ¬ï¼Œä¸‹è½½åï¼Œç„¶åè§£å‹ã€‚è·å–ä»£ç ä¹‹å‰ï¼Œè¯·å…ˆç¡®ä¿ä½ çš„ JDK ç‰ˆæœ¬æ˜¯ 1.8 ä»¥ä¸Šå“¦ã€‚</p><h3 id="é¡¹ç›®ç¼–è¯‘"><a href="#é¡¹ç›®ç¼–è¯‘" class="headerlink" title="é¡¹ç›®ç¼–è¯‘"></a>é¡¹ç›®ç¼–è¯‘</h3><p>è¿›å…¥ spring-boot-2.0.1.RELEASE çš„ç›®å½•ä¸‹ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚</p><h4 id="è·³è¿‡æµ‹è¯•ç”¨ä¾‹ç¼–è¯‘"><a href="#è·³è¿‡æµ‹è¯•ç”¨ä¾‹ç¼–è¯‘" class="headerlink" title="è·³è¿‡æµ‹è¯•ç”¨ä¾‹ç¼–è¯‘"></a>è·³è¿‡æµ‹è¯•ç”¨ä¾‹ç¼–è¯‘</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mvn clean install -DskipTests -Pfast //è·³è¿‡æµ‹è¯•ç”¨ä¾‹</span><br></pre></td></tr></table></figure><p>è·³è¿‡æµ‹è¯•ç”¨ä¾‹å¯ä»¥åŠ å¿«ç¼–è¯‘çš„é€Ÿåº¦ã€‚</p><p>å…ˆçœ‹ä¸‹è¿è¡ŒæˆåŠŸçš„æ•ˆæœï¼š</p><p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fqdm9wd342j31gc1mc7n7.jpg" alt="springboot201"></p><p>åªèŠ±äº† 6 åˆ†å¤šé’Ÿå°±å¥½äº†ã€‚</p><h4 id="å…¨é‡ç¼–è¯‘"><a href="#å…¨é‡ç¼–è¯‘" class="headerlink" title="å…¨é‡ç¼–è¯‘"></a>å…¨é‡ç¼–è¯‘</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mvn -f spring-boot-project -Pfull clean install</span><br></pre></td></tr></table></figure><p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fqdm9xd4pdj31kw18l7s3.jpg" alt="springboot2-error3"></p><p>å…¨é‡ç¼–è¯‘ç«Ÿç„¶æŠ¥é”™ï¼Œä¸€æ³¢æœªå¹³ï¼Œä¸€æ³¢åˆèµ·ï¼</p><p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fqdm9y57j4j31kw0e7wls.jpg" alt="2018-04-15_15-37-25"></p><p>çœ‹ç½‘ä¸Šçš„è§£å†³æ–¹æ³•æ˜¯ï¼šåœ¨é¡¹ç›®çš„ pom.xml æ–‡ä»¶ä¸­çš„ <code>&lt;properties&gt;</code> æ·»åŠ  <code>&lt;javadocExecutable&gt;</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">javadocExecutable</span>&gt;</span>$&#123;java.home&#125;/../bin/javadoc<span class="tag">&lt;/<span class="name">javadocExecutable</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ­¤æ–¹æ³•è™½ç„¶ç®¡ç”¨ï¼Œä½†æ˜¯åªæ˜¯ä¸´æ—¶çš„ï¼Œéœ€è¦å¯¹æ¯ä¸ªé¡¹ç›®éƒ½è¿›è¡Œæ·»åŠ ã€‚</p><p>é—®é¢˜äº§ç”Ÿçš„åŸå› åº”è¯¥æ˜¯ï¼Œmvn æ‹¿åˆ°çš„ JAVA_HOME ä½ç½®åº”è¯¥æ˜¯ ${JAVA_HOME}/jre è€Œä¸æ˜¯ jdk ä½ç½®ã€‚</p><p>åé¢åˆçœ‹å®˜æ–¹çš„ README ä¸Šé¢å†™çš„æ‰§è¡Œå‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mvn clean install</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œåä¹Ÿæ˜¯æœ‰å„ç§æŠ¥é”™ï¼Œå°è¯•äº†å¾ˆä¹…è§£å†³ï¼Œæœ€åèŠ±äº†å¥½å‡ ä¸ªå°æ—¶æ‰åˆ°ä¸‹é¢è¿™å›¾ï¼š</p><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fqdma1lfkdj31kw0yqh5s.jpg" alt="springboot2-error4"></p><p>å¤ªæŠ˜è…¾äººäº†ï¼Œå¤ªéº»çƒ¦äº†ï¼</p><p>æš‚æ—¶å°±ä¸å…¨é‡ç¼–è¯‘äº†ï¼Œæˆ‘ä»¬å°±ç›´æ¥æŠŠç°åœ¨ <code>è·³è¿‡æµ‹è¯•ç”¨ä¾‹ç¼–è¯‘</code>  åçš„é¡¹ç›®å¯¼å…¥åˆ° IDEA ä¸­å»ã€‚</p><h3 id="å¯¼å…¥é¡¹ç›®å·¥ç¨‹"><a href="#å¯¼å…¥é¡¹ç›®å·¥ç¨‹" class="headerlink" title="å¯¼å…¥é¡¹ç›®å·¥ç¨‹"></a>å¯¼å…¥é¡¹ç›®å·¥ç¨‹</h3><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fqdma2dis9j31ia10447y.jpg" alt="import"></p><p>å¯¼å…¥åå°†é‚£äº›æµ‹è¯•çš„ module æ ‡è®°ä¸º maven é¡¹ç›®ï¼Œç„¶ååé¢è‡ªå·±å†æ ¹æ®æµ‹è¯•ç”¨ä¾‹å»è·Ÿæºç å§ã€‚</p><p>å¯¼å…¥åé¡¹ç›®æ²¡å‡ºç°æŠ¥é”™ï¼Œç¾æ»‹æ»‹ï¼Œåé¢æºç å¯ä»¥çœ‹èµ·æ¥ã€‚</p><p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fqdm9ipwfhj31kw0zkkj1.jpg" alt="success02"></p><h3 id="é‡åˆ°çš„å‘"><a href="#é‡åˆ°çš„å‘" class="headerlink" title="é‡åˆ°çš„å‘"></a>é‡åˆ°çš„å‘</h3><p>åœ¨è¿™ä¹‹å‰ï¼Œæˆ‘è‡ªå·±åˆ›å»ºé¡¹ç›® Spring Boot 2 é¡¹ç›®éƒ½æ˜¯å¤±è´¥çš„ï¼Œmaven è¿è¡Œé¡¹ç›®ï¼ˆmvn clean installï¼‰æŠ¥é”™å¦‚ä¸‹ï¼š</p><p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fqdm9wsmiqj31gc1mc7n7.jpg" alt="springboot2-error2"></p><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fqdm9zrq04j31kw0wru0p.jpg" alt="springboot2-error"></p><p>é€šè¿‡ä¸Šå›¾å¯ä»¥å‘ç°æŠ¥é”™çš„ç½ªé­ç¥¸é¦–æ˜¯ç”±äºæ‰¾ä¸åˆ° org.yaml.snakeyaml  1.19 çš„åŒ…ï¼Œè¿™ä¸ªä¾èµ–æ­»æ´»ä¸‹ä¸ä¸‹æ¥ï¼Œè‹¦é€¼äº†ğŸ˜¢ã€‚</p><p>ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯å…¬å¸é…çš„ maven setting.xml æ–‡ä»¶æœ‰é—®é¢˜ï¼ˆå…¬å¸ç§æœæœ‰é—®é¢˜ï¼‰ï¼Œå¯¼è‡´æˆ‘è¿™ä¸ª  org.yaml.snakeyaml  1.19 çš„åŒ…ä¸€ç›´ä¸‹è½½ä¸æ¥ã€‚åæ¥æˆ‘å«ç¾¤é‡Œçš„å¥½å‹å¸®å¿™æµ‹è¯•ä¸‹èƒ½ä¸èƒ½åˆ›å»º Spring Boot 2 é¡¹ç›®ï¼Œç»“æœä»–ä»¬éƒ½è¡Œçš„ã€‚æˆ‘å°±æ¢æˆäº†ä»–ä»¬é˜¿é‡Œäº‘é•œåƒçš„ setting æ–‡ä»¶ï¼Œç»“æœåœ¨æˆ‘è¿™è¿˜æ˜¯ä¸è¡Œçš„ã€‚çœŸæ˜¯é†‰äº†ï¼Œæˆ‘å¹²è„†ç›´æ¥å«ä»–æŠŠ maven æœ¬åœ°ä»“åº“ä¸­çš„ org.yaml.snakeyaml  1.19 æ•´ä¸ªåŒ…éƒ½å‘ç»™æˆ‘ï¼Œç»“æœå†æ¬¡åˆ›å»º Spring Boot 2 é¡¹ç›®å°±èƒ½æˆåŠŸäº†ã€‚ç¾æ»‹æ»‹ğŸ˜„ï¼</p><p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fqdm9yr6s8j31kw0o3tkj.jpg" alt="springboot2-success"></p><p>ç„¶åå°±è¹­ç€ç°åœ¨ç¯å¢ƒ OKï¼Œå¼€å§‹æ­å»ºæˆ‘çš„ Spring Boot 2 æºç é˜…è¯»ç¯å¢ƒï¼</p><h3 id="ç›¸å…³æ–‡ç« "><a href="#ç›¸å…³æ–‡ç« " class="headerlink" title="ç›¸å…³æ–‡ç« "></a>ç›¸å…³æ–‡ç« </h3><p>1ã€<a href="http://www.54tianzhisheng.cn/2018/03/06/SpringBoot2-Migration-Guide/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (ä¸€)ï¼šSpring Boot 2.0 è¿ç§»æŒ‡å—</a></p><p>2ã€<a href="http://www.54tianzhisheng.cn/2018/03/06/SpringBoot2-new-features/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (äºŒ)ï¼šSpring Boot 2.0 æ–°ç‰¹æ€§è¯¦è§£</a></p><p>3ã€<a href="http://www.54tianzhisheng.cn/2018/04/13/Spring_Boot_2.0_Configuration_Changelog/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (ä¸‰)ï¼šSpring Boot 2.0 é…ç½®æ”¹å˜</a></p><p>4ã€<a href="http://www.54tianzhisheng.cn/2018/04/15/springboot2_code/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (å››)ï¼šSpring Boot 2.0 æºç é˜…è¯»ç¯å¢ƒæ­å»º</a></p><p>5ã€<a href="http://www.54tianzhisheng.cn/2018/04/18/spring_boot2_project/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (äº”)ï¼šSpring Boot 2.0 é¡¹ç›®æºç ç»“æ„é¢„è§ˆ</a></p><p>6ã€<a href="http://www.54tianzhisheng.cn/2018/04/19/SpringBootApplication-annotation/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (å…­)ï¼šSpring boot 2.0 ä¸­ SpringBootApplication æ³¨è§£è¯¦è§£</a></p><p>7ã€<a href="http://www.54tianzhisheng.cn/2018/04/30/springboot_SpringApplication/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (ä¸ƒ)ï¼šSpringApplication æ·±å…¥æ¢ç´¢</a></p><h3 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h3><p>æºç ä¸éª—äººï¼Œå¤šçœ‹çœ‹ï¼</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://ws3.sinaimg.cn/large/006tNc79gy1fqdma0kpk1j31hc0zkqox.jpg&quot; alt=&quot;night-photograph-2183637_1920&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="Java" scheme="http://yoursite.com/tags/Java/"/>
    
      <category term="SpringBoot" scheme="http://yoursite.com/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>Spring Boot 2.0ç³»åˆ—æ–‡ç« (ä¸‰)ï¼šSpring Boot 2.0 é…ç½®æ”¹å˜</title>
    <link href="http://yoursite.com/2018/04/13/Spring_Boot_2.0_Configuration_Changelog/"/>
    <id>http://yoursite.com/2018/04/13/Spring_Boot_2.0_Configuration_Changelog/</id>
    <published>2018-04-12T16:00:00.000Z</published>
    <updated>2018-04-19T16:10:55.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1fqc4n57tj4j31hc0zktmm.jpg" alt="pocket-watch-3156771_1920"></p><a id="more"></a><h3 id="å‰æ"><a href="#å‰æ" class="headerlink" title="å‰æ"></a>å‰æ</h3><p>å¥½ä¹…æ²¡æ›´æ–°æ–‡ç« äº†ï¼Œæœ¬æ¥æ‰“ç®—åœ¨æ¯•ä¸šä¹‹å‰ä¸æ›´æ–°äº†ï¼Œè¿™é‡Œï¼Œå¯¹ä¸ä½äº†ï¼Œæˆ‘åˆæ›´æ–°äº†ã€‚ğŸ˜ğŸ˜</p><p>ä¹‹å‰ç¿»è¯‘äº†ä¸¤ç¯‡ Spring Boot 2.0 çš„æ–‡ç« ï¼Œ<a href="http://www.54tianzhisheng.cn/2018/03/06/SpringBoot2-Migration-Guide/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (ä¸€)ï¼šSpring Boot 2.0 è¿ç§»æŒ‡å—</a>   å’Œ  <a href="http://www.54tianzhisheng.cn/2018/03/06/SpringBoot2-new-features/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (äºŒ)ï¼šSpring Boot 2.0 æ–°ç‰¹æ€§è¯¦è§£</a></p><p>ä»Šå¤©å°±ç»§ç»­è¯¦ç»†æ¢ç©¶ Spring Boot 2.0 é‡Œé¢çš„æ”¹å˜ã€‚</p><h3 id="å…³æ³¨æˆ‘"><a href="#å…³æ³¨æˆ‘" class="headerlink" title="å…³æ³¨æˆ‘"></a>å…³æ³¨æˆ‘</h3><p><img src="http://ohfk1r827.bkt.clouddn.com/blog/180103/C6LG3mGa12.jpg" alt="mark"></p><p>è½¬è½½è¯·åŠ¡å¿…æ³¨æ˜åŸåˆ›åœ°å€ä¸ºï¼š<a href="http://www.54tianzhisheng.cn/2018/04/13/Spring_Boot_2.0_Configuration_Changelog/" target="_blank" rel="noopener">http://www.54tianzhisheng.cn/2018/04/13/Spring_Boot_2.0_Configuration_Changelog/</a></p><h3 id="é…ç½®æ”¹å˜"><a href="#é…ç½®æ”¹å˜" class="headerlink" title="é…ç½®æ”¹å˜"></a>é…ç½®æ”¹å˜</h3><p>é…ç½®å±æ€§åœ¨ 1.5.10.RELEASE å’Œ 2.0.0.RELEASE ä¸¤ä¸ªç‰ˆæœ¬ä¹‹é—´çš„æ”¹å˜ï¼š</p><h4 id="å¯ç”¨é”®"><a href="#å¯ç”¨é”®" class="headerlink" title="å¯ç”¨é”®"></a>å¯ç”¨é”®</h4><p>ä¸‹é¢çš„è¡¨æ˜¯ 2.0.0.RELEASE ç‰ˆæœ¬ä¸­çš„å¼ƒç”¨é”®ï¼š</p><table><thead><tr><th>Key</th><th>Replacementï¼ˆæ›¿ä»£ï¼‰</th><th>åŸå› </th></tr></thead><tbody><tr><td><code>spring.datasource.hikari.initialization-fail-fast</code></td><td></td><td></td></tr><tr><td><code>spring.main.web-environment</code></td><td><code>spring.main.web-application-type</code></td></tr></tbody></table><h4 id="æ–°é”®"><a href="#æ–°é”®" class="headerlink" title="æ–°é”®"></a>æ–°é”®</h4><p>ä¸‹é¢çš„è¡¨æ˜¯ 2.0.0.RELEASE ç‰ˆæœ¬ä¸­æ–°çš„é”®ï¼š</p><table><thead><tr><th>Key</th><th>Default valueï¼ˆé»˜è®¤å€¼ï¼‰</th><th>æè¿°</th></tr></thead><tbody><tr><td><code>logging.file.max-history</code></td><td><code>0</code></td><td>è¦ä¿å­˜çš„å½’æ¡£æ—¥å¿—æ–‡ä»¶çš„æœ€å¤§å€¼</td></tr><tr><td><code>logging.file.max-size</code></td><td><code>10MB</code></td><td>æ—¥å¿—æ–‡ä»¶æœ€å¤§å®¹é‡</td></tr><tr><td><code>logging.pattern.dateformat</code></td><td><code>yyyy-MM-dd HH:mm:ss.SSS</code></td><td>æ—¥å¿—çš„æ—¥æœŸæ ¼å¼</td></tr><tr><td><code>management.endpoint.auditevents.cache.time-to-live</code></td><td><code>0ms</code></td><td>å¯ä»¥ç¼“å­˜å“åº”çš„æœ€é•¿æ—¶é—´</td></tr><tr><td><code>management.endpoint.auditevents.enabled</code></td><td><code>true</code></td><td>æ˜¯å¦å¯ç”¨ auditevents ç«¯ç‚¹</td></tr><tr><td><code>management.endpoint.beans.cache.time-to-live</code></td><td><code>0ms</code></td><td>å¯ä»¥ç¼“å­˜å“åº”çš„æœ€é•¿æ—¶é—´</td></tr><tr><td><code>management.endpoint.beans.enabled</code></td><td><code>true</code></td><td>æ˜¯å¦å¯ç”¨ bean ç«¯ç‚¹</td></tr><tr><td><code>management.endpoint.conditions.cache.time-to-live</code></td><td><code>0ms</code></td><td>å¯ä»¥ç¼“å­˜å“åº”çš„æœ€é•¿æ—¶é—´</td></tr><tr><td><code>management.endpoint.conditions.enabled</code></td><td><code>true</code></td><td>æ˜¯å¦å¯ç”¨ conditions ç«¯ç‚¹</td></tr><tr><td><code>management.endpoint.configprops.cache.time-to-live</code></td><td><code>0ms</code></td><td>å¯ä»¥ç¼“å­˜å“åº”çš„æœ€é•¿æ—¶é—´</td></tr><tr><td><code>management.endpoint.configprops.enabled</code></td><td><code>true</code></td><td>æ˜¯å¦å¯ç”¨ configprops ç«¯ç‚¹</td></tr><tr><td><code>management.endpoint.configprops.keys-to-sanitize</code></td><td><code>password,secret,key,token,    .credentials.,vcap_services</code></td><td>Keys that should be sanitized</td></tr><tr><td><code>management.endpoint.env.cache.time-to-live</code></td><td><code>0ms</code></td><td>å¯ä»¥ç¼“å­˜å“åº”çš„æœ€é•¿æ—¶é—´</td></tr><tr><td><code>management.endpoint.env.enabled</code></td><td><code>true</code></td><td>æ˜¯å¦å¯ç”¨ env ç«¯ç‚¹</td></tr><tr><td><code>management.endpoint.env.keys-to-sanitize</code></td><td><code>password,secret,key,token,   .credentials.,vcap_services</code></td><td>Keys that should be sanitized.</td></tr><tr><td><code>management.endpoint.flyway.cache.time-to-live</code></td><td><code>0ms</code></td><td>å¯ä»¥ç¼“å­˜å“åº”çš„æœ€é•¿æ—¶é—´</td></tr><tr><td><code>management.endpoint.flyway.enabled</code></td><td><code>true</code></td><td>æ˜¯å¦å¯ç”¨ flyway ç«¯ç‚¹</td></tr><tr><td><code>management.endpoint.health.cache.time-to-live</code></td><td><code>0ms</code></td><td>å¯ä»¥ç¼“å­˜å“åº”çš„æœ€é•¿æ—¶é—´</td></tr><tr><td><code>management.endpoint.health.enabled</code></td><td><code>true</code></td><td>æ˜¯å¦å¯ç”¨ health ç«¯ç‚¹</td></tr><tr><td><code>management.endpoint.health.roles</code></td><td></td><td>è§’è‰²ç”¨äºç¡®å®šç”¨æˆ·æ˜¯å¦æœ‰æƒæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯</td></tr><tr><td><code>management.endpoint.health.show-details</code></td><td><code>never</code></td><td>ä½•æ—¶æ˜¾ç¤ºå®Œæ•´çš„å¥åº·è¯¦æƒ…</td></tr><tr><td><code>management.endpoint.heapdump.cache.time-to-live</code></td><td><code>0ms</code></td><td>å¯ä»¥ç¼“å­˜å“åº”çš„æœ€é•¿æ—¶é—´</td></tr><tr><td><code>management.endpoint.heapdump.enabled</code></td><td><code>true</code></td><td>æ˜¯å¦å¯ç”¨ heapdump ç«¯ç‚¹</td></tr><tr><td><code>management.endpoint.httptrace.cache.time-to-live</code></td><td><code>0ms</code></td><td>å¯ä»¥ç¼“å­˜å“åº”çš„æœ€é•¿æ—¶é—´</td></tr><tr><td><code>management.endpoint.httptrace.enabled</code></td><td><code>true</code></td><td>æ˜¯å¦å¯ç”¨ httptrace ç«¯ç‚¹</td></tr><tr><td><code>management.endpoint.info.cache.time-to-live</code></td><td><code>0ms</code></td><td>å¯ä»¥ç¼“å­˜å“åº”çš„æœ€é•¿æ—¶é—´</td></tr><tr><td><code>management.endpoint.info.enabled</code></td><td><code>true</code></td><td>æ˜¯å¦å¯ç”¨ info ç«¯ç‚¹</td></tr><tr><td><code>management.endpoint.jolokia.config</code></td><td></td><td>Jolokia è®¾ç½®</td></tr><tr><td><code>management.endpoint.jolokia.enabled</code></td><td><code>true</code></td><td>æ˜¯å¦å¯ç”¨ jolokia ç«¯ç‚¹</td></tr><tr><td><code>management.endpoint.liquibase.cache.time-to-live</code></td><td><code>0ms</code></td><td>å¯ä»¥ç¼“å­˜å“åº”çš„æœ€é•¿æ—¶é—´</td></tr><tr><td><code>management.endpoint.liquibase.enabled</code></td><td><code>true</code></td><td>æ˜¯å¦å¯ç”¨ liquibase ç«¯ç‚¹</td></tr><tr><td><code>management.endpoint.logfile.cache.time-to-live</code></td><td><code>0ms</code></td><td>å¯ä»¥ç¼“å­˜å“åº”çš„æœ€é•¿æ—¶é—´</td></tr><tr><td><code>management.endpoint.logfile.enabled</code></td><td><code>true</code></td><td>æ˜¯å¦å¯ç”¨ logfile ç«¯ç‚¹</td></tr><tr><td><code>management.endpoint.logfile.external-file</code></td><td></td><td>è¦è®¿é—®çš„å¤–éƒ¨æ—¥å¿—æ–‡ä»¶</td></tr><tr><td><code>management.endpoint.loggers.cache.time-to-live</code></td><td><code>0ms</code></td><td>å¯ä»¥ç¼“å­˜å“åº”çš„æœ€é•¿æ—¶é—´</td></tr><tr><td><code>management.endpoint.loggers.enabled</code></td><td><code>true</code></td><td>æ˜¯å¦å¯ç”¨ loggers ç«¯ç‚¹</td></tr><tr><td><code>management.endpoint.mappings.cache.time-to-live</code></td><td><code>0ms</code></td><td>å¯ä»¥ç¼“å­˜å“åº”çš„æœ€é•¿æ—¶é—´</td></tr><tr><td><code>management.endpoint.mappings.enabled</code></td><td><code>true</code></td><td>æ˜¯å¦å¯ç”¨ mappings ç«¯ç‚¹</td></tr><tr><td><code>management.endpoint.metrics.cache.time-to-live</code></td><td><code>0ms</code></td><td>å¯ä»¥ç¼“å­˜å“åº”çš„æœ€é•¿æ—¶é—´</td></tr><tr><td><code>management.endpoint.metrics.enabled</code></td><td><code>true</code></td><td>æ˜¯å¦å¯ç”¨ metrics ç«¯ç‚¹</td></tr><tr><td><code>management.endpoint.prometheus.cache.time-to-live</code></td><td><code>0ms</code></td><td>å¯ä»¥ç¼“å­˜å“åº”çš„æœ€é•¿æ—¶é—´</td></tr><tr><td><code>management.endpoint.prometheus.enabled</code></td><td><code>true</code></td><td>æ˜¯å¦å¯ç”¨ prometheus ç«¯ç‚¹</td></tr><tr><td><code>management.endpoint.scheduledtasks.cache.time-to-live</code></td><td><code>0ms</code></td><td>å¯ä»¥ç¼“å­˜å“åº”çš„æœ€é•¿æ—¶é—´</td></tr><tr><td><code>management.endpoint.scheduledtasks.enabled</code></td><td><code>true</code></td><td>æ˜¯å¦å¯ç”¨ scheduledtasks ç«¯ç‚¹</td></tr><tr><td><code>management.endpoint.sessions.enabled</code></td><td><code>true</code></td><td>æ˜¯å¦å¯ç”¨ sessions ç«¯ç‚¹</td></tr><tr><td><code>management.endpoint.shutdown.enabled</code></td><td><code>false</code></td><td>æ˜¯å¦å¯ç”¨ shutdown ç«¯ç‚¹</td></tr><tr><td><code>management.endpoint.threaddump.cache.time-to-live</code></td><td><code>0ms</code></td><td>å¯ä»¥ç¼“å­˜å“åº”çš„æœ€é•¿æ—¶é—´</td></tr><tr><td><code>management.endpoint.threaddump.enabled</code></td><td><code>true</code></td><td>æ˜¯å¦å¯ç”¨ threaddump ç«¯ç‚¹</td></tr><tr><td><code>management.endpoints.enabled-by-default</code></td><td></td><td>æ˜¯å¦å¯ç”¨æˆ–è€…å…³é—­æ‰€æœ‰çš„ç«¯ç‚¹</td></tr><tr><td><code>management.endpoints.jmx.domain</code></td><td><code>org.springframework.boot</code></td><td>ç«¯ç‚¹ JMX åŸŸå</td></tr><tr><td><code>management.endpoints.jmx.exposure.exclude</code></td><td></td><td>åº”æ’é™¤çš„ç«¯ç‚¹ ID</td></tr><tr><td><code>management.endpoints.jmx.exposure.include</code></td><td><code>*</code></td><td>åº”åŒ…å«çš„ç«¯ç‚¹ ID æˆ–å…¨éƒ¨ <code>*</code></td></tr><tr><td><code>management.endpoints.jmx.static-names</code></td><td></td><td>è¿½åŠ åˆ°æ‰€æœ‰è¡¨ç¤ºç«¯ç‚¹çš„ MBean çš„ObjectName çš„é™æ€å±æ€§.</td></tr><tr><td><code>management.endpoints.jmx.unique-names</code></td><td><code>false</code></td><td>æ˜¯å¦ç¡®ä¿ ObjectNames åœ¨å‘ç”Ÿå†²çªæ—¶è¢«ä¿®æ”¹</td></tr><tr><td><code>management.endpoints.web.base-path</code></td><td><code>/actuator</code></td><td>Web ç«¯ç‚¹çš„åŸºæœ¬è·¯å¾„</td></tr><tr><td><code>management.endpoints.web.cors.allow-credentials</code></td><td></td><td>æ˜¯å¦æ”¯æŒå‡­è¯</td></tr><tr><td><code>management.endpoints.web.cors.allowed-headers</code></td><td></td><td>Comma-separated list of headers to allow in a request. â€˜*â€™ allows all headers.</td></tr><tr><td><code>management.endpoints.web.cors.allowed-methods</code></td><td></td><td>Comma-separated list of methods to allow. â€˜*â€™ allows all methods.</td></tr><tr><td><code>management.endpoints.web.cors.allowed-origins</code></td><td></td><td>Comma-separated list of origins to allow. â€˜*â€™ allows all origins.</td></tr><tr><td><code>management.endpoints.web.cors.exposed-headers</code></td><td></td><td>Comma-separated list of headers to include in a response.</td></tr><tr><td><code>management.endpoints.web.cors.max-age</code></td><td><code>1800s</code></td><td>How long the response from a pre-flight request can be cached by clients.</td></tr><tr><td><code>management.endpoints.web.exposure.exclude</code></td><td></td><td>Endpoint IDs that should be excluded.</td></tr><tr><td><code>management.endpoints.web.exposure.include</code></td><td><code>health,info</code></td><td>Endpoint IDs that should be included or â€˜*â€™ for all.</td></tr><tr><td><code>management.endpoints.web.path-mapping</code></td><td></td><td>Mapping between endpoint IDs and the path that should expose them.</td></tr><tr><td><code>management.health.influxdb.enabled</code></td><td><code>true</code></td><td>Whether to enable InfluxDB health check.</td></tr><tr><td><code>management.health.neo4j.enabled</code></td><td><code>true</code></td><td>Whether to enable Neo4j health check.</td></tr><tr><td><code>management.health.status.http-mapping</code></td><td></td><td>Mapping of health statuses to HTTP status codes.</td></tr><tr><td><code>management.metrics.binders.files.enabled</code></td><td><code>true</code></td><td>Whether to enable files metrics.</td></tr><tr><td><code>management.metrics.binders.integration.enabled</code></td><td><code>true</code></td><td>Whether to enable Spring Integration metrics.</td></tr><tr><td><code>management.metrics.binders.jvm.enabled</code></td><td><code>true</code></td><td>Whether to enable JVM metrics.</td></tr><tr><td><code>management.metrics.binders.logback.enabled</code></td><td><code>true</code></td><td>Whether to enable Logback metrics.</td></tr><tr><td><code>management.metrics.binders.processor.enabled</code></td><td><code>true</code></td><td>Whether to enable processor metrics.</td></tr><tr><td><code>management.metrics.binders.uptime.enabled</code></td><td><code>true</code></td><td>Whether to enable uptime metrics.</td></tr><tr><td><code>management.metrics.distribution.percentiles</code></td><td></td><td>Specific computed non-aggregable percentiles to ship to the backend for meter IDs starting-with the specified name.</td></tr><tr><td><code>management.metrics.distribution.percentiles-histogram</code></td><td></td><td>Whether meter IDs starting-with the specified name should be publish percentile histograms.</td></tr><tr><td><code>management.metrics.distribution.sla</code></td><td></td><td>Specific SLA boundaries for meter IDs starting-with the specified name.</td></tr><tr><td><code>management.metrics.enable</code></td><td></td><td>Whether meter IDs starting-with the specified name should be enabled.</td></tr><tr><td><code>management.metrics.export.atlas.batch-size</code></td><td><code>10000</code></td><td>Number of measurements per request to use for this backend.</td></tr><tr><td><code>management.metrics.export.atlas.config-refresh-frequency</code></td><td><code>10s</code></td><td>Frequency for refreshing config settings from the LWC service.</td></tr><tr><td><code>management.metrics.export.atlas.config-time-to-live</code></td><td><code>150s</code></td><td>Time to live for subscriptions from the LWC service.</td></tr><tr><td><code>management.metrics.export.atlas.config-uri</code></td><td><code>http://localhost:7101/     lwc/api/v1/expressions/local-dev</code></td><td>URI for the Atlas LWC endpoint to retrieve current subscriptions.</td></tr><tr><td><code>management.metrics.export.atlas.connect-timeout</code></td><td><code>1s</code></td><td>Connection timeout for requests to this backend.</td></tr><tr><td><code>management.metrics.export.atlas.enabled</code></td><td><code>true</code></td><td>Whether exporting of metrics to this backend is enabled.</td></tr><tr><td><code>management.metrics.export.atlas.eval-uri</code></td><td><code>http://localhost:7101/ lwc/api/v1/evaluate</code></td><td>URI for the Atlas LWC endpoint to evaluate the data for a subscription.</td></tr><tr><td><code>management.metrics.export.atlas.lwc-enabled</code></td><td><code>false</code></td><td>Whether to enable streaming to Atlas LWC.</td></tr><tr><td><code>management.metrics.export.atlas.meter-time-to-live</code></td><td><code>15m</code></td><td>Time to live for meters that do not have any activity.</td></tr><tr><td><code>management.metrics.export.atlas.num-threads</code></td><td><code>2</code></td><td>Number of threads to use with the metrics publishing scheduler.</td></tr><tr><td><code>management.metrics.export.atlas.read-timeout</code></td><td><code>10s</code></td><td>Read timeout for requests to this backend.</td></tr><tr><td><code>management.metrics.export.atlas.step</code></td><td><code>1m</code></td><td>Step size (i.e. reporting frequency) to use.</td></tr><tr><td><code>management.metrics.export.atlas.uri</code></td><td><code>http://localhost:7101/ api/v1/publish</code></td><td>URI of the Atlas server.</td></tr><tr><td><code>management.metrics.export.datadog.api-key</code></td><td></td><td>Datadog API key.</td></tr><tr><td><code>management.metrics.export.datadog.application-key</code></td><td></td><td>Datadog application key.</td></tr><tr><td><code>management.metrics.export.datadog.batch-size</code></td><td><code>10000</code></td><td>Number of measurements per request to use for this backend.</td></tr><tr><td><code>management.metrics.export.datadog.connect-timeout</code></td><td><code>1s</code></td><td>Connection timeout for requests to this backend.</td></tr><tr><td><code>management.metrics.export.datadog.descriptions</code></td><td><code>true</code></td><td>Whether to publish descriptions metadata to Datadog.</td></tr><tr><td><code>management.metrics.export.datadog.enabled</code></td><td><code>true</code></td><td>Whether exporting of metrics to this backend is enabled.</td></tr><tr><td><code>management.metrics.export.datadog.host-tag</code></td><td><code>instance</code></td><td>Tag that will be mapped to â€œhostâ€ when shipping metrics to Datadog.</td></tr><tr><td><code>management.metrics.export.datadog.num-threads</code></td><td><code>2</code></td><td>Number of threads to use with the metrics publishing scheduler.</td></tr><tr><td><code>management.metrics.export.datadog.read-timeout</code></td><td><code>10s</code></td><td>Read timeout for requests to this backend.</td></tr><tr><td><code>management.metrics.export.datadog.step</code></td><td><code>1m</code></td><td>Step size (i.e. reporting frequency) to use.</td></tr><tr><td><code>management.metrics.export.datadog.uri</code></td><td><code>https://app.datadoghq.com</code></td><td>URI to ship metrics to.</td></tr><tr><td><code>management.metrics.export.ganglia.addressing-mode</code></td><td><code>multicast</code></td><td>UDP addressing mode, either unicast or multicast.</td></tr><tr><td><code>management.metrics.export.ganglia.duration-units</code></td><td><code>milliseconds</code></td><td>Base time unit used to report durations.</td></tr><tr><td><code>management.metrics.export.ganglia.enabled</code></td><td><code>true</code></td><td>Whether exporting of metrics to Ganglia is enabled.</td></tr><tr><td><code>management.metrics.export.ganglia.host</code></td><td><code>localhost</code></td><td>Host of the Ganglia server to receive exported metrics.</td></tr><tr><td><code>management.metrics.export.ganglia.port</code></td><td><code>8649</code></td><td>Port of the Ganglia server to receive exported metrics.</td></tr><tr><td><code>management.metrics.export.ganglia.protocol-version</code></td><td><code>3.1</code></td><td>Ganglia protocol version.</td></tr><tr><td><code>management.metrics.export.ganglia.rate-units</code></td><td><code>seconds</code></td><td>Base time unit used to report rates.</td></tr><tr><td><code>management.metrics.export.ganglia.step</code></td><td><code>1m</code></td><td>Step size (i.e. reporting frequency) to use.</td></tr><tr><td><code>management.metrics.export.ganglia.time-to-live</code></td><td><code>1</code></td><td>Time to live for metrics on Ganglia.</td></tr><tr><td><code>management.metrics.export.graphite.duration-units</code></td><td><code>milliseconds</code></td><td>Base time unit used to report durations.</td></tr><tr><td><code>management.metrics.export.graphite.enabled</code></td><td><code>true</code></td><td>Whether exporting of metrics to Graphite is enabled.</td></tr><tr><td><code>management.metrics.export.graphite.host</code></td><td><code>localhost</code></td><td>Host of the Graphite server to receive exported metrics.</td></tr><tr><td><code>management.metrics.export.graphite.port</code></td><td><code>2004</code></td><td>Port of the Graphite server to receive exported metrics.</td></tr><tr><td><code>management.metrics.export.graphite.protocol</code></td><td><code>pickled</code></td><td>Protocol to use while shipping data to Graphite.</td></tr><tr><td><code>management.metrics.export.graphite.rate-units</code></td><td><code>seconds</code></td><td>Base time unit used to report rates.</td></tr><tr><td><code>management.metrics.export.graphite.step</code></td><td><code>1m</code></td><td>Step size (i.e. reporting frequency) to use.</td></tr><tr><td><code>management.metrics.export.graphite.tags-as-prefix</code></td><td>``</td><td>For the default naming convention, turn the specified tag keys into part of the metric prefix.</td></tr><tr><td><code>management.metrics.export.influx.auto-create-db</code></td><td><code>true</code></td><td>Whether to create the Influx database if it does not exist before attempting to publish metrics to it.</td></tr><tr><td><code>management.metrics.export.influx.batch-size</code></td><td><code>10000</code></td><td>Number of measurements per request to use for this backend.</td></tr><tr><td><code>management.metrics.export.influx.compressed</code></td><td><code>true</code></td><td>Whether to enable GZIP compression of metrics batches published to Influx.</td></tr><tr><td><code>management.metrics.export.influx.connect-timeout</code></td><td><code>1s</code></td><td>Connection timeout for requests to this backend.</td></tr><tr><td><code>management.metrics.export.influx.consistency</code></td><td><code>one</code></td><td>Write consistency for each point.</td></tr><tr><td><code>management.metrics.export.influx.db</code></td><td><code>mydb</code></td><td>Tag that will be mapped to â€œhostâ€ when shipping metrics to Influx.</td></tr><tr><td><code>management.metrics.export.influx.enabled</code></td><td><code>true</code></td><td>Whether exporting of metrics to this backend is enabled.</td></tr><tr><td><code>management.metrics.export.influx.num-threads</code></td><td><code>2</code></td><td>Number of threads to use with the metrics publishing scheduler.</td></tr><tr><td><code>management.metrics.export.influx.password</code></td><td></td><td>Login password of the Influx server.</td></tr><tr><td><code>management.metrics.export.influx.read-timeout</code></td><td><code>10s</code></td><td>Read timeout for requests to this backend.</td></tr><tr><td><code>management.metrics.export.influx.retention-policy</code></td><td></td><td>Retention policy to use (Influx writes to the DEFAULT retention policy if one is not specified).</td></tr><tr><td><code>management.metrics.export.influx.step</code></td><td><code>1m</code></td><td>Step size (i.e. reporting frequency) to use.</td></tr><tr><td><code>management.metrics.export.influx.uri</code></td><td><code>http://localhost:8086</code></td><td>URI of the Influx server.</td></tr><tr><td><code>management.metrics.export.influx.user-name</code></td><td></td><td>Login user of the Influx server.</td></tr><tr><td><code>management.metrics.export.jmx.enabled</code></td><td><code>true</code></td><td>Whether exporting of metrics to JMX is enabled.</td></tr><tr><td><code>management.metrics.export.jmx.step</code></td><td><code>1m</code></td><td>Step size (i.e. reporting frequency) to use.</td></tr><tr><td><code>management.metrics.export.newrelic.account-id</code></td><td></td><td>New Relic account ID.</td></tr><tr><td><code>management.metrics.export.newrelic.api-key</code></td><td></td><td>New Relic API key.</td></tr><tr><td><code>management.metrics.export.newrelic.batch-size</code></td><td><code>10000</code></td><td>Number of measurements per request to use for this backend.</td></tr><tr><td><code>management.metrics.export.newrelic.connect-timeout</code></td><td><code>1s</code></td><td>Connection timeout for requests to this backend.</td></tr><tr><td><code>management.metrics.export.newrelic.enabled</code></td><td><code>true</code></td><td>Whether exporting of metrics to this backend is enabled.</td></tr><tr><td><code>management.metrics.export.newrelic.num-threads</code></td><td><code>2</code></td><td>Number of threads to use with the metrics publishing scheduler.</td></tr><tr><td><code>management.metrics.export.newrelic.read-timeout</code></td><td><code>10s</code></td><td>Read timeout for requests to this backend.</td></tr><tr><td><code>management.metrics.export.newrelic.step</code></td><td><code>1m</code></td><td>Step size (i.e. reporting frequency) to use.</td></tr><tr><td><code>management.metrics.export.newrelic.uri</code></td><td><code>https://insights-collector    .newrelic.com</code></td><td>URI to ship metrics to.</td></tr><tr><td><code>management.metrics.export.prometheus.descriptions</code></td><td><code>true</code></td><td>Whether to enable publishing descriptions as part of the scrape payload to Prometheus.</td></tr><tr><td><code>management.metrics.export.prometheus.enabled</code></td><td><code>true</code></td><td>Whether exporting of metrics to Prometheus is enabled.</td></tr><tr><td><code>management.metrics.export.prometheus.step</code></td><td><code>1m</code></td><td>Step size (i.e. reporting frequency) to use.</td></tr><tr><td><code>management.metrics.export.signalfx.access-token</code></td><td></td><td>SignalFX access token.</td></tr><tr><td><code>management.metrics.export.signalfx.batch-size</code></td><td><code>10000</code></td><td>Number of measurements per request to use for this backend.</td></tr><tr><td><code>management.metrics.export.signalfx.connect-timeout</code></td><td><code>1s</code></td><td>Connection timeout for requests to this backend.</td></tr><tr><td><code>management.metrics.export.signalfx.enabled</code></td><td><code>true</code></td><td>Whether exporting of metrics to this backend is enabled.</td></tr><tr><td><code>management.metrics.export.signalfx.num-threads</code></td><td><code>2</code></td><td>Number of threads to use with the metrics publishing scheduler.</td></tr><tr><td><code>management.metrics.export.signalfx.read-timeout</code></td><td><code>10s</code></td><td>Read timeout for requests to this backend.</td></tr><tr><td><code>management.metrics.export.signalfx.source</code></td><td></td><td>Uniquely identifies the app instance that is publishing metrics to SignalFx.</td></tr><tr><td><code>management.metrics.export.signalfx.step</code></td><td><code>10s</code></td><td>Step size (i.e. reporting frequency) to use.</td></tr><tr><td><code>management.metrics.export.signalfx.uri</code></td><td><code>https://ingest.signalfx.com</code></td><td>URI to ship metrics to.</td></tr><tr><td><code>management.metrics.export.simple.enabled</code></td><td><code>true</code></td><td>Whether, in the absence of any other exporter, exporting of metrics to an in-memory backend is enabled.</td></tr><tr><td><code>management.metrics.export.simple.mode</code></td><td><code>cumulative</code></td><td>Counting mode.</td></tr><tr><td><code>management.metrics.export.simple.step</code></td><td><code>1m</code></td><td>Step size (i.e. reporting frequency) to use.</td></tr><tr><td><code>management.metrics.export.statsd.enabled</code></td><td><code>true</code></td><td>Whether exporting of metrics to StatsD is enabled.</td></tr><tr><td><code>management.metrics.export.statsd.flavor</code></td><td><code>datadog</code></td><td>StatsD line protocol to use.</td></tr><tr><td><code>management.metrics.export.statsd.host</code></td><td><code>localhost</code></td><td>Host of the StatsD server to receive exported metrics.</td></tr><tr><td><code>management.metrics.export.statsd.max-packet-length</code></td><td><code>1400</code></td><td>Total length of a single payload should be kept within your networkâ€™s MTU.</td></tr><tr><td><code>management.metrics.export.statsd.polling-frequency</code></td><td><code>10s</code></td><td>How often gauges will be polled.</td></tr><tr><td><code>management.metrics.export.statsd.port</code></td><td><code>8125</code></td><td>Port of the StatsD server to receive exported metrics.</td></tr><tr><td><code>management.metrics.export.statsd.publish-unchanged-meters</code></td><td><code>true</code></td><td>Whether to send unchanged meters to the StatsD server.</td></tr><tr><td><code>management.metrics.export.statsd.queue-size</code></td><td><code>2147483647</code></td><td>Maximum size of the queue of items waiting to be sent to the StatsD server.</td></tr><tr><td><code>management.metrics.export.wavefront.api-token</code></td><td></td><td>API token used when publishing metrics directly to the Wavefront API host.</td></tr><tr><td><code>management.metrics.export.wavefront.batch-size</code></td><td><code>10000</code></td><td>Number of measurements per request to use for this backend.</td></tr><tr><td><code>management.metrics.export.wavefront.connect-timeout</code></td><td><code>1s</code></td><td>Connection timeout for requests to this backend.</td></tr><tr><td><code>management.metrics.export.wavefront.enabled</code></td><td><code>true</code></td><td>Whether exporting of metrics to this backend is enabled.</td></tr><tr><td><code>management.metrics.export.wavefront.global-prefix</code></td><td></td><td>Global prefix to separate metrics originating from this appâ€™s white box instrumentation from those originating from other Wavefront integrations when viewed in the Wavefront UI.</td></tr><tr><td><code>management.metrics.export.wavefront.num-threads</code></td><td><code>2</code></td><td>Number of threads to use with the metrics publishing scheduler.</td></tr><tr><td><code>management.metrics.export.wavefront.read-timeout</code></td><td><code>10s</code></td><td>Read timeout for requests to this backend.</td></tr><tr><td><code>management.metrics.export.wavefront.source</code></td><td></td><td>Unique identifier for the app instance that is the source of metrics being published to Wavefront.</td></tr><tr><td><code>management.metrics.export.wavefront.step</code></td><td><code>10s</code></td><td>Step size (i.e. reporting frequency) to use.</td></tr><tr><td><code>management.metrics.export.wavefront.uri</code></td><td><code>https://longboard.wavefront.com</code></td><td>URI to ship metrics to.</td></tr><tr><td><code>management.metrics.use-global-registry</code></td><td><code>true</code></td><td>Whether auto-configured MeterRegistry implementations should be bound to the global static registry on Metrics.</td></tr><tr><td><code>management.metrics.web.client.max-uri-tags</code></td><td><code>100</code></td><td>Maximum number of unique URI tag values allowed.</td></tr><tr><td><code>management.metrics.web.client.requests-metric-name</code></td><td><code>http.client.requests</code></td><td>Name of the metric for sent requests.</td></tr><tr><td><code>management.metrics.web.server.auto-time-requests</code></td><td><code>true</code></td><td>Whether requests handled by Spring MVC or WebFlux should be automatically timed.</td></tr><tr><td><code>management.metrics.web.server.requests-metric-name</code></td><td><code>http.server.requests</code></td><td>Name of the metric for received requests.</td></tr><tr><td><code>management.server.add-application-context-header</code></td><td><code>false</code></td><td>Add the â€œX-Application-Contextâ€ HTTP header in each response.</td></tr><tr><td><code>management.server.address</code></td><td></td><td>Network address to which the management endpoints should bind.</td></tr><tr><td><code>management.server.port</code></td><td></td><td>Management endpoint HTTP port (uses the same port as the application by default).</td></tr><tr><td><code>management.server.servlet.context-path</code></td><td><code>Management endpoint context-path (for instance,</code>/management).</td><td></td></tr><tr><td><code>management.server.ssl.ciphers</code></td><td></td><td></td></tr><tr><td><code>management.server.ssl.client-auth</code></td><td></td><td></td></tr><tr><td><code>management.server.ssl.enabled</code></td><td></td><td></td></tr><tr><td><code>management.server.ssl.enabled-protocols</code></td><td></td><td></td></tr><tr><td><code>management.server.ssl.key-alias</code></td><td></td><td></td></tr><tr><td><code>management.server.ssl.key-password</code></td><td></td><td></td></tr><tr><td><code>management.server.ssl.key-store</code></td><td></td><td></td></tr><tr><td><code>management.server.ssl.key-store-password</code></td><td></td><td></td></tr><tr><td><code>management.server.ssl.key-store-provider</code></td><td></td><td></td></tr><tr><td><code>management.server.ssl.key-store-type</code></td><td></td><td></td></tr><tr><td><code>management.server.ssl.protocol</code></td><td></td><td></td></tr><tr><td><code>management.server.ssl.trust-store</code></td><td></td><td></td></tr><tr><td><code>management.server.ssl.trust-store-password</code></td><td></td><td></td></tr><tr><td><code>management.server.ssl.trust-store-provider</code></td><td></td><td></td></tr><tr><td><code>management.server.ssl.trust-store-type</code></td><td></td><td></td></tr><tr><td><code>management.trace.http.enabled</code></td><td><code>true</code></td><td>Whether to enable HTTP request-response tracing.</td></tr><tr><td><code>management.trace.http.include</code></td><td><code>request-headers,response-headers, cookies,errors</code></td><td>Items to be included in the trace.</td></tr><tr><td><code>server.error.include-exception</code></td><td><code>false</code></td><td>Include the â€œexceptionâ€ attribute.</td></tr><tr><td><code>server.http2.enabled</code></td><td></td><td></td></tr><tr><td><code>server.jetty.accesslog.append</code></td><td><code>false</code></td><td>Append to log.</td></tr><tr><td><code>server.jetty.accesslog.date-format</code></td><td><code>dd/MMM/yyyy:HH:mm:ss Z</code></td><td>Timestamp format of the request log.</td></tr><tr><td><code>server.jetty.accesslog.enabled</code></td><td><code>false</code></td><td>Enable access log.</td></tr><tr><td><code>server.jetty.accesslog.extended-format</code></td><td><code>false</code></td><td>Enable extended NCSA format.</td></tr><tr><td><code>server.jetty.accesslog.file-date-format</code></td><td></td><td>Date format to place in log file name.</td></tr><tr><td><code>server.jetty.accesslog.filename</code></td><td></td><td>Log filename.</td></tr><tr><td><code>server.jetty.accesslog.locale</code></td><td></td><td>Locale of the request log.</td></tr><tr><td><code>server.jetty.accesslog.log-cookies</code></td><td><code>false</code></td><td>Enable logging of the request cookies.</td></tr><tr><td><code>server.jetty.accesslog.log-latency</code></td><td><code>false</code></td><td>Enable logging of request processing time.</td></tr><tr><td><code>server.jetty.accesslog.log-server</code></td><td><code>false</code></td><td>Enable logging of the request hostname.</td></tr><tr><td><code>server.jetty.accesslog.retention-period</code></td><td><code>31</code></td><td>Number of days before rotated log files are deleted.</td></tr><tr><td><code>server.jetty.accesslog.time-zone</code></td><td><code>GMT</code></td><td>Timezone of the request log.</td></tr><tr><td><code>server.servlet.application-display-name</code></td><td><code>application</code></td><td>Display name of the application.</td></tr><tr><td><code>server.servlet.context-parameters</code></td><td></td><td>Servlet context init parameters.</td></tr><tr><td><code>server.servlet.context-path</code></td><td></td><td>Context path of the application.</td></tr><tr><td><code>server.servlet.jsp.class-name</code></td><td></td><td></td></tr><tr><td><code>server.servlet.jsp.init-parameters</code></td><td></td><td></td></tr><tr><td><code>server.servlet.jsp.registered</code></td><td></td><td></td></tr><tr><td><code>server.servlet.path</code></td><td><code>/</code></td><td>Path of the main dispatcher servlet.</td></tr><tr><td><code>server.servlet.session.cookie.comment</code></td><td></td><td></td></tr><tr><td><code>server.servlet.session.cookie.domain</code></td><td></td><td></td></tr><tr><td><code>server.servlet.session.cookie.http-only</code></td><td></td><td></td></tr><tr><td><code>server.servlet.session.cookie.max-age</code></td><td></td><td></td></tr><tr><td><code>server.servlet.session.cookie.name</code></td><td></td><td></td></tr><tr><td><code>server.servlet.session.cookie.path</code></td><td></td><td></td></tr><tr><td><code>server.servlet.session.cookie.secure</code></td><td></td><td></td></tr><tr><td><code>server.servlet.session.persistent</code></td><td></td><td></td></tr><tr><td><code>server.servlet.session.store-dir</code></td><td></td><td></td></tr><tr><td><code>server.servlet.session.timeout</code></td><td></td><td></td></tr><tr><td><code>server.servlet.session.tracking-modes</code></td><td></td><td></td></tr><tr><td><code>server.tomcat.max-http-header-size</code></td><td><code>0</code></td><td>Maximum size, in bytes, of the HTTP message header.</td></tr><tr><td><code>server.tomcat.resource.cache-ttl</code></td><td></td><td>Time-to-live of the static resource cache.</td></tr><tr><td><code>server.tomcat.use-relative-redirects</code></td><td></td><td>Whether HTTP 1.1 and later location headers generated by a call to sendRedirect will use relative or absolute redirects.</td></tr><tr><td><code>server.undertow.eager-filter-init</code></td><td><code>true</code></td><td>Whether servlet filters should be initialized on startup.</td></tr><tr><td><code>spring.banner.charset</code></td><td><code>UTF-8</code></td><td>Banner file encoding.</td></tr><tr><td><code>spring.banner.image.height</code></td><td></td><td>Height of the banner image in chars (default based on image height).</td></tr><tr><td><code>spring.banner.image.invert</code></td><td><code>false</code></td><td>Whether images should be inverted for dark terminal themes.</td></tr><tr><td><code>spring.banner.image.location</code></td><td><code>classpath:banner.gif</code></td><td>Banner image file location (jpg or png can also be used).</td></tr><tr><td><code>spring.banner.image.margin</code></td><td><code>2</code></td><td>Left hand image margin in chars.</td></tr><tr><td><code>spring.banner.image.width</code></td><td><code>76</code></td><td>Width of the banner image in chars.</td></tr><tr><td><code>spring.banner.location</code></td><td><code>classpath:banner.txt</code></td><td>Banner text resource location.</td></tr><tr><td><code>spring.batch.initialize-schema</code></td><td><code>embedded</code></td><td>Database schema initialization mode.</td></tr><tr><td><code>spring.cache.redis.cache-null-values</code></td><td><code>true</code></td><td>Allow caching null values.</td></tr><tr><td><code>spring.cache.redis.key-prefix</code></td><td></td><td>Key prefix.</td></tr><tr><td><code>spring.cache.redis.time-to-live</code></td><td></td><td>Entry expiration.</td></tr><tr><td><code>spring.cache.redis.use-key-prefix</code></td><td><code>true</code></td><td>Whether to use the key prefix when writing to Redis.</td></tr><tr><td><code>spring.config.additional-location</code></td><td></td><td>Config file locations used in addition to the defaults.</td></tr><tr><td><code>spring.data.cassandra.connect-timeout</code></td><td></td><td>Socket option: connection time out.</td></tr><tr><td><code>spring.data.cassandra.pool.heartbeat-interval</code></td><td><code>30s</code></td><td>Heartbeat interval after which a message is sent on an idle connection to make sure itâ€™s still alive.</td></tr><tr><td><code>spring.data.cassandra.pool.idle-timeout</code></td><td><code>120s</code></td><td>Idle timeout before an idle connection is removed.</td></tr><tr><td><code>spring.data.cassandra.pool.max-queue-size</code></td><td><code>256</code></td><td>Maximum number of requests that get queued if no connection is available.</td></tr><tr><td><code>spring.data.cassandra.pool.pool-timeout</code></td><td><code>5000ms</code></td><td>Pool timeout when trying to acquire a connection from a hostâ€™s pool.</td></tr><tr><td><code>spring.data.cassandra.read-timeout</code></td><td></td><td>Socket option: read time out.</td></tr><tr><td><code>spring.data.cassandra.repositories.type</code></td><td><code>auto</code></td><td>Type of Cassandra repositories to enable.</td></tr><tr><td><code>spring.data.couchbase.repositories.type</code></td><td><code>auto</code></td><td>Type of Couchbase repositories to enable.</td></tr><tr><td><code>spring.data.mongodb.repositories.type</code></td><td><code>auto</code></td><td>Type of Mongo repositories to enable.</td></tr><tr><td><code>spring.data.neo4j.auto-index</code></td><td><code>none</code></td><td>Auto index mode.</td></tr><tr><td><code>spring.data.web.pageable.default-page-size</code></td><td><code>20</code></td><td>Default page size.</td></tr><tr><td><code>spring.data.web.pageable.max-page-size</code></td><td><code>2000</code></td><td>Maximum page size to be accepted.</td></tr><tr><td><code>spring.data.web.pageable.one-indexed-parameters</code></td><td><code>false</code></td><td>Whether to expose and assume 1-based page number indexes.</td></tr><tr><td><code>spring.data.web.pageable.page-parameter</code></td><td><code>page</code></td><td>Page index parameter name.</td></tr><tr><td><code>spring.data.web.pageable.prefix</code></td><td>``</td><td>General prefix to be prepended to the page number and page size parameters.</td></tr><tr><td><code>spring.data.web.pageable.qualifier-delimiter</code></td><td><code>_</code></td><td>Delimiter to be used between the qualifier and the actual page number and size properties.</td></tr><tr><td><code>spring.data.web.pageable.size-parameter</code></td><td><code>size</code></td><td>Page size parameter name.</td></tr><tr><td><code>spring.data.web.sort.sort-parameter</code></td><td><code>sort</code></td><td>Sort parameter name.</td></tr><tr><td><code>spring.datasource.hikari.initialization-fail-timeout</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.hikari.metrics-tracker-factory</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.hikari.scheduled-executor</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.hikari.scheduled-executor-service</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.hikari.schema</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.initialization-mode</code></td><td><code>embedded</code></td><td>Initialize the datasource with available DDL and DML scripts.</td></tr><tr><td><code>spring.devtools.restart.log-condition-evaluation-delta</code></td><td><code>true</code></td><td>Whether to log the condition evaluation delta upon restart.</td></tr><tr><td><code>spring.flyway.baseline-description</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.baseline-on-migrate</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.baseline-version</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.check-location</code></td><td><code>true</code></td><td>Whether to check that migration scripts location exists.</td></tr><tr><td><code>spring.flyway.clean-disabled</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.clean-on-validation-error</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.dry-run-output</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.enabled</code></td><td><code>true</code></td><td>æ˜¯å¦å¯ç”¨ flyway.</td></tr><tr><td><code>spring.flyway.encoding</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.error-handlers</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.group</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.ignore-future-migrations</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.ignore-missing-migrations</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.init-sqls</code></td><td></td><td>SQL statements to execute to initialize a connection immediately after obtaining it.</td></tr><tr><td><code>spring.flyway.installed-by</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.locations</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.mixed</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.out-of-order</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.password</code></td><td></td><td>å¦‚æœæ‚¨æƒ³è®© Flyway åˆ›å»ºè‡ªå·±çš„DataSourceï¼Œå¯ä»¥ä½¿ç”¨ JDBC å¯†ç </td></tr><tr><td><code>spring.flyway.placeholder-prefix</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.placeholder-replacement</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.placeholder-suffix</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.placeholders</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.repeatable-sql-migration-prefix</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.schemas</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.skip-default-callbacks</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.skip-default-resolvers</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.sql-migration-prefix</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.sql-migration-separator</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.sql-migration-suffix</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.sql-migration-suffixes</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.table</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.target</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.undo-sql-migration-prefix</code></td><td></td><td></td></tr><tr><td><code>spring.flyway.url</code></td><td></td><td>è¦è¿ç§»çš„æ•°æ®åº“çš„ JDBC URL</td></tr><tr><td><code>spring.flyway.user</code></td><td></td><td>ç™»å½•è¦è¿ç§»æ•°æ®åº“çš„ç”¨æˆ·å</td></tr><tr><td><code>spring.flyway.validate-on-migrate</code></td><td></td><td></td></tr><tr><td><code>spring.gson.date-format</code></td><td></td><td>åºåˆ—åŒ– Date å¯¹è±¡æ—¶ä½¿ç”¨çš„æ ¼å¼</td></tr><tr><td><code>spring.gson.disable-html-escaping</code></td><td></td><td>Whether to disable the escaping of HTML characters such as â€˜&lt;â€™, â€˜&gt;â€™, etc.</td></tr><tr><td><code>spring.gson.disable-inner-class-serialization</code></td><td></td><td>Whether to exclude inner classes during serialization.</td></tr><tr><td><code>spring.gson.enable-complex-map-key-serialization</code></td><td></td><td>Whether to enable serialization of complex map keys (i.e. non-primitives).</td></tr><tr><td><code>spring.gson.exclude-fields-without-expose-annotation</code></td><td></td><td>Whether to exclude all fields from consideration for serialization or deserialization that do not have the â€œExposeâ€ annotation.</td></tr><tr><td><code>spring.gson.field-naming-policy</code></td><td></td><td>Naming policy that should be applied to an objectâ€™s field during serialization and deserialization.</td></tr><tr><td><code>spring.gson.generate-non-executable-json</code></td><td></td><td>Whether to generate non executable JSON by prefixing the output with some special text.</td></tr><tr><td><code>spring.gson.lenient</code></td><td></td><td>Whether to be lenient about parsing JSON that doesnâ€™t conform to RFC 4627.</td></tr><tr><td><code>spring.gson.long-serialization-policy</code></td><td></td><td>Serialization policy for Long and long types.</td></tr><tr><td><code>spring.gson.pretty-printing</code></td><td></td><td>Whether to output serialized JSON that fits in a page for pretty printing.</td></tr><tr><td><code>spring.gson.serialize-nulls</code></td><td></td><td>Whether to serialize null fields.</td></tr><tr><td><code>spring.influx.password</code></td><td></td><td>Influx ç™»å½•ç”¨æˆ·åå¯†ç </td></tr><tr><td><code>spring.influx.url</code></td><td></td><td>InfluxDB æ•°æ®åº“ URL</td></tr><tr><td><code>spring.influx.user</code></td><td></td><td>Influx ç™»å½•ç”¨æˆ·å</td></tr><tr><td><code>spring.integration.jdbc.initialize-schema</code></td><td><code>embedded</code></td><td>Database schema initialization mode.</td></tr><tr><td><code>spring.integration.jdbc.schema</code></td><td><code>classpath:org/springframework/ integration/jdbc/schema-@@platform@@.sql</code></td><td>Path to the SQL file to use to initialize the database schema.</td></tr><tr><td><code>spring.jdbc.template.fetch-size</code></td><td><code>-1</code></td><td>Number of rows that should be fetched from the database when more rows are needed.</td></tr><tr><td><code>spring.jdbc.template.max-rows</code></td><td><code>-1</code></td><td>Maximum number of rows.</td></tr><tr><td><code>spring.jdbc.template.query-timeout</code></td><td></td><td>Query timeout.</td></tr><tr><td><code>spring.jpa.mapping-resources</code></td><td></td><td>Mapping resources (equivalent to â€œmapping-fileâ€ entries in persistence.xml).</td></tr><tr><td><code>spring.jta.atomikos.datasource.concurrent-connection-validation</code></td><td></td><td></td></tr><tr><td><code>spring.jta.atomikos.properties.allow-sub-transactions</code></td><td><code>true</code></td><td>Specify whether sub-transactions are allowed.</td></tr><tr><td><code>spring.jta.atomikos.properties.default-max-wait-time-on-shutdown</code></td><td></td><td>How long should normal shutdown (no-force) wait for transactions to complete.</td></tr><tr><td><code>spring.jta.atomikos.properties.recovery.delay</code></td><td><code>10000ms</code></td><td>Delay between two recovery scans.</td></tr><tr><td><code>spring.jta.atomikos.properties.recovery.forget-orphaned-log-entries-delay</code></td><td><code>86400000ms</code></td><td>Delay after which recovery can cleanup pending (â€˜orphanedâ€™) log entries.</td></tr><tr><td><code>spring.jta.atomikos.properties.recovery.max-retries</code></td><td><code>5</code></td><td>Number of retry attempts to commit the transaction before throwing an exception.</td></tr><tr><td><code>spring.jta.atomikos.properties.recovery.retry-interval</code></td><td><code>10000ms</code></td><td>Delay between retry attempts.</td></tr><tr><td><code>spring.kafka.admin.client-id</code></td><td></td><td>ID to pass to the server when making requests.</td></tr><tr><td><code>spring.kafka.admin.fail-fast</code></td><td><code>false</code></td><td>Whether to fail fast if the broker is not available on startup.</td></tr><tr><td><code>spring.kafka.admin.properties</code></td><td></td><td>Additional admin-specific properties used to configure the client.</td></tr><tr><td><code>spring.kafka.admin.ssl.key-password</code></td><td></td><td>Password of the private key in the key store file.</td></tr><tr><td><code>spring.kafka.admin.ssl.keystore-location</code></td><td></td><td>Location of the key store file.</td></tr><tr><td><code>spring.kafka.admin.ssl.keystore-password</code></td><td></td><td>Store password for the key store file.</td></tr><tr><td><code>spring.kafka.admin.ssl.truststore-location</code></td><td></td><td>Location of the trust store file.</td></tr><tr><td><code>spring.kafka.admin.ssl.truststore-password</code></td><td></td><td>Store password for the trust store file.</td></tr><tr><td><code>spring.kafka.consumer.properties</code></td><td></td><td>Additional consumer-specific properties used to configure the client.</td></tr><tr><td><code>spring.kafka.consumer.ssl.key-password</code></td><td></td><td>Password of the private key in the key store file.</td></tr><tr><td><code>spring.kafka.consumer.ssl.keystore-location</code></td><td></td><td>Location of the key store file.</td></tr><tr><td><code>spring.kafka.consumer.ssl.keystore-password</code></td><td></td><td>Store password for the key store file.</td></tr><tr><td><code>spring.kafka.consumer.ssl.truststore-location</code></td><td></td><td>Location of the trust store file.</td></tr><tr><td><code>spring.kafka.consumer.ssl.truststore-password</code></td><td></td><td>Store password for the trust store file.</td></tr><tr><td><code>spring.kafka.jaas.control-flag</code></td><td><code>required</code></td><td>Control flag for login configuration.</td></tr><tr><td><code>spring.kafka.jaas.enabled</code></td><td><code>false</code></td><td>Whether to enable JAAS configuration.</td></tr><tr><td><code>spring.kafka.jaas.login-module</code></td><td><code>com.sun.security.auth           .module.Krb5LoginModule</code></td><td>Login module.</td></tr><tr><td><code>spring.kafka.jaas.options</code></td><td></td><td>Additional JAAS options.</td></tr><tr><td><code>spring.kafka.listener.client-id</code></td><td></td><td>Prefix for the listenerâ€™s consumer client.id property.</td></tr><tr><td><code>spring.kafka.listener.idle-event-interval</code></td><td></td><td>Time between publishing idle consumer events (no data received).</td></tr><tr><td><code>spring.kafka.listener.log-container-config</code></td><td></td><td>Whether to log the container configuration during initialization (INFO level).</td></tr><tr><td><code>spring.kafka.listener.monitor-interval</code></td><td></td><td>Time between checks for non-responsive consumers.</td></tr><tr><td><code>spring.kafka.listener.no-poll-threshold</code></td><td></td><td>Multiplier applied to â€œpollTimeoutâ€ to determine if a consumer is non-responsive.</td></tr><tr><td><code>spring.kafka.listener.type</code></td><td><code>single</code></td><td>Listener type.</td></tr><tr><td><code>spring.kafka.producer.properties</code></td><td></td><td>Additional producer-specific properties used to configure the client.</td></tr><tr><td><code>spring.kafka.producer.ssl.key-password</code></td><td></td><td>Password of the private key in the key store file.</td></tr><tr><td><code>spring.kafka.producer.ssl.keystore-location</code></td><td></td><td>Location of the key store file.</td></tr><tr><td><code>spring.kafka.producer.ssl.keystore-password</code></td><td></td><td>Store password for the key store file.</td></tr><tr><td><code>spring.kafka.producer.ssl.truststore-location</code></td><td></td><td>Location of the trust store file.</td></tr><tr><td><code>spring.kafka.producer.ssl.truststore-password</code></td><td></td><td>Store password for the trust store file.</td></tr><tr><td><code>spring.kafka.producer.transaction-id-prefix</code></td><td></td><td>When non empty, enables transaction support for producer.</td></tr><tr><td><code>spring.ldap.anonymous-read-only</code></td><td><code>false</code></td><td>Whether read-only operations should use an anonymous environment.</td></tr><tr><td><code>spring.liquibase.change-log</code></td><td><code>classpath:/db/changelog/     db.changelog-master.yaml</code></td><td>Change log configuration path.</td></tr><tr><td><code>spring.liquibase.check-change-log-location</code></td><td><code>true</code></td><td>Whether to check that the change log location exists.</td></tr><tr><td><code>spring.liquibase.contexts</code></td><td></td><td>Comma-separated list of runtime contexts to use.</td></tr><tr><td><code>spring.liquibase.default-schema</code></td><td></td><td>Default database schema.</td></tr><tr><td><code>spring.liquibase.drop-first</code></td><td><code>false</code></td><td>Whether to first drop the database schema.</td></tr><tr><td><code>spring.liquibase.enabled</code></td><td><code>true</code></td><td>Whether to enable Liquibase support.</td></tr><tr><td><code>spring.liquibase.labels</code></td><td></td><td>Comma-separated list of runtime labels to use.</td></tr><tr><td><code>spring.liquibase.parameters</code></td><td></td><td>Change log parameters.</td></tr><tr><td><code>spring.liquibase.password</code></td><td></td><td>Login password of the database to migrate.</td></tr><tr><td><code>spring.liquibase.rollback-file</code></td><td></td><td>File to which rollback SQL is written when an update is performed.</td></tr><tr><td><code>spring.liquibase.url</code></td><td></td><td>JDBC URL of the database to migrate.</td></tr><tr><td><code>spring.liquibase.user</code></td><td></td><td>Login user of the database to migrate.</td></tr><tr><td><code>spring.main.web-application-type</code></td><td></td><td>Flag to explicitly request a specific type of web application.</td></tr><tr><td><code>spring.messages.cache-duration</code></td><td></td><td>Loaded resource bundle files cache duration.</td></tr><tr><td><code>spring.messages.use-code-as-default-message</code></td><td><code>false</code></td><td>Whether to use the message code as the default message instead of throwing a â€œNoSuchMessageExceptionâ€.</td></tr><tr><td><code>spring.mvc.contentnegotiation.favor-parameter</code></td><td><code>false</code></td><td>Whether a request parameter (â€œformatâ€ by default) should be used to determine the requested media type.</td></tr><tr><td><code>spring.mvc.contentnegotiation.favor-path-extension</code></td><td><code>false</code></td><td>Whether the path extension in the URL path should be used to determine the requested media type.</td></tr><tr><td><code>spring.mvc.contentnegotiation.media-types</code></td><td></td><td>Map file extensions to media types for content negotiation.</td></tr><tr><td><code>spring.mvc.contentnegotiation.parameter-name</code></td><td></td><td>Query parameter name to use when â€œfavor-parameterâ€ is enabled.</td></tr><tr><td><code>spring.mvc.pathmatch.use-registered-suffix-pattern</code></td><td><code>false</code></td><td>Whether suffix pattern matching should work only against extensions registered with â€œspring.mvc.contentnegotiation.media-types.*â€.</td></tr><tr><td><code>spring.mvc.pathmatch.use-suffix-pattern</code></td><td><code>false</code></td><td>Whether to use suffix pattern match (â€œ.*â€) when matching patterns to requests.</td></tr><tr><td><code>spring.quartz.jdbc.initialize-schema</code></td><td><code>embedded</code></td><td>Database schema initialization mode.</td></tr><tr><td><code>spring.quartz.jdbc.schema</code></td><td><code>classpath:org/quartz/impl/ jdbcjobstore/ tables_@@platform@@.sql</code></td><td>Path to the SQL file to use to initialize the database schema.</td></tr><tr><td><code>spring.quartz.job-store-type</code></td><td><code>memory</code></td><td>Quartz job store type.</td></tr><tr><td><code>spring.quartz.properties</code></td><td></td><td>Additional Quartz Scheduler properties.</td></tr><tr><td><code>spring.rabbitmq.listener.direct.acknowledge-mode</code></td><td></td><td>Acknowledge mode of container.</td></tr><tr><td><code>spring.rabbitmq.listener.direct.auto-startup</code></td><td><code>true</code></td><td>Whether to start the container automatically on startup.</td></tr><tr><td><code>spring.rabbitmq.listener.direct.consumers-per-queue</code></td><td></td><td>Number of consumers per queue.</td></tr><tr><td><code>spring.rabbitmq.listener.direct.default-requeue-rejected</code></td><td></td><td>Whether rejected deliveries are re-queued by default.</td></tr><tr><td><code>spring.rabbitmq.listener.direct.idle-event-interval</code></td><td></td><td>How often idle container events should be published.</td></tr><tr><td><code>spring.rabbitmq.listener.direct.prefetch</code></td><td></td><td>Number of messages to be handled in a single request.</td></tr><tr><td><code>spring.rabbitmq.listener.direct.retry.enabled</code></td><td><code>false</code></td><td>Whether publishing retries are enabled.</td></tr><tr><td><code>spring.rabbitmq.listener.direct.retry.initial-interval</code></td><td><code>1000ms</code></td><td>Duration between the first and second attempt to deliver a message.</td></tr><tr><td><code>spring.rabbitmq.listener.direct.retry.max-attempts</code></td><td><code>3</code></td><td>Maximum number of attempts to deliver a message.</td></tr><tr><td><code>spring.rabbitmq.listener.direct.retry.max-interval</code></td><td><code>10000ms</code></td><td>Maximum duration between attempts.</td></tr><tr><td><code>spring.rabbitmq.listener.direct.retry.multiplier</code></td><td><code>1</code></td><td>Multiplier to apply to the previous retry interval.</td></tr><tr><td><code>spring.rabbitmq.listener.direct.retry.stateless</code></td><td><code>true</code></td><td>Whether retries are stateless or stateful.</td></tr><tr><td><code>spring.rabbitmq.listener.type</code></td><td><code>simple</code></td><td>Listener container type.</td></tr><tr><td><code>spring.rabbitmq.ssl.key-store-type</code></td><td><code>PKCS12</code></td><td>Key store type.</td></tr><tr><td><code>spring.rabbitmq.ssl.trust-store-type</code></td><td><code>JKS</code></td><td>Trust store type.</td></tr><tr><td><code>spring.rabbitmq.template.exchange</code></td><td>``</td><td>Name of the default exchange to use for send operations.</td></tr><tr><td><code>spring.rabbitmq.template.routing-key</code></td><td>``</td><td>Value of a default routing key to use for send operations.</td></tr><tr><td><code>spring.reactor.stacktrace-mode.enabled</code></td><td><code>false</code></td><td>Whether Reactor should collect stacktrace information at runtime.</td></tr><tr><td><code>spring.redis.jedis.pool.max-active</code></td><td><code>8</code></td><td>Maximum number of connections that can be allocated by the pool at a given time.</td></tr><tr><td><code>spring.redis.jedis.pool.max-idle</code></td><td><code>8</code></td><td>Maximum number of â€œidleâ€ connections in the pool.</td></tr><tr><td><code>spring.redis.jedis.pool.max-wait</code></td><td><code>-1ms</code></td><td>Maximum amount of time a connection allocation should block before throwing an exception when the pool is exhausted.</td></tr><tr><td><code>spring.redis.jedis.pool.min-idle</code></td><td><code>0</code></td><td>Target for the minimum number of idle connections to maintain in the pool.</td></tr><tr><td><code>spring.redis.lettuce.pool.max-active</code></td><td><code>8</code></td><td>Maximum number of connections that can be allocated by the pool at a given time.</td></tr><tr><td><code>spring.redis.lettuce.pool.max-idle</code></td><td><code>8</code></td><td>Maximum number of â€œidleâ€ connections in the pool.</td></tr><tr><td><code>spring.redis.lettuce.pool.max-wait</code></td><td><code>-1ms</code></td><td>Maximum amount of time a connection allocation should block before throwing an exception when the pool is exhausted.</td></tr><tr><td><code>spring.redis.lettuce.pool.min-idle</code></td><td><code>0</code></td><td>Target for the minimum number of idle connections to maintain in the pool.</td></tr><tr><td><code>spring.redis.lettuce.shutdown-timeout</code></td><td><code>100ms</code></td><td>Shutdown timeout.</td></tr><tr><td><code>spring.resources.cache.cachecontrol.cache-private</code></td><td></td><td>Indicate that the response message is intended for a single user and must not be stored by a shared cache.</td></tr><tr><td><code>spring.resources.cache.cachecontrol.cache-public</code></td><td></td><td>Indicate that any cache may store the response.</td></tr><tr><td><code>spring.resources.cache.cachecontrol.max-age</code></td><td></td><td>Maximum time the response should be cached, in seconds if no duration suffix is not specified.</td></tr><tr><td><code>spring.resources.cache.cachecontrol.must-revalidate</code></td><td></td><td>Indicate that once it has become stale, a cache must not use the response without re-validating it with the server.</td></tr><tr><td><code>spring.resources.cache.cachecontrol.no-cache</code></td><td></td><td>Indicate that the cached response can be reused only if re-validated with the server.</td></tr><tr><td><code>spring.resources.cache.cachecontrol.no-store</code></td><td></td><td>Indicate to not cache the response in any case.</td></tr><tr><td><code>spring.resources.cache.cachecontrol.no-transform</code></td><td></td><td>Indicate intermediaries (caches and others) that they should not transform the response content.</td></tr><tr><td><code>spring.resources.cache.cachecontrol.proxy-revalidate</code></td><td></td><td>Same meaning as the â€œmust-revalidateâ€ directive, except that it does not apply to private caches.</td></tr><tr><td><code>spring.resources.cache.cachecontrol.s-max-age</code></td><td></td><td>Maximum time the response should be cached by shared caches, in seconds if no duration suffix is not specified.</td></tr><tr><td><code>spring.resources.cache.cachecontrol.stale-if-error</code></td><td></td><td>Maximum time the response may be used when errors are encountered, in seconds if no duration suffix is not specified.</td></tr><tr><td><code>spring.resources.cache.cachecontrol.stale-while-revalidate</code></td><td></td><td>Maximum time the response can be served after it becomes stale, in seconds if no duration suffix is not specified.</td></tr><tr><td><code>spring.resources.cache.period</code></td><td></td><td>Cache period for the resources served by the resource handler.</td></tr><tr><td><code>spring.security.filter.dispatcher-types</code></td><td><code>async,error,request</code></td><td>Security filter chain dispatcher types.</td></tr><tr><td><code>spring.security.filter.order</code></td><td><code>-100</code></td><td>Security filter chain order.</td></tr><tr><td><code>spring.security.oauth2.client.provider</code></td><td></td><td>OAuth provider details.</td></tr><tr><td><code>spring.security.oauth2.client.registration</code></td><td></td><td>OAuth client registrations.</td></tr><tr><td><code>spring.security.user.name</code></td><td><code>user</code></td><td>Default user name.</td></tr><tr><td><code>spring.security.user.password</code></td><td></td><td>Password for the default user name.</td></tr><tr><td><code>spring.security.user.roles</code></td><td></td><td>Granted roles for the default user name.</td></tr><tr><td><code>spring.servlet.multipart.enabled</code></td><td><code>true</code></td><td>Whether to enable support of multipart uploads.</td></tr><tr><td><code>spring.servlet.multipart.file-size-threshold</code></td><td><code>0</code></td><td>Threshold after which files are written to disk.</td></tr><tr><td><code>spring.servlet.multipart.location</code></td><td></td><td>Intermediate location of uploaded files.</td></tr><tr><td><code>spring.servlet.multipart.max-file-size</code></td><td><code>1MB</code></td><td>Max file size.</td></tr><tr><td><code>spring.servlet.multipart.max-request-size</code></td><td><code>10MB</code></td><td>Max request size.</td></tr><tr><td><code>spring.servlet.multipart.resolve-lazily</code></td><td><code>false</code></td><td>Whether to resolve the multipart request lazily at the time of file or parameter access.</td></tr><tr><td><code>spring.session.jdbc.cleanup-cron</code></td><td><code>0 * * * * *</code></td><td>Cron expression for expired session cleanup job.</td></tr><tr><td><code>spring.session.jdbc.initialize-schema</code></td><td><code>embedded</code></td><td>Database schema initialization mode.</td></tr><tr><td><code>spring.session.mongodb.collection-name</code></td><td><code>sessions</code></td><td>Collection name used to store sessions.</td></tr><tr><td><code>spring.session.redis.cleanup-cron</code></td><td><code>0 * * * * *</code></td><td>Cron expression for expired session cleanup job.</td></tr><tr><td><code>spring.session.servlet.filter-dispatcher-types</code></td><td><code>async,error,request</code></td><td>Session repository filter dispatcher types.</td></tr><tr><td><code>spring.session.servlet.filter-order</code></td><td></td><td>Session repository filter order.</td></tr><tr><td><code>spring.thymeleaf.enable-spring-el-compiler</code></td><td><code>false</code></td><td>Enable the SpringEL compiler in SpringEL expressions.</td></tr><tr><td><code>spring.thymeleaf.reactive.chunked-mode-view-names</code></td><td></td><td>Comma-separated list of view names (patterns allowed) that should be the only ones executed in CHUNKED mode when a max chunk size is set.</td></tr><tr><td><code>spring.thymeleaf.reactive.full-mode-view-names</code></td><td></td><td>Comma-separated list of view names (patterns allowed) that should be executed in FULL mode even if a max chunk size is set.</td></tr><tr><td><code>spring.thymeleaf.reactive.max-chunk-size</code></td><td><code>0</code></td><td>Maximum size of data buffers used for writing to the response, in bytes.</td></tr><tr><td><code>spring.thymeleaf.reactive.media-types</code></td><td></td><td>Media types supported by the view technology.</td></tr><tr><td><code>spring.thymeleaf.servlet.content-type</code></td><td><code>text/html</code></td><td>Content-Type value written to HTTP responses.</td></tr><tr><td><code>spring.webflux.date-format</code></td><td></td><td>Date format to use.</td></tr><tr><td><code>spring.webflux.static-path-pattern</code></td><td><code>/**</code></td><td>Path pattern used for static resources.</td></tr><tr><td><code>spring.webservices.wsdl-locations</code></td><td></td><td>Comma-separated list of locations of WSDLs and accompanying XSDs to be exposed as beans.</td></tr></tbody></table><table><thead><tr><th>Key</th><th>Replacementï¼ˆæ›¿ä»£ï¼‰</th><th>åŸå› </th></tr></thead><tbody><tr><td><code>banner.charset</code></td><td><code>spring.banner.charset</code></td><td></td></tr><tr><td><code>banner.image.height</code></td><td><code>spring.banner.image.height</code></td><td></td></tr><tr><td><code>banner.image.invert</code></td><td><code>spring.banner.image.invert</code></td><td></td></tr><tr><td><code>banner.image.location</code></td><td><code>spring.banner.image.location</code></td><td></td></tr><tr><td><code>banner.image.margin</code></td><td><code>spring.banner.image.margin</code></td><td></td></tr><tr><td><code>banner.image.width</code></td><td><code>spring.banner.image.width</code></td><td></td></tr><tr><td><code>banner.location</code></td><td><code>spring.banner.location</code></td><td></td></tr><tr><td><code>endpoints.actuator.enabled</code></td><td></td><td>actuator  ç«¯ç‚¹ä¸å†å¯ç”¨</td></tr><tr><td><code>endpoints.actuator.path</code></td><td></td><td>actuator  ç«¯ç‚¹ä¸å†å¯ç”¨</td></tr><tr><td><code>endpoints.actuator.sensitive</code></td><td></td><td>actuator  ç«¯ç‚¹ä¸å†å¯ç”¨</td></tr><tr><td><code>endpoints.auditevents.enabled</code></td><td><code>management.endpoint.  auditevents.enabled</code></td><td></td></tr><tr><td><code>endpoints.auditevents.path</code></td><td><code>management.endpoints.web.path-mapping.auditevents</code></td><td></td></tr><tr><td><code>endpoints.auditevents.sensitive</code></td><td></td><td>ç»ˆç«¯æ•æ„Ÿæ ‡å¿—ä¸å†å¯å®šåˆ¶ï¼Œå› ä¸ºSpring Boot ä¸å†æä¾›å¯è‡ªå®šä¹‰çš„å®‰å…¨è‡ªåŠ¨é…ç½®</td></tr><tr><td><code>endpoints.autoconfig.enabled</code></td><td><code>management.endpoint.   conditions.enabled</code></td><td></td></tr><tr><td><code>endpoints.autoconfig.id</code></td><td></td><td>ç«¯ç‚¹æ ‡è¯†ç¬¦ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>endpoints.autoconfig.path</code></td><td><code>management.endpoints.web.path-mapping.conditions</code></td><td></td></tr><tr><td><code>endpoints.autoconfig.sensitive</code></td><td></td><td>ç»ˆç«¯æ•æ„Ÿæ ‡å¿—ä¸å†å¯å®šåˆ¶ï¼Œå› ä¸ºSpring Boot ä¸å†æä¾›å¯è‡ªå®šä¹‰çš„å®‰å…¨è‡ªåŠ¨é…ç½®</td></tr><tr><td><code>endpoints.beans.enabled</code></td><td><code>management.endpoint.beans.enabled</code></td><td></td></tr><tr><td><code>endpoints.beans.id</code></td><td></td><td>ç«¯ç‚¹æ ‡è¯†ç¬¦ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>endpoints.beans.path</code></td><td><code>management.endpoints.web.path-mapping.beans</code></td><td></td></tr><tr><td><code>endpoints.beans.sensitive</code></td><td></td><td>ç»ˆç«¯æ•æ„Ÿæ ‡å¿—ä¸å†å¯å®šåˆ¶ï¼Œå› ä¸ºSpring Boot ä¸å†æä¾›å¯è‡ªå®šä¹‰çš„å®‰å…¨è‡ªåŠ¨é…ç½®</td></tr><tr><td><code>endpoints.configprops.enabled</code></td><td><code>management.endpoint.   configprops.enabled</code></td><td></td></tr><tr><td><code>endpoints.configprops.id</code></td><td></td><td>ç«¯ç‚¹æ ‡è¯†ç¬¦ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>endpoints.configprops.keys-to-sanitize</code></td><td><code>management.endpoint.     configprops.keys-to-sanitize</code></td><td></td></tr><tr><td><code>endpoints.configprops.path</code></td><td><code>management.endpoints.web.path-mapping.configprops</code></td><td></td></tr><tr><td><code>endpoints.configprops.sensitive</code></td><td></td><td>ç»ˆç«¯æ•æ„Ÿæ ‡å¿—ä¸å†å¯å®šåˆ¶ï¼Œå› ä¸ºSpring Boot ä¸å†æä¾›å¯è‡ªå®šä¹‰çš„å®‰å…¨è‡ªåŠ¨é…ç½®</td></tr><tr><td><code>endpoints.cors.allow-credentials</code></td><td><code>management.endpoints.      web.cors.allow-credentials</code></td><td></td></tr><tr><td><code>endpoints.cors.allowed-headers</code></td><td><code>management.endpoints.    web.cors.allowed-headers</code></td><td></td></tr><tr><td><code>endpoints.cors.allowed-methods</code></td><td><code>management.endpoints.    web.cors.allowed-methods</code></td><td></td></tr><tr><td><code>endpoints.cors.allowed-origins</code></td><td><code>management.endpoints.    web.cors.allowed-origins</code></td><td></td></tr><tr><td><code>endpoints.cors.exposed-headers</code></td><td><code>management.endpoints.    web.cors.exposed-headers</code></td><td></td></tr><tr><td><code>endpoints.cors.max-age</code></td><td><code>management.endpoints.        web.cors.max-age</code></td><td></td></tr><tr><td><code>endpoints.docs.curies.enabled</code></td><td></td><td>docs ç«¯ç‚¹ä¸å†å¯ç”¨</td></tr><tr><td><code>endpoints.docs.enabled</code></td><td></td><td>docs ç«¯ç‚¹ä¸å†å¯ç”¨</td></tr><tr><td><code>endpoints.docs.path</code></td><td></td><td>docs ç«¯ç‚¹ä¸å†å¯ç”¨</td></tr><tr><td><code>endpoints.docs.sensitive</code></td><td></td><td>docs ç«¯ç‚¹ä¸å†å¯ç”¨</td></tr><tr><td><code>endpoints.dump.enabled</code></td><td><code>management.endpoint.    threaddump.enabled</code></td><td></td></tr><tr><td><code>endpoints.dump.id</code></td><td></td><td>ç«¯ç‚¹æ ‡è¯†ç¬¦ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>endpoints.dump.path</code></td><td><code>management.endpoints.web.path-mapping.dump</code></td><td></td></tr><tr><td><code>endpoints.dump.sensitive</code></td><td></td><td>ç»ˆç«¯æ•æ„Ÿæ ‡å¿—ä¸å†å¯å®šåˆ¶ï¼Œå› ä¸ºSpring Boot ä¸å†æä¾›å¯è‡ªå®šä¹‰çš„å®‰å…¨è‡ªåŠ¨é…ç½®</td></tr><tr><td><code>endpoints.enabled</code></td><td><code>management.endpoints.             enabled-by-default</code></td><td></td></tr><tr><td><code>endpoints.env.enabled</code></td><td><code>management.endpoint.env.enabled</code></td><td></td></tr><tr><td><code>endpoints.env.id</code></td><td></td><td>ç«¯ç‚¹æ ‡è¯†ç¬¦ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>endpoints.env.keys-to-sanitize</code></td><td><code>management.endpoint.             env.keys-to-sanitize</code></td><td></td></tr><tr><td><code>endpoints.env.path</code></td><td><code>management.endpoints.            web.path-mapping.env</code></td><td></td></tr><tr><td><code>endpoints.env.sensitive</code></td><td></td><td>ç»ˆç«¯æ•æ„Ÿæ ‡å¿—ä¸å†å¯å®šåˆ¶ï¼Œå› ä¸ºSpring Boot ä¸å†æä¾›å¯è‡ªå®šä¹‰çš„å®‰å…¨è‡ªåŠ¨é…ç½®</td></tr><tr><td><code>endpoints.flyway.enabled</code></td><td><code>management.endpoint.flyway.enabled</code></td><td></td></tr><tr><td><code>endpoints.flyway.id</code></td><td></td><td>ç«¯ç‚¹æ ‡è¯†ç¬¦ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>endpoints.flyway.sensitive</code></td><td></td><td>ç»ˆç«¯æ•æ„Ÿæ ‡å¿—ä¸å†å¯å®šåˆ¶ï¼Œå› ä¸ºSpring Boot ä¸å†æä¾›å¯è‡ªå®šä¹‰çš„å®‰å…¨è‡ªåŠ¨é…ç½®</td></tr><tr><td><code>endpoints.health.enabled</code></td><td><code>management.endpoint.health.enabled</code></td><td></td></tr><tr><td><code>endpoints.health.id</code></td><td></td><td>ç«¯ç‚¹æ ‡è¯†ç¬¦ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>endpoints.health.mapping</code></td><td><code>management.health.status.http-mapping</code></td><td></td></tr><tr><td><code>endpoints.health.path</code></td><td><code>management.endpoints.web.path-mapping.health</code></td><td></td></tr><tr><td><code>endpoints.health.sensitive</code></td><td></td><td>ç»ˆç«¯æ•æ„Ÿæ ‡å¿—ä¸å†å¯å®šåˆ¶ï¼Œå› ä¸ºSpring Boot ä¸å†æä¾›å¯è‡ªå®šä¹‰çš„å®‰å…¨è‡ªåŠ¨é…ç½®</td></tr><tr><td><code>endpoints.health.time-to-live</code></td><td><code>management.endpoint.    health.cache.time-to-live</code></td><td></td></tr><tr><td><code>endpoints.heapdump.enabled</code></td><td><code>management.endpoint.heapdump.enabled</code></td><td></td></tr><tr><td><code>endpoints.heapdump.path</code></td><td><code>management.endpoints.web.path-mapping.heapdump</code></td><td></td></tr><tr><td><code>endpoints.heapdump.sensitive</code></td><td></td><td>ç»ˆç«¯æ•æ„Ÿæ ‡å¿—ä¸å†å¯å®šåˆ¶ï¼Œå› ä¸ºSpring Boot ä¸å†æä¾›å¯è‡ªå®šä¹‰çš„å®‰å…¨è‡ªåŠ¨é…ç½®</td></tr><tr><td><code>endpoints.hypermedia.enabled</code></td><td></td><td>Actuator ä¸­çš„ Hypermedia ä¸å†å¯ç”¨</td></tr><tr><td><code>endpoints.info.enabled</code></td><td><code>management.endpoint.info.enabled</code></td><td></td></tr><tr><td><code>endpoints.info.id</code></td><td></td><td>ç«¯ç‚¹æ ‡è¯†ç¬¦ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>endpoints.info.path</code></td><td><code>management.endpoints.web.path-mapping.info</code></td><td></td></tr><tr><td><code>endpoints.info.sensitive</code></td><td></td><td>ç»ˆç«¯æ•æ„Ÿæ ‡å¿—ä¸å†å¯å®šåˆ¶ï¼Œå› ä¸ºSpring Boot ä¸å†æä¾›å¯è‡ªå®šä¹‰çš„å®‰å…¨è‡ªåŠ¨é…ç½®</td></tr><tr><td><code>endpoints.jmx.domain</code></td><td><code>management.endpoints.jmx.domain</code></td><td></td></tr><tr><td><code>endpoints.jmx.enabled</code></td><td><code>management.endpoints. jmx.exposure.exclude</code></td><td></td></tr><tr><td><code>endpoints.jmx.static-names</code></td><td><code>management.endpoints.        jmx.static-names</code></td><td></td></tr><tr><td><code>endpoints.jmx.unique-names</code></td><td><code>management.endpoints.        jmx.unique-names</code></td><td></td></tr><tr><td><code>endpoints.jolokia.enabled</code></td><td><code>management.endpoint.     jolokia.enabled</code></td><td></td></tr><tr><td><code>endpoints.jolokia.path</code></td><td><code>management.endpoints.web.path-mapping.jolokia</code></td><td></td></tr><tr><td><code>endpoints.jolokia.sensitive</code></td><td></td><td>ç»ˆç«¯æ•æ„Ÿæ ‡å¿—ä¸å†å¯å®šåˆ¶ï¼Œå› ä¸ºSpring Boot ä¸å†æä¾›å¯è‡ªå®šä¹‰çš„å®‰å…¨è‡ªåŠ¨é…ç½®</td></tr><tr><td><code>endpoints.liquibase.enabled</code></td><td><code>management.endpoint.   liquibase.enabled</code></td><td></td></tr><tr><td><code>endpoints.liquibase.id</code></td><td></td><td>ç«¯ç‚¹æ ‡è¯†ç¬¦ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>endpoints.liquibase.sensitive</code></td><td></td><td>ç»ˆç«¯æ•æ„Ÿæ ‡å¿—ä¸å†å¯å®šåˆ¶ï¼Œå› ä¸ºSpring Boot ä¸å†æä¾›å¯è‡ªå®šä¹‰çš„å®‰å…¨è‡ªåŠ¨é…ç½®</td></tr><tr><td><code>endpoints.logfile.enabled</code></td><td><code>management.endpoint.     logfile.enabled</code></td><td></td></tr><tr><td><code>endpoints.logfile.external-file</code></td><td><code>management.endpoint.     logfile.external-file</code></td><td></td></tr><tr><td><code>endpoints.logfile.path</code></td><td><code>management.endpoints.web.path-mapping.logfile</code></td><td></td></tr><tr><td><code>endpoints.logfile.sensitive</code></td><td></td><td>ç»ˆç«¯æ•æ„Ÿæ ‡å¿—ä¸å†å¯å®šåˆ¶ï¼Œå› ä¸ºSpring Boot ä¸å†æä¾›å¯è‡ªå®šä¹‰çš„å®‰å…¨è‡ªåŠ¨é…ç½®</td></tr><tr><td><code>endpoints.loggers.enabled</code></td><td><code>management.endpoint.      loggers.enabled</code></td><td></td></tr><tr><td><code>endpoints.loggers.id</code></td><td></td><td>ç«¯ç‚¹æ ‡è¯†ç¬¦ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>endpoints.loggers.path</code></td><td><code>management.endpoints.web.path-mapping.loggers</code></td><td></td></tr><tr><td><code>endpoints.loggers.sensitive</code></td><td></td><td>ç»ˆç«¯æ•æ„Ÿæ ‡å¿—ä¸å†å¯å®šåˆ¶ï¼Œå› ä¸ºSpring Boot ä¸å†æä¾›å¯è‡ªå®šä¹‰çš„å®‰å…¨è‡ªåŠ¨é…ç½®</td></tr><tr><td><code>endpoints.mappings.enabled</code></td><td><code>management.endpoint.     mappings.enabled</code></td><td></td></tr><tr><td><code>endpoints.mappings.id</code></td><td></td><td>ç«¯ç‚¹æ ‡è¯†ç¬¦ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>endpoints.mappings.path</code></td><td><code>management.endpoints.web.path-mapping.mappings</code></td><td></td></tr><tr><td><code>endpoints.mappings.sensitive</code></td><td></td><td>ç»ˆç«¯æ•æ„Ÿæ ‡å¿—ä¸å†å¯å®šåˆ¶ï¼Œå› ä¸ºSpring Boot ä¸å†æä¾›å¯è‡ªå®šä¹‰çš„å®‰å…¨è‡ªåŠ¨é…ç½®</td></tr><tr><td><code>endpoints.metrics.enabled</code></td><td><code>management.endpoint.metrics.enabled</code></td><td></td></tr><tr><td><code>endpoints.metrics.filter.counter-submissions</code></td><td></td><td>Metrics support ç°åœ¨ä½¿ç”¨åƒåˆ†å°º</td></tr><tr><td><code>endpoints.metrics.filter.enabled</code></td><td></td><td>Metrics support ç°åœ¨ä½¿ç”¨åƒåˆ†å°º</td></tr><tr><td><code>endpoints.metrics.filter.gauge-submissions</code></td><td></td><td>Metrics support ç°åœ¨ä½¿ç”¨åƒåˆ†å°º</td></tr><tr><td><code>endpoints.metrics.id</code></td><td></td><td>ç«¯ç‚¹æ ‡è¯†ç¬¦ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>endpoints.metrics.path</code></td><td><code>management.endpoints.web.path-mapping.metrics</code></td><td></td></tr><tr><td><code>endpoints.metrics.sensitive</code></td><td></td><td>ç»ˆç«¯æ•æ„Ÿæ ‡å¿—ä¸å†å¯å®šåˆ¶ï¼Œå› ä¸ºSpring Boot ä¸å†æä¾›å¯è‡ªå®šä¹‰çš„å®‰å…¨è‡ªåŠ¨é…ç½®</td></tr><tr><td><code>endpoints.sensitive</code></td><td></td><td>ç»ˆç«¯æ•æ„Ÿæ ‡å¿—ä¸å†å¯å®šåˆ¶ï¼Œå› ä¸ºSpring Boot ä¸å†æä¾›å¯è‡ªå®šä¹‰çš„å®‰å…¨è‡ªåŠ¨é…ç½®</td></tr><tr><td><code>endpoints.shutdown.enabled</code></td><td><code>management.endpoint.     shutdown.enabled</code></td><td></td></tr><tr><td><code>endpoints.shutdown.id</code></td><td></td><td>ç«¯ç‚¹æ ‡è¯†ç¬¦ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>endpoints.shutdown.path</code></td><td><code>management.endpoints.web.path-mapping.shutdown</code></td><td></td></tr><tr><td><code>endpoints.shutdown.sensitive</code></td><td></td><td>ç»ˆç«¯æ•æ„Ÿæ ‡å¿—ä¸å†å¯å®šåˆ¶ï¼Œå› ä¸ºSpring Boot ä¸å†æä¾›å¯è‡ªå®šä¹‰çš„å®‰å…¨è‡ªåŠ¨é…ç½®</td></tr><tr><td><code>endpoints.trace.enabled</code></td><td><code>management.endpoint.     httptrace.enabled</code></td><td></td></tr><tr><td><code>endpoints.trace.filter.enabled</code></td><td><code>management.trace.http.enabled</code></td><td></td></tr><tr><td><code>endpoints.trace.id</code></td><td></td><td>ç«¯ç‚¹æ ‡è¯†ç¬¦ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>endpoints.trace.path</code></td><td><code>management.endpoints.web.path-mapping.httptrace</code></td><td></td></tr><tr><td><code>endpoints.trace.sensitive</code></td><td></td><td>ç»ˆç«¯æ•æ„Ÿæ ‡å¿—ä¸å†å¯å®šåˆ¶ï¼Œå› ä¸ºSpring Boot ä¸å†æä¾›å¯è‡ªå®šä¹‰çš„å®‰å…¨è‡ªåŠ¨é…ç½®</td></tr><tr><td><code>error.path</code></td><td></td><td>Path of the error controller.</td></tr><tr><td><code>flyway.baseline-description</code></td><td><code>spring.flyway.baseline-description</code></td><td></td></tr><tr><td><code>flyway.baseline-on-migrate</code></td><td><code>spring.flyway.baseline-on-migrate</code></td><td></td></tr><tr><td><code>flyway.baseline-version</code></td><td><code>spring.flyway.baseline-version</code></td><td></td></tr><tr><td><code>flyway.check-location</code></td><td><code>spring.flyway.check-location</code></td><td></td></tr><tr><td><code>flyway.clean-on-validation-error</code></td><td><code>spring.flyway.                    clean-on-validation-error</code></td><td></td></tr><tr><td><code>flyway.enabled</code></td><td><code>spring.flyway.enabled</code></td><td></td></tr><tr><td><code>flyway.encoding</code></td><td><code>spring.flyway.encoding</code></td><td></td></tr><tr><td><code>flyway.ignore-failed-future-migration</code></td><td></td><td></td></tr><tr><td><code>flyway.init-sqls</code></td><td><code>spring.flyway.init-sqls</code></td><td></td></tr><tr><td><code>flyway.locations</code></td><td><code>spring.flyway.locations</code></td><td></td></tr><tr><td><code>flyway.out-of-order</code></td><td><code>spring.flyway.out-of-order</code></td><td></td></tr><tr><td><code>flyway.password</code></td><td><code>spring.flyway.password</code></td><td></td></tr><tr><td><code>flyway.placeholder-prefix</code></td><td><code>spring.flyway.placeholder-prefix</code></td><td></td></tr><tr><td><code>flyway.placeholder-replacement</code></td><td><code>spring.flyway.placeholder-replacement</code></td><td></td></tr><tr><td><code>flyway.placeholder-suffix</code></td><td><code>spring.flyway.placeholder-suffix</code></td><td></td></tr><tr><td><code>flyway.placeholders</code></td><td><code>spring.flyway.placeholders</code></td><td></td></tr><tr><td><code>flyway.schemas</code></td><td><code>spring.flyway.schemas</code></td><td></td></tr><tr><td><code>flyway.sql-migration-prefix</code></td><td><code>spring.flyway.sql-migration-prefix</code></td><td></td></tr><tr><td><code>flyway.sql-migration-separator</code></td><td><code>spring.flyway.sql-migration-separator</code></td><td></td></tr><tr><td><code>flyway.sql-migration-suffix</code></td><td><code>spring.flyway.sql-migration-suffixes</code></td><td></td></tr><tr><td><code>flyway.table</code></td><td><code>spring.flyway.table</code></td><td></td></tr><tr><td><code>flyway.target</code></td><td><code>spring.flyway.target</code></td><td></td></tr><tr><td><code>flyway.url</code></td><td><code>spring.flyway.url</code></td><td></td></tr><tr><td><code>flyway.user</code></td><td><code>spring.flyway.user</code></td><td></td></tr><tr><td><code>flyway.validate-on-migrate</code></td><td><code>spring.flyway.validate-on-migrate</code></td><td></td></tr><tr><td><code>jolokia.config</code></td><td><code>management.endpoint.jolokia.config</code></td><td></td></tr><tr><td><code>liquibase.change-log</code></td><td><code>spring.liquibase.change-log</code></td><td></td></tr><tr><td><code>liquibase.check-change-log-location</code></td><td><code>spring.liquibase.check-change-log-location</code></td><td></td></tr><tr><td><code>liquibase.contexts</code></td><td><code>spring.liquibase.contexts</code></td><td></td></tr><tr><td><code>liquibase.default-schema</code></td><td><code>spring.liquibase.default-schema</code></td><td></td></tr><tr><td><code>liquibase.drop-first</code></td><td><code>spring.liquibase.drop-first</code></td><td></td></tr><tr><td><code>liquibase.enabled</code></td><td><code>spring.liquibase.enabled</code></td><td></td></tr><tr><td><code>liquibase.labels</code></td><td><code>spring.liquibase.labels</code></td><td></td></tr><tr><td><code>liquibase.parameters</code></td><td><code>spring.liquibase.parameters</code></td><td></td></tr><tr><td><code>liquibase.password</code></td><td><code>spring.liquibase.password</code></td><td></td></tr><tr><td><code>liquibase.rollback-file</code></td><td><code>spring.liquibase.rollback-file</code></td><td></td></tr><tr><td><code>liquibase.url</code></td><td><code>spring.liquibase.url</code></td><td></td></tr><tr><td><code>liquibase.user</code></td><td><code>spring.liquibase.user</code></td><td></td></tr><tr><td><code>management.add-application-context-header</code></td><td><code>management.server.add-application-context-header</code></td><td></td></tr><tr><td><code>management.address</code></td><td><code>management.server.address</code></td><td></td></tr><tr><td><code>management.context-path</code></td><td><code>management.server.       servlet.context-path</code></td><td></td></tr><tr><td><code>management.port</code></td><td><code>management.server.port</code></td><td></td></tr><tr><td><code>management.security.enabled</code></td><td></td><td>ç°åœ¨æä¾›å…¨å±€ security è‡ªåŠ¨é…ç½®ã€‚</td></tr><tr><td><code>management.security.roles</code></td><td></td><td>security è‡ªåŠ¨é…ç½®ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>management.security.sessions</code></td><td></td><td>security è‡ªåŠ¨é…ç½®ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>management.shell.auth.jaas.domain</code></td><td></td><td>CRaSH æ”¯æŒä¸å†å¯ç”¨</td></tr><tr><td><code>management.shell.auth.key.path</code></td><td></td><td>CRaSH æ”¯æŒä¸å†å¯ç”¨</td></tr><tr><td><code>management.shell.auth.simple.user.name</code></td><td></td><td>CRaSH æ”¯æŒä¸å†å¯ç”¨</td></tr><tr><td><code>management.shell.auth.simple.user.password</code></td><td></td><td>CRaSH æ”¯æŒä¸å†å¯ç”¨</td></tr><tr><td><code>management.shell.auth.spring.roles</code></td><td></td><td>CRaSH æ”¯æŒä¸å†å¯ç”¨</td></tr><tr><td><code>management.shell.auth.type</code></td><td></td><td>CRaSH æ”¯æŒä¸å†å¯ç”¨</td></tr><tr><td><code>management.shell.ssh.auth-timeout</code></td><td></td><td>CRaSH æ”¯æŒä¸å†å¯ç”¨</td></tr><tr><td><code>management.shell.ssh.enabled</code></td><td></td><td>CRaSH æ”¯æŒä¸å†å¯ç”¨</td></tr><tr><td><code>management.shell.ssh.idle-timeout</code></td><td></td><td>CRaSH æ”¯æŒä¸å†å¯ç”¨</td></tr><tr><td><code>management.shell.ssh.key-path</code></td><td></td><td>CRaSH æ”¯æŒä¸å†å¯ç”¨</td></tr><tr><td><code>management.shell.ssh.port</code></td><td></td><td>CRaSH æ”¯æŒä¸å†å¯ç”¨</td></tr><tr><td><code>management.shell.telnet.enabled</code></td><td></td><td>CRaSH æ”¯æŒä¸å†å¯ç”¨</td></tr><tr><td><code>management.shell.telnet.port</code></td><td></td><td>CRaSH æ”¯æŒä¸å†å¯ç”¨</td></tr><tr><td><code>management.ssl.ciphers</code></td><td><code>management.server.ssl.ciphers</code></td><td></td></tr><tr><td><code>management.ssl.client-auth</code></td><td><code>management.server.ssl.client-auth</code></td><td></td></tr><tr><td><code>management.ssl.enabled</code></td><td><code>management.server.ssl.enabled</code></td><td></td></tr><tr><td><code>management.ssl.enabled-protocols</code></td><td><code>management.server.ssl.enabled-protocols</code></td><td></td></tr><tr><td><code>management.ssl.key-alias</code></td><td><code>management.server.ssl.key-alias</code></td><td></td></tr><tr><td><code>management.ssl.key-password</code></td><td><code>management.server.ssl.key-password</code></td><td></td></tr><tr><td><code>management.ssl.key-store</code></td><td><code>management.server.ssl.key-store</code></td><td></td></tr><tr><td><code>management.ssl.key-store-password</code></td><td><code>management.server.ssl.key-store-password</code></td><td></td></tr><tr><td><code>management.ssl.key-store-provider</code></td><td><code>management.server.ssl.key-store-provider</code></td><td></td></tr><tr><td><code>management.ssl.key-store-type</code></td><td><code>management.server.ssl.key-store-type</code></td><td></td></tr><tr><td><code>management.ssl.protocol</code></td><td><code>management.server.ssl.protocol</code></td><td></td></tr><tr><td><code>management.ssl.trust-store</code></td><td><code>management.server.ssl.trust-store</code></td><td></td></tr><tr><td><code>management.ssl.trust-store-password</code></td><td><code>management.server.ssl.trust-store-password</code></td><td></td></tr><tr><td><code>management.ssl.trust-store-provider</code></td><td><code>management.server.ssl.trust-store-provider</code></td><td></td></tr><tr><td><code>management.ssl.trust-store-type</code></td><td><code>management.server.ssl.trust-store-type</code></td><td></td></tr><tr><td><code>management.trace.include</code></td><td><code>management.trace.http.include</code></td><td></td></tr><tr><td><code>security.basic.authorize-mode</code></td><td></td><td>security è‡ªåŠ¨é…ç½®ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>security.basic.enabled</code></td><td></td><td>security è‡ªåŠ¨é…ç½®ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>security.basic.path</code></td><td></td><td>security è‡ªåŠ¨é…ç½®ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>security.basic.realm</code></td><td></td><td>security è‡ªåŠ¨é…ç½®ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>security.enable-csrf</code></td><td></td><td>security è‡ªåŠ¨é…ç½®ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>security.filter-dispatcher-types</code></td><td><code>spring.security.         filter.dispatcher-types</code></td><td></td></tr><tr><td><code>security.filter-order</code></td><td><code>spring.security.filter.order</code></td><td></td></tr><tr><td><code>security.headers.cache</code></td><td></td><td>security è‡ªåŠ¨é…ç½®ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>security.headers.content-security-policy</code></td><td></td><td>security è‡ªåŠ¨é…ç½®ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>security.headers.content-security-policy-mode</code></td><td></td><td>security è‡ªåŠ¨é…ç½®ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>security.headers.content-type</code></td><td></td><td>security è‡ªåŠ¨é…ç½®ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>security.headers.frame</code></td><td></td><td>security è‡ªåŠ¨é…ç½®ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>security.headers.hsts</code></td><td></td><td>security è‡ªåŠ¨é…ç½®ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>security.headers.xss</code></td><td></td><td>security è‡ªåŠ¨é…ç½®ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>security.ignored</code></td><td></td><td>security è‡ªåŠ¨é…ç½®ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>security.oauth2.                authorization.check-token-access</code></td><td></td><td>Spring Security è®¿é—®è§„åˆ™ç”¨äºæ£€æŸ¥ä»¤ç‰Œç«¯ç‚¹ï¼ˆä¾‹å¦‚ï¼ŒSpELè¡¨è¾¾å¼ï¼Œå¦‚â€œisAuthenticatedï¼ˆï¼‰â€ï¼‰</td></tr><tr><td><code>security.oauth2.authorization.realm</code></td><td></td><td>å®¢æˆ·ç«¯èº«ä»½éªŒè¯çš„é¢†åŸŸåç§°</td></tr><tr><td><code>security.oauth2.authorization.token-key-access</code></td><td></td><td>Spring Securityè®¿é—®è§„åˆ™ç”¨äºæ£€æŸ¥ä»¤ç‰Œç«¯ç‚¹ï¼ˆä¾‹å¦‚ï¼ŒSpELè¡¨è¾¾å¼ï¼Œå¦‚â€œisAuthenticatedï¼ˆï¼‰â€ï¼‰</td></tr><tr><td><code>security.oauth2.client.access-token-uri</code></td><td></td><td></td></tr><tr><td><code>security.oauth2.client.access-token-validity-seconds</code></td><td></td><td></td></tr><tr><td><code>security.oauth2.client.additional-information</code></td><td></td><td></td></tr><tr><td><code>security.oauth2.client.authentication-scheme</code></td><td></td><td></td></tr><tr><td><code>security.oauth2.client.authorities</code></td><td></td><td></td></tr><tr><td><code>security.oauth2.client.authorized-grant-types</code></td><td></td><td></td></tr><tr><td><code>security.oauth2.client.auto-approve-scopes</code></td><td></td><td></td></tr><tr><td><code>security.oauth2.client.client-authentication-scheme</code></td><td></td><td></td></tr><tr><td><code>security.oauth2.client.client-id</code></td><td></td><td></td></tr><tr><td><code>security.oauth2.client.client-secret</code></td><td></td><td></td></tr><tr><td><code>security.oauth2.client.grant-type</code></td><td></td><td></td></tr><tr><td><code>security.oauth2.client.id</code></td><td></td><td></td></tr><tr><td><code>security.oauth2.client.pre-            established-redirect-uri</code></td><td></td><td></td></tr><tr><td><code>security.oauth2.client.refresh-token-validity-seconds</code></td><td></td><td></td></tr><tr><td><code>security.oauth2.client.registered-redirect-uri</code></td><td></td><td></td></tr><tr><td><code>security.oauth2.client.resource-ids</code></td><td></td><td></td></tr><tr><td><code>security.oauth2.client.scope</code></td><td></td><td></td></tr><tr><td><code>security.oauth2.client.token-name</code></td><td></td><td></td></tr><tr><td><code>security.oauth2.client.use-current-uri</code></td><td></td><td></td></tr><tr><td><code>security.oauth2.client.user-authorization-uri</code></td><td></td><td></td></tr><tr><td><code>security.oauth2.resource.filter-order</code></td><td><code>0</code></td><td>ç”¨äºéªŒè¯ä»¤ç‰Œçš„è¿‡æ»¤å™¨é“¾çš„é¡ºåºã€‚</td></tr><tr><td><code>security.oauth2.resource.id</code></td><td></td><td>èµ„æºçš„æ ‡è¯†ç¬¦</td></tr><tr><td><code>security.oauth2.resource.jwk.key-set-uri</code></td><td></td><td>è·å–éªŒè¯å¯†é’¥ä»¥éªŒè¯ JWT ä»¤ç‰Œçš„ URI</td></tr><tr><td><code>security.oauth2.resource.jwt.key-uri</code></td><td></td><td>JWT ä»¤ç‰Œçš„ URI</td></tr><tr><td><code>security.oauth2.resource.jwt.key-value</code></td><td></td><td>JWT ä»¤ç‰Œçš„éªŒè¯å¯†é’¥</td></tr><tr><td><code>security.oauth2.resource.prefer-token-info</code></td><td><code>true</code></td><td>ä½¿ç”¨ä»¤ç‰Œä¿¡æ¯ï¼Œå¯ä»¥è®¾ç½®ä¸º falseä»¥ä½¿ç”¨ç”¨æˆ·ä¿¡æ¯</td></tr><tr><td><code>security.oauth2.resource.service-id</code></td><td><code>resource</code></td><td></td></tr><tr><td><code>security.oauth2.resource.token-info-uri</code></td><td></td><td>token decoding ç«¯ç‚¹çš„ URI</td></tr><tr><td><code>security.oauth2.resource.token-type</code></td><td></td><td>ä½¿ç”¨ userInfoUri æ—¶è¦å‘é€çš„ä»¤ç‰Œç±»å‹ã€‚</td></tr><tr><td><code>security.oauth2.resource.user-info-uri</code></td><td></td><td>ç”¨æˆ·ç«¯ç‚¹çš„ URI</td></tr><tr><td><code>security.oauth2.sso.filter-order</code></td><td></td><td>å¦‚æœä¸æä¾›æ˜¾å¼çš„WebSecurityConfigurerAdapterï¼Œåˆ™åº”ç”¨è¿‡æ»¤å™¨é¡ºåºï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥æ”¹ä¸ºæä¾›é¡ºåºï¼‰ã€‚</td></tr><tr><td><code>security.oauth2.sso.login-path</code></td><td><code>/login</code></td><td>ç™»å½•é¡µé¢çš„è·¯å¾„ï¼Œå³è§¦å‘é‡å®šå‘åˆ° OAuth2 æˆæƒæœåŠ¡å™¨çš„é¡µé¢ã€‚</td></tr><tr><td><code>security.require-ssl</code></td><td></td><td>security è‡ªåŠ¨é…ç½®å·²ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>security.sessions</code></td><td></td><td>security è‡ªåŠ¨é…ç½®å·²ä¸å†å¯å®šåˆ¶</td></tr><tr><td><code>security.user.name</code></td><td><code>spring.security.user.name</code></td><td></td></tr><tr><td><code>security.user.password</code></td><td><code>spring.security.user.password</code></td><td></td></tr><tr><td><code>security.user.role</code></td><td><code>spring.security.user.roles</code></td><td></td></tr><tr><td><code>server.context-parameters</code></td><td><code>server.servlet.context-parameters</code></td><td></td></tr><tr><td><code>server.context-path</code></td><td><code>server.servlet.context-path</code></td><td></td></tr><tr><td><code>server.display-name</code></td><td><code>server.servlet.             application-display-name</code></td><td></td></tr><tr><td><code>server.jsp-servlet.class-name</code></td><td><code>server.servlet.jsp.class-name</code></td><td></td></tr><tr><td><code>server.jsp-servlet.init-parameters</code></td><td><code>server.servlet.jsp.init-parameters</code></td><td></td></tr><tr><td><code>server.jsp-servlet.registered</code></td><td><code>server.servlet.jsp.registered</code></td><td></td></tr><tr><td><code>server.servlet-path</code></td><td><code>server.servlet.path</code></td><td></td></tr><tr><td><code>server.session.cookie.comment</code></td><td><code>server.servlet.session.cookie.comment</code></td><td></td></tr><tr><td><code>server.session.cookie.domain</code></td><td><code>server.servlet.session.cookie.domain</code></td><td></td></tr><tr><td><code>server.session.cookie.http-only</code></td><td><code>server.servlet.       session.cookie.http-only</code></td><td></td></tr><tr><td><code>server.session.cookie.max-age</code></td><td><code>server.servlet.session.cookie.max-age</code></td><td></td></tr><tr><td><code>server.session.cookie.name</code></td><td><code>server.servlet.session.cookie.name</code></td><td></td></tr><tr><td><code>server.session.cookie.path</code></td><td><code>server.servlet.session.cookie.path</code></td><td></td></tr><tr><td><code>server.session.cookie.secure</code></td><td><code>server.servlet.session.cookie.secure</code></td><td></td></tr><tr><td><code>server.session.persistent</code></td><td><code>server.servlet.session.persistent</code></td><td></td></tr><tr><td><code>server.session.store-dir</code></td><td><code>server.servlet.session.store-dir</code></td><td></td></tr><tr><td><code>server.session.timeout</code></td><td><code>server.servlet.session.timeout</code></td><td></td></tr><tr><td><code>server.session.tracking-modes</code></td><td><code>server.servlet.session.tracking-modes</code></td><td></td></tr><tr><td><code>spring.activemq.pool.configuration.block-if-session-pool-is-full</code></td><td></td><td></td></tr><tr><td><code>spring.activemq.pool.configuration.block-if-session-pool-is-full-timeout</code></td><td></td><td></td></tr><tr><td><code>spring.activemq.pool.configuration.connection-factory</code></td><td></td><td></td></tr><tr><td><code>spring.activemq.pool.configuration.create-connection-on-startup</code></td><td></td><td></td></tr><tr><td><code>spring.activemq.pool.configuration.expiry-timeout</code></td><td></td><td></td></tr><tr><td><code>spring.activemq.pool.configuration.idle-timeout</code></td><td></td><td></td></tr><tr><td><code>spring.activemq.pool.configuration.max-connections</code></td><td></td><td></td></tr><tr><td><code>spring.activemq.pool.configuration.maximum-active-session-per-connection</code></td><td></td><td></td></tr><tr><td><code>spring.activemq.pool.configuration.properties</code></td><td></td><td></td></tr><tr><td><code>spring.activemq.pool.configuration.reconnect-on-exception</code></td><td></td><td></td></tr><tr><td><code>spring.activemq.pool.configuration.time-between-expiration-check-millis</code></td><td></td><td></td></tr><tr><td><code>spring.activemq.pool.configuration.use-anonymous-producers</code></td><td></td><td></td></tr><tr><td><code>spring.application.index</code></td><td></td><td>åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ ID é»˜è®¤æƒ…å†µä¸‹æ˜¯å”¯ä¸€çš„</td></tr><tr><td><code>spring.batch.initializer.enabled</code></td><td><code>spring.batch.initialize-schema</code></td><td></td></tr><tr><td><code>spring.cache.guava.spec</code></td><td></td><td>ç”¨äºåˆ›å»ºç¼“å­˜çš„è§„èŒƒ</td></tr><tr><td><code>spring.cache.hazelcast.config</code></td><td></td><td>ç”¨äºåˆå§‹åŒ– Hazelcast çš„é…ç½®æ–‡ä»¶çš„ä½ç½®</td></tr><tr><td><code>spring.data.cassandra.connect-timeout-millis</code></td><td><code>spring.data.          cassandra.connect-timeout</code></td><td></td></tr><tr><td><code>spring.data.cassandra.read-timeout-millis</code></td><td><code>spring.data.cassandra.read-timeout</code></td><td></td></tr><tr><td><code>spring.data.cassandra.repositories.enabled</code></td><td><code>spring.data.cassandra.    repositories.type</code></td><td></td></tr><tr><td><code>spring.data.couchbase.repositories.enabled</code></td><td><code>spring.data.couchbase.    repositories.type</code></td><td></td></tr><tr><td><code>spring.data.mongodb.repositories.enabled</code></td><td><code>spring.data.mongodb.    repositories.type</code></td><td></td></tr><tr><td><code>spring.data.neo4j.compiler</code></td><td></td><td>ä» Neo4j 3 å¼€å§‹ä¸å†æ”¯æŒ</td></tr><tr><td><code>spring.datasource.dbcp.access-to-underlying-connection-allowed</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.connection-init-sqls</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.default-auto-commit</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.default-catalog</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.default-read-only</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.default-transaction-isolation</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.driver-class-name</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.initial-size</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.log-abandoned</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.login-timeout</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.max-active</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.max-idle</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.max-open-prepared-statements</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.max-wait</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.min-evictable-idle-time-millis</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.min-idle</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.num-tests-per-eviction-run</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.password</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.pool-prepared-statements</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.remove-abandoned</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.remove-abandoned-timeout</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.test-on-borrow</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.test-on-return</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.test-while-idle</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.time-between-eviction-runs-millis</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.url</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.username</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.validation-query</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.dbcp.validation-query-timeout</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.hikari.connection-customizer-class-name</code></td><td></td><td></td></tr><tr><td><code>spring.datasource.initialize</code></td><td><code>spring.datasource.       initialization-mode</code></td><td></td></tr><tr><td><code>spring.devtools.remote.debug.enabled</code></td><td></td><td>è¿œç¨‹ debug å·²ä¸å†æ”¯æŒ</td></tr><tr><td><code>spring.devtools.remote.debug.local-port</code></td><td></td><td>è¿œç¨‹ debug å·²ä¸å†æ”¯æŒ</td></tr><tr><td><code>spring.http.multipart.enabled</code></td><td><code>spring.servlet.multipart.enabled</code></td><td></td></tr><tr><td><code>spring.http.multipart.file-size-threshold</code></td><td><code>spring.servlet.multipart.file-size-threshold</code></td><td></td></tr><tr><td><code>spring.http.multipart.location</code></td><td><code>spring.servlet.multipart.location</code></td><td></td></tr><tr><td><code>spring.http.multipart.max-file-size</code></td><td><code>spring.servlet.multipart.max-file-size</code></td><td></td></tr><tr><td><code>spring.http.multipart.max-request-size</code></td><td><code>spring.servlet.           multipart.max-request-size</code></td><td></td></tr><tr><td><code>spring.http.multipart.resolve-lazily</code></td><td><code>spring.servlet.multipart.resolve-lazily</code></td><td></td></tr><tr><td><code>spring.jpa.hibernate.naming.strategy</code></td><td></td><td>Hibernate 4 çš„è‡ªåŠ¨é…ç½®å·²ä¸å†æä¾›</td></tr><tr><td><code>spring.jta.atomikos.properties.console-log-level</code></td><td><code>warn</code></td><td></td></tr><tr><td><code>spring.messages.cache-seconds</code></td><td><code>spring.messages.cache-duration</code></td><td></td></tr><tr><td><code>spring.metrics.export.aggregate.key-pattern</code></td><td></td><td>Metrics support ç°åœ¨ä½¿ç”¨åƒåˆ†å°º</td></tr><tr><td><code>spring.metrics.export.aggregate.prefix</code></td><td></td><td>Metrics support ç°åœ¨ä½¿ç”¨åƒåˆ†å°º</td></tr><tr><td><code>spring.metrics.export.delay-millis</code></td><td></td><td>Metrics support ç°åœ¨ä½¿ç”¨åƒåˆ†å°º</td></tr><tr><td><code>spring.metrics.export.enabled</code></td><td></td><td>Metrics support ç°åœ¨ä½¿ç”¨åƒåˆ†å°º</td></tr><tr><td><code>spring.metrics.export.excludes</code></td><td></td><td>Metrics support ç°åœ¨ä½¿ç”¨åƒåˆ†å°º</td></tr><tr><td><code>spring.metrics.export.includes</code></td><td></td><td>Metrics support ç°åœ¨ä½¿ç”¨åƒåˆ†å°º</td></tr><tr><td><code>spring.metrics.export.redis.key</code></td><td></td><td>Metrics support ç°åœ¨ä½¿ç”¨åƒåˆ†å°º</td></tr><tr><td><code>spring.metrics.export.redis.prefix</code></td><td></td><td>Metrics support ç°åœ¨ä½¿ç”¨åƒåˆ†å°º</td></tr><tr><td><code>spring.metrics.export.send-latest</code></td><td></td><td>Metrics support ç°åœ¨ä½¿ç”¨åƒåˆ†å°º</td></tr><tr><td><code>spring.metrics.export.statsd.host</code></td><td><code>management.metrics.    export.statsd.host</code></td><td></td></tr><tr><td><code>spring.metrics.export.statsd.port</code></td><td><code>management.metrics.   export.statsd.port</code></td><td></td></tr><tr><td><code>spring.metrics.export.statsd.prefix</code></td><td></td><td>Metrics support ç°åœ¨ä½¿ç”¨åƒåˆ†å°º</td></tr><tr><td><code>spring.metrics.export.triggers</code></td><td></td><td>Metrics support ç°åœ¨ä½¿ç”¨åƒåˆ†å°º</td></tr><tr><td><code>spring.mobile.devicedelegatingviewresolver.enable-fallback</code></td><td><code>false</code></td><td>å¯ç”¨å¯¹å›é€€è§£å†³æ–¹æ¡ˆçš„æ”¯æŒ</td></tr><tr><td><code>spring.mobile.devicedelegatingviewresolver.enabled</code></td><td><code>false</code></td><td>å¯ç”¨ device è§†å›¾è§£æå™¨</td></tr><tr><td><code>spring.mobile.devicedelegatingviewresolver.mobile-prefix</code></td><td><code>mobile/</code></td><td>ç”¨äºæŸ¥çœ‹ç§»åŠ¨è®¾å¤‡åç§°çš„å‰ç¼€</td></tr><tr><td><code>spring.mobile.devicedelegatingviewresolver.mobile-suffix</code></td><td>``</td><td>é™„åŠ åç¼€ä»¥æŸ¥çœ‹ç§»åŠ¨è®¾å¤‡çš„åç§°</td></tr><tr><td><code>spring.mobile.devicedelegatingviewresolver.normal-prefix</code></td><td>``</td><td>ç”¨äºæŸ¥çœ‹æ™®é€šè®¾å¤‡åç§°çš„å‰ç¼€.</td></tr><tr><td><code>spring.mobile.devicedelegatingviewresolver.normal-suffix</code></td><td>``</td><td>é™„åŠ åç¼€ä»¥æŸ¥çœ‹æ™®é€šè®¾å¤‡çš„åç§°</td></tr><tr><td><code>spring.mobile.devicedelegatingviewresolver.tablet-prefix</code></td><td><code>tablet/</code></td><td>å‰ç¼€é¢„è®¾ä¸ºæŸ¥çœ‹å¹³æ¿ç”µè„‘è®¾å¤‡çš„åç§°</td></tr><tr><td><code>spring.mobile.devicedelegatingviewresolver.tablet-suffix</code></td><td>``</td><td>é™„åŠ åç¼€ä»¥æŸ¥çœ‹å¹³æ¿ç”µè„‘è®¾å¤‡çš„åç§°</td></tr><tr><td><code>spring.mobile.sitepreference.enabled</code></td><td><code>true</code></td><td>å¯ç”¨ SitePreferenceHandler.</td></tr><tr><td><code>spring.mvc.media-types</code></td><td><code>spring.mvc.    contentnegotiation.media-types</code></td><td></td></tr><tr><td><code>spring.rabbitmq.listener.acknowledge-mode</code></td><td></td><td></td></tr><tr><td><code>spring.rabbitmq.listener.auto-startup</code></td><td></td><td></td></tr><tr><td><code>spring.rabbitmq.listener.concurrency</code></td><td></td><td></td></tr><tr><td><code>spring.rabbitmq.listener.default-requeue-rejected</code></td><td></td><td></td></tr><tr><td><code>spring.rabbitmq.listener.idle-event-interval</code></td><td></td><td></td></tr><tr><td><code>spring.rabbitmq.listener.max-concurrency</code></td><td></td><td></td></tr><tr><td><code>spring.rabbitmq.listener.prefetch</code></td><td></td><td></td></tr><tr><td><code>spring.rabbitmq.listener.retry.enabled</code></td><td><code>false</code></td><td>æ˜¯å¦å¯ç”¨å‘å¸ƒé‡è¯•</td></tr><tr><td><code>spring.rabbitmq.listener.retry.initial-interval</code></td><td><code>1000</code></td><td>ç¬¬ä¸€æ¬¡å’Œç¬¬äºŒæ¬¡å°è¯•å‘å¸ƒæˆ–ä¼ é€’è®¯æ¯çš„æ—¶é—´é—´éš”</td></tr><tr><td><code>spring.rabbitmq.listener.retry.max-attempts</code></td><td><code>3</code></td><td>å°è¯•å‘å¸ƒæˆ–ä¼ é€’é‚®ä»¶çš„æœ€å¤§æ¬¡æ•°</td></tr><tr><td><code>spring.rabbitmq.listener.retry.max-interval</code></td><td><code>10000</code></td><td>å°è¯•ä¹‹é—´çš„æœ€å¤§é—´éš”</td></tr><tr><td><code>spring.rabbitmq.listener.retry.multiplier</code></td><td><code>1</code></td><td>äºå…ˆå‰é‡è¯•é—´éš”çš„å€æ•°</td></tr><tr><td><code>spring.rabbitmq.listener.retry.stateless</code></td><td><code>true</code></td><td>æ— è®ºé‡è¯•æ˜¯æ— çŠ¶æ€è¿˜æ˜¯æœ‰çŠ¶æ€</td></tr><tr><td><code>spring.rabbitmq.listener.transaction-size</code></td><td></td><td></td></tr><tr><td><code>spring.redis.pool.max-active</code></td><td><code>spring.redis.jedis.pool.max-idle</code></td><td></td></tr><tr><td><code>spring.redis.pool.max-idle</code></td><td><code>spring.redis.jedis.pool.max-idle</code></td><td></td></tr><tr><td><code>spring.redis.pool.max-wait</code></td><td><code>spring.redis.jedis.pool.max-wait</code></td><td></td></tr><tr><td><code>spring.redis.pool.min-idle</code></td><td><code>spring.redis.jedis.pool.min-idle</code></td><td></td></tr><tr><td><code>spring.resources.cache-period</code></td><td><code>spring.resources.cache.period</code></td><td></td></tr><tr><td><code>spring.sendgrid.password</code></td><td></td><td>ä¸å†æ”¯æŒä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç  ( ä½¿ç”¨ spring.sendgrid.api-key ä»£æ›¿ )</td></tr><tr><td><code>spring.sendgrid.username</code></td><td></td><td>ä¸å†æ”¯æŒä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç  ( ä½¿ç”¨ spring.sendgrid.api-key ä»£æ›¿ )</td></tr><tr><td><code>spring.session.jdbc.initializer.enabled</code></td><td><code>spring.session.         jdbc.initialize-schema</code></td><td></td></tr><tr><td><code>spring.session.mongo.collection-name</code></td><td><code>spring.session.mongodb.collection-name</code></td><td></td></tr><tr><td><code>spring.social.auto-connection-views</code></td><td><code>false</code></td><td>ä¸ºæ”¯æŒçš„ç”Ÿäº§è€…å¯ç”¨è¿æ¥çŠ¶æ€è§†å›¾</td></tr><tr><td><code>spring.social.facebook.app-id</code></td><td></td><td>Application id.</td></tr><tr><td><code>spring.social.facebook.app-secret</code></td><td></td><td>Application secret.</td></tr><tr><td><code>spring.social.linkedin.app-id</code></td><td></td><td>Application id.</td></tr><tr><td><code>spring.social.linkedin.app-secret</code></td><td></td><td>Application secret.</td></tr><tr><td><code>spring.social.twitter.app-id</code></td><td></td><td>Application id.</td></tr><tr><td><code>spring.social.twitter.app-secret</code></td><td></td><td>Application secret.</td></tr><tr><td><code>spring.thymeleaf.content-type</code></td><td><code>spring.thymeleaf.      servlet.content-type</code></td></tr></tbody></table><h3 id="ç›¸å…³æ–‡ç« "><a href="#ç›¸å…³æ–‡ç« " class="headerlink" title="ç›¸å…³æ–‡ç« "></a>ç›¸å…³æ–‡ç« </h3><h3 id="ç›¸å…³æ–‡ç« -1"><a href="#ç›¸å…³æ–‡ç« -1" class="headerlink" title="ç›¸å…³æ–‡ç« "></a>ç›¸å…³æ–‡ç« </h3><p>1ã€<a href="http://www.54tianzhisheng.cn/2018/03/06/SpringBoot2-Migration-Guide/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (ä¸€)ï¼šSpring Boot 2.0 è¿ç§»æŒ‡å—</a></p><p>2ã€<a href="http://www.54tianzhisheng.cn/2018/03/06/SpringBoot2-new-features/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (äºŒ)ï¼šSpring Boot 2.0 æ–°ç‰¹æ€§è¯¦è§£</a></p><p>3ã€<a href="http://www.54tianzhisheng.cn/2018/04/13/Spring_Boot_2.0_Configuration_Changelog/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (ä¸‰)ï¼šSpring Boot 2.0 é…ç½®æ”¹å˜</a></p><p>4ã€<a href="http://www.54tianzhisheng.cn/2018/04/15/springboot2_code/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (å››)ï¼šSpring Boot 2.0 æºç é˜…è¯»ç¯å¢ƒæ­å»º</a></p><p>5ã€<a href="http://www.54tianzhisheng.cn/2018/04/18/spring_boot2_project/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (äº”)ï¼šSpring Boot 2.0 é¡¹ç›®æºç ç»“æ„é¢„è§ˆ</a></p><p>6ã€<a href="http://www.54tianzhisheng.cn/2018/04/19/SpringBootApplication-annotation/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (å…­)ï¼šSpring boot 2.0 ä¸­ SpringBootApplication æ³¨è§£è¯¦è§£</a></p><h3 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h3><p>è‹±æ–‡å‚è€ƒï¼š<a href="">https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-2.0-Configuration-Changelog</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://ws2.sinaimg.cn/large/006tKfTcgy1fqc4n57tj4j31hc0zktmm.jpg&quot; alt=&quot;pocket-watch-3156771_1920&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="Java" scheme="http://yoursite.com/tags/Java/"/>
    
      <category term="SpringBoot" scheme="http://yoursite.com/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>å†™è¿™ä¹ˆå¤šç³»åˆ—åšå®¢ï¼Œæ€ªä¸å¾—æ‰¾ä¸åˆ°å¥³æœ‹å‹</title>
    <link href="http://yoursite.com/2018/03/27/blogs/"/>
    <id>http://yoursite.com/2018/03/27/blogs/</id>
    <published>2018-03-26T16:00:00.000Z</published>
    <updated>2018-03-27T15:18:02.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://ws2.sinaimg.cn/large/006tKfTcgy1fprrv5n1p2j31hc0u0tm6.jpg" alt="nature-3054445_1920"></p><h3 id="å‰æ"><a href="#å‰æ" class="headerlink" title="å‰æ"></a>å‰æ</h3><p>å¥½å‡ å‘¨æ²¡æ›´æ–°åšå®¢äº†ï¼Œå¯¹ä¸æ–­æ”¯æŒæˆ‘åšå®¢çš„ç«¥é‹ä»¬è¯´å£°ï¼šâ€œæŠ±æ­‰äº†ï¼â€ã€‚è‡ªå·±è¿™æ®µæ—¶é—´ç¡®å®æ¯”è¾ƒå¿™ï¼Œè€Œä¸”è¿˜åœ¨æŠ½ç©ºå®Œæˆå­¦æ ¡çš„æ¯•ä¸šè®¾è®¡ã€‚ä»Šå¤©æ™šä¸ŠæŠ½ç©ºæŠŠå¤§å­¦æœŸé—´å†™è¿‡çš„åšå®¢å¼„ä¸€ä¸ªç³»åˆ—æ–‡ç« åˆé›†ï¼Œç®—æ˜¯å¯¹å¤§å­¦è¿™å››å¹´çš„ä¸€ä¸ªæ€»ç»“ï¼Œè¯æ˜è‡ªå·±æ²¡ç™½è¿‡ã€‚</p><a id="more"></a><p>ç†Ÿæ‚‰æˆ‘çš„äººéƒ½çŸ¥é“æˆ‘å†™åšå®¢çš„æ—¶é—´æ¯”è¾ƒæ—©ï¼Œè€Œä¸”åšæŒçš„æ—¶é—´ä¹Ÿæ¯”è¾ƒä¹…ï¼Œä¸€ç›´åˆ°ç°åœ¨ä¹Ÿæ˜¯ä¸€ç›´ä¿æŒç€æ›´æ–°çŠ¶æ€ã€‚æœ€æ—©æœ€æ—©å¼€å§‹å†™åšå®¢æ˜¯åœ¨ CSDN ä¸Šå†™çš„ï¼Œç„¶ååœ¨ç®€ä¹¦ä¹Ÿå†™è¿‡ä¸€æ®µæ—¶é—´ï¼Œåæ¥æ”¾å¼ƒäº†ç®€ä¹¦è½¬æˆ˜äº†æ˜é‡‘ï¼Œä»¥ä¸‹å›¾ç‰‡æ˜¯è‡ªå·±åœ¨æ˜é‡‘è¿™ä¸€å¹´çš„æˆæœï¼Œå¿« <strong>1.5 ä¸‡</strong>å…³æ³¨äº†ï¼Œå“ˆå“ˆå“ˆã€‚</p><p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1fprrv4ovhqj31kw0iaadw.jpg" alt="21"></p><p>å»å¹´è¿‡å¹´å‰è¿˜æ”¶åˆ°æ˜é‡‘é€æ¥çš„ä¸“å±ç¤¼ç‰©ï¼ŒçœŸæ˜¯æ¿€åŠ¨ï¼Œæ„Ÿè°¢æ˜é‡‘ï¼Œå¸Œæœ›è¶ŠåŠè¶Šå¥½ï¼</p><p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1fprrv2qhutj31kw23vu0x.jpg" alt="IMG_20180206_125142"></p><p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1fprrv7e4wvj31kw23vb29.jpg" alt="IMG_20180206_125159"></p><p>ç»†æ•°æ–‡ç« åï¼Œå‘ç°è‡ªå·±åœ¨å®ä¹ çš„è¿™æ®µæ—¶é—´å†™çš„åšå®¢ä¹ŸæŒºå¤šçš„ï¼Œè€Œä¸”è´¨é‡è¿˜æ¯”è¾ƒé«˜ï¼Œç»å¸¸ä¸Šå¼€å‘è€…å¤´æ¡ã€æ˜é‡‘ç­‰å¹³å°çš„é¦–é¡µæ¨èã€‚åœ¨æ­¤ï¼Œæ„Ÿè°¢å®ä¹ æœŸé—´ç»„å†…å¤§ä½¬ä»¬çš„å„ç§å¸®åŠ©ï¼</p><p>è¿™é‡Œå†æ¬¡è¯´ä¸‹å†™åšå®¢çš„å¥½å¤„ï¼š</p><ul><li>å¾ˆå¥½çš„ç”¨æ¥æ€»ç»“è‡ªå·±æ‰€å­¦çš„çŸ¥è¯†</li><li>é‡åˆ°é‚£ä¹ˆä¸€ç¾¤ä¹Ÿå†™åšå®¢çš„å¤§ä½¬ï¼Œæœ‰å…±åŒè¯é¢˜èŠäº†</li><li>é¢è¯•åŠ åˆ†ï¼ˆåœ¨ç®€å†ä¸Šæ”¾ä¸Šè‡ªå·±çš„ä¸ªäººç½‘ç«™é“¾æ¥ï¼Œé¢è¯•å®˜å°±å¯ä»¥æ›´å¥½çš„äº†è§£ä½ ï¼ŒçŸ¥é“ä½ æ‰€å­¦çŸ¥è¯†çš„æ·±åº¦å’Œå¹¿åº¦ï¼‰</li></ul><p>ä¸è¦å°çœ‹ä½ çš„æ¯ä¸€ç¯‡ä¸èµ·çœ¼åšå®¢ï¼Œç”¨ä¸€ä¸ªèš‚èšé‡‘æœå¤§ä½¬è·Ÿæˆ‘è¯´çš„è¯å«åšï¼š<strong>åšç§¯è–„å‘</strong>ï¼</p><p>ä¸å¤šè¯´äº†ï¼Œå¦‚æœæƒ³å’Œæˆ‘äº¤æµçš„å¯ä»¥åŠ æˆ‘ qq ç¾¤ï¼š<strong>528776268</strong>    å’Œæˆ‘çš„å¾®ä¿¡ï¼š<strong>zhisheng_tian</strong></p><h3 id="å…³æ³¨æˆ‘"><a href="#å…³æ³¨æˆ‘" class="headerlink" title="å…³æ³¨æˆ‘"></a>å…³æ³¨æˆ‘</h3><p><img src="http://ohfk1r827.bkt.clouddn.com/blog/180103/C6LG3mGa12.jpg" alt="mark"></p><p>è½¬è½½è¯·åŠ¡å¿…æ³¨æ˜åŸåˆ›åœ°å€ä¸ºï¼š<a href="http://www.54tianzhisheng.cn/2018/03/27/blogs/" target="_blank" rel="noopener">http://www.54tianzhisheng.cn/2018/03/27/blogs/</a></p><h3 id="ç³»åˆ—æ–‡ç« åˆé›†"><a href="#ç³»åˆ—æ–‡ç« åˆé›†" class="headerlink" title="ç³»åˆ—æ–‡ç« åˆé›†"></a>ç³»åˆ—æ–‡ç« åˆé›†</h3><h4 id="Spring-Boot-ç³»åˆ—æ–‡ç« "><a href="#Spring-Boot-ç³»åˆ—æ–‡ç« " class="headerlink" title="Spring Boot ç³»åˆ—æ–‡ç« "></a><strong>Spring Boot ç³»åˆ—æ–‡ç« </strong></h4><p>1ã€<a href="http://www.54tianzhisheng.cn/2018/01/05/SpringBoot-Kafka/" target="_blank" rel="noopener">Spring Bootç³»åˆ—æ–‡ç« ï¼ˆä¸€ï¼‰ï¼šSpringBoot Kafka æ•´åˆä½¿ç”¨</a></p><p>2ã€<a href="http://www.54tianzhisheng.cn/2018/01/17/SpringBoot-Admin/" target="_blank" rel="noopener">Spring Bootç³»åˆ—æ–‡ç« ï¼ˆäºŒï¼‰ï¼šSpringBoot Admin ä½¿ç”¨æŒ‡å—</a></p><p>3ã€<a href="http://www.54tianzhisheng.cn/2018/01/26/SpringBoot-RabbitMQ/" target="_blank" rel="noopener">Spring Bootç³»åˆ—æ–‡ç« ï¼ˆä¸‰ï¼‰ï¼šSpringBoot RabbitMQ æ•´åˆä½¿ç”¨</a></p><p>4ã€<a href="http://www.54tianzhisheng.cn/2018/01/27/SpringBoot-ActiveMQ/" target="_blank" rel="noopener">Spring Bootç³»åˆ—æ–‡ç« ï¼ˆå››ï¼‰ï¼šSpringBoot ActiveMQ æ•´åˆä½¿ç”¨</a></p><p>5ã€<a href="http://www.54tianzhisheng.cn/2018/01/28/RabbitMQ/" target="_blank" rel="noopener">Spring Bootç³»åˆ—æ–‡ç« ï¼ˆäº”ï¼‰ï¼šSpringBoot RabbitMQ æ•´åˆè¿›é˜¶ç‰ˆ</a></p><p>6ã€<a href="http://www.54tianzhisheng.cn/2018/02/07/SpringBoot-RocketMQ/" target="_blank" rel="noopener">Spring Bootç³»åˆ—æ–‡ç« ï¼ˆå…­ï¼‰ï¼šSpringBoot RocketMQ æ•´åˆä½¿ç”¨å’Œç›‘æ§</a></p><p>7ã€æ›´å¤šè¯·æœŸå¾…</p><h4 id="Spring-Boot-2-0-ç³»åˆ—æ–‡ç« "><a href="#Spring-Boot-2-0-ç³»åˆ—æ–‡ç« " class="headerlink" title="Spring Boot 2.0 ç³»åˆ—æ–‡ç« "></a><strong>Spring Boot 2.0 ç³»åˆ—æ–‡ç« </strong></h4><p>1ã€<a href="http://www.54tianzhisheng.cn/2018/03/06/SpringBoot2-Migration-Guide/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (ä¸€)ï¼šSpring Boot 2.0 è¿ç§»æŒ‡å—</a></p><p>2ã€<a href="http://www.54tianzhisheng.cn/2018/03/06/SpringBoot2-new-features/" target="_blank" rel="noopener">Spring Boot 2.0ç³»åˆ—æ–‡ç« (äºŒ)ï¼šSpring Boot 2.0 æ–°ç‰¹æ€§è¯¦è§£</a></p><p>3ã€åé¢ç»å¯¹æœ‰æ›´å¤šæ–‡ç« å‡ºç°çš„</p><h4 id="Docker-ç³»åˆ—æ–‡ç« "><a href="#Docker-ç³»åˆ—æ–‡ç« " class="headerlink" title="Docker ç³»åˆ—æ–‡ç« "></a><strong>Docker ç³»åˆ—æ–‡ç« </strong></h4><p>1ã€<a href="http://www.54tianzhisheng.cn/2017/11/26/Docker-harbor/" target="_blank" rel="noopener">Dockerç³»åˆ—æ–‡ç« ï¼ˆä¸€ï¼‰ï¼šåŸºäº Harbor æ­å»º Docker ç§æœ‰é•œåƒä»“åº“</a></p><p>2ã€<a href="http://www.54tianzhisheng.cn/2018/01/25/Docker-install/" target="_blank" rel="noopener">Dockerç³»åˆ—æ–‡ç« ï¼ˆäºŒï¼‰ï¼šMac å®‰è£… Docker åŠå¸¸ç”¨å‘½ä»¤</a></p><p>3ã€åŒæ ·ï¼Œåé¢ä¹Ÿä¼šæŒç»­æ›´æ–°</p><h4 id="ElasticSearch-ç³»åˆ—æ–‡ç« "><a href="#ElasticSearch-ç³»åˆ—æ–‡ç« " class="headerlink" title="ElasticSearch ç³»åˆ—æ–‡ç« "></a><strong>ElasticSearch ç³»åˆ—æ–‡ç« </strong></h4><p>1ã€<a href="http://www.54tianzhisheng.cn/2017/09/08/Elasticsearch-analyzers/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆä¸€ï¼‰ï¼šElasticsearch é»˜è®¤åˆ†è¯å™¨å’Œä¸­åˆ†åˆ†è¯å™¨ä¹‹é—´çš„æ¯”è¾ƒåŠä½¿ç”¨æ–¹æ³•</a></p><p>2ã€ <a href="http://www.54tianzhisheng.cn/2017/09/09/Elasticsearch-install/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆäºŒï¼‰ï¼šå…¨æ–‡æœç´¢å¼•æ“ Elasticsearch é›†ç¾¤æ­å»ºå…¥é—¨æ•™ç¨‹</a></p><p>3ã€<a href="http://www.54tianzhisheng.cn/2017/10/15/ElasticSearch-cluster-health-metrics/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆä¸‰ï¼‰ï¼šElasticSearch é›†ç¾¤ç›‘æ§</a></p><p>4ã€<a href="http://www.54tianzhisheng.cn/2017/10/18/ElasticSearch-nodes-metrics/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆå››ï¼‰ï¼šElasticSearch å•ä¸ªèŠ‚ç‚¹ç›‘æ§</a></p><p>5ã€<a href="http://www.54tianzhisheng.cn/2017/12/25/ELK/" target="_blank" rel="noopener">Elasticsearch ç³»åˆ—æ–‡ç« ï¼ˆäº”ï¼‰ï¼šELK å®æ—¶æ—¥å¿—åˆ†æå¹³å°ç¯å¢ƒæ­å»º</a></p><p>6ã€ä¹Ÿæœ‰æ›´å¤šæ·±å…¥çš„æ–‡ç« </p><h4 id="æ­å»ºåšå®¢ç³»åˆ—æ–‡ç« "><a href="#æ­å»ºåšå®¢ç³»åˆ—æ–‡ç« " class="headerlink" title="æ­å»ºåšå®¢ç³»åˆ—æ–‡ç« "></a><strong>æ­å»ºåšå®¢ç³»åˆ—æ–‡ç« </strong></h4><p>1ã€<a href="http://www.54tianzhisheng.cn/2017/03/28/%E5%88%A9%E7%94%A8Github%20Page%20%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E7%BD%91%E7%AB%99/" target="_blank" rel="noopener">åˆ©ç”¨Github Page æ­å»ºä¸ªäººåšå®¢ç½‘ç«™</a></p><p>2ã€<a href="http://www.54tianzhisheng.cn/2017/04/13/Hexo-yilia-changyan/" target="_blank" rel="noopener">Github pages + Hexo åšå®¢ yilia ä¸»é¢˜ä½¿ç”¨ç•…è¨€è¯„è®ºç³»ç»Ÿ</a></p><p>3ã€<a href="http://www.54tianzhisheng.cn/2017/12/18/hexo-yilia/" target="_blank" rel="noopener">Hexo + yilia æ­å»ºåšå®¢å¯èƒ½ä¼šé‡åˆ°çš„æ‰€æœ‰ç–‘é—®</a></p><p>4ã€<a href="http://www.54tianzhisheng.cn/2017/06/13/Hexo-yilia-toc/" target="_blank" rel="noopener">Hexo + yilia ä¸»é¢˜å®ç°æ–‡ç« ç›®å½•</a></p><p>5ã€è¿™ä¸ªç³»åˆ—çœ‹æƒ…å†µï¼Œå¯èƒ½è¿˜ä¼šæœ‰</p><h4 id="Java-ç³»åˆ—æ–‡ç« "><a href="#Java-ç³»åˆ—æ–‡ç« " class="headerlink" title="Java ç³»åˆ—æ–‡ç« "></a><strong>Java ç³»åˆ—æ–‡ç« </strong></h4><p>1ã€<a href="http://www.54tianzhisheng.cn/2017/06/13/String-new/" target="_blank" rel="noopener">å…³äºString s = new String(â€œxyzâ€); åˆ›å»ºå‡ ä¸ªå¯¹è±¡çš„é—®é¢˜</a></p><p>2ã€<a href="http://www.54tianzhisheng.cn/2017/06/13/Java-Thread/" target="_blank" rel="noopener">ã€ŠJava å¤šçº¿ç¨‹ç¼–ç¨‹æ ¸å¿ƒæŠ€æœ¯ã€‹å­¦ä¹ ç¬”è®°åŠæ€»ç»“</a></p><p>3ã€<a href="http://www.54tianzhisheng.cn/2017/06/13/java-var/" target="_blank" rel="noopener">ä»å¯¹è±¡æ·±å…¥åˆ†æ Java ä¸­å®ä¾‹å˜é‡å’Œç±»å˜é‡çš„åŒºåˆ«</a></p><p>4ã€<a href="http://www.54tianzhisheng.cn/2017/06/13/%E6%B7%B1%E5%BA%A6%E6%8E%A2%E7%A9%B6Java%20%E4%B8%AD%20finally%20%E8%AF%AD%E5%8F%A5%E5%9D%97/" target="_blank" rel="noopener">æ·±åº¦æ¢ç©¶Java ä¸­ finally è¯­å¥å—</a></p><p>5ã€<a href="http://www.54tianzhisheng.cn/2017/06/13/%E8%A7%A3%E5%86%B3jdk1.8%E4%B8%AD%E5%8F%91%E9%80%81%E9%82%AE%E4%BB%B6%E5%A4%B1%E8%B4%A5%EF%BC%88handshake_failure%EF%BC%89%E9%97%AE%E9%A2%98/" target="_blank" rel="noopener">è§£å†³jdk1.8ä¸­å‘é€é‚®ä»¶å¤±è´¥ï¼ˆhandshake_failureï¼‰é—®é¢˜</a></p><p>6ã€<a href="http://www.54tianzhisheng.cn/2017/06/13/%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90%20Java%20Web%20%E4%B8%AD%E7%9A%84%E4%B8%AD%E6%96%87%E7%BC%96%E7%A0%81%E9%97%AE%E9%A2%98/" target="_blank" rel="noopener">æ·±å…¥åˆ†æ Java Web ä¸­çš„ä¸­æ–‡ç¼–ç é—®é¢˜</a></p><p>7ã€<a href="http://www.54tianzhisheng.cn/2017/06/13/%E5%A5%87%E6%80%AA%E7%9A%84Java%E9%A2%98%EF%BC%9A%E4%B8%BA%E4%BB%80%E4%B9%88128%20==%20128%E8%BF%94%E5%9B%9E%E4%B8%BAFalse%EF%BC%8C%E8%80%8C127%20==%20127%E4%BC%9A%E8%BF%94%E5%9B%9E%E4%B8%BATrue-/" target="_blank" rel="noopener">å¥‡æ€ªçš„Javaé¢˜ï¼šä¸ºä»€ä¹ˆ128 == 128è¿”å›ä¸ºFalseï¼Œè€Œ127 == 127ä¼šè¿”å›ä¸ºTrue?</a></p><p>8ã€<a href="http://www.54tianzhisheng.cn/2017/06/13/java%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6/" target="_blank" rel="noopener">Javaè¯»å–æ–‡ä»¶</a></p><p>9ã€<a href="http://www.54tianzhisheng.cn/2017/06/13/HashMap-Hashtable/" target="_blank" rel="noopener">HashMapã€Hashtableã€HashSet å’Œ ConcurrentHashMap çš„æ¯”è¾ƒ</a></p><p>10ã€<a href="http://www.54tianzhisheng.cn/2017/06/13/Java%E8%BF%9E%E6%8E%A5Oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E4%B8%89%E7%A7%8D%E8%BF%9E%E6%8E%A5%E6%96%B9%E5%BC%8F/" target="_blank" rel="noopener">Javaè¿æ¥Oracleæ•°æ®åº“çš„ä¸‰ç§è¿æ¥æ–¹å¼</a></p><p>11ã€<a href="http://www.54tianzhisheng.cn/2017/06/13/Java%20NIO%20%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B/" target="_blank" rel="noopener">Java NIO ç³»åˆ—æ•™ç¨‹</a></p><p>12ã€<a href="http://www.54tianzhisheng.cn/2017/06/13/Java-16-lession/" target="_blank" rel="noopener">ã€Šç–¯ç‹‚ Java çªç ´ç¨‹åºå‘˜åŸºæœ¬åŠŸçš„ 16 è¯¾ã€‹è¯»ä¹¦ç¬”è®°</a></p><p>13ã€<a href="http://www.54tianzhisheng.cn/2017/06/17/%E8%AF%A6%E7%BB%86%E6%B7%B1%E5%85%A5%E5%88%86%E6%9E%90%20Java%20ClassLoader%20%E5%B7%A5%E4%BD%9C%E6%9C%BA%E5%88%B6/" target="_blank" rel="noopener">è¯¦ç»†æ·±å…¥åˆ†æ Java ClassLoader å·¥ä½œæœºåˆ¶</a></p><p>14ã€<a href="http://www.54tianzhisheng.cn/2017/06/17/%E8%AF%A6%E8%A7%A3%20Filter%20%E8%BF%87%E6%BB%A4%E5%99%A8/" target="_blank" rel="noopener">è¯¦è§£ Filter è¿‡æ»¤å™¨</a></p><p>15ã€<a href="http://www.54tianzhisheng.cn/2017/06/23/java-io/" target="_blank" rel="noopener">Java IOæµå­¦ä¹ è¶…è¯¦ç»†æ€»ç»“ï¼ˆå›¾æ–‡å¹¶èŒ‚ï¼‰</a></p><p>16ã€<a href="http://www.54tianzhisheng.cn/2017/07/09/servlet/" target="_blank" rel="noopener">é€šè¿‡æºç è¯¦è§£ Servlet</a></p><p>17ã€<a href="http://www.54tianzhisheng.cn/2017/07/25/Java-performance-tuning/" target="_blank" rel="noopener">Java æ€§èƒ½è°ƒä¼˜éœ€è¦æ ¼å¤–æ³¨æ„çš„ç»†èŠ‚</a></p><p>18ã€<a href="http://www.54tianzhisheng.cn/2017/07/29/ThreadPool/" target="_blank" rel="noopener">Java çº¿ç¨‹æ± è‰ºæœ¯æ¢ç´¢</a></p><p>19ã€<a href="http://www.54tianzhisheng.cn/2017/06/13/JVM%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7jps%E3%80%81jstack%E3%80%81jmap%E3%80%81jhat%E3%80%81jstat%E7%AD%89%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3/" target="_blank" rel="noopener">JVMæ€§èƒ½è°ƒä¼˜ç›‘æ§å·¥å…·jpsã€jstackã€jmapã€jhatã€jstatç­‰ä½¿ç”¨è¯¦è§£</a></p><p>20ã€è¿™ä¸ªå¿…é¡»çš„æŒç»­æ›´æ–°ä¸‹å»</p><h4 id="Maven-ç³»åˆ—æ–‡ç« "><a href="#Maven-ç³»åˆ—æ–‡ç« " class="headerlink" title="Maven  ç³»åˆ—æ–‡ç« "></a><strong>Maven  ç³»åˆ—æ–‡ç« </strong></h4><p>1ã€<a href="http://www.54tianzhisheng.cn/2017/10/14/Nexus3-Maven/" target="_blank" rel="noopener">Centos7 æ­å»ºæœ€æ–° Nexus3 Maven ç§æœ</a></p><p>2ã€<a href="http://www.54tianzhisheng.cn/2017/11/11/Maven-dependencies-dependencyManagement/" target="_blank" rel="noopener">Maven ä¸­ dependencies ä¸ dependencyManagement çš„åŒºåˆ«</a></p><h4 id="Kafka-ç³»åˆ—æ–‡ç« "><a href="#Kafka-ç³»åˆ—æ–‡ç« " class="headerlink" title="Kafka ç³»åˆ—æ–‡ç« "></a><strong>Kafka ç³»åˆ—æ–‡ç« </strong></h4><p>1ã€<a href="http://www.54tianzhisheng.cn/2018/01/04/Kafka/" target="_blank" rel="noopener">Kafka å®‰è£…åŠå¿«é€Ÿå…¥é—¨</a></p><p>2ã€<a href="http://www.54tianzhisheng.cn/2018/01/05/SpringBoot-Kafka/" target="_blank" rel="noopener">Spring Bootç³»åˆ—æ–‡ç« ï¼ˆä¸€ï¼‰ï¼šSpringBoot Kafka æ•´åˆä½¿ç”¨</a></p><h4 id="Mybatis-ç³»åˆ—æ–‡ç« "><a href="#Mybatis-ç³»åˆ—æ–‡ç« " class="headerlink" title="Mybatis ç³»åˆ—æ–‡ç« "></a><strong>Mybatis ç³»åˆ—æ–‡ç« </strong></h4><p>1ã€<a href="http://blog.csdn.net/tzs_1041218129/article/details/53404326" target="_blank" rel="noopener">é€šè¿‡é¡¹ç›®é€æ­¥æ·±å…¥äº†è§£Mybatis&lt;ä¸€&gt;</a></p><p>2ã€<a href="http://blog.csdn.net/tzs_1041218129/article/details/53449052" target="_blank" rel="noopener">é€šè¿‡é¡¹ç›®é€æ­¥æ·±å…¥äº†è§£Mybatis&lt;äºŒ&gt;</a></p><p>3ã€<a href="http://blog.csdn.net/tzs_1041218129/article/details/53456677" target="_blank" rel="noopener">é€šè¿‡é¡¹ç›®é€æ­¥æ·±å…¥äº†è§£Mybatis&lt;ä¸‰&gt;</a></p><p>4ã€<a href="http://www.54tianzhisheng.cn/2017/06/15/%E9%80%9A%E8%BF%87%E9%A1%B9%E7%9B%AE%E9%80%90%E6%AD%A5%E6%B7%B1%E5%85%A5%E4%BA%86%E8%A7%A3Mybatis(%E5%9B%9B" target="_blank" rel="noopener">é€šè¿‡é¡¹ç›®é€æ­¥æ·±å…¥äº†è§£Mybatisï¼ˆå››)</a>/)</p><p>5ã€<a href="http://www.54tianzhisheng.cn/2017/06/13/MyBatis-foreach/" target="_blank" rel="noopener">MyBatisçš„foreachè¯­å¥è¯¦è§£</a></p><p>6ã€æœŸå¾…å®ƒçš„æºç è§£ææ–‡ç« å—ï¼Ÿ</p><h4 id="Nginx-ç³»åˆ—æ–‡ç« "><a href="#Nginx-ç³»åˆ—æ–‡ç« " class="headerlink" title="Nginx ç³»åˆ—æ–‡ç« "></a><strong>Nginx ç³»åˆ—æ–‡ç« </strong></h4><p>1ã€<a href="http://www.54tianzhisheng.cn/2017/08/18/Ubuntu-install-Nginx/" target="_blank" rel="noopener">Ubuntu16.10 å®‰è£… Nginx</a></p><p>2ã€<a href="http://www.54tianzhisheng.cn/2017/08/05/Nginx/" target="_blank" rel="noopener">Nginx åŸºæœ¬çŸ¥è¯†å¿«é€Ÿå…¥é—¨</a></p><h4 id="Python-çˆ¬è™«ç³»åˆ—æ–‡ç« "><a href="#Python-çˆ¬è™«ç³»åˆ—æ–‡ç« " class="headerlink" title="Python çˆ¬è™«ç³»åˆ—æ–‡ç« "></a><strong>Python çˆ¬è™«ç³»åˆ—æ–‡ç« </strong></h4><p>1ã€<a href="http://www.54tianzhisheng.cn/2017/06/13/Python%E7%88%AC%E8%99%AB%E5%AE%9E%E6%88%98%E4%B9%8B%E7%88%AC%E5%8F%96%E7%99%BE%E5%BA%A6%E8%B4%B4%E5%90%A7%E5%B8%96%E5%AD%90/" target="_blank" rel="noopener">Pythonçˆ¬è™«å®æˆ˜ä¹‹çˆ¬å–ç™¾åº¦è´´å§å¸–å­</a></p><p>2ã€<a href="http://www.54tianzhisheng.cn/2017/06/13/Pyspider%E6%A1%86%E6%9E%B6%20%E2%80%94%E2%80%94%20Python%E7%88%AC%E8%99%AB%E5%AE%9E%E6%88%98%E4%B9%8B%E7%88%AC%E5%8F%96%20V2EX%20%E7%BD%91%E7%AB%99%E5%B8%96%E5%AD%90/" target="_blank" rel="noopener">Pyspideræ¡†æ¶ â€”â€” Pythonçˆ¬è™«å®æˆ˜ä¹‹çˆ¬å– V2EX ç½‘ç«™å¸–å­</a></p><p>3ã€<a href="http://www.54tianzhisheng.cn/2017/06/13/Python%E7%88%AC%E8%99%AB%E5%AE%9E%E6%88%98%E4%B9%8B%E7%88%AC%E5%8F%96%E7%B3%97%E4%BA%8B%E7%99%BE%E7%A7%91%E6%AE%B5%E5%AD%90/" target="_blank" rel="noopener">Pythonçˆ¬è™«å®æˆ˜ä¹‹çˆ¬å–ç³—äº‹ç™¾ç§‘æ®µå­</a></p><p>4ã€è¿™ä¸ªä¼°è®¡å¾—ç­‰æœ‰æœºä¼šå†æ¬¡å­¦ Python æ—¶å†å†™</p><h4 id="RocketMQ-ç³»åˆ—æ–‡ç« "><a href="#RocketMQ-ç³»åˆ—æ–‡ç« " class="headerlink" title="RocketMQ ç³»åˆ—æ–‡ç« "></a><strong>RocketMQ ç³»åˆ—æ–‡ç« </strong></h4><p>1ã€<a href="http://www.54tianzhisheng.cn/2018/02/05/RocketMQ/" target="_blank" rel="noopener">RocketMQç³»åˆ—æ–‡ç« ï¼ˆä¸€ï¼‰ï¼šRocketMQ åˆæ¢</a></p><p>2ã€<a href="http://www.54tianzhisheng.cn/2018/02/06/RocketMQ-install/" target="_blank" rel="noopener">RocketMQç³»åˆ—æ–‡ç« ï¼ˆäºŒï¼‰ï¼šRocketMQ å®‰è£…åŠå¿«é€Ÿå…¥é—¨</a></p><p>3ã€<a href="http://www.54tianzhisheng.cn/2018/02/07/rocketmq-example/" target="_blank" rel="noopener">RocketMQç³»åˆ—æ–‡ç« ï¼ˆä¸‰ï¼‰ï¼šRocketMQ ç®€å•çš„æ¶ˆæ¯ç¤ºä¾‹</a></p><p>4ã€<a href="http://www.54tianzhisheng.cn/2018/02/07/SpringBoot-RocketMQ/" target="_blank" rel="noopener">Spring Bootç³»åˆ—æ–‡ç« ï¼ˆå…­ï¼‰ï¼šSpringBoot RocketMQ æ•´åˆä½¿ç”¨å’Œç›‘æ§</a></p><h4 id="Spring-MVC-ç³»åˆ—æ–‡ç« "><a href="#Spring-MVC-ç³»åˆ—æ–‡ç« " class="headerlink" title="Spring MVC ç³»åˆ—æ–‡ç« "></a><strong>Spring MVC ç³»åˆ—æ–‡ç« </strong></h4><p>1ã€<a href="http://www.54tianzhisheng.cn/2017/06/13/Spring%20MVC%20+%20Hibernate%20JPA%20+%20Bootstrap%20%E6%90%AD%E5%BB%BA%E7%9A%84%E5%8D%9A%E5%AE%A2%E7%B3%BB%E7%BB%9F/" target="_blank" rel="noopener">Spring MVCç³»åˆ—æ–‡ç« ï¼ˆä¸€ï¼‰ï¼šSpring MVC + Hibernate JPA + Bootstrap æ­å»ºçš„åšå®¢ç³»ç»Ÿ Demo</a></p><p>2ã€<a href="http://www.54tianzhisheng.cn/2017/06/13/Spring%20MVC+Hibernate%20JPA%E6%90%AD%E5%BB%BA%E7%9A%84%E5%8D%9A%E5%AE%A2%E7%B3%BB%E7%BB%9F%E9%A1%B9%E7%9B%AE%E4%B8%AD%E6%89%80%E9%81%87%E5%88%B0%E7%9A%84%E5%9D%91/" target="_blank" rel="noopener">Spring MVCç³»åˆ—æ–‡ç« ï¼ˆäºŒï¼‰ï¼šSpring MVC+Hibernate JPAæ­å»ºçš„åšå®¢ç³»ç»Ÿé¡¹ç›®ä¸­æ‰€é‡åˆ°çš„å‘</a></p><p>3ã€<a href="http://www.54tianzhisheng.cn/2017/07/14/Spring-MVC01/" target="_blank" rel="noopener">Spring MVCç³»åˆ—æ–‡ç« ï¼ˆä¸‰ï¼‰ï¼šçœ‹é€ Spring MVC æºä»£ç åˆ†æä¸å®è·µ â€”â€” ç½‘ç«™åŸºç¡€çŸ¥è¯†</a></p><p>4ã€<a href="http://www.54tianzhisheng.cn/2017/07/14/Spring-MVC02/" target="_blank" rel="noopener">Spring MVCç³»åˆ—æ–‡ç« ï¼ˆå››ï¼‰ï¼šçœ‹é€ Spring MVC æºä»£ç åˆ†æä¸å®è·µ â€”â€” ä¿¯è§† Spring MVC</a></p><p>5ã€<a href="http://www.54tianzhisheng.cn/2017/07/21/Spring-MVC03/" target="_blank" rel="noopener">Spring MVCç³»åˆ—æ–‡ç« ï¼ˆäº”ï¼‰ï¼šçœ‹é€ Spring MVC æºä»£ç åˆ†æä¸å®è·µ â€”â€” Spring MVC ç»„ä»¶åˆ†æ</a></p><p>6ã€<a href="http://www.54tianzhisheng.cn/2017/06/16/%E9%80%9A%E8%BF%87%E9%A1%B9%E7%9B%AE%E9%80%90%E6%AD%A5%E6%B7%B1%E5%85%A5%E4%BA%86%E8%A7%A3Spring%20MVC%EF%BC%88%E4%B8%80%EF%BC%89/" target="_blank" rel="noopener">é€šè¿‡é¡¹ç›®é€æ­¥æ·±å…¥äº†è§£Spring MVCï¼ˆä¸€ï¼‰</a></p><h4 id="Netty-ç³»åˆ—æ–‡ç« "><a href="#Netty-ç³»åˆ—æ–‡ç« " class="headerlink" title="Netty ç³»åˆ—æ–‡ç« "></a><strong>Netty ç³»åˆ—æ–‡ç« </strong></h4><p>1ã€<a href="http://www.54tianzhisheng.cn/2017/12/08/netty-01-env/" target="_blank" rel="noopener">Nettyç³»åˆ—æ–‡ç« ï¼ˆä¸€ï¼‰ï¼šNetty æºç é˜…è¯»ä¹‹åˆå§‹ç¯å¢ƒæ­å»º</a></p><p>2ã€è¿™ä¸ªç³»åˆ—è¿Ÿæ—©ä¼šæ›´æ–°çš„ã€‚</p><h4 id="å‰ç«¯ç³»åˆ—æ–‡ç« "><a href="#å‰ç«¯ç³»åˆ—æ–‡ç« " class="headerlink" title="å‰ç«¯ç³»åˆ—æ–‡ç« "></a><strong>å‰ç«¯ç³»åˆ—æ–‡ç« </strong></h4><p>1ã€<a href="http://www.54tianzhisheng.cn/2017/06/18/Bootstrap%E5%85%A5%E9%97%A8%E9%9C%80%E6%8E%8C%E6%8F%A1%E7%9A%84%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%88%E4%B8%80%EF%BC%89/" target="_blank" rel="noopener">Bootstrapå…¥é—¨éœ€æŒæ¡çš„çŸ¥è¯†ç‚¹ï¼ˆä¸€ï¼‰</a></p><p>2ã€<a href="http://www.54tianzhisheng.cn/2017/06/18/Bootstrap%E5%85%A5%E9%97%A8%E9%9C%80%E6%8E%8C%E6%8F%A1%E7%9A%84%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%88%E4%BA%8C%EF%BC%89/" target="_blank" rel="noopener">Bootstrapå…¥é—¨éœ€æŒæ¡çš„çŸ¥è¯†ç‚¹ï¼ˆäºŒï¼‰</a></p><p>3ã€<a href="http://www.54tianzhisheng.cn/2017/12/09/CodeMirror/" target="_blank" rel="noopener">ä½¿ç”¨ CodeMirror æ‰“é€ å±äºè‡ªå·±çš„åœ¨çº¿ä»£ç ç¼–è¾‘å™¨</a></p><p>4ã€<a href="http://www.54tianzhisheng.cn/2017/06/23/AJAX/" target="_blank" rel="noopener">AJAX å­¦ä¹ </a></p><p>5ã€å‰ç«¯æ¸£æ¸£è¿™ä¸ªä¹Ÿè¦æ…¢æ…¢å­¦ä¹ è¿™å—</p><h4 id="é¢è¯•ç»éªŒç³»åˆ—"><a href="#é¢è¯•ç»éªŒç³»åˆ—" class="headerlink" title="é¢è¯•ç»éªŒç³»åˆ—"></a><strong>é¢è¯•ç»éªŒç³»åˆ—</strong></h4><p>1ã€<a href="http://www.54tianzhisheng.cn/2017/08/04/yaxin/" target="_blank" rel="noopener">ç§‹æ‹›ç¬¬ä¸€ç«™ â€”â€” äºšä¿¡ç§‘æŠ€</a></p><p>2ã€<a href="http://www.54tianzhisheng.cn/2017/08/04/iqiyi/" target="_blank" rel="noopener">ç§‹æ‹›ç¬¬äºŒç«™ â€”â€” å†…æ¨çˆ±å¥‡è‰ºï¼ˆä¸€é¢äºŒé¢ï¼‰</a></p><p>3ã€<a href="http://www.54tianzhisheng.cn/2017/08/04/alibaba/" target="_blank" rel="noopener">ç§‹æ‹›ç¬¬ä¸‰ç«™ â€”â€” å†…æ¨é˜¿é‡Œï¼ˆä¸€é¢ï¼‰</a></p><p>4ã€ <a href="http://www.54tianzhisheng.cn/2017/09/17/Interview-summary/" target="_blank" rel="noopener">é¢è¯•è¿‡é˜¿é‡Œç­‰äº’è”ç½‘å¤§å…¬å¸ï¼Œæˆ‘çŸ¥é“äº†è¿™äº›å¥—è·¯</a></p><p>5ã€<a href="http://www.54tianzhisheng.cn/2017/08/28/recommend-books/" target="_blank" rel="noopener">é‚£äº›å¹´æˆ‘çœ‹è¿‡çš„ä¹¦ â€”â€” è‡´æ•¬æˆ‘çš„å¤§å­¦ç”Ÿæ´» â€”â€” Say Good Bye ï¼</a></p><h4 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a><strong>å…¶ä»–</strong></h4><p>è¿˜æœ‰ä¸€äº›å…¶ä»–æ–¹é¢çš„æŠ€æœ¯æ–‡ç« ï¼Œç®—ä¸æ˜¯ç³»åˆ—æ–‡ç« ï¼Œæ¯”è¾ƒé›¶æ•£ï¼Œè¿˜æœ‰å°±æ˜¯ä¸€äº›éšç¬”æ–‡ç« ï¼Œå°±ä¸æŠŠå®ƒä»¬æ”¾åœ¨åˆé›†é‡Œäº†ã€‚</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>ç”¨è‡ªå·±çš„ä¸€å¥è¯ï¼š<strong>å‘è¦ä¸€ä¸ªä¸ªå¡«ï¼Œè·¯è¦ä¸€æ­¥æ­¥èµ°ï¼å‰äººæ ½æ ‘ï¼Œåäººä¹˜å‡‰ï¼Œå­¦ä¼šæ„Ÿæ©ï¼</strong></p><p>å»ºäº†ä¸ªä¸é”™çš„å¾®ä¿¡ç¾¤ï¼Œå¦‚æœæœ‰æ„Ÿå…´è¶£çš„å¯ä»¥åŠ æˆ‘å¾®ä¿¡ï¼Œå¯¹æˆ‘å›å¤  <strong>åŠ ç¾¤</strong> ï¼Œç„¶åä¼šæ‹‰ä½ è¿›ç¾¤äº¤æµã€‚</p><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fp0t1jn6s4j30qi0z10x1.jpg" alt="1520091522031"></p><p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fp3jkmizmpj30o00didgn.jpg" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://ws2.sinaimg.cn/large/006tKfTcgy1fprrv5n1p2j31hc0u0tm6.jpg&quot; alt=&quot;nature-3054445_1920&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;å‰æ&quot;&gt;&lt;a href=&quot;#å‰æ&quot; class=&quot;headerlink&quot; title=&quot;å‰æ&quot;&gt;&lt;/a&gt;å‰æ&lt;/h3&gt;&lt;p&gt;å¥½å‡ å‘¨æ²¡æ›´æ–°åšå®¢äº†ï¼Œå¯¹ä¸æ–­æ”¯æŒæˆ‘åšå®¢çš„ç«¥é‹ä»¬è¯´å£°ï¼šâ€œæŠ±æ­‰äº†ï¼â€ã€‚è‡ªå·±è¿™æ®µæ—¶é—´ç¡®å®æ¯”è¾ƒå¿™ï¼Œè€Œä¸”è¿˜åœ¨æŠ½ç©ºå®Œæˆå­¦æ ¡çš„æ¯•ä¸šè®¾è®¡ã€‚ä»Šå¤©æ™šä¸ŠæŠ½ç©ºæŠŠå¤§å­¦æœŸé—´å†™è¿‡çš„åšå®¢å¼„ä¸€ä¸ªç³»åˆ—æ–‡ç« åˆé›†ï¼Œç®—æ˜¯å¯¹å¤§å­¦è¿™å››å¹´çš„ä¸€ä¸ªæ€»ç»“ï¼Œè¯æ˜è‡ªå·±æ²¡ç™½è¿‡ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="åšå®¢åˆé›†" scheme="http://yoursite.com/tags/%E5%8D%9A%E5%AE%A2%E5%90%88%E9%9B%86/"/>
    
  </entry>
  
</feed>
